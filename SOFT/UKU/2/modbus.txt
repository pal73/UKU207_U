; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\modbus.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\modbus.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DAPSENERGIA --omf_browse=.\EXE\modbus.crf modbus.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  CRC16_2 PROC
;;;235    //-----------------------------------------------
;;;236    unsigned short CRC16_2(char* buf, short len)
000000  b570              PUSH     {r4-r6,lr}
;;;237    {
000002  4605              MOV      r5,r0
;;;238    unsigned short crc = 0xFFFF;
000004  f64f70ff          MOV      r0,#0xffff
;;;239    short pos;
;;;240    short i;
;;;241    
;;;242    for (pos = 0; pos < len; pos++)
000008  f04f0300          MOV      r3,#0
;;;243      	{
;;;244        	crc ^= (unsigned short)buf[pos];          // XOR byte into least sig. byte of crc
;;;245    
;;;246        	for ( i = 8; i != 0; i--) 
;;;247    		{    // Loop over each bit
;;;248          	if ((crc & 0x0001) != 0) 
;;;249    			{      // If the LSB is set
;;;250            		crc >>= 1;                    // Shift right and XOR 0xA001
;;;251            		crc ^= 0xA001;
00000c  f24a0401          MOV      r4,#0xa001
000010  e015              B        |L1.62|
                  |L1.18|
000012  5cea              LDRB     r2,[r5,r3]            ;244
000014  ea820000          EOR      r0,r2,r0              ;244
000018  f04f0208          MOV      r2,#8                 ;246
                  |L1.28|
00001c  07c6              LSLS     r6,r0,#31             ;248
00001e  d004              BEQ      |L1.42|
000020  ea4f0050          LSR      r0,r0,#1              ;250
000024  ea800004          EOR      r0,r0,r4
000028  e001              B        |L1.46|
                  |L1.42|
;;;252          		}
;;;253          	else  crc >>= 1;                    // Just shift right
00002a  ea4f0050          LSR      r0,r0,#1
                  |L1.46|
00002e  f1a20201          SUB      r2,r2,#1              ;246
000032  b212              SXTH     r2,r2                 ;246
000034  2a00              CMP      r2,#0                 ;246
000036  d1f1              BNE      |L1.28|
000038  f1030301          ADD      r3,r3,#1              ;242
00003c  b21b              SXTH     r3,r3                 ;242
                  |L1.62|
00003e  428b              CMP      r3,r1                 ;242
000040  dbe7              BLT      |L1.18|
;;;254        		}
;;;255      	}
;;;256      // Note, this number has low and high bytes swapped, so use it accordingly (or swap bytes)
;;;257    return crc;
;;;258    }
000042  bd70              POP      {r4-r6,pc}
;;;259    
                          ENDP

                  modbus_hold_registers_transmit PROC
;;;1028   //-----------------------------------------------
;;;1029   void modbus_hold_registers_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr,unsigned short reg_quantity, char prot)
000044  b5f0              PUSH     {r4-r7,lr}
;;;1030   {
000046  b0a7              SUB      sp,sp,#0x9c
000048  461d              MOV      r5,r3
00004a  9b2c              LDR      r3,[sp,#0xb0]
00004c  4604              MOV      r4,r0
00004e  460f              MOV      r7,r1
;;;1031   signed char modbus_registers[150];
;;;1032   //char modbus_tx_buff[150];
;;;1033   unsigned short crc_temp;
;;;1034   char i;
;;;1035   
;;;1036   modbus_registers[20]=(char)((LPC_RTC->YEAR)>>8);			//Рег11  Время, год
000050  48ff              LDR      r0,|L1.1104|
000052  8b81              LDRH     r1,[r0,#0x1c]
000054  ea4f2111          LSR      r1,r1,#8
000058  f88d1018          STRB     r1,[sp,#0x18]
;;;1037   modbus_registers[21]=(char)((LPC_RTC->YEAR));
00005c  8b81              LDRH     r1,[r0,#0x1c]
00005e  f88d1019          STRB     r1,[sp,#0x19]
;;;1038   modbus_registers[22]=(char)((LPC_RTC->MONTH)>>8);		//Рег12  Время, месяц
000062  7e01              LDRB     r1,[r0,#0x18]
000064  f04f0100          MOV      r1,#0
000068  f88d101a          STRB     r1,[sp,#0x1a]
;;;1039   modbus_registers[23]=(char)((LPC_RTC->MONTH));
00006c  7e06              LDRB     r6,[r0,#0x18]
00006e  f88d601b          STRB     r6,[sp,#0x1b]
;;;1040   modbus_registers[24]=(char)((LPC_RTC->DOM)>>8);			//Рег13  Время, день месяца
000072  7b06              LDRB     r6,[r0,#0xc]
000074  f88d101c          STRB     r1,[sp,#0x1c]
;;;1041   modbus_registers[25]=(char)((LPC_RTC->DOM));
000078  7b06              LDRB     r6,[r0,#0xc]
00007a  f88d601d          STRB     r6,[sp,#0x1d]
;;;1042   modbus_registers[26]=(char)((LPC_RTC->HOUR)>>8);			//Рег14  Время, час
00007e  7a06              LDRB     r6,[r0,#8]
000080  f88d101e          STRB     r1,[sp,#0x1e]
;;;1043   modbus_registers[27]=(char)((LPC_RTC->HOUR));
000084  7a06              LDRB     r6,[r0,#8]
000086  f88d601f          STRB     r6,[sp,#0x1f]
;;;1044   modbus_registers[28]=(char)((LPC_RTC->MIN)>>8);			//Рег15  Время, минуты
00008a  7906              LDRB     r6,[r0,#4]
00008c  f88d1020          STRB     r1,[sp,#0x20]
;;;1045   modbus_registers[29]=(char)((LPC_RTC->MIN));
000090  7906              LDRB     r6,[r0,#4]
000092  f88d6021          STRB     r6,[sp,#0x21]
;;;1046   modbus_registers[30]=(char)((LPC_RTC->SEC)>>8);			//Рег16  Время, секунды
000096  7806              LDRB     r6,[r0,#0]
000098  f88d1022          STRB     r1,[sp,#0x22]
;;;1047   modbus_registers[31]=(char)((LPC_RTC->SEC));
00009c  7800              LDRB     r0,[r0,#0]
00009e  f88d0023          STRB     r0,[sp,#0x23]
;;;1048   modbus_registers[38]=(char)(NUMIST>>8);				//Рег20  Количество выпрямителей в структуре
0000a2  48ec              LDR      r0,|L1.1108|
0000a4  8800              LDRH     r0,[r0,#0]  ; NUMIST
0000a6  ea4f2120          ASR      r1,r0,#8
0000aa  f88d102a          STRB     r1,[sp,#0x2a]
;;;1049   modbus_registers[39]=(char)(NUMIST);
0000ae  f88d002b          STRB     r0,[sp,#0x2b]
;;;1050   modbus_registers[40]=(char)(PAR>>8);					//Рег21  Параллельная работа выпрямителей вкл./выкл.
0000b2  48e9              LDR      r0,|L1.1112|
0000b4  8800              LDRH     r0,[r0,#0]  ; PAR
0000b6  ea4f2120          ASR      r1,r0,#8
0000ba  f88d102c          STRB     r1,[sp,#0x2c]
;;;1051   modbus_registers[41]=(char)(PAR);
0000be  f88d002d          STRB     r0,[sp,#0x2d]
;;;1052   modbus_registers[42]=(char)(ZV_ON>>8);					//Рег22  Звуковая аварийная сигнализация вкл./выкл.
0000c2  48e6              LDR      r0,|L1.1116|
0000c4  8800              LDRH     r0,[r0,#0]  ; ZV_ON
0000c6  ea4f2120          ASR      r1,r0,#8
0000ca  f88d102e          STRB     r1,[sp,#0x2e]
;;;1053   modbus_registers[43]=(char)(ZV_ON);
0000ce  f88d002f          STRB     r0,[sp,#0x2f]
;;;1054   modbus_registers[46]=(char)(UBM_AV>>8);				//Рег24  Аварийный уровень отклонения напряжения средней точки батареи, %
0000d2  48e3              LDR      r0,|L1.1120|
0000d4  8800              LDRH     r0,[r0,#0]  ; UBM_AV
0000d6  ea4f2120          ASR      r1,r0,#8
0000da  f88d1032          STRB     r1,[sp,#0x32]
;;;1055   modbus_registers[47]=(char)(UBM_AV);
0000de  f88d0033          STRB     r0,[sp,#0x33]
;;;1056   modbus_registers[58]=(char)(TBAT>>8);					//Рег30  Период проверки цепи батареи, минут.
0000e2  48e0              LDR      r0,|L1.1124|
0000e4  8800              LDRH     r0,[r0,#0]  ; TBAT
0000e6  ea4f2120          ASR      r1,r0,#8
0000ea  f88d103e          STRB     r1,[sp,#0x3e]
;;;1057   modbus_registers[59]=(char)(TBAT);
0000ee  f88d003f          STRB     r0,[sp,#0x3f]
;;;1058   modbus_registers[60]=(char)(UMAX>>8);					//Рег31  Максимальное (аварийное) напряжение выпрямителей, 0.1В
0000f2  48dd              LDR      r0,|L1.1128|
0000f4  8800              LDRH     r0,[r0,#0]  ; UMAX
0000f6  ea4f2120          ASR      r1,r0,#8
0000fa  f88d1040          STRB     r1,[sp,#0x40]
;;;1059   modbus_registers[61]=(char)(UMAX);
0000fe  f88d0041          STRB     r0,[sp,#0x41]
;;;1060   modbus_registers[62]=(char)((UB20-DU)>>8);				//Рег32  Минимальное (аварийное) напряжение выпрямителей, 0.1В
000102  48da              LDR      r0,|L1.1132|
000104  49da              LDR      r1,|L1.1136|
000106  8800              LDRH     r0,[r0,#0]  ; UB20
000108  8809              LDRH     r1,[r1,#0]  ; DU
00010a  eba00101          SUB      r1,r0,r1
00010e  ea4f2621          ASR      r6,r1,#8
000112  f88d6042          STRB     r6,[sp,#0x42]
;;;1061   modbus_registers[63]=(char)((UB20-DU));
000116  f88d1043          STRB     r1,[sp,#0x43]
;;;1062   modbus_registers[64]=(char)(UB0>>8);					//Рег33  Напряжение содержания батареи при 0гЦ, 0.1В
00011a  49d6              LDR      r1,|L1.1140|
00011c  8809              LDRH     r1,[r1,#0]  ; UB0
00011e  ea4f2621          ASR      r6,r1,#8
000122  f88d6044          STRB     r6,[sp,#0x44]
;;;1063   modbus_registers[65]=(char)(UB0);
000126  f88d1045          STRB     r1,[sp,#0x45]
;;;1064   modbus_registers[66]=(char)(UB20>>8);					//Рег34  Напряжение содержания батареи при 20гЦ, 0.1В
00012a  ea4f2120          ASR      r1,r0,#8
00012e  f88d1046          STRB     r1,[sp,#0x46]
;;;1065   modbus_registers[67]=(char)(UB20);
000132  f88d0047          STRB     r0,[sp,#0x47]
;;;1066   modbus_registers[68]=(char)(USIGN>>8);					//Рег35  Минимальное (сигнальное) напряжение батареи, 1В
000136  48d0              LDR      r0,|L1.1144|
000138  8800              LDRH     r0,[r0,#0]  ; USIGN
00013a  ea4f2120          ASR      r1,r0,#8
00013e  f88d1048          STRB     r1,[sp,#0x48]
;;;1067   modbus_registers[69]=(char)(USIGN);
000142  f88d0049          STRB     r0,[sp,#0x49]
;;;1068   modbus_registers[70]=(char)(UMN>>8);					//Рег36  Минимальное (аварийное) напряжение питающей сети, 1В
000146  48cd              LDR      r0,|L1.1148|
000148  8800              LDRH     r0,[r0,#0]  ; UMN
00014a  ea4f2120          ASR      r1,r0,#8
00014e  f88d104a          STRB     r1,[sp,#0x4a]
;;;1069   modbus_registers[71]=(char)(UMN);
000152  f88d004b          STRB     r0,[sp,#0x4b]
;;;1070   modbus_registers[72]=(char)(U0B>>8);					//Рег37  Рабочее напряжение при невведенных батареях, 0.1В
000156  48ca              LDR      r0,|L1.1152|
000158  8800              LDRH     r0,[r0,#0]  ; U0B
00015a  ea4f2120          ASR      r1,r0,#8
00015e  f88d104c          STRB     r1,[sp,#0x4c]
;;;1071   modbus_registers[73]=(char)(U0B);
000162  f88d004d          STRB     r0,[sp,#0x4d]
;;;1072   modbus_registers[74]=(char)(IKB>>8);					//Рег38  Ток контроля наличия батареи, 0.1а
000166  48c7              LDR      r0,|L1.1156|
000168  8800              LDRH     r0,[r0,#0]  ; IKB
00016a  ea4f2120          ASR      r1,r0,#8
00016e  f88d104e          STRB     r1,[sp,#0x4e]
;;;1073   modbus_registers[75]=(char)(IKB);
000172  f88d004f          STRB     r0,[sp,#0x4f]
;;;1074   modbus_registers[76]=(char)(IZMAX>>8);					//Рег39  Ток заряда батареи максимальный, 0.1А
000176  48c4              LDR      r0,|L1.1160|
000178  8800              LDRH     r0,[r0,#0]  ; IZMAX
00017a  ea4f2120          ASR      r1,r0,#8
00017e  f88d1050          STRB     r1,[sp,#0x50]
;;;1075   modbus_registers[77]=(char)(IZMAX);
000182  f88d0051          STRB     r0,[sp,#0x51]
;;;1076   modbus_registers[78]=(char)(IMAX>>8);					//Рег40  Ток переключения на большее кол-во выпрямителей, 0.1А
000186  48c1              LDR      r0,|L1.1164|
000188  8800              LDRH     r0,[r0,#0]  ; IMAX
00018a  ea4f2120          ASR      r1,r0,#8
00018e  f88d1052          STRB     r1,[sp,#0x52]
;;;1077   modbus_registers[79]=(char)(IMAX);
000192  f88d0053          STRB     r0,[sp,#0x53]
;;;1078   modbus_registers[80]=(char)(IMIN>>8);					//Рег41  Ток переключения на меньшее кол-во выпрямителей, 0.1А
000196  48be              LDR      r0,|L1.1168|
000198  8800              LDRH     r0,[r0,#0]  ; IMIN
00019a  ea4f2120          ASR      r1,r0,#8
00019e  f88d1054          STRB     r1,[sp,#0x54]
;;;1079   modbus_registers[81]=(char)(IMIN);
0001a2  f88d0055          STRB     r0,[sp,#0x55]
;;;1080   modbus_registers[82]=(char)(UVZ>>8);					//Рег42  Напряжение выравнивающего заряда, 0.1В
0001a6  48bb              LDR      r0,|L1.1172|
0001a8  8800              LDRH     r0,[r0,#0]  ; UVZ
0001aa  ea4f2120          ASR      r1,r0,#8
0001ae  f88d1056          STRB     r1,[sp,#0x56]
;;;1081   modbus_registers[83]=(char)(UVZ);
0001b2  f88d0057          STRB     r0,[sp,#0x57]
;;;1082   modbus_registers[84]=(char)(TZAS>>8);					//Рег43  Время задержки включения выпрямителей, сек
0001b6  48b8              LDR      r0,|L1.1176|
0001b8  8800              LDRH     r0,[r0,#0]  ; TZAS
0001ba  ea4f2120          ASR      r1,r0,#8
0001be  f88d1058          STRB     r1,[sp,#0x58]
;;;1083   modbus_registers[85]=(char)(TZAS);
0001c2  f88d0059          STRB     r0,[sp,#0x59]
;;;1084   modbus_registers[86]=(char)(TMAX>>8);					//Рег44  Температура выпрямителей аварийная, 1гЦ
0001c6  48b5              LDR      r0,|L1.1180|
0001c8  8800              LDRH     r0,[r0,#0]  ; TMAX
0001ca  ea4f2120          ASR      r1,r0,#8
0001ce  f88d105a          STRB     r1,[sp,#0x5a]
;;;1085   modbus_registers[87]=(char)(TMAX);
0001d2  f88d005b          STRB     r0,[sp,#0x5b]
;;;1086   modbus_registers[88]=(char)(TSIGN>>8);					//Рег45  Температура выпрямителей сигнальная, 1гЦ
0001d6  48b2              LDR      r0,|L1.1184|
0001d8  8800              LDRH     r0,[r0,#0]  ; TSIGN
0001da  ea4f2120          ASR      r1,r0,#8
0001de  f88d105c          STRB     r1,[sp,#0x5c]
;;;1087   modbus_registers[89]=(char)(TSIGN);
0001e2  f88d005d          STRB     r0,[sp,#0x5d]
;;;1088   modbus_registers[90]=(char)(TBATMAX>>8);				//Рег46  Температура батареи аварийная, 1гЦ
0001e6  48af              LDR      r0,|L1.1188|
0001e8  8800              LDRH     r0,[r0,#0]  ; TBATMAX
0001ea  ea4f2120          ASR      r1,r0,#8
0001ee  f88d105e          STRB     r1,[sp,#0x5e]
;;;1089   modbus_registers[91]=(char)(TBATMAX);
0001f2  f88d005f          STRB     r0,[sp,#0x5f]
;;;1090   modbus_registers[92]=(char)(TBATSIGN>>8);				//Рег47  Температура батареи сигнальная, 1гЦ
0001f6  48ac              LDR      r0,|L1.1192|
0001f8  8800              LDRH     r0,[r0,#0]  ; TBATSIGN
0001fa  ea4f2120          ASR      r1,r0,#8
0001fe  f88d1060          STRB     r1,[sp,#0x60]
;;;1091   modbus_registers[93]=(char)(TBATSIGN);
000202  f88d0061          STRB     r0,[sp,#0x61]
;;;1092   modbus_registers[94]=(char)(speedChrgCurr>>8);					//Рег48  Ток ускоренного заряда, 0.1А
000206  48a9              LDR      r0,|L1.1196|
000208  8800              LDRH     r0,[r0,#0]  ; speedChrgCurr
00020a  ea4f2120          ASR      r1,r0,#8
00020e  f88d1062          STRB     r1,[sp,#0x62]
;;;1093   modbus_registers[95]=(char)(speedChrgCurr);
000212  f88d0063          STRB     r0,[sp,#0x63]
;;;1094   modbus_registers[96]=(char)(speedChrgVolt>>8);				//Рег49	 Напряжение ускоренного заряда, 0.1В 
000216  48a6              LDR      r0,|L1.1200|
000218  8800              LDRH     r0,[r0,#0]  ; speedChrgVolt
00021a  ea4f2120          ASR      r1,r0,#8
00021e  f88d1064          STRB     r1,[sp,#0x64]
;;;1095   modbus_registers[97]=(char)(speedChrgVolt);
000222  f88d0065          STRB     r0,[sp,#0x65]
;;;1096   modbus_registers[98]=(char)(speedChrgTimeInHour>>8);				//Рег50	 Время ускоренного заряда, 1ч
000226  48a3              LDR      r0,|L1.1204|
000228  8800              LDRH     r0,[r0,#0]  ; speedChrgTimeInHour
00022a  ea4f2120          ASR      r1,r0,#8
00022e  f88d1066          STRB     r1,[sp,#0x66]
;;;1097   modbus_registers[99]=(char)(speedChrgTimeInHour);
000232  f88d0067          STRB     r0,[sp,#0x67]
;;;1098   modbus_registers[100]=(char)(U_OUT_KONTR_MAX>>8);					//Рег51	 Контроль выходного напряжения, Umax, 0.1В
000236  48a0              LDR      r0,|L1.1208|
000238  8800              LDRH     r0,[r0,#0]  ; U_OUT_KONTR_MAX
00023a  ea4f2120          ASR      r1,r0,#8
00023e  f88d1068          STRB     r1,[sp,#0x68]
;;;1099   modbus_registers[101]=(char)(U_OUT_KONTR_MAX);
000242  f88d0069          STRB     r0,[sp,#0x69]
;;;1100   modbus_registers[102]=(char)(U_OUT_KONTR_MIN>>8);					//Рег52	 Контроль выходного напряжения, Umin, 0.1В
000246  489d              LDR      r0,|L1.1212|
000248  8800              LDRH     r0,[r0,#0]  ; U_OUT_KONTR_MIN
00024a  ea4f2120          ASR      r1,r0,#8
00024e  f88d106a          STRB     r1,[sp,#0x6a]
;;;1101   modbus_registers[103]=(char)(U_OUT_KONTR_MIN);
000252  f88d006b          STRB     r0,[sp,#0x6b]
;;;1102   modbus_registers[104]=(char)(U_OUT_KONTR_DELAY>>8);				//Рег53	 Контроль выходного напряжения, Tзадержки, 1сек.
000256  489a              LDR      r0,|L1.1216|
000258  8800              LDRH     r0,[r0,#0]  ; U_OUT_KONTR_DELAY
00025a  ea4f2120          ASR      r1,r0,#8
00025e  f88d106c          STRB     r1,[sp,#0x6c]
;;;1103   modbus_registers[105]=(char)(U_OUT_KONTR_DELAY);
000262  f88d006d          STRB     r0,[sp,#0x6d]
;;;1104   
;;;1105   
;;;1106   
;;;1107   
;;;1108   if(prot==MODBUS_RTU_PROT)
;;;1109   	{
;;;1110   	modbus_tx_buff[0]=adr;
;;;1111   	modbus_tx_buff[1]=func;
;;;1112   	modbus_tx_buff[2]=(char)(reg_quantity*2);
;;;1113   	mem_copy((char*)&modbus_tx_buff[3],(char*)&modbus_registers[(reg_adr-1)*2],reg_quantity*2);
000266  f1a20201          SUB      r2,r2,#1
00026a  a801              ADD      r0,sp,#4              ;1031
00026c  eb000142          ADD      r1,r0,r2,LSL #1
000270  b12b              CBZ      r3,|L1.638|
;;;1114   	
;;;1115   	crc_temp=CRC16_2(modbus_tx_buff,(reg_quantity*2)+3);
;;;1116   
;;;1117   	modbus_tx_buff[3+(reg_quantity*2)]=(char)crc_temp;
;;;1118   	modbus_tx_buff[4+(reg_quantity*2)]=crc_temp>>8;
;;;1119   
;;;1120   	for (i=0;i<(5+(reg_quantity*2));i++)
;;;1121   		{
;;;1122   		putchar0(modbus_tx_buff[i]);
;;;1123   		}
;;;1124   
;;;1125   	for (i=0;i<(5+(reg_quantity*2));i++)
;;;1126   		{
;;;1127   		putchar_sc16is700(modbus_tx_buff[i]);
;;;1128   		}
;;;1129   	}
;;;1130   else if(prot==MODBUS_TCP_PROT)
000272  2b01              CMP      r3,#1
000274  d101              BNE      |L1.634|
;;;1131   	{
;;;1132   	modbus_tcp_out_ptr=(char*)&modbus_registers[(reg_adr-1)*2];
000276  4893              LDR      r0,|L1.1220|
000278  6001              STR      r1,[r0,#0]  ; modbus_tcp_out_ptr
                  |L1.634|
;;;1133   	}
;;;1134   }
00027a  b027              ADD      sp,sp,#0x9c
00027c  bdf0              POP      {r4-r7,pc}
                  |L1.638|
00027e  4e92              LDR      r6,|L1.1224|
000280  7034              STRB     r4,[r6,#0]            ;1110
000282  7077              STRB     r7,[r6,#1]            ;1111
000284  ea4f0245          LSL      r2,r5,#1              ;1112
000288  70b2              STRB     r2,[r6,#2]            ;1112
00028a  f1060003          ADD      r0,r6,#3              ;1113
00028e  f7fffffe          BL       mem_copy
000292  2003              MOVS     r0,#3                 ;1115
000294  eb000045          ADD      r0,r0,r5,LSL #1       ;1115
000298  b201              SXTH     r1,r0                 ;1115
00029a  4630              MOV      r0,r6                 ;1115
00029c  f7fffffe          BL       CRC16_2
0002a0  eb060145          ADD      r1,r6,r5,LSL #1       ;1117
0002a4  70c8              STRB     r0,[r1,#3]            ;1117
0002a6  ea4f2010          LSR      r0,r0,#8              ;1118
0002aa  7108              STRB     r0,[r1,#4]            ;1118
0002ac  f04f0400          MOV      r4,#0                 ;1120
0002b0  f04f0005          MOV      r0,#5                 ;1120
0002b4  eb000545          ADD      r5,r0,r5,LSL #1       ;1120
0002b8  e005              B        |L1.710|
                  |L1.698|
0002ba  5d30              LDRB     r0,[r6,r4]            ;1122
0002bc  f7fffffe          BL       putchar0
0002c0  f1040401          ADD      r4,r4,#1              ;1120
0002c4  b2e4              UXTB     r4,r4                 ;1120
                  |L1.710|
0002c6  42a5              CMP      r5,r4                 ;1120
0002c8  d8f7              BHI      |L1.698|
0002ca  f04f0400          MOV      r4,#0                 ;1125
0002ce  e005              B        |L1.732|
                  |L1.720|
0002d0  5d30              LDRB     r0,[r6,r4]            ;1127
0002d2  f7fffffe          BL       putchar_sc16is700
0002d6  f1040401          ADD      r4,r4,#1              ;1125
0002da  b2e4              UXTB     r4,r4                 ;1125
                  |L1.732|
0002dc  42a5              CMP      r5,r4                 ;1125
0002de  d8f7              BHI      |L1.720|
0002e0  e7cb              B        |L1.634|
;;;1135   
                          ENDP

                  modbus_input_registers_transmit PROC
;;;1136   //-----------------------------------------------
;;;1137   void modbus_input_registers_transmit(unsigned char adr,unsigned char func,unsigned short reg_adr,unsigned short reg_quantity, char prot)
0002e2  e92d41f0          PUSH     {r4-r8,lr}
;;;1138   {
0002e6  b0fe              SUB      sp,sp,#0x1f8
0002e8  461d              MOV      r5,r3
0002ea  9e84              LDR      r6,[sp,#0x210]
;;;1139   signed char modbus_registers[500];
;;;1140   //char modbus_tx_buff[200];
;;;1141   unsigned short crc_temp;
;;;1142   char i;
;;;1143   short tempS;
;;;1144   
;;;1145   //tempS=(MODBUS_INPUT_REGS[0]);
;;;1146   
;;;1147   modbus_registers[0]=(signed char)(out_U>>8);					//Рег1   	напряжение выходной шины, 0.1В
0002ec  4b77              LDR      r3,|L1.1228|
0002ee  881b              LDRH     r3,[r3,#0]  ; out_U
0002f0  ea4f2423          ASR      r4,r3,#8
0002f4  f88d4004          STRB     r4,[sp,#4]
;;;1148   modbus_registers[1]=(signed char)(out_U);
0002f8  f88d3005          STRB     r3,[sp,#5]
;;;1149   modbus_registers[2]=(signed char)(bps_I>>8);					//Рег2   	ток выпрямителей, 0.1А
0002fc  4b74              LDR      r3,|L1.1232|
0002fe  881b              LDRH     r3,[r3,#0]  ; bps_I
000300  ea4f2423          ASR      r4,r3,#8
000304  f88d4006          STRB     r4,[sp,#6]
;;;1150   modbus_registers[3]=(signed char)(bps_I);
000308  f88d3007          STRB     r3,[sp,#7]
;;;1151   modbus_registers[4]=(signed char)(net_U>>8);					//Рег3   	напряжение сети питания, 1В
00030c  4b71              LDR      r3,|L1.1236|
00030e  881b              LDRH     r3,[r3,#0]  ; net_U
000310  ea4f2423          ASR      r4,r3,#8
000314  f88d4008          STRB     r4,[sp,#8]
;;;1152   modbus_registers[5]=(signed char)(net_U);
000318  f88d3009          STRB     r3,[sp,#9]
;;;1153   modbus_registers[6]=(signed char)(net_F>>8);					//Рег4   	частота сети питания, 0.1Гц
00031c  4b6e              LDR      r3,|L1.1240|
00031e  881b              LDRH     r3,[r3,#0]  ; net_F
000320  ea4f2423          ASR      r4,r3,#8
000324  f88d400a          STRB     r4,[sp,#0xa]
;;;1154   modbus_registers[7]=(signed char)(net_F);
000328  f88d300b          STRB     r3,[sp,#0xb]
;;;1155   modbus_registers[8]=(signed char)(net_Ua>>8);					//Рег5	напряжение сети питания фаза A, 1В	
00032c  4b6b              LDR      r3,|L1.1244|
00032e  881b              LDRH     r3,[r3,#0]  ; net_Ua
000330  ea4f2423          ASR      r4,r3,#8
000334  f88d400c          STRB     r4,[sp,#0xc]
;;;1156   modbus_registers[9]=(signed char)(net_Ua);		 	
000338  f88d300d          STRB     r3,[sp,#0xd]
;;;1157   modbus_registers[10]=(signed char)(net_Ub>>8);				//Рег6	напряжение сети питания фаза B, 1В
00033c  4b68              LDR      r3,|L1.1248|
00033e  881b              LDRH     r3,[r3,#0]  ; net_Ub
000340  ea4f2423          ASR      r4,r3,#8
000344  f88d400e          STRB     r4,[sp,#0xe]
;;;1158   modbus_registers[11]=(signed char)(net_Ub);
000348  f88d300f          STRB     r3,[sp,#0xf]
;;;1159   modbus_registers[12]=(signed char)(net_Uc>>8);				//Рег7	напряжение сети питания фаза C, 1В
00034c  4b65              LDR      r3,|L1.1252|
00034e  881b              LDRH     r3,[r3,#0]  ; net_Uc
000350  ea4f2423          ASR      r4,r3,#8
000354  f88d4010          STRB     r4,[sp,#0x10]
;;;1160   modbus_registers[13]=(signed char)(net_Uc);
000358  f88d3011          STRB     r3,[sp,#0x11]
;;;1161   modbus_registers[14]=(signed char)(bat[0]._Ub>>8);				//Рег8	напряжение батареи №1, 0.1В
00035c  4c62              LDR      r4,|L1.1256|
00035e  8863              LDRH     r3,[r4,#2]  ; bat
000360  ea4f2723          ASR      r7,r3,#8
000364  f88d7012          STRB     r7,[sp,#0x12]
;;;1162   modbus_registers[15]=(signed char)(bat[0]._Ub);
000368  f88d3013          STRB     r3,[sp,#0x13]
;;;1163   modbus_registers[16]=(signed char)(bat[0]._Ib>>8);				//Рег9   	ток батареи №1, 0.01А
00036c  8923              LDRH     r3,[r4,#8]  ; bat
00036e  ea4f2723          ASR      r7,r3,#8
000372  f88d7014          STRB     r7,[sp,#0x14]
;;;1164   modbus_registers[17]=(signed char)(bat[0]._Ib);
000376  f88d3015          STRB     r3,[sp,#0x15]
;;;1165   modbus_registers[18]=(signed char)(bat[0]._Tb>>8);				//Рег10	температура батареи №1, 1Гц
00037a  8963              LDRH     r3,[r4,#0xa]  ; bat
00037c  ea4f2723          ASR      r7,r3,#8
000380  f88d7016          STRB     r7,[sp,#0x16]
;;;1166   modbus_registers[19]=(signed char)(bat[0]._Tb);
000384  f88d3017          STRB     r3,[sp,#0x17]
;;;1167   modbus_registers[20]=(signed char)(bat[0]._zar>>8);			//Рег11	заряд батареи №1, %
000388  8a23              LDRH     r3,[r4,#0x10]  ; bat
00038a  ea4f2713          LSR      r7,r3,#8
00038e  f88d7018          STRB     r7,[sp,#0x18]
;;;1168   modbus_registers[21]=(signed char)(bat[0]._zar);
000392  f88d3019          STRB     r3,[sp,#0x19]
;;;1169   modbus_registers[22]=(signed char)(bat[0]._Ubm>>8);			//Рег12	напряжение средней точки батареи №1, 0.1В
000396  88a3              LDRH     r3,[r4,#4]  ; bat
000398  ea4f2723          ASR      r7,r3,#8
00039c  f88d701a          STRB     r7,[sp,#0x1a]
;;;1170   modbus_registers[23]=(signed char)(bat[0]._Ubm);
0003a0  f88d301b          STRB     r3,[sp,#0x1b]
;;;1171   modbus_registers[24]=(signed char)(bat[0]._dUbm>>8);			//Рег13	ошибка средней точки батареи №1, %
0003a4  88e3              LDRH     r3,[r4,#6]  ; bat
0003a6  ea4f2723          ASR      r7,r3,#8
0003aa  f88d701c          STRB     r7,[sp,#0x1c]
;;;1172   modbus_registers[25]=(signed char)(bat[0]._dUbm);
0003ae  f88d301d          STRB     r3,[sp,#0x1d]
;;;1173   modbus_registers[26]=(signed char)(BAT_C_REAL[0]>>8);			//Рег14	Реальная емкость батареи №1, 0.1А*ч, если 0x5555 то не измерялась
0003b2  4f4e              LDR      r7,|L1.1260|
0003b4  883b              LDRH     r3,[r7,#0]  ; BAT_C_REAL
0003b6  ea4f2c23          ASR      r12,r3,#8
0003ba  f88dc01e          STRB     r12,[sp,#0x1e]
;;;1174   modbus_registers[27]=(signed char)(BAT_C_REAL[0]);
0003be  f88d301f          STRB     r3,[sp,#0x1f]
;;;1175   modbus_registers[28]=(signed char)(bat[1]._Ub>>8);				//Рег15	напряжение батареи №1, 0.1В
0003c2  f8b4304e          LDRH     r3,[r4,#0x4e]  ; bat
0003c6  ea4f2c23          ASR      r12,r3,#8
0003ca  f88dc020          STRB     r12,[sp,#0x20]
;;;1176   modbus_registers[29]=(signed char)(bat[1]._Ub);
0003ce  f88d3021          STRB     r3,[sp,#0x21]
;;;1177   modbus_registers[30]=(signed char)(bat[1]._Ib>>8);				//Рег16   	ток батареи №1, 0.01А
0003d2  f8b43054          LDRH     r3,[r4,#0x54]  ; bat
0003d6  ea4f2c23          ASR      r12,r3,#8
0003da  f88dc022          STRB     r12,[sp,#0x22]
;;;1178   modbus_registers[31]=(signed char)(bat[1]._Ib);
0003de  f88d3023          STRB     r3,[sp,#0x23]
;;;1179   modbus_registers[32]=(signed char)(bat[1]._Tb>>8);				//Рег17	температура батареи №1, 1Гц
0003e2  f8b43056          LDRH     r3,[r4,#0x56]  ; bat
0003e6  ea4f2c23          ASR      r12,r3,#8
0003ea  f88dc024          STRB     r12,[sp,#0x24]
;;;1180   modbus_registers[33]=(signed char)(bat[1]._Tb);
0003ee  f88d3025          STRB     r3,[sp,#0x25]
;;;1181   modbus_registers[34]=(signed char)(bat[1]._zar>>8);			//Рег18	заряд батареи №1, %
0003f2  f8b4305c          LDRH     r3,[r4,#0x5c]  ; bat
0003f6  ea4f2c13          LSR      r12,r3,#8
0003fa  f88dc026          STRB     r12,[sp,#0x26]
;;;1182   modbus_registers[35]=(signed char)(bat[1]._zar);
0003fe  f88d3027          STRB     r3,[sp,#0x27]
;;;1183   modbus_registers[36]=(signed char)(bat[1]._Ubm>>8);			//Рег19	напряжение средней точки батареи №1, 0.1В
000402  f8b43050          LDRH     r3,[r4,#0x50]  ; bat
000406  ea4f2c23          ASR      r12,r3,#8
00040a  f88dc028          STRB     r12,[sp,#0x28]
;;;1184   modbus_registers[37]=(signed char)(bat[1]._Ubm);
00040e  f88d3029          STRB     r3,[sp,#0x29]
;;;1185   modbus_registers[38]=(signed char)(bat[1]._dUbm>>8);			//Рег20	ошибка средней точки батареи №1, %
000412  f8b43052          LDRH     r3,[r4,#0x52]  ; bat
000416  ea4f2423          ASR      r4,r3,#8
00041a  f88d402a          STRB     r4,[sp,#0x2a]
;;;1186   modbus_registers[39]=(signed char)(bat[1]._dUbm);
00041e  f88d302b          STRB     r3,[sp,#0x2b]
;;;1187   modbus_registers[40]=(signed char)(BAT_C_REAL[1]>>8);			//Рег21	Реальная емкость батареи №1, 0.1А*ч, если 0x5555 то не измерялась
000422  887b              LDRH     r3,[r7,#2]  ; BAT_C_REAL
000424  ea4f2423          ASR      r4,r3,#8
000428  f88d402c          STRB     r4,[sp,#0x2c]
;;;1188   modbus_registers[41]=(signed char)(BAT_C_REAL[1]);
00042c  f88d302d          STRB     r3,[sp,#0x2d]
;;;1189   modbus_registers[42]=(signed char)(bps[0]._Uii>>8);			//Рег22	Выходное напряжение выпрямителя №1, 0.1В
000430  4c2f              LDR      r4,|L1.1264|
000432  69e3              LDR      r3,[r4,#0x1c]  ; bps
000434  ea4f2723          ASR      r7,r3,#8
000438  f88d702e          STRB     r7,[sp,#0x2e]
;;;1190   modbus_registers[43]=(signed char)(bps[0]._Uii);
00043c  f88d302f          STRB     r3,[sp,#0x2f]
;;;1191   modbus_registers[44]=(signed char)(bps[0]._Ii>>8);				//Рег23	Выходной ток выпрямителя №1, 0.1А
000440  6a63              LDR      r3,[r4,#0x24]  ; bps
000442  ea4f2723          ASR      r7,r3,#8
000446  f88d7030          STRB     r7,[sp,#0x30]
;;;1192   modbus_registers[45]=(signed char)(bps[0]._Ii);
00044a  f88d3031          STRB     r3,[sp,#0x31]
;;;1193   modbus_registers[46]=(signed char)(bps[0]._Ti>>8);				//Рег24	Температура радиатора выпрямителя №1, 1гЦ
00044e  e051              B        |L1.1268|
                  |L1.1104|
                          DCD      0x40024020
                  |L1.1108|
                          DCD      NUMIST
                  |L1.1112|
                          DCD      PAR
                  |L1.1116|
                          DCD      ZV_ON
                  |L1.1120|
                          DCD      UBM_AV
                  |L1.1124|
                          DCD      TBAT
                  |L1.1128|
                          DCD      UMAX
                  |L1.1132|
                          DCD      UB20
                  |L1.1136|
                          DCD      ||DU||
                  |L1.1140|
                          DCD      UB0
                  |L1.1144|
                          DCD      USIGN
                  |L1.1148|
                          DCD      UMN
                  |L1.1152|
                          DCD      U0B
                  |L1.1156|
                          DCD      IKB
                  |L1.1160|
                          DCD      IZMAX
                  |L1.1164|
                          DCD      IMAX
                  |L1.1168|
                          DCD      IMIN
                  |L1.1172|
                          DCD      UVZ
                  |L1.1176|
                          DCD      TZAS
                  |L1.1180|
                          DCD      TMAX
                  |L1.1184|
                          DCD      TSIGN
                  |L1.1188|
                          DCD      TBATMAX
                  |L1.1192|
                          DCD      TBATSIGN
                  |L1.1196|
                          DCD      speedChrgCurr
                  |L1.1200|
                          DCD      speedChrgVolt
                  |L1.1204|
                          DCD      speedChrgTimeInHour
                  |L1.1208|
                          DCD      U_OUT_KONTR_MAX
                  |L1.1212|
                          DCD      U_OUT_KONTR_MIN
                  |L1.1216|
                          DCD      U_OUT_KONTR_DELAY
                  |L1.1220|
                          DCD      modbus_tcp_out_ptr
                  |L1.1224|
                          DCD      ||area_number.4||+0x3c
                  |L1.1228|
                          DCD      out_U
                  |L1.1232|
                          DCD      bps_I
                  |L1.1236|
                          DCD      net_U
                  |L1.1240|
                          DCD      net_F
                  |L1.1244|
                          DCD      net_Ua
                  |L1.1248|
                          DCD      net_Ub
                  |L1.1252|
                          DCD      net_Uc
                  |L1.1256|
                          DCD      bat
                  |L1.1260|
                          DCD      BAT_C_REAL
                  |L1.1264|
                          DCD      bps
                  |L1.1268|
0004f4  6aa3              LDR      r3,[r4,#0x28]  ; bps
0004f6  ea4f2723          ASR      r7,r3,#8
0004fa  f88d7032          STRB     r7,[sp,#0x32]
;;;1194   modbus_registers[47]=(signed char)(bps[0]._Ti);
0004fe  f88d3033          STRB     r3,[sp,#0x33]
;;;1195   modbus_registers[48]=(signed char)(bps[0]._av>>8);				//Рег25	Байт флагов выпрямителя №1, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
000502  f04f0700          MOV      r7,#0
000506  f88d7034          STRB     r7,[sp,#0x34]
;;;1196   modbus_registers[49]=(signed char)(bps[0]._av);
00050a  7863              LDRB     r3,[r4,#1]  ; bps
00050c  f88d3035          STRB     r3,[sp,#0x35]
;;;1197   modbus_registers[50]=(signed char)(bps[1]._Uii>>8);			//Рег26	Выходное напряжение выпрямителя №2, 0.1В
000510  6fa3              LDR      r3,[r4,#0x78]  ; bps
000512  ea4f2c23          ASR      r12,r3,#8
000516  f88dc036          STRB     r12,[sp,#0x36]
;;;1198   modbus_registers[51]=(signed char)(bps[1]._Uii);
00051a  f88d3037          STRB     r3,[sp,#0x37]
;;;1199   modbus_registers[52]=(signed char)(bps[1]._Ii>>8);				//Рег27	Выходной ток выпрямителя №2, 0.1А
00051e  f8d43080          LDR      r3,[r4,#0x80]  ; bps
000522  ea4f2c23          ASR      r12,r3,#8
000526  f88dc038          STRB     r12,[sp,#0x38]
;;;1200   modbus_registers[53]=(signed char)(bps[1]._Ii);
00052a  f88d3039          STRB     r3,[sp,#0x39]
;;;1201   modbus_registers[54]=(signed char)(bps[1]._Ti>>8);				//Рег28	Температура радиатора выпрямителя №2, 1гЦ
00052e  f8d43084          LDR      r3,[r4,#0x84]  ; bps
000532  ea4f2c23          ASR      r12,r3,#8
000536  f88dc03a          STRB     r12,[sp,#0x3a]
;;;1202   modbus_registers[55]=(signed char)(bps[1]._Ti);
00053a  f88d303b          STRB     r3,[sp,#0x3b]
;;;1203   modbus_registers[56]=(signed char)(bps[1]._av>>8);				//Рег29	Байт флагов выпрямителя №2, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
00053e  f88d703c          STRB     r7,[sp,#0x3c]
;;;1204   modbus_registers[57]=(signed char)(bps[1]._av);
000542  f894305d          LDRB     r3,[r4,#0x5d]  ; bps
000546  f88d303d          STRB     r3,[sp,#0x3d]
;;;1205   modbus_registers[58]=(signed char)(bps[2]._Uii>>8);			//Рег30	Выходное напряжение выпрямителя №3, 0.1В
00054a  f8d430d4          LDR      r3,[r4,#0xd4]  ; bps
00054e  ea4f2c23          ASR      r12,r3,#8
000552  f88dc03e          STRB     r12,[sp,#0x3e]
;;;1206   modbus_registers[59]=(signed char)(bps[2]._Uii);
000556  f88d303f          STRB     r3,[sp,#0x3f]
;;;1207   modbus_registers[60]=(signed char)(bps[2]._Ii>>8);				//Рег31	Выходной ток выпрямителя №3, 0.1А
00055a  f8d430dc          LDR      r3,[r4,#0xdc]  ; bps
00055e  ea4f2c23          ASR      r12,r3,#8
000562  f88dc040          STRB     r12,[sp,#0x40]
;;;1208   modbus_registers[61]=(signed char)(bps[2]._Ii);
000566  f88d3041          STRB     r3,[sp,#0x41]
;;;1209   modbus_registers[62]=(signed char)(bps[2]._Ti>>8);				//Рег32	Температура радиатора выпрямителя №3, 1гЦ
00056a  f8d430e0          LDR      r3,[r4,#0xe0]  ; bps
00056e  ea4f2c23          ASR      r12,r3,#8
000572  f88dc042          STRB     r12,[sp,#0x42]
;;;1210   modbus_registers[63]=(signed char)(bps[2]._Ti);
000576  f88d3043          STRB     r3,[sp,#0x43]
;;;1211   modbus_registers[64]=(signed char)(bps[2]._av>>8);				//Рег33	Байт флагов выпрямителя №3, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
00057a  f88d7044          STRB     r7,[sp,#0x44]
;;;1212   modbus_registers[65]=(signed char)(bps[2]._av);
00057e  f89430b9          LDRB     r3,[r4,#0xb9]  ; bps
000582  f88d3045          STRB     r3,[sp,#0x45]
;;;1213   modbus_registers[66]=(signed char)(bps[3]._Uii>>8);			//Рег34	Выходное напряжение выпрямителя №4, 0.1В
000586  f8d43130          LDR      r3,[r4,#0x130]  ; bps
00058a  ea4f2c23          ASR      r12,r3,#8
00058e  f88dc046          STRB     r12,[sp,#0x46]
;;;1214   modbus_registers[67]=(signed char)(bps[3]._Uii);
000592  f88d3047          STRB     r3,[sp,#0x47]
;;;1215   modbus_registers[68]=(signed char)(bps[3]._Ii>>8);				//Рег35	Выходной ток выпрямителя №4, 0.1А
000596  f8d43138          LDR      r3,[r4,#0x138]  ; bps
00059a  ea4f2c23          ASR      r12,r3,#8
00059e  f88dc048          STRB     r12,[sp,#0x48]
;;;1216   modbus_registers[69]=(signed char)(bps[3]._Ii);
0005a2  f88d3049          STRB     r3,[sp,#0x49]
;;;1217   modbus_registers[70]=(signed char)(bps[3]._Ti>>8);				//Рег36	Температура радиатора выпрямителя №4, 1гЦ
0005a6  f8d4313c          LDR      r3,[r4,#0x13c]  ; bps
0005aa  ea4f2c23          ASR      r12,r3,#8
0005ae  f88dc04a          STRB     r12,[sp,#0x4a]
;;;1218   modbus_registers[71]=(signed char)(bps[3]._Ti);
0005b2  f88d304b          STRB     r3,[sp,#0x4b]
;;;1219   modbus_registers[72]=(signed char)(bps[3]._av>>8);				//Рег37	Байт флагов выпрямителя №4, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
0005b6  f88d704c          STRB     r7,[sp,#0x4c]
;;;1220   modbus_registers[73]=(signed char)(bps[3]._av);
0005ba  f8943115          LDRB     r3,[r4,#0x115]  ; bps
0005be  f88d304d          STRB     r3,[sp,#0x4d]
;;;1221   modbus_registers[74]=(signed char)(bps[4]._Uii>>8);			//Рег38	Выходное напряжение выпрямителя №5, 0.1В
0005c2  f8d4318c          LDR      r3,[r4,#0x18c]  ; bps
0005c6  ea4f2c23          ASR      r12,r3,#8
0005ca  f88dc04e          STRB     r12,[sp,#0x4e]
;;;1222   modbus_registers[75]=(signed char)(bps[4]._Uii);
0005ce  f88d304f          STRB     r3,[sp,#0x4f]
;;;1223   modbus_registers[76]=(signed char)(bps[4]._Ii>>8);				//Рег39	Выходной ток выпрямителя №5, 0.1А
0005d2  f8d43194          LDR      r3,[r4,#0x194]  ; bps
0005d6  ea4f2c23          ASR      r12,r3,#8
0005da  f88dc050          STRB     r12,[sp,#0x50]
;;;1224   modbus_registers[77]=(signed char)(bps[4]._Ii);
0005de  f88d3051          STRB     r3,[sp,#0x51]
;;;1225   modbus_registers[78]=(signed char)(bps[4]._Ti>>8);				//Рег40	Температура радиатора выпрямителя №5, 1гЦ
0005e2  f8d43198          LDR      r3,[r4,#0x198]  ; bps
0005e6  ea4f2c23          ASR      r12,r3,#8
0005ea  f88dc052          STRB     r12,[sp,#0x52]
;;;1226   modbus_registers[79]=(signed char)(bps[4]._Ti);
0005ee  f88d3053          STRB     r3,[sp,#0x53]
;;;1227   modbus_registers[80]=(signed char)(bps[4]._av>>8);				//Рег41	Байт флагов выпрямителя №5, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
0005f2  f88d7054          STRB     r7,[sp,#0x54]
;;;1228   modbus_registers[81]=(signed char)(bps[4]._av);
0005f6  f8943171          LDRB     r3,[r4,#0x171]  ; bps
0005fa  f88d3055          STRB     r3,[sp,#0x55]
;;;1229   modbus_registers[82]=(signed char)(bps[5]._Uii>>8);			//Рег42	Выходное напряжение выпрямителя №6, 0.1В
0005fe  f8d431e8          LDR      r3,[r4,#0x1e8]  ; bps
000602  ea4f2c23          ASR      r12,r3,#8
000606  f88dc056          STRB     r12,[sp,#0x56]
;;;1230   modbus_registers[83]=(signed char)(bps[5]._Uii);
00060a  f88d3057          STRB     r3,[sp,#0x57]
;;;1231   modbus_registers[84]=(signed char)(bps[5]._Ii>>8);				//Рег43	Выходной ток выпрямителя №6, 0.1А
00060e  f8d431f0          LDR      r3,[r4,#0x1f0]  ; bps
000612  ea4f2c23          ASR      r12,r3,#8
000616  f88dc058          STRB     r12,[sp,#0x58]
;;;1232   modbus_registers[85]=(signed char)(bps[5]._Ii);
00061a  f88d3059          STRB     r3,[sp,#0x59]
;;;1233   modbus_registers[86]=(signed char)(bps[5]._Ti>>8);				//Рег44	Температура радиатора выпрямителя №6, 1гЦ
00061e  f504740c          ADD      r4,r4,#0x230
000622  f8543c3c          LDR      r3,[r4,#-0x3c]  ; bps
000626  ea4f2c23          ASR      r12,r3,#8
00062a  f88dc05a          STRB     r12,[sp,#0x5a]
;;;1234   modbus_registers[87]=(signed char)(bps[5]._Ti);
00062e  f88d305b          STRB     r3,[sp,#0x5b]
;;;1235   modbus_registers[88]=(signed char)(bps[5]._av>>8);				//Рег45	Байт флагов выпрямителя №6, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
000632  f88d705c          STRB     r7,[sp,#0x5c]
;;;1236   modbus_registers[89]=(signed char)(bps[5]._av);
000636  f8143c63          LDRB     r3,[r4,#-0x63]  ; bps
00063a  f88d305d          STRB     r3,[sp,#0x5d]
;;;1237   modbus_registers[90]=(signed char)(bps[6]._Uii>>8);			//Рег46	Выходное напряжение выпрямителя №7, 0.1В
00063e  6963              LDR      r3,[r4,#0x14]  ; bps
000640  ea4f2c23          ASR      r12,r3,#8
000644  f88dc05e          STRB     r12,[sp,#0x5e]
;;;1238   modbus_registers[91]=(signed char)(bps[6]._Uii);
000648  f88d305f          STRB     r3,[sp,#0x5f]
;;;1239   modbus_registers[92]=(signed char)(bps[6]._Ii>>8);				//Рег47	Выходной ток выпрямителя №7, 0.1А
00064c  69e3              LDR      r3,[r4,#0x1c]  ; bps
00064e  ea4f2c23          ASR      r12,r3,#8
000652  f88dc060          STRB     r12,[sp,#0x60]
;;;1240   modbus_registers[93]=(signed char)(bps[6]._Ii);
000656  f88d3061          STRB     r3,[sp,#0x61]
;;;1241   modbus_registers[94]=(signed char)(bps[6]._Ti>>8);				//Рег48	Температура радиатора выпрямителя №7, 1гЦ
00065a  6a23              LDR      r3,[r4,#0x20]  ; bps
00065c  ea4f2c23          ASR      r12,r3,#8
000660  f88dc062          STRB     r12,[sp,#0x62]
;;;1242   modbus_registers[95]=(signed char)(bps[6]._Ti);
000664  f88d3063          STRB     r3,[sp,#0x63]
;;;1243   modbus_registers[96]=(signed char)(bps[6]._av>>8);				//Рег49	Байт флагов выпрямителя №7, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
000668  f88d7064          STRB     r7,[sp,#0x64]
;;;1244   modbus_registers[97]=(signed char)(bps[6]._av);
00066c  f8143c07          LDRB     r3,[r4,#-7]  ; bps
000670  f88d3065          STRB     r3,[sp,#0x65]
;;;1245   modbus_registers[98]=(signed char)(bps[7]._Uii>>8);			//Рег50	Выходное напряжение выпрямителя №8, 0.1В
000674  6f23              LDR      r3,[r4,#0x70]  ; bps
000676  ea4f2c23          ASR      r12,r3,#8
00067a  f88dc066          STRB     r12,[sp,#0x66]
;;;1246   modbus_registers[99]=(signed char)(bps[7]._Uii);
00067e  f88d3067          STRB     r3,[sp,#0x67]
;;;1247   modbus_registers[100]=(signed char)(bps[7]._Ii>>8);			//Рег51	Выходной ток выпрямителя №8, 0.1А
000682  6fa3              LDR      r3,[r4,#0x78]  ; bps
000684  ea4f2c23          ASR      r12,r3,#8
000688  f88dc068          STRB     r12,[sp,#0x68]
;;;1248   modbus_registers[101]=(signed char)(bps[7]._Ii);
00068c  f88d3069          STRB     r3,[sp,#0x69]
;;;1249   modbus_registers[102]=(signed char)(bps[7]._Ti>>8);			//Рег52	Температура радиатора выпрямителя №8, 1гЦ
000690  6fe3              LDR      r3,[r4,#0x7c]  ; bps
000692  ea4f2c23          ASR      r12,r3,#8
000696  f88dc06a          STRB     r12,[sp,#0x6a]
;;;1250   modbus_registers[103]=(signed char)(bps[7]._Ti);
00069a  f88d306b          STRB     r3,[sp,#0x6b]
;;;1251   modbus_registers[104]=(signed char)(bps[7]._av>>8);			//Рег53	Байт флагов выпрямителя №8, 0x01 - перегрев, 0x02 завышено Uвых, 0x04 занижено Uвых, 0x08 - отсутствует связь с выпрямителем
00069e  f88d706c          STRB     r7,[sp,#0x6c]
;;;1252   modbus_registers[105]=(signed char)(bps[7]._av);
0006a2  f8943055          LDRB     r3,[r4,#0x55]  ; bps
0006a6  f88d306d          STRB     r3,[sp,#0x6d]
;;;1253   modbus_registers[106]=(signed char)(bps_U>>8);					//Рег54   	напряжение выпрямителей, 0.1В
0006aa  4bff              LDR      r3,|L1.2728|
0006ac  881b              LDRH     r3,[r3,#0]  ; bps_U
0006ae  ea4f2423          ASR      r4,r3,#8
0006b2  f88d406e          STRB     r4,[sp,#0x6e]
;;;1254   modbus_registers[107]=(signed char)(bps_U);
0006b6  f88d306f          STRB     r3,[sp,#0x6f]
;;;1255   tempS=0;
0006ba  463b              MOV      r3,r7
;;;1256   if(speedChIsOn) tempS=1;
0006bc  4cfb              LDR      r4,|L1.2732|
0006be  8824              LDRH     r4,[r4,#0]  ; speedChIsOn
0006c0  b10c              CBZ      r4,|L1.1734|
0006c2  f04f0301          MOV      r3,#1
                  |L1.1734|
;;;1257   modbus_registers[108]=(signed char)(tempS>>8);					//Рег55   	Ускоренный заряд включенность, (1 - вкл, 0 - Выкл)
0006c6  ea4f2423          ASR      r4,r3,#8
0006ca  f88d4070          STRB     r4,[sp,#0x70]
;;;1258   modbus_registers[109]=(signed char)(tempS);
0006ce  f88d3071          STRB     r3,[sp,#0x71]
;;;1259   tempS=0;
0006d2  f04f0300          MOV      r3,#0
;;;1260   if(spc_stat==spcVZ) tempS=1;
0006d6  4cf6              LDR      r4,|L1.2736|
0006d8  7824              LDRB     r4,[r4,#0]  ; spc_stat
0006da  2c02              CMP      r4,#2
0006dc  d101              BNE      |L1.1762|
0006de  f04f0301          MOV      r3,#1
                  |L1.1762|
;;;1261   modbus_registers[110]=(signed char)(tempS>>8);					//Рег56   	Выравнивающий заряд включенность, (1 - вкл, 0 - Выкл)
0006e2  ea4f2423          ASR      r4,r3,#8
0006e6  f88d4072          STRB     r4,[sp,#0x72]
;;;1262   modbus_registers[111]=(signed char)(tempS);
0006ea  f88d3073          STRB     r3,[sp,#0x73]
;;;1263   modbus_registers[112]=(signed char)(uout_av>>8);					//Рег57   Контроль выходного напряжения, (0 - норма, 1 - завышено, 2 - занижено)
0006ee  f88d7074          STRB     r7,[sp,#0x74]
;;;1264   modbus_registers[113]=(signed char)(uout_av);
0006f2  4bf0              LDR      r3,|L1.2740|
0006f4  781b              LDRB     r3,[r3,#0]  ; uout_av
0006f6  f88d3075          STRB     r3,[sp,#0x75]
;;;1265   
;;;1266   tempS=0;													 //Рег60	Регистр флагов состояния системы
0006fa  f04f0400          MOV      r4,#0
;;;1267   if(bat_ips._av)			tempS|=(1<<0);						 // Бит 0	Авария батареи
0006fe  4bee              LDR      r3,|L1.2744|
000700  f893303d          LDRB     r3,[r3,#0x3d]  ; bat_ips
000704  b10b              CBZ      r3,|L1.1802|
000706  f04f0401          MOV      r4,#1
                  |L1.1802|
;;;1268   if(avar_stat&0x0001)   	tempS|=(1<<1);						 //	Бит 1	Авария питающей сети 
00070a  4bec              LDR      r3,|L1.2748|
00070c  681b              LDR      r3,[r3,#0]  ; avar_stat
00070e  07df              LSLS     r7,r3,#31
000710  d001              BEQ      |L1.1814|
000712  f0440402          ORR      r4,r4,#2
                  |L1.1814|
;;;1269   if(avar_stat&(1<<(3+0)))tempS|=(1<<2);						 //	Бит 2	Авария выпрямителя №1
000716  071f              LSLS     r7,r3,#28
000718  d501              BPL      |L1.1822|
00071a  f0440404          ORR      r4,r4,#4
                  |L1.1822|
;;;1270   if(avar_stat&(1<<(3+1)))tempS|=(1<<3);						 //	Бит 3	Авария выпрямителя №2
00071e  06df              LSLS     r7,r3,#27
000720  d501              BPL      |L1.1830|
000722  f0440408          ORR      r4,r4,#8
                  |L1.1830|
;;;1271   if(avar_stat&(1<<(3+2)))tempS|=(1<<4);						 //	Бит 4	Авария выпрямителя №2
000726  069b              LSLS     r3,r3,#26
000728  d501              BPL      |L1.1838|
00072a  f0440410          ORR      r4,r4,#0x10
                  |L1.1838|
;;;1272   modbus_registers[118]=(signed char)(tempS>>8);
00072e  ea4f2324          ASR      r3,r4,#8
000732  f88d307a          STRB     r3,[sp,#0x7a]
;;;1273   modbus_registers[119]=(signed char)(tempS);
000736  f88d407b          STRB     r4,[sp,#0x7b]
;;;1274   
;;;1275   tempS=t_ext[0];
00073a  4fe1              LDR      r7,|L1.2752|
00073c  f9b73000          LDRSH    r3,[r7,#0]  ; t_ext
;;;1276   if(ND_EXT[0])tempS=-1000;
000740  f8df8380          LDR      r8,|L1.2756|
000744  f8dfc380          LDR      r12,|L1.2760|
000748  f8984000          LDRB     r4,[r8,#0]  ; ND_EXT
00074c  b104              CBZ      r4,|L1.1872|
00074e  4663              MOV      r3,r12
                  |L1.1872|
;;;1277   modbus_registers[400]=(signed char)(tempS>>8);				//Рег201	Внешний датчик температуры №1
000750  ea4f2423          ASR      r4,r3,#8
000754  f88d4194          STRB     r4,[sp,#0x194]
;;;1278   modbus_registers[401]=(signed char)(tempS);
000758  f88d3195          STRB     r3,[sp,#0x195]
;;;1279   tempS=t_ext[1];
00075c  f9b74002          LDRSH    r4,[r7,#2]  ; t_ext
;;;1280   if(ND_EXT[1])tempS=-1000;
000760  f8983001          LDRB     r3,[r8,#1]  ; ND_EXT
000764  b103              CBZ      r3,|L1.1896|
000766  4664              MOV      r4,r12
                  |L1.1896|
;;;1281   modbus_registers[402]=(signed char)(tempS>>8);				//Рег202	Внешний датчик температуры №2
000768  ea4f2324          ASR      r3,r4,#8
00076c  f88d3196          STRB     r3,[sp,#0x196]
;;;1282   modbus_registers[403]=(signed char)(tempS);
000770  f88d4197          STRB     r4,[sp,#0x197]
;;;1283   tempS=t_ext[2];
000774  f9b77004          LDRSH    r7,[r7,#4]  ; t_ext
;;;1284   if(ND_EXT[2])tempS=-1000;
000778  f8983002          LDRB     r3,[r8,#2]  ; ND_EXT
00077c  b103              CBZ      r3,|L1.1920|
00077e  4667              MOV      r7,r12
                  |L1.1920|
;;;1285   modbus_registers[404]=(signed char)(tempS>>8);				//Рег203	Внешний датчик температуры №3
000780  ea4f2327          ASR      r3,r7,#8
000784  f88d3198          STRB     r3,[sp,#0x198]
;;;1286   modbus_registers[405]=(signed char)(tempS);
000788  f88d7199          STRB     r7,[sp,#0x199]
;;;1287   /*tempS=t_ext[3];
;;;1288   if(ND_EXT[3])tempS=-1000;
;;;1289   modbus_registers[406]=(signed char)(tempS>>8);				//Рег204	Внешний датчик температуры №4
;;;1290   modbus_registers[407]=(signed char)(tempS);   */
;;;1291   
;;;1292   tempS=0;
00078c  f04f0400          MOV      r4,#0
;;;1293   if(sk_stat[0]==ssON) tempS|=0x0001;
000790  f8dfc338          LDR      r12,|L1.2764|
000794  f89c3000          LDRB     r3,[r12,#0]  ; sk_stat
000798  2b01              CMP      r3,#1
00079a  d100              BNE      |L1.1950|
00079c  461c              MOV      r4,r3
                  |L1.1950|
;;;1294   if(sk_av_stat[0]==sasON) tempS|=0x0002;
00079e  4fcc              LDR      r7,|L1.2768|
0007a0  783b              LDRB     r3,[r7,#0]  ; sk_av_stat
0007a2  2b01              CMP      r3,#1
0007a4  d101              BNE      |L1.1962|
0007a6  f0440402          ORR      r4,r4,#2
                  |L1.1962|
;;;1295   modbus_registers[420]=(signed char)(tempS>>8);				//Рег211	Состояние  сухого контакта №1, (нулевой бит - физическое состояние, 1 - замкнут, 0 - разомкнут, первый бит - аварийность, 1 - авария, 0 - норма)
0007aa  ea4f2324          ASR      r3,r4,#8
0007ae  f88d31a8          STRB     r3,[sp,#0x1a8]
;;;1296   modbus_registers[421]=(signed char)(tempS);
0007b2  f88d41a9          STRB     r4,[sp,#0x1a9]
;;;1297   tempS=0;
0007b6  f04f0400          MOV      r4,#0
;;;1298   if(sk_stat[1]==ssON) tempS|=0x0001;
0007ba  f89c3001          LDRB     r3,[r12,#1]  ; sk_stat
0007be  2b01              CMP      r3,#1
0007c0  d100              BNE      |L1.1988|
0007c2  461c              MOV      r4,r3
                  |L1.1988|
;;;1299   if(sk_av_stat[1]==sasON) tempS|=0x0002;
0007c4  787b              LDRB     r3,[r7,#1]  ; sk_av_stat
0007c6  2b01              CMP      r3,#1
0007c8  d101              BNE      |L1.1998|
0007ca  f0440402          ORR      r4,r4,#2
                  |L1.1998|
;;;1300   modbus_registers[422]=(signed char)(tempS>>8);				//Рег212	Состояние  сухого контакта №1, (нулевой бит - физическое состояние, 1 - замкнут, 0 - разомкнут, первый бит - аварийность, 1 - авария, 0 - норма)
0007ce  ea4f2324          ASR      r3,r4,#8
0007d2  f88d31aa          STRB     r3,[sp,#0x1aa]
;;;1301   modbus_registers[423]=(signed char)(tempS);
0007d6  f88d41ab          STRB     r4,[sp,#0x1ab]
;;;1302   tempS=0;
0007da  f04f0400          MOV      r4,#0
;;;1303   if(sk_stat[2]==ssON) tempS|=0x0001;
0007de  f89c3002          LDRB     r3,[r12,#2]  ; sk_stat
0007e2  2b01              CMP      r3,#1
0007e4  d100              BNE      |L1.2024|
0007e6  461c              MOV      r4,r3
                  |L1.2024|
;;;1304   if(sk_av_stat[2]==sasON) tempS|=0x0002;
0007e8  78bb              LDRB     r3,[r7,#2]  ; sk_av_stat
0007ea  2b01              CMP      r3,#1
0007ec  d101              BNE      |L1.2034|
0007ee  f0440402          ORR      r4,r4,#2
                  |L1.2034|
;;;1305   modbus_registers[424]=(signed char)(tempS>>8);				//Рег213	Состояние  сухого контакта №1, (нулевой бит - физическое состояние, 1 - замкнут, 0 - разомкнут, первый бит - аварийность, 1 - авария, 0 - норма)
0007f2  ea4f2324          ASR      r3,r4,#8
0007f6  f88d31ac          STRB     r3,[sp,#0x1ac]
;;;1306   modbus_registers[425]=(signed char)(tempS);
0007fa  f88d41ad          STRB     r4,[sp,#0x1ad]
;;;1307   tempS=0;
0007fe  f04f0300          MOV      r3,#0
;;;1308   if(sk_stat[3]==ssON) tempS|=0x0001;
000802  f89c4003          LDRB     r4,[r12,#3]  ; sk_stat
000806  2c01              CMP      r4,#1
000808  d101              BNE      |L1.2062|
00080a  f04f0301          MOV      r3,#1
                  |L1.2062|
;;;1309   if(sk_av_stat[3]==sasON) tempS|=0x0002;
00080e  78fc              LDRB     r4,[r7,#3]  ; sk_av_stat
000810  2c01              CMP      r4,#1
000812  d101              BNE      |L1.2072|
000814  f0430302          ORR      r3,r3,#2
                  |L1.2072|
;;;1310   modbus_registers[426]=(signed char)(tempS>>8);				//Рег214	Состояние  сухого контакта №1, (нулевой бит - физическое состояние, 1 - замкнут, 0 - разомкнут, первый бит - аварийность, 1 - авария, 0 - норма)
000818  ea4f2423          ASR      r4,r3,#8
00081c  f88d41ae          STRB     r4,[sp,#0x1ae]
;;;1311   modbus_registers[427]=(signed char)(tempS);
000820  f88d31af          STRB     r3,[sp,#0x1af]
000824  ab01              ADD      r3,sp,#4              ;1139
;;;1312   
;;;1313   //modbus_registers[
;;;1314   
;;;1315   
;;;1316   if(prot==MODBUS_RTU_PROT)
;;;1317   	{
;;;1318   	modbus_tx_buff[0]=adr;
;;;1319   	modbus_tx_buff[1]=func;
;;;1320   
;;;1321   	modbus_tx_buff[2]=(char)(reg_quantity*2);
;;;1322   
;;;1323   	mem_copy((signed char*)&modbus_tx_buff[3],(signed char*)&modbus_registers[(reg_adr-1)*2],reg_quantity*2);
000826  f1a20201          SUB      r2,r2,#1
00082a  4faa              LDR      r7,|L1.2772|
00082c  eb030342          ADD      r3,r3,r2,LSL #1
000830  ea4f0245          LSL      r2,r5,#1              ;1321
000834  b156              CBZ      r6,|L1.2124|
;;;1324   
;;;1325   	crc_temp=CRC16_2(modbus_tx_buff,(reg_quantity*2)+3);
;;;1326   
;;;1327   	modbus_tx_buff[3+(reg_quantity*2)]=(char)crc_temp;
;;;1328   	modbus_tx_buff[4+(reg_quantity*2)]=crc_temp>>8;
;;;1329   
;;;1330   	for (i=0;i<(5+(reg_quantity*2));i++)
;;;1331   		{
;;;1332   		putchar0(modbus_tx_buff[i]);
;;;1333   		}
;;;1334   	for (i=0;i<(5+(reg_quantity*2));i++)
;;;1335   		{
;;;1336   		putchar_sc16is700(modbus_tx_buff[i]);
;;;1337   		}
;;;1338   	}
;;;1339   else if(prot==MODBUS_TCP_PROT)
000836  2e01              CMP      r6,#1
000838  d105              BNE      |L1.2118|
;;;1340   	{
;;;1341   	mem_copy((signed char*)modbus_tx_buff,(signed char*)&modbus_registers[(reg_adr-1)*2],reg_quantity*2);
00083a  4619              MOV      r1,r3
00083c  4638              MOV      r0,r7
00083e  f7fffffe          BL       mem_copy
;;;1342   	modbus_tcp_out_ptr=(signed char*)modbus_tx_buff;
000842  48a5              LDR      r0,|L1.2776|
000844  6007              STR      r7,[r0,#0]  ; modbus_tcp_out_ptr
                  |L1.2118|
;;;1343   	}
;;;1344   }
000846  b07e              ADD      sp,sp,#0x1f8
000848  e8bd81f0          POP      {r4-r8,pc}
                  |L1.2124|
00084c  7038              STRB     r0,[r7,#0]            ;1318
00084e  7079              STRB     r1,[r7,#1]            ;1319
000850  70ba              STRB     r2,[r7,#2]            ;1321
000852  4619              MOV      r1,r3                 ;1323
000854  1cf8              ADDS     r0,r7,#3              ;1323
000856  f7fffffe          BL       mem_copy
00085a  2003              MOVS     r0,#3                 ;1325
00085c  eb000045          ADD      r0,r0,r5,LSL #1       ;1325
000860  b201              SXTH     r1,r0                 ;1325
000862  489c              LDR      r0,|L1.2772|
000864  f7fffffe          BL       CRC16_2
000868  eb070145          ADD      r1,r7,r5,LSL #1       ;1327
00086c  70c8              STRB     r0,[r1,#3]            ;1327
00086e  ea4f2010          LSR      r0,r0,#8              ;1328
000872  7108              STRB     r0,[r1,#4]            ;1328
000874  f04f0400          MOV      r4,#0                 ;1330
000878  f04f0005          MOV      r0,#5                 ;1330
00087c  eb000545          ADD      r5,r0,r5,LSL #1       ;1330
000880  e005              B        |L1.2190|
                  |L1.2178|
000882  5d38              LDRB     r0,[r7,r4]            ;1332
000884  f7fffffe          BL       putchar0
000888  f1040401          ADD      r4,r4,#1              ;1330
00088c  b2e4              UXTB     r4,r4                 ;1330
                  |L1.2190|
00088e  42a5              CMP      r5,r4                 ;1330
000890  d8f7              BHI      |L1.2178|
000892  f04f0400          MOV      r4,#0                 ;1334
000896  e005              B        |L1.2212|
                  |L1.2200|
000898  5d38              LDRB     r0,[r7,r4]            ;1336
00089a  f7fffffe          BL       putchar_sc16is700
00089e  f1040401          ADD      r4,r4,#1              ;1334
0008a2  b2e4              UXTB     r4,r4                 ;1334
                  |L1.2212|
0008a4  42a5              CMP      r5,r4                 ;1334
0008a6  d8f7              BHI      |L1.2200|
0008a8  e7cd              B        |L1.2118|
;;;1345   
                          ENDP

                  modbus_in PROC
;;;260    //-----------------------------------------------
;;;261    void modbus_in(void)
0008aa  e92d4ff0          PUSH     {r4-r11,lr}
;;;262    {
0008ae  b089              SUB      sp,sp,#0x24
;;;263    short crc16_calculated;		//вычисляемая из принятых данных CRC
;;;264    short crc16_incapsulated;	//встроеннная в посылку CRC
;;;265    unsigned short modbus_rx_arg0;		//встроенный в посылку первый аргумент
;;;266    unsigned short modbus_rx_arg1;		//встроенный в посылку второй аргумент
;;;267    //unsigned short modbus_rx_arg2;		//встроенный в посылку третий аргумент
;;;268    //unsigned short modbus_rx_arg3;		//встроенный в посылку четвертый аргумент
;;;269    unsigned char modbus_func;			//встроенный в посылку код функции
;;;270    
;;;271    
;;;272    
;;;273    mem_copy(modbus_an_buffer,modbus_rx_buffer,modbus_rx_buffer_ptr);
0008b0  4c8a              LDR      r4,|L1.2780|
0008b2  4988              LDR      r1,|L1.2772|
0008b4  393c              SUBS     r1,r1,#0x3c
0008b6  7862              LDRB     r2,[r4,#1]  ; modbus_rx_buffer_ptr
0008b8  f101001e          ADD      r0,r1,#0x1e
0008bc  f7fffffe          BL       mem_copy
;;;274    modbus_rx_counter=modbus_rx_buffer_ptr;
0008c0  7861              LDRB     r1,[r4,#1]  ; modbus_rx_buffer_ptr
0008c2  70a1              STRB     r1,[r4,#2]
;;;275    modbus_rx_buffer_ptr=0;
0008c4  f04f0900          MOV      r9,#0
0008c8  f8849001          STRB     r9,[r4,#1]
;;;276    bMODBUS_TIMEOUT=0;
0008cc  f8849000          STRB     r9,[r4,#0]
;;;277    	
;;;278    crc16_calculated  = CRC16_2((char*)modbus_an_buffer, modbus_rx_counter-2);
0008d0  4880              LDR      r0,|L1.2772|
0008d2  f1a10102          SUB      r1,r1,#2
0008d6  f1a0001e          SUB      r0,r0,#0x1e
0008da  f7fffffe          BL       CRC16_2
0008de  fa0ffa80          SXTH     r10,r0
;;;279    crc16_incapsulated = *((short*)&modbus_an_buffer[modbus_rx_counter-2]);
0008e2  487c              LDR      r0,|L1.2772|
0008e4  78a1              LDRB     r1,[r4,#2]  ; modbus_rx_counter
0008e6  381e              SUBS     r0,r0,#0x1e
0008e8  eb000201          ADD      r2,r0,r1
0008ec  f932bc02          LDRSH    r11,[r2,#-2]
;;;280    
;;;281    modbus_plazma1=modbus_rx_counter;
0008f0  80e1              STRH     r1,[r4,#6]
;;;282    modbus_plazma2=crc16_calculated;
0008f2  f8a4a008          STRH     r10,[r4,#8]
;;;283    modbus_plazma3=crc16_incapsulated;
0008f6  f8a4b00a          STRH     r11,[r4,#0xa]
;;;284    
;;;285    modbus_func=modbus_an_buffer[1];
0008fa  7846              LDRB     r6,[r0,#1]  ; modbus_an_buffer
;;;286    modbus_rx_arg0=(((unsigned short)modbus_an_buffer[2])*((unsigned short)256))+((unsigned short)modbus_an_buffer[3]);
0008fc  78c2              LDRB     r2,[r0,#3]  ; modbus_an_buffer
0008fe  7881              LDRB     r1,[r0,#2]  ; modbus_an_buffer
000900  eb022301          ADD      r3,r2,r1,LSL #8
000904  b29d              UXTH     r5,r3
;;;287    modbus_rx_arg1=(((unsigned short)modbus_an_buffer[4])*((unsigned short)256))+((unsigned short)modbus_an_buffer[5]);
000906  7943              LDRB     r3,[r0,#5]  ; modbus_an_buffer
000908  7904              LDRB     r4,[r0,#4]  ; modbus_an_buffer
00090a  eb032304          ADD      r3,r3,r4,LSL #8
00090e  b29c              UXTH     r4,r3
;;;288    //modbus_rx_arg2=(((unsigned short)modbus_an_buffer[6])*((unsigned short)256))+((unsigned short)modbus_an_buffer[7]);
;;;289    //modbus_rx_arg3=(((unsigned short)modbus_an_buffer[8])*((unsigned short)256))+((unsigned short)modbus_an_buffer[9]);
;;;290    
;;;291    //#define IPS_CURR_AVG_MODBUS_ADRESS	1
;;;292    
;;;293    
;;;294    if(modbus_an_buffer[0]=='r')
000910  7800              LDRB     r0,[r0,#0]  ; modbus_an_buffer
000912  2872              CMP      r0,#0x72
000914  d17e              BNE      |L1.2580|
;;;295    	{
;;;296    	pvlk=1;
000916  4f72              LDR      r7,|L1.2784|
000918  f04f0001          MOV      r0,#1
00091c  8038              STRH     r0,[r7,#0]
;;;297    	if(modbus_an_buffer[1]=='e')
00091e  f8df81b4          LDR      r8,|L1.2772|
000922  2e65              CMP      r6,#0x65
000924  f1a8081e          SUB      r8,r8,#0x1e
000928  d174              BNE      |L1.2580|
;;;298    		{
;;;299    		pvlk=2;
00092a  f04f0002          MOV      r0,#2
00092e  8038              STRH     r0,[r7,#0]
;;;300    		if(modbus_an_buffer[2]=='a')
000930  2961              CMP      r1,#0x61
000932  d16f              BNE      |L1.2580|
;;;301    			{
;;;302    			pvlk=3;
000934  f04f0003          MOV      r0,#3
000938  8038              STRH     r0,[r7,#0]
;;;303    			if(modbus_an_buffer[3]=='d')
00093a  2a64              CMP      r2,#0x64
00093c  d16a              BNE      |L1.2580|
;;;304    				{
;;;305    				pvlk=4;
00093e  f04f0004          MOV      r0,#4
000942  8038              STRH     r0,[r7,#0]
;;;306    				if(modbus_an_buffer[6]==crc_87(modbus_an_buffer,6))
000944  f04f0106          MOV      r1,#6
000948  4640              MOV      r0,r8
00094a  f7fffffe          BL       crc_87
00094e  f8981006          LDRB     r1,[r8,#6]  ; modbus_an_buffer
000952  4288              CMP      r0,r1
000954  d15e              BNE      |L1.2580|
;;;307    					{
;;;308    					pvlk=5;
000956  f04f0005          MOV      r0,#5
00095a  8038              STRH     r0,[r7,#0]
;;;309    					if(modbus_an_buffer[7]==crc_95(modbus_an_buffer,6))
00095c  f04f0106          MOV      r1,#6
000960  4640              MOV      r0,r8
000962  f7fffffe          BL       crc_95
000966  f8981007          LDRB     r1,[r8,#7]  ; modbus_an_buffer
00096a  4288              CMP      r0,r1
00096c  d152              BNE      |L1.2580|
;;;310    						{
;;;311    						pvlk=6;	
;;;312    
;;;313    							{
;;;314    							unsigned short ptr;
;;;315    							unsigned long data1,data2;
;;;316    							char temp_out[20];
;;;317    							pvlk++;
00096e  f04f0007          MOV      r0,#7
000972  8038              STRH     r0,[r7,#0]
;;;318    							ptr=modbus_an_buffer[4]+(modbus_an_buffer[5]*256U);
000974  f8980004          LDRB     r0,[r8,#4]  ; modbus_an_buffer
000978  f8981005          LDRB     r1,[r8,#5]  ; modbus_an_buffer
00097c  eb002001          ADD      r0,r0,r1,LSL #8
000980  b280              UXTH     r0,r0
000982  4607              MOV      r7,r0
000984  9008              STR      r0,[sp,#0x20]
;;;319    							data1=lc640_read_long(ptr);
000986  4638              MOV      r0,r7
000988  f7fffffe          BL       lc640_read_long
00098c  9007              STR      r0,[sp,#0x1c]
;;;320    							data2=lc640_read_long(ptr+4);
00098e  1d38              ADDS     r0,r7,#4
000990  f7fffffe          BL       lc640_read_long
000994  9006              STR      r0,[sp,#0x18]
;;;321    							temp_out[0]='r';
000996  f04f0072          MOV      r0,#0x72
00099a  f88d0004          STRB     r0,[sp,#4]
;;;322    							temp_out[1]='e';
00099e  4630              MOV      r0,r6
0009a0  f88d0005          STRB     r0,[sp,#5]
;;;323    							temp_out[2]='a';
0009a4  f04f0061          MOV      r0,#0x61
0009a8  f88d0006          STRB     r0,[sp,#6]
;;;324    							temp_out[3]='d';
0009ac  f04f0064          MOV      r0,#0x64
0009b0  f88d0007          STRB     r0,[sp,#7]
;;;325    							temp_out[4]=*((char*)&ptr);
0009b4  f89d0020          LDRB     r0,[sp,#0x20]
0009b8  f88d0008          STRB     r0,[sp,#8]
;;;326    							temp_out[5]=*(((char*)&ptr)+1);	
0009bc  f89d0021          LDRB     r0,[sp,#0x21]
0009c0  f88d0009          STRB     r0,[sp,#9]
;;;327    							temp_out[6]=*((char*)&data1);
0009c4  f89d001c          LDRB     r0,[sp,#0x1c]
0009c8  f88d000a          STRB     r0,[sp,#0xa]
;;;328    							temp_out[7]=*(((char*)&data1)+1);		
0009cc  f89d001d          LDRB     r0,[sp,#0x1d]
0009d0  f88d000b          STRB     r0,[sp,#0xb]
;;;329    							temp_out[8]=*(((char*)&data1)+2);	
0009d4  f89d001e          LDRB     r0,[sp,#0x1e]
0009d8  f88d000c          STRB     r0,[sp,#0xc]
;;;330    							temp_out[9]=*(((char*)&data1)+3);		
0009dc  f89d001f          LDRB     r0,[sp,#0x1f]
0009e0  f88d000d          STRB     r0,[sp,#0xd]
;;;331    							temp_out[10]=*((char*)&data2);
0009e4  f89d0018          LDRB     r0,[sp,#0x18]
0009e8  f88d000e          STRB     r0,[sp,#0xe]
;;;332    							temp_out[11]=*(((char*)&data2)+1);		
0009ec  f89d0019          LDRB     r0,[sp,#0x19]
0009f0  f88d000f          STRB     r0,[sp,#0xf]
;;;333    							temp_out[12]=*(((char*)&data2)+2);	
0009f4  f89d001a          LDRB     r0,[sp,#0x1a]
0009f8  f88d0010          STRB     r0,[sp,#0x10]
;;;334    							temp_out[13]=*(((char*)&data2)+3);	
0009fc  f89d001b          LDRB     r0,[sp,#0x1b]
000a00  f88d0011          STRB     r0,[sp,#0x11]
;;;335    							temp_out[14]=crc_87(temp_out,14);	
000a04  f04f010e          MOV      r1,#0xe
000a08  a801              ADD      r0,sp,#4
000a0a  f7fffffe          BL       crc_87
000a0e  f88d0012          STRB     r0,[sp,#0x12]
;;;336    							temp_out[15]=crc_95(temp_out,14);			
000a12  e000              B        |L1.2582|
                  |L1.2580|
000a14  e02c              B        |L1.2672|
                  |L1.2582|
000a16  210e              MOVS     r1,#0xe
000a18  a801              ADD      r0,sp,#4
000a1a  f7fffffe          BL       crc_95
000a1e  f88d0013          STRB     r0,[sp,#0x13]
;;;337    							
;;;338    							temp_out[17]=0;
000a22  f88d9015          STRB     r9,[sp,#0x15]
;;;339    							for (i=0;i<16;i++)
000a26  4f2f              LDR      r7,|L1.2788|
000a28  f8879000          STRB     r9,[r7,#0]
000a2c  f10d0804          ADD      r8,sp,#4              ;316
                  |L1.2608|
;;;340    								{
;;;341    								putchar_sc16is700(temp_out[i]);
000a30  7838              LDRB     r0,[r7,#0]  ; i
000a32  f8180000          LDRB     r0,[r8,r0]
000a36  f7fffffe          BL       putchar_sc16is700
;;;342    								temp_out[17]^=temp_out[i];
000a3a  7838              LDRB     r0,[r7,#0]  ; i
000a3c  f89d1015          LDRB     r1,[sp,#0x15]
000a40  f8182000          LDRB     r2,[r8,r0]
000a44  ea810102          EOR      r1,r1,r2
000a48  f88d1015          STRB     r1,[sp,#0x15]
000a4c  f1000001          ADD      r0,r0,#1              ;339
000a50  b2c0              UXTB     r0,r0                 ;339
000a52  7038              STRB     r0,[r7,#0]            ;339
000a54  2810              CMP      r0,#0x10              ;339
000a56  d3eb              BCC      |L1.2608|
;;;343    								}
;;;344    							putchar_sc16is700(16);
000a58  2010              MOVS     r0,#0x10
000a5a  f7fffffe          BL       putchar_sc16is700
;;;345    							putchar_sc16is700(temp_out[17]^16);
000a5e  f89d0015          LDRB     r0,[sp,#0x15]
000a62  f0800010          EOR      r0,r0,#0x10
000a66  f7fffffe          BL       putchar_sc16is700
;;;346    							putchar_sc16is700(0x0a);
000a6a  200a              MOVS     r0,#0xa
000a6c  f7fffffe          BL       putchar_sc16is700
                  |L1.2672|
;;;347    							}
;;;348    						}
;;;349    					}
;;;350    				}
;;;351    			} 
;;;352    		}	 
;;;353    	} 
;;;354    
;;;355    if(modbus_an_buffer[0]=='w')
000a70  4818              LDR      r0,|L1.2772|
000a72  381e              SUBS     r0,r0,#0x1e
000a74  7800              LDRB     r0,[r0,#0]  ; modbus_an_buffer
000a76  2877              CMP      r0,#0x77
000a78  d17d              BNE      |L1.2934|
;;;356    	{
;;;357    //	pvlk=1;
;;;358    	if(modbus_an_buffer[1]=='r')
000a7a  4f16              LDR      r7,|L1.2772|
000a7c  3f1e              SUBS     r7,r7,#0x1e
000a7e  7878              LDRB     r0,[r7,#1]  ; modbus_an_buffer
000a80  2872              CMP      r0,#0x72
000a82  d178              BNE      |L1.2934|
;;;359    		{
;;;360    //		pvlk=2;
;;;361    		if(modbus_an_buffer[2]=='i')
000a84  78b8              LDRB     r0,[r7,#2]  ; modbus_an_buffer
000a86  2869              CMP      r0,#0x69
000a88  d175              BNE      |L1.2934|
;;;362    			{
;;;363    //			pvlk=3;
;;;364    			if(modbus_an_buffer[3]=='t')
000a8a  78f8              LDRB     r0,[r7,#3]  ; modbus_an_buffer
000a8c  2874              CMP      r0,#0x74
000a8e  d172              BNE      |L1.2934|
;;;365    				{
;;;366    //				pvlk=4;
;;;367    				if(modbus_an_buffer[4]=='e')
000a90  7938              LDRB     r0,[r7,#4]  ; modbus_an_buffer
000a92  2865              CMP      r0,#0x65
000a94  d16f              BNE      |L1.2934|
;;;368    					{
;;;369    //					pvlk=5;
;;;370    					if(modbus_an_buffer[15]==crc_87(modbus_an_buffer,15))
000a96  210f              MOVS     r1,#0xf
000a98  4638              MOV      r0,r7
000a9a  f7fffffe          BL       crc_87
000a9e  7bf9              LDRB     r1,[r7,#0xf]  ; modbus_an_buffer
000aa0  4288              CMP      r0,r1
000aa2  d168              BNE      |L1.2934|
;;;371    						{
;;;372    //						pvlk=6;
;;;373    						if(modbus_an_buffer[16]==crc_95(modbus_an_buffer,15))
000aa4  210f              MOVS     r1,#0xf
000aa6  e01f              B        |L1.2792|
                  |L1.2728|
                          DCD      bps_U
                  |L1.2732|
                          DCD      speedChIsOn
                  |L1.2736|
                          DCD      spc_stat
                  |L1.2740|
                          DCD      uout_av
                  |L1.2744|
                          DCD      bat_ips
                  |L1.2748|
                          DCD      avar_stat
                  |L1.2752|
                          DCD      t_ext
                  |L1.2756|
                          DCD      ND_EXT
                  |L1.2760|
                          DCD      0xfffffc18
                  |L1.2764|
                          DCD      sk_stat
                  |L1.2768|
                          DCD      sk_av_stat
                  |L1.2772|
                          DCD      ||area_number.4||+0x3c
                  |L1.2776|
                          DCD      modbus_tcp_out_ptr
                  |L1.2780|
                          DCD      ||area_number.8||
                  |L1.2784|
                          DCD      pvlk
                  |L1.2788|
                          DCD      i
                  |L1.2792|
000ae8  4638              MOV      r0,r7
000aea  f7fffffe          BL       crc_95
000aee  7c39              LDRB     r1,[r7,#0x10]  ; modbus_an_buffer
000af0  4288              CMP      r0,r1
000af2  d179              BNE      |L1.3048|
;;;374    
;;;375    							{
;;;376    							unsigned short ptr;
;;;377    							unsigned long data1,data2;
;;;378    							char temp_out[20];
;;;379    //							pvlk=7;
;;;380    							ptr=modbus_an_buffer[5]+(modbus_an_buffer[6]*256U);
000af4  7978              LDRB     r0,[r7,#5]  ; modbus_an_buffer
000af6  79b9              LDRB     r1,[r7,#6]  ; modbus_an_buffer
000af8  eb002001          ADD      r0,r0,r1,LSL #8
000afc  b280              UXTH     r0,r0
000afe  4680              MOV      r8,r0
000b00  9008              STR      r0,[sp,#0x20]
;;;381    							*((char*)&data1)=modbus_an_buffer[7];
000b02  79f8              LDRB     r0,[r7,#7]  ; modbus_an_buffer
000b04  f88d001c          STRB     r0,[sp,#0x1c]
;;;382    							*(((char*)&data1)+1)=modbus_an_buffer[8];
000b08  7a38              LDRB     r0,[r7,#8]  ; modbus_an_buffer
000b0a  f88d001d          STRB     r0,[sp,#0x1d]
;;;383    							*(((char*)&data1)+2)=modbus_an_buffer[9];
000b0e  7a78              LDRB     r0,[r7,#9]  ; modbus_an_buffer
000b10  f88d001e          STRB     r0,[sp,#0x1e]
;;;384    							*(((char*)&data1)+3)=modbus_an_buffer[10];
000b14  7ab8              LDRB     r0,[r7,#0xa]  ; modbus_an_buffer
000b16  f88d001f          STRB     r0,[sp,#0x1f]
;;;385    							*((char*)&data2)=modbus_an_buffer[11];
000b1a  7af8              LDRB     r0,[r7,#0xb]  ; modbus_an_buffer
000b1c  f88d0018          STRB     r0,[sp,#0x18]
;;;386    							*(((char*)&data2)+1)=modbus_an_buffer[12];
000b20  7b38              LDRB     r0,[r7,#0xc]  ; modbus_an_buffer
000b22  f88d0019          STRB     r0,[sp,#0x19]
;;;387    							*(((char*)&data2)+2)=modbus_an_buffer[13];
000b26  7b78              LDRB     r0,[r7,#0xd]  ; modbus_an_buffer
000b28  f88d001a          STRB     r0,[sp,#0x1a]
;;;388    							*(((char*)&data2)+3)=modbus_an_buffer[14];	
000b2c  7bb8              LDRB     r0,[r7,#0xe]  ; modbus_an_buffer
000b2e  f88d001b          STRB     r0,[sp,#0x1b]
;;;389    							lc640_write_long(ptr,data1);
000b32  4640              MOV      r0,r8
000b34  9907              LDR      r1,[sp,#0x1c]
000b36  f7fffffe          BL       lc640_write_long
;;;390    							lc640_write_long(ptr+4,data2);
000b3a  f1080004          ADD      r0,r8,#4
000b3e  9906              LDR      r1,[sp,#0x18]
000b40  f7fffffe          BL       lc640_write_long
;;;391    							
;;;392    							//data1=lc640_read_long(ptr);
;;;393    							//data2=lc640_read_long(ptr+4);
;;;394    							temp_out[0]='w';
000b44  f04f0077          MOV      r0,#0x77
000b48  f88d0004          STRB     r0,[sp,#4]
;;;395    							temp_out[1]='r';
000b4c  f04f0072          MOV      r0,#0x72
000b50  f88d0005          STRB     r0,[sp,#5]
;;;396    							temp_out[2]='i';
000b54  f04f0069          MOV      r0,#0x69
000b58  f88d0006          STRB     r0,[sp,#6]
;;;397    							temp_out[3]='t';
000b5c  f04f0074          MOV      r0,#0x74
000b60  f88d0007          STRB     r0,[sp,#7]
;;;398    							temp_out[4]='e';
000b64  f04f0065          MOV      r0,#0x65
000b68  f88d0008          STRB     r0,[sp,#8]
;;;399    							temp_out[5]=*((char*)&ptr);
000b6c  f89d0020          LDRB     r0,[sp,#0x20]
000b70  f88d0009          STRB     r0,[sp,#9]
;;;400    							temp_out[6]=*(((char*)&ptr)+1);	
000b74  e000              B        |L1.2936|
                  |L1.2934|
000b76  e037              B        |L1.3048|
                  |L1.2936|
000b78  f89d0021          LDRB     r0,[sp,#0x21]
000b7c  f88d000a          STRB     r0,[sp,#0xa]
;;;401    						
;;;402    							temp_out[7]=crc_87(temp_out,7);	
000b80  f04f0107          MOV      r1,#7
000b84  a801              ADD      r0,sp,#4
000b86  f7fffffe          BL       crc_87
000b8a  f88d000b          STRB     r0,[sp,#0xb]
;;;403    							temp_out[8]=crc_95(temp_out,7);			
000b8e  2107              MOVS     r1,#7
000b90  a801              ADD      r0,sp,#4
000b92  f7fffffe          BL       crc_95
000b96  f88d000c          STRB     r0,[sp,#0xc]
;;;404    							
;;;405    							temp_out[10]=0;
000b9a  f88d900e          STRB     r9,[sp,#0xe]
;;;406    							for (i=0;i<9;i++)
000b9e  4fb8              LDR      r7,|L1.3712|
000ba0  f8879000          STRB     r9,[r7,#0]
000ba4  f10d0804          ADD      r8,sp,#4              ;378
                  |L1.2984|
;;;407    								{
;;;408    								putchar_sc16is700(temp_out[i]);
000ba8  7838              LDRB     r0,[r7,#0]  ; i
000baa  f8180000          LDRB     r0,[r8,r0]
000bae  f7fffffe          BL       putchar_sc16is700
;;;409    								temp_out[10]^=temp_out[i];
000bb2  7838              LDRB     r0,[r7,#0]  ; i
000bb4  f89d100e          LDRB     r1,[sp,#0xe]
000bb8  f8182000          LDRB     r2,[r8,r0]
000bbc  ea810102          EOR      r1,r1,r2
000bc0  f88d100e          STRB     r1,[sp,#0xe]
000bc4  f1000001          ADD      r0,r0,#1              ;406
000bc8  b2c0              UXTB     r0,r0                 ;406
000bca  7038              STRB     r0,[r7,#0]            ;406
000bcc  2809              CMP      r0,#9                 ;406
000bce  d3eb              BCC      |L1.2984|
;;;410    								}
;;;411    							putchar_sc16is700(9);
000bd0  2009              MOVS     r0,#9
000bd2  f7fffffe          BL       putchar_sc16is700
;;;412    							putchar_sc16is700(temp_out[10]^9);
000bd6  f89d000e          LDRB     r0,[sp,#0xe]
000bda  f0800009          EOR      r0,r0,#9
000bde  f7fffffe          BL       putchar_sc16is700
;;;413    							putchar_sc16is700(0x0a);
000be2  200a              MOVS     r0,#0xa
000be4  f7fffffe          BL       putchar_sc16is700
                  |L1.3048|
;;;414    							}
;;;415    						}
;;;416    					}
;;;417    				}
;;;418    		   	}
;;;419    		}
;;;420    	}
;;;421    
;;;422    if(crc16_calculated==crc16_incapsulated)
000be8  45da              CMP      r10,r11
000bea  d12b              BNE      |L1.3140|
;;;423    	{
;;;424    	ica_plazma[4]++;
000bec  4aa5              LDR      r2,|L1.3716|
000bee  7910              LDRB     r0,[r2,#4]  ; ica_plazma
000bf0  f1000001          ADD      r0,r0,#1
000bf4  7110              STRB     r0,[r2,#4]
;;;425     	if(modbus_an_buffer[0]==MODBUS_ADRESS)
000bf6  4ba4              LDR      r3,|L1.3720|
000bf8  4fa4              LDR      r7,|L1.3724|
000bfa  7819              LDRB     r1,[r3,#0]  ; modbus_an_buffer
000bfc  f9b70000          LDRSH    r0,[r7,#0]  ; MODBUS_ADRESS
000c00  4281              CMP      r1,r0
000c02  d175              BNE      |L1.3312|
;;;426    		{
;;;427    		if(modbus_func==3)		//чтение произвольного кол-ва регистров хранения
000c04  2e03              CMP      r6,#3
000c06  d10c              BNE      |L1.3106|
;;;428    			{
;;;429    			modbus_plazma++;
000c08  49a1              LDR      r1,|L1.3728|
000c0a  888a              LDRH     r2,[r1,#4]  ; modbus_plazma
000c0c  f1020201          ADD      r2,r2,#1
000c10  808a              STRH     r2,[r1,#4]
;;;430    			modbus_hold_registers_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0,modbus_rx_arg1,MODBUS_RTU_PROT);
000c12  4623              MOV      r3,r4
000c14  462a              MOV      r2,r5
000c16  4631              MOV      r1,r6
000c18  b2c0              UXTB     r0,r0
000c1a  f8cd9000          STR      r9,[sp,#0]
000c1e  f7fffffe          BL       modbus_hold_registers_transmit
                  |L1.3106|
;;;431    			}
;;;432    
;;;433    		if(modbus_func==4)		//чтение произвольного кол-ва регистров	входов
000c22  2e04              CMP      r6,#4
000c24  d005              BEQ      |L1.3122|
;;;434    			{
;;;435    			modbus_input_registers_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0,modbus_rx_arg1,MODBUS_RTU_PROT);
;;;436    			}
;;;437    
;;;438    		else if(modbus_func==6) 	//запись регистров хранения
000c26  2e06              CMP      r6,#6
000c28  d10c              BNE      |L1.3140|
;;;439    			{
;;;440    			if(modbus_rx_arg0==11)		//Установка времени 
;;;441    				{
;;;442    				LPC_RTC->YEAR=(uint16_t)modbus_rx_arg1;
000c2a  489a              LDR      r0,|L1.3732|
000c2c  2d0b              CMP      r5,#0xb               ;440
000c2e  d00c              BEQ      |L1.3146|
000c30  e00c              B        |L1.3148|
                  |L1.3122|
000c32  f8cd9000          STR      r9,[sp,#0]            ;435
000c36  8838              LDRH     r0,[r7,#0]            ;435  ; MODBUS_ADRESS
000c38  4623              MOV      r3,r4                 ;435
000c3a  462a              MOV      r2,r5                 ;435
000c3c  4631              MOV      r1,r6                 ;435
000c3e  b2c0              UXTB     r0,r0                 ;435
000c40  f7fffffe          BL       modbus_input_registers_transmit
                  |L1.3140|
;;;443    				}
;;;444    			if(modbus_rx_arg0==12)		//Установка времени 
;;;445    				{
;;;446    				LPC_RTC->MONTH=(uint16_t)modbus_rx_arg1;
;;;447    				}
;;;448    			if(modbus_rx_arg0==13)		//Установка времени 
;;;449    				{
;;;450    				LPC_RTC->DOM=(uint16_t)modbus_rx_arg1;
;;;451    				}
;;;452    			if(modbus_rx_arg0==14)		//Установка времени 
;;;453    				{
;;;454    				LPC_RTC->HOUR=(uint16_t)modbus_rx_arg1;
;;;455    				}
;;;456    			if(modbus_rx_arg0==15)		//Установка времени 
;;;457    				{
;;;458    				LPC_RTC->MIN=(uint16_t)modbus_rx_arg1;
;;;459    				}
;;;460    			if(modbus_rx_arg0==16)		//Установка времени 
;;;461    				{
;;;462    				LPC_RTC->SEC=(uint16_t)modbus_rx_arg1;
;;;463    				}
;;;464    			if(modbus_rx_arg0==20)		//ток стабилизации для режима стабилизации тока
;;;465    				{
;;;466    				if((modbus_rx_arg1>0)&&(modbus_rx_arg1<=18))
;;;467    				lc640_write_int(EE_NUMIST,modbus_rx_arg1);  
;;;468    				}
;;;469    			if(modbus_rx_arg0==21)		//ток стабилизации для режима стабилизации тока
;;;470    				{
;;;471    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
;;;472    				lc640_write_int(EE_PAR,modbus_rx_arg1);  
;;;473    				}
;;;474    			if(modbus_rx_arg0==22)		//ток стабилизации для режима стабилизации тока
;;;475    				{
;;;476    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
;;;477    				lc640_write_int(EE_ZV_ON,modbus_rx_arg1);  
;;;478    				}
;;;479    			if(modbus_rx_arg0==23)		//ток стабилизации для режима стабилизации тока
;;;480    				{
;;;481    				if((modbus_rx_arg1==0)||(modbus_rx_arg1==1))
;;;482    				lc640_write_int(EE_TERMOKOMP,modbus_rx_arg1);  
;;;483    				}
;;;484    			if(modbus_rx_arg0==24)		//ток стабилизации для режима стабилизации тока
;;;485    				{
;;;486    				if(/*(modbus_rx_arg1>=0)||*/(modbus_rx_arg1<=20))
;;;487    				lc640_write_int(EE_UBM_AV,modbus_rx_arg1);  
;;;488    				}
;;;489    
;;;490    
;;;491    			if(modbus_rx_arg0==30)		//напряжение стабилизации для режима стабилизации напряжения
;;;492    				{
;;;493    				/*if(modbus_rx_arg1<0)TBAT=0;
;;;494    				else */if((modbus_rx_arg1>0)&&(modbus_rx_arg1<=5))modbus_rx_arg1=0;
;;;495    				else if(modbus_rx_arg1>=60)TBAT=60;
;;;496    				else TBAT=modbus_rx_arg1;
;;;497    				lc640_write_int(EE_TBAT,TBAT);
;;;498    
;;;499    				main_kb_cnt=(TBAT*60)-20;
;;;500    	     		}
;;;501    			if(modbus_rx_arg0==31)		//
;;;502    				{
;;;503    				lc640_write_int(EE_UMAX,modbus_rx_arg1);
;;;504    	     		}
;;;505    			if(modbus_rx_arg0==32)		//
;;;506    				{
;;;507    				lc640_write_int(EE_DU,UB20-modbus_rx_arg1);
;;;508    	     		}
;;;509    			if(modbus_rx_arg0==33)		//
;;;510    				{
;;;511    				lc640_write_int(EE_UB0,modbus_rx_arg1);
;;;512    	     		}
;;;513    			if(modbus_rx_arg0==34)		//
;;;514    				{
;;;515    				lc640_write_int(EE_UB20,modbus_rx_arg1);
;;;516    	     		}
;;;517    			if(modbus_rx_arg0==35)		//
;;;518    				{
;;;519    				lc640_write_int(EE_USIGN,modbus_rx_arg1);
;;;520    	     		}
;;;521    			if(modbus_rx_arg0==36)		//
;;;522    				{
;;;523    				lc640_write_int(EE_UMN,modbus_rx_arg1);
;;;524    	     		}
;;;525    			if(modbus_rx_arg0==37)		//
;;;526    				{
;;;527    				lc640_write_int(EE_U0B,modbus_rx_arg1);
;;;528    	     		}
;;;529    			if(modbus_rx_arg0==38)		//
;;;530    				{
;;;531    				lc640_write_int(EE_IKB,modbus_rx_arg1);
;;;532    	     		}
;;;533    			if(modbus_rx_arg0==39)		//
;;;534    				{
;;;535    				lc640_write_int(EE_IZMAX,modbus_rx_arg1);
;;;536    	     		}
;;;537    			if(modbus_rx_arg0==40)		//
;;;538    				{
;;;539    				lc640_write_int(EE_IMAX,modbus_rx_arg1);
;;;540    	     		}
;;;541    			if(modbus_rx_arg0==41)		//
;;;542    				{
;;;543    				lc640_write_int(EE_IMIN,modbus_rx_arg1);
;;;544    	     		}
;;;545    			if(modbus_rx_arg0==42)		//
;;;546    				{
;;;547    				lc640_write_int(EE_UVZ,modbus_rx_arg1);
;;;548    	     		}
;;;549    			if(modbus_rx_arg0==43)		//
;;;550    				{
;;;551    				lc640_write_int(EE_TZAS,modbus_rx_arg1);
;;;552    	     		}
;;;553    			if(modbus_rx_arg0==44)		//
;;;554    				{
;;;555    				lc640_write_int(EE_TMAX,modbus_rx_arg1);
;;;556    	     		}
;;;557    			if(modbus_rx_arg0==45)		//
;;;558    				{
;;;559    				lc640_write_int(EE_TSIGN,modbus_rx_arg1);
;;;560    	     		}
;;;561    			if(modbus_rx_arg0==46)		//
;;;562    				{
;;;563    				lc640_write_int(EE_TBATMAX,modbus_rx_arg1);
;;;564    	     		}
;;;565    			if(modbus_rx_arg0==47)		//
;;;566    				{
;;;567    				lc640_write_int(EE_TBATSIGN,modbus_rx_arg1);
;;;568    	     		}
;;;569    			if(modbus_rx_arg0==48)		//
;;;570    				{
;;;571    				lc640_write_int(EE_SPEED_CHRG_CURR,modbus_rx_arg1);
;;;572    	     		}
;;;573    			if(modbus_rx_arg0==49)		//
;;;574    				{
;;;575    				lc640_write_int(EE_SPEED_CHRG_VOLT,modbus_rx_arg1);
;;;576    	     		}
;;;577    			if(modbus_rx_arg0==50)		//
;;;578    				{
;;;579    				lc640_write_int(EE_SPEED_CHRG_TIME,modbus_rx_arg1);
;;;580    	     		}
;;;581    			if(modbus_rx_arg0==51)		//
;;;582    				{
;;;583    				lc640_write_int(EE_U_OUT_KONTR_MAX,modbus_rx_arg1);
;;;584    	     		}
;;;585    			if(modbus_rx_arg0==52)		//
;;;586    				{
;;;587    				lc640_write_int(EE_U_OUT_KONTR_MIN,modbus_rx_arg1);
;;;588    	     		}
;;;589    			if(modbus_rx_arg0==53)		//
;;;590    				{
;;;591    				lc640_write_int(EE_U_OUT_KONTR_DELAY,modbus_rx_arg1);
;;;592    	     		}
;;;593    
;;;594    			if(modbus_rx_arg0==19)		//вкл/выкл источника напр.
;;;595    				{
;;;596    	/*			if(modbus_rx_arg1==1)
;;;597    					{
;;;598    					if(work_stat!=wsPS)
;;;599    						{
;;;600    						work_stat=wsPS;
;;;601    						time_proc=0;
;;;602    						time_proc_remain=T_PROC_PS;
;;;603    						restart_on_PS();
;;;604    						lc640_write_int(EE_MAIN_MENU_MODE,mmmIN);
;;;605    						}
;;;606    					}
;;;607    				if(modbus_rx_arg1==0)
;;;608    					{
;;;609    					if(work_stat==wsPS)
;;;610    						{
;;;611    						work_stat=wsOFF;
;;;612    						restart_off();
;;;613    						}
;;;614    					} */
;;;615    				}
;;;616    			if(modbus_rx_arg0==20)		//вкл/выкл источника тока
;;;617    				{
;;;618    /*				if(modbus_rx_arg1==1)
;;;619    					{
;;;620    					if(work_stat!=wsGS)
;;;621    						{
;;;622    						work_stat=wsGS;
;;;623    						time_proc=0;
;;;624    						time_proc_remain=T_PROC_GS;
;;;625    						lc640_write_int(EE_MAIN_MENU_MODE,mmmIT);
;;;626    						}
;;;627    					}
;;;628    				if(modbus_rx_arg1==0)
;;;629    					{
;;;630    					if(work_stat==wsGS)
;;;631    						{
;;;632    						work_stat=wsOFF;
;;;633    						restart_off();
;;;634    						}
;;;635    					}*/
;;;636    				}
;;;637    			//modbus_hold_register_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0);
;;;638    			modbus_hold_registers_transmit(MODBUS_ADRESS,modbus_func,modbus_rx_arg0,1,MODBUS_RTU_PROT);
;;;639    			}
;;;640    		} 
;;;641    	else if(modbus_an_buffer[0]==ICA_MODBUS_ADDRESS)
;;;642    		{
;;;643    		ica_plazma[3]++;
;;;644    		if(modbus_func==4)		//чтение произвольного кол-ва регистров	входов
;;;645    			{
;;;646    			ica_plazma[2]++;
;;;647    			if(modbus_an_buffer[2]==2)
;;;648    				{
;;;649    				ica_your_current=(((unsigned short)modbus_an_buffer[3])*((unsigned short)256))+((unsigned short)modbus_an_buffer[4]);
;;;650    				}
;;;651    			}
;;;652    		}
;;;653    	
;;;654    	}
;;;655    
;;;656    
;;;657    }
000c44  b009              ADD      sp,sp,#0x24
000c46  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.3146|
000c4a  8784              STRH     r4,[r0,#0x3c]         ;442
                  |L1.3148|
000c4c  2d0c              CMP      r5,#0xc               ;444
000c4e  d101              BNE      |L1.3156|
000c50  f8804038          STRB     r4,[r0,#0x38]         ;446
                  |L1.3156|
000c54  2d0d              CMP      r5,#0xd               ;448
000c56  d101              BNE      |L1.3164|
000c58  f880402c          STRB     r4,[r0,#0x2c]         ;450
                  |L1.3164|
000c5c  2d0e              CMP      r5,#0xe               ;452
000c5e  d101              BNE      |L1.3172|
000c60  f8804028          STRB     r4,[r0,#0x28]         ;454
                  |L1.3172|
000c64  2d0f              CMP      r5,#0xf               ;456
000c66  d101              BNE      |L1.3180|
000c68  f8804024          STRB     r4,[r0,#0x24]         ;458
                  |L1.3180|
000c6c  2d10              CMP      r5,#0x10              ;460
000c6e  d101              BNE      |L1.3188|
000c70  f8804020          STRB     r4,[r0,#0x20]         ;462
                  |L1.3188|
000c74  2d14              CMP      r5,#0x14              ;464
000c76  d106              BNE      |L1.3206|
000c78  1e60              SUBS     r0,r4,#1              ;466
000c7a  2811              CMP      r0,#0x11              ;466
000c7c  d803              BHI      |L1.3206|
000c7e  b221              SXTH     r1,r4                 ;467
000c80  2098              MOVS     r0,#0x98              ;467
000c82  f7fffffe          BL       lc640_write_int
                  |L1.3206|
000c86  2d15              CMP      r5,#0x15              ;469
000c88  d106              BNE      |L1.3224|
000c8a  b10c              CBZ      r4,|L1.3216|
000c8c  2c01              CMP      r4,#1                 ;471
000c8e  d103              BNE      |L1.3224|
                  |L1.3216|
000c90  b221              SXTH     r1,r4                 ;472
000c92  20ca              MOVS     r0,#0xca              ;472
000c94  f7fffffe          BL       lc640_write_int
                  |L1.3224|
000c98  2d16              CMP      r5,#0x16              ;474
000c9a  d106              BNE      |L1.3242|
000c9c  b10c              CBZ      r4,|L1.3234|
000c9e  2c01              CMP      r4,#1                 ;476
000ca0  d103              BNE      |L1.3242|
                  |L1.3234|
000ca2  b221              SXTH     r1,r4                 ;477
000ca4  2086              MOVS     r0,#0x86              ;477
000ca6  f7fffffe          BL       lc640_write_int
                  |L1.3242|
000caa  2d17              CMP      r5,#0x17              ;479
000cac  d106              BNE      |L1.3260|
000cae  b10c              CBZ      r4,|L1.3252|
000cb0  2c01              CMP      r4,#1                 ;481
000cb2  d103              BNE      |L1.3260|
                  |L1.3252|
000cb4  b221              SXTH     r1,r4                 ;482
000cb6  20f2              MOVS     r0,#0xf2              ;482
000cb8  f7fffffe          BL       lc640_write_int
                  |L1.3260|
000cbc  2d18              CMP      r5,#0x18              ;484
000cbe  d106              BNE      |L1.3278|
000cc0  2c14              CMP      r4,#0x14              ;486
000cc2  d804              BHI      |L1.3278|
000cc4  b221              SXTH     r1,r4                 ;487
000cc6  f44f7019          MOV      r0,#0x264             ;487
000cca  f7fffffe          BL       lc640_write_int
                  |L1.3278|
000cce  2d1e              CMP      r5,#0x1e              ;491
000cd0  d120              BNE      |L1.3348|
000cd2  1e60              SUBS     r0,r4,#1              ;494
000cd4  f8df81c0          LDR      r8,|L1.3736|
000cd8  2804              CMP      r0,#4                 ;494
000cda  d802              BHI      |L1.3298|
000cdc  f04f0400          MOV      r4,#0                 ;494
000ce0  e009              B        |L1.3318|
                  |L1.3298|
000ce2  2c3c              CMP      r4,#0x3c              ;495
000ce4  d305              BCC      |L1.3314|
000ce6  f04f003c          MOV      r0,#0x3c              ;495
000cea  f8a80000          STRH     r0,[r8,#0]            ;495
000cee  e002              B        |L1.3318|
                  |L1.3312|
000cf0  e0ad              B        |L1.3662|
                  |L1.3314|
000cf2  f8a84000          STRH     r4,[r8,#0]            ;496
                  |L1.3318|
000cf6  f9b81000          LDRSH    r1,[r8,#0]            ;497  ; TBAT
000cfa  20c2              MOVS     r0,#0xc2              ;497
000cfc  f7fffffe          BL       lc640_write_int
000d00  f8b80000          LDRH     r0,[r8,#0]            ;499  ; TBAT
000d04  f06f0113          MVN      r1,#0x13              ;499
000d08  ebc01000          RSB      r0,r0,r0,LSL #4       ;499
000d0c  eb010080          ADD      r0,r1,r0,LSL #2       ;499
000d10  4962              LDR      r1,|L1.3740|
000d12  8008              STRH     r0,[r1,#0]            ;499
                  |L1.3348|
000d14  2d1f              CMP      r5,#0x1f              ;501
000d16  d103              BNE      |L1.3360|
000d18  b221              SXTH     r1,r4                 ;503
000d1a  2078              MOVS     r0,#0x78              ;503
000d1c  f7fffffe          BL       lc640_write_int
                  |L1.3360|
000d20  2d20              CMP      r5,#0x20              ;505
000d22  d106              BNE      |L1.3378|
000d24  485e              LDR      r0,|L1.3744|
000d26  8800              LDRH     r0,[r0,#0]            ;507  ; UB20
000d28  1b00              SUBS     r0,r0,r4              ;507
000d2a  b201              SXTH     r1,r0                 ;507
000d2c  20c8              MOVS     r0,#0xc8              ;507
000d2e  f7fffffe          BL       lc640_write_int
                  |L1.3378|
000d32  2d21              CMP      r5,#0x21              ;509
000d34  d103              BNE      |L1.3390|
000d36  b221              SXTH     r1,r4                 ;511
000d38  207a              MOVS     r0,#0x7a              ;511
000d3a  f7fffffe          BL       lc640_write_int
                  |L1.3390|
000d3e  2d22              CMP      r5,#0x22              ;513
000d40  d103              BNE      |L1.3402|
000d42  b221              SXTH     r1,r4                 ;515
000d44  207c              MOVS     r0,#0x7c              ;515
000d46  f7fffffe          BL       lc640_write_int
                  |L1.3402|
000d4a  2d23              CMP      r5,#0x23              ;517
000d4c  d103              BNE      |L1.3414|
000d4e  b221              SXTH     r1,r4                 ;519
000d50  2082              MOVS     r0,#0x82              ;519
000d52  f7fffffe          BL       lc640_write_int
                  |L1.3414|
000d56  2d24              CMP      r5,#0x24              ;521
000d58  d103              BNE      |L1.3426|
000d5a  b221              SXTH     r1,r4                 ;523
000d5c  2084              MOVS     r0,#0x84              ;523
000d5e  f7fffffe          BL       lc640_write_int
                  |L1.3426|
000d62  2d25              CMP      r5,#0x25              ;525
000d64  d103              BNE      |L1.3438|
000d66  b221              SXTH     r1,r4                 ;527
000d68  2094              MOVS     r0,#0x94              ;527
000d6a  f7fffffe          BL       lc640_write_int
                  |L1.3438|
000d6e  2d26              CMP      r5,#0x26              ;529
000d70  d103              BNE      |L1.3450|
000d72  b221              SXTH     r1,r4                 ;531
000d74  2088              MOVS     r0,#0x88              ;531
000d76  f7fffffe          BL       lc640_write_int
                  |L1.3450|
000d7a  2d27              CMP      r5,#0x27              ;533
000d7c  d103              BNE      |L1.3462|
000d7e  b221              SXTH     r1,r4                 ;535
000d80  2092              MOVS     r0,#0x92              ;535
000d82  f7fffffe          BL       lc640_write_int
                  |L1.3462|
000d86  2d28              CMP      r5,#0x28              ;537
000d88  d103              BNE      |L1.3474|
000d8a  b221              SXTH     r1,r4                 ;539
000d8c  208c              MOVS     r0,#0x8c              ;539
000d8e  f7fffffe          BL       lc640_write_int
                  |L1.3474|
000d92  2d29              CMP      r5,#0x29              ;541
000d94  d103              BNE      |L1.3486|
000d96  b221              SXTH     r1,r4                 ;543
000d98  208e              MOVS     r0,#0x8e              ;543
000d9a  f7fffffe          BL       lc640_write_int
                  |L1.3486|
000d9e  2d2a              CMP      r5,#0x2a              ;545
000da0  d103              BNE      |L1.3498|
000da2  b221              SXTH     r1,r4                 ;547
000da4  20de              MOVS     r0,#0xde              ;547
000da6  f7fffffe          BL       lc640_write_int
                  |L1.3498|
000daa  2d2b              CMP      r5,#0x2b              ;549
000dac  d103              BNE      |L1.3510|
000dae  b221              SXTH     r1,r4                 ;551
000db0  2096              MOVS     r0,#0x96              ;551
000db2  f7fffffe          BL       lc640_write_int
                  |L1.3510|
000db6  2d2c              CMP      r5,#0x2c              ;553
000db8  d103              BNE      |L1.3522|
000dba  b221              SXTH     r1,r4                 ;555
000dbc  207e              MOVS     r0,#0x7e              ;555
000dbe  f7fffffe          BL       lc640_write_int
                  |L1.3522|
000dc2  2d2d              CMP      r5,#0x2d              ;557
000dc4  d103              BNE      |L1.3534|
000dc6  b221              SXTH     r1,r4                 ;559
000dc8  20c6              MOVS     r0,#0xc6              ;559
000dca  f7fffffe          BL       lc640_write_int
                  |L1.3534|
000dce  2d2e              CMP      r5,#0x2e              ;561
000dd0  d103              BNE      |L1.3546|
000dd2  b221              SXTH     r1,r4                 ;563
000dd4  20cc              MOVS     r0,#0xcc              ;563
000dd6  f7fffffe          BL       lc640_write_int
                  |L1.3546|
000dda  2d2f              CMP      r5,#0x2f              ;565
000ddc  d103              BNE      |L1.3558|
000dde  b221              SXTH     r1,r4                 ;567
000de0  20ce              MOVS     r0,#0xce              ;567
000de2  f7fffffe          BL       lc640_write_int
                  |L1.3558|
000de6  2d30              CMP      r5,#0x30              ;569
000de8  d104              BNE      |L1.3572|
000dea  b221              SXTH     r1,r4                 ;571
000dec  f44f708b          MOV      r0,#0x116             ;571
000df0  f7fffffe          BL       lc640_write_int
                  |L1.3572|
000df4  2d31              CMP      r5,#0x31              ;573
000df6  d104              BNE      |L1.3586|
000df8  b221              SXTH     r1,r4                 ;575
000dfa  f44f708c          MOV      r0,#0x118             ;575
000dfe  f7fffffe          BL       lc640_write_int
                  |L1.3586|
000e02  2d32              CMP      r5,#0x32              ;577
000e04  d104              BNE      |L1.3600|
000e06  b221              SXTH     r1,r4                 ;579
000e08  f44f708d          MOV      r0,#0x11a             ;579
000e0c  f7fffffe          BL       lc640_write_int
                  |L1.3600|
000e10  2d33              CMP      r5,#0x33              ;581
000e12  d104              BNE      |L1.3614|
000e14  b221              SXTH     r1,r4                 ;583
000e16  f44f7095          MOV      r0,#0x12a             ;583
000e1a  f7fffffe          BL       lc640_write_int
                  |L1.3614|
000e1e  2d34              CMP      r5,#0x34              ;585
000e20  d104              BNE      |L1.3628|
000e22  b221              SXTH     r1,r4                 ;587
000e24  f44f7096          MOV      r0,#0x12c             ;587
000e28  f7fffffe          BL       lc640_write_int
                  |L1.3628|
000e2c  2d35              CMP      r5,#0x35              ;589
000e2e  d104              BNE      |L1.3642|
000e30  b221              SXTH     r1,r4                 ;591
000e32  f44f7097          MOV      r0,#0x12e             ;591
000e36  f7fffffe          BL       lc640_write_int
                  |L1.3642|
000e3a  f8cd9000          STR      r9,[sp,#0]            ;638
000e3e  8838              LDRH     r0,[r7,#0]            ;638  ; MODBUS_ADRESS
000e40  2301              MOVS     r3,#1                 ;638
000e42  462a              MOV      r2,r5                 ;638
000e44  4631              MOV      r1,r6                 ;638
000e46  b2c0              UXTB     r0,r0                 ;638
000e48  f7fffffe          BL       modbus_hold_registers_transmit
                  |L1.3660|
000e4c  e6fa              B        |L1.3140|
                  |L1.3662|
000e4e  4815              LDR      r0,|L1.3748|
000e50  f9b00000          LDRSH    r0,[r0,#0]            ;641  ; ICA_MODBUS_ADDRESS
000e54  4281              CMP      r1,r0                 ;641
000e56  d1f9              BNE      |L1.3660|
000e58  78d0              LDRB     r0,[r2,#3]            ;643  ; ica_plazma
000e5a  f1000001          ADD      r0,r0,#1              ;643
000e5e  70d0              STRB     r0,[r2,#3]            ;643
000e60  2e04              CMP      r6,#4                 ;644
000e62  d1f3              BNE      |L1.3660|
000e64  7890              LDRB     r0,[r2,#2]            ;646  ; ica_plazma
000e66  f1000001          ADD      r0,r0,#1              ;646
000e6a  7090              STRB     r0,[r2,#2]            ;646
000e6c  7898              LDRB     r0,[r3,#2]            ;647  ; modbus_an_buffer
000e6e  2802              CMP      r0,#2                 ;647
000e70  d1ec              BNE      |L1.3660|
000e72  7918              LDRB     r0,[r3,#4]            ;649  ; modbus_an_buffer
000e74  78d9              LDRB     r1,[r3,#3]            ;649  ; modbus_an_buffer
000e76  eb002001          ADD      r0,r0,r1,LSL #8       ;649
000e7a  490b              LDR      r1,|L1.3752|
000e7c  8008              STRH     r0,[r1,#0]            ;649
000e7e  e6e1              B        |L1.3140|
;;;658    /*
                          ENDP

                  |L1.3712|
                          DCD      i
                  |L1.3716|
                          DCD      ica_plazma
                  |L1.3720|
                          DCD      ||area_number.4||+0x1e
                  |L1.3724|
                          DCD      MODBUS_ADRESS
                  |L1.3728|
                          DCD      ||area_number.8||
                  |L1.3732|
                          DCD      0x40024000
                  |L1.3736|
                          DCD      TBAT
                  |L1.3740|
                          DCD      main_kb_cnt
                  |L1.3744|
                          DCD      UB20
                  |L1.3748|
                          DCD      ICA_MODBUS_ADDRESS
                  |L1.3752|
                          DCD      ica_your_current

                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  modbus_buf
                          %        20

                          AREA ||area_number.4||, DATA, NOINIT, ALIGN=0

                          EXPORTAS ||area_number.4||, ||.bss||
                  modbus_rx_buffer
                          %        30
                  modbus_an_buffer
                          %        30
                  modbus_tx_buff
                          %        100

                          AREA ||.data||, DATA, ALIGN=1

                  modbus_crc16
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.7||, DATA, ALIGN=0

                          EXPORTAS ||area_number.7||, ||.data||
                  modbus_timeout_cnt
000000  00                DCB      0x00

                          AREA ||area_number.8||, DATA, ALIGN=1

                          EXPORTAS ||area_number.8||, ||.data||
                  bMODBUS_TIMEOUT
000000  00                DCB      0x00
                  modbus_rx_buffer_ptr
000001  00                DCB      0x00
                  modbus_rx_counter
000002  0000              DCB      0x00,0x00
                  modbus_plazma
000004  0000              DCB      0x00,0x00
                  modbus_plazma1
000006  0000              DCB      0x00,0x00
                  modbus_plazma2
000008  0000              DCB      0x00,0x00
                  modbus_plazma3
00000a  0000              DCB      0x00,0x00

                          AREA ||area_number.9||, DATA, ALIGN=1

                          EXPORTAS ||area_number.9||, ||.data||
                  modbus_plazma_p
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.10||, DATA, ALIGN=1

                          EXPORTAS ||area_number.10||, ||.data||
                  modbus_plazma_pp
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.11||, DATA, ALIGN=1

                          EXPORTAS ||area_number.11||, ||.data||
                  modbus_rx_arg0
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.12||, DATA, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.data||
                  modbus_rx_arg1
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.13||, DATA, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.data||
                  modbus_rx_arg2
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.14||, DATA, ALIGN=1

                          EXPORTAS ||area_number.14||, ||.data||
                  modbus_rx_arg3
000000  0000              DCB      0x00,0x00
