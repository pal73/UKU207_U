; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\control.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\control.d --feedback=.\EXE\UKU_220_IPS_TERMOKOMPENSAT.fed --cpu=Cortex-M3 --apcs=interwork -O1 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU_220_IPS_TERMOKOMPENSAT -DUKU2071x -DUKU_ZVU --omf_browse=.\EXE\control.crf control.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  ke_start PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  e92d41fc          PUSH     {r2-r8,lr}
;;;297    {          
000004  4606              MOV      r6,r0
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f04f0400          MOV      r4,#0
00000a  4dff              LDR      r5,|L1.1032|
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000c  f04f0064          MOV      r0,#0x64
000010  77a8              STRB     r0,[r5,#0x1e]
;;;315    
;;;316    	spc_stat=spcKE;
000012  f04f0701          MOV      r7,#1
000016  76af              STRB     r7,[r5,#0x1a]
;;;317    	__ee_spc_stat=spcKE;
000018  f8a57068          STRH     r7,[r5,#0x68]
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001c  4639              MOV      r1,r7
00001e  f240209a          MOV      r0,#0x29a
000022  f7fffffe          BL       lc640_write_int
;;;319    	
;;;320    	spc_bat=0;
000026  76ec              STRB     r4,[r5,#0x1b]
;;;321    	__ee_spc_bat=0;
000028  f8a5406a          STRH     r4,[r5,#0x6a]
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  4621              MOV      r1,r4
00002e  f240209e          MOV      r0,#0x29e
000032  f7fffffe          BL       lc640_write_int
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000036  f8df83d4          LDR      r8,|L1.1036|
00003a  f8c84018          STR      r4,[r8,#0x18]  ; bat
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
00003e  48f4              LDR      r0,|L1.1040|
000040  2100              MOVS     r1,#0
000042  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
000046  f7fffffe          BL       lc640_write_int
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004a  f8a8404a          STRH     r4,[r8,#0x4a]
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
00004e  2100              MOVS     r1,#0
000050  f44f70e3          MOV      r0,#0x1c6
000054  f7fffffe          BL       lc640_write_int
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  772c              STRB     r4,[r5,#0x1c]
;;;332    	__ee_spc_phase=0;
00005a  f8a5406c          STRH     r4,[r5,#0x6c]
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  4621              MOV      r1,r4
000060  f44f7028          MOV      r0,#0x2a0
000064  f7fffffe          BL       lc640_write_int
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000068  eb060046          ADD      r0,r6,r6,LSL #1
00006c  eb001006          ADD      r0,r0,r6,LSL #4
000070  eb080180          ADD      r1,r8,r0,LSL #2
000074  48e7              LDR      r0,|L1.1044|
000076  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
000078  f1000001          ADD      r0,r0,#1
00007c  f0000007          AND      r0,r0,#7
000080  eb010040          ADD      r0,r1,r0,LSL #1
000084  8c00              LDRH     r0,[r0,#0x20]
000086  9001              STR      r0,[sp,#4]
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  4ee3              LDR      r6,|L1.1048|
00008a  8bb0              LDRH     r0,[r6,#0x1c]
00008c  9000              STR      r0,[sp,#0]
;;;343    		gran_char(&temp,1,99);
00008e  f04f0263          MOV      r2,#0x63
000092  f04f0101          MOV      r1,#1
000096  4668              MOV      r0,sp
000098  f7fffffe          BL       gran_char
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  f10504f8          ADD      r4,r5,#0xf8
0000a0  f89d0000          LDRB     r0,[sp,#0]
0000a4  7020              STRB     r0,[r4,#0]
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  7e30              LDRB     r0,[r6,#0x18]
0000a8  9000              STR      r0,[sp,#0]
;;;347    		gran_char(&temp,1,12);
0000aa  220c              MOVS     r2,#0xc
0000ac  2101              MOVS     r1,#1
0000ae  4668              MOV      r0,sp
0000b0  f7fffffe          BL       gran_char
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  f89d0000          LDRB     r0,[sp,#0]
0000b8  7060              STRB     r0,[r4,#1]
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000ba  7b30              LDRB     r0,[r6,#0xc]
0000bc  9000              STR      r0,[sp,#0]
;;;351    		gran_char(&temp,1,31);
0000be  221f              MOVS     r2,#0x1f
0000c0  2101              MOVS     r1,#1
0000c2  4668              MOV      r0,sp
0000c4  f7fffffe          BL       gran_char
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000c8  f89d0000          LDRB     r0,[sp,#0]
0000cc  70a0              STRB     r0,[r4,#2]
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000ce  f89d0004          LDRB     r0,[sp,#4]
0000d2  70e0              STRB     r0,[r4,#3]
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d4  f24020a2          MOV      r0,#0x2a2
0000d8  6821              LDR      r1,[r4,#0]  ; ke_date
0000da  f7fffffe          BL       lc640_write_long
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000de  7a30              LDRB     r0,[r6,#8]
0000e0  9000              STR      r0,[sp,#0]
;;;358    		gran_char(&temp,0,23);
0000e2  2217              MOVS     r2,#0x17
0000e4  2100              MOVS     r1,#0
0000e6  4668              MOV      r0,sp
0000e8  f7fffffe          BL       gran_char
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ec  f89d0000          LDRB     r0,[sp,#0]
0000f0  7120              STRB     r0,[r4,#4]
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f2  7930              LDRB     r0,[r6,#4]
0000f4  9000              STR      r0,[sp,#0]
;;;362    		gran_char(&temp,0,59);
0000f6  223b              MOVS     r2,#0x3b
0000f8  2100              MOVS     r1,#0
0000fa  4668              MOV      r0,sp
0000fc  f7fffffe          BL       gran_char
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  f89d0000          LDRB     r0,[sp,#0]
000104  7160              STRB     r0,[r4,#5]
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  7830              LDRB     r0,[r6,#0]
000108  9000              STR      r0,[sp,#0]
;;;366    		gran_char(&temp,0,59);
00010a  223b              MOVS     r2,#0x3b
00010c  2100              MOVS     r1,#0
00010e  4668              MOV      r0,sp
000110  f7fffffe          BL       gran_char
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  f89d0000          LDRB     r0,[sp,#0]
000118  71a0              STRB     r0,[r4,#6]
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011a  f89d0005          LDRB     r0,[sp,#5]
00011e  71e0              STRB     r0,[r4,#7]
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000120  f24020a6          MOV      r0,#0x2a6
000124  6861              LDR      r1,[r4,#4]  ; ke_date
000126  f7fffffe          BL       lc640_write_long
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
00012a  70af              STRB     r7,[r5,#2]
;;;373    	}
;;;374    }
00012c  e8bd81fc          POP      {r2-r8,pc}
;;;375    #endif
                          ENDP

                  ke_drv PROC
;;;457    //-----------------------------------------------
;;;458    void ke_drv(void)
000130  e92d47f0          PUSH     {r4-r10,lr}
;;;459    {
000134  b088              SUB      sp,sp,#0x20
;;;460    static char ke_drv_cnt_10s;
;;;461    static short i_bat_buff[6];
;;;462    static char i_bat_buff_cnt;
;;;463    short ke_drv_i_temp;
;;;464    short ke_drv_i_avg;
;;;465    char i;
;;;466    short ke_drv_i_temp_temp;
;;;467    const long bat_hndl_t_razr_const[7]={600L,1800L,3600L,10800L,18000L,36000L,72000L};
000136  f04f021c          MOV      r2,#0x1c
00013a  49b8              LDR      r1,|L1.1052|
00013c  a801              ADD      r0,sp,#4
00013e  f7fffffe          BL       __aeabi_memcpy4
;;;468    
;;;469    if(bat_hndl_zvu_ke_init==1)	  //Инициализация при включении контроля емкости 
000142  4eb1              LDR      r6,|L1.1032|
;;;470    	{
;;;471    	
;;;472    	i_bat_buff[0]=0;
000144  4bb6              LDR      r3,|L1.1056|
000146  2500              MOVS     r5,#0
000148  78b0              LDRB     r0,[r6,#2]            ;469  ; bat_hndl_zvu_ke_init
00014a  2801              CMP      r0,#1                 ;469
00014c  d102              BNE      |L1.340|
00014e  801d              STRH     r5,[r3,#0]
;;;473    	i_bat_buff[0]=0;
;;;474    	i_bat_buff[0]=0;
;;;475    	i_bat_buff[0]=0;
;;;476    	i_bat_buff[0]=0;
;;;477    	i_bat_buff[0]=0;
;;;478    	i_bat_buff_cnt=0;
000150  71b5              STRB     r5,[r6,#6]
;;;479    
;;;480    	bat_hndl_zvu_ke_init=0;
000152  70b5              STRB     r5,[r6,#2]
                  |L1.340|
;;;481    	}
;;;482    
;;;483    
;;;484    
;;;485    
;;;486    if(spc_stat==spcKE)
000154  7eb0              LDRB     r0,[r6,#0x1a]  ; spc_stat
000156  2801              CMP      r0,#1
000158  d17e              BNE      |L1.600|
;;;487    	{
;;;488    	ke_drv_i_temp=-Ib_ips_termokompensat/10;
00015a  48b2              LDR      r0,|L1.1060|
00015c  f04f070a          MOV      r7,#0xa
000160  f9b00000          LDRSH    r0,[r0,#0]  ; Ib_ips_termokompensat
000164  f1c00000          RSB      r0,r0,#0
000168  fb90f0f7          SDIV     r0,r0,r7
00016c  b200              SXTH     r0,r0
;;;489    	if(ke_drv_i_temp<0)ke_drv_i_temp=0;
00016e  2800              CMP      r0,#0
000170  da01              BGE      |L1.374|
000172  f04f0000          MOV      r0,#0
                  |L1.374|
;;;490    
;;;491    	bat_hndl_plazma[3]=ke_drv_cnt_10s;
000176  4aac              LDR      r2,|L1.1064|
000178  7971              LDRB     r1,[r6,#5]  ; ke_drv_cnt_10s
00017a  60d1              STR      r1,[r2,#0xc]  ; bat_hndl_plazma
;;;492    	if(++ke_drv_cnt_10s>10)
00017c  1c49              ADDS     r1,r1,#1
;;;493    		{
;;;494    		ke_drv_cnt_10s=0;
;;;495    
;;;496    		i_bat_buff_cnt++;
;;;497    		if(i_bat_buff_cnt>=6)i_bat_buff_cnt=0;
;;;498    		bat_hndl_plazma[2]=i_bat_buff_cnt;
;;;499    		i_bat_buff[i_bat_buff_cnt]=ke_drv_i_temp;
;;;500    		ke_drv_i_temp_temp=0;
;;;501    		for(i=0;i<6;i++)
;;;502    			{
;;;503    			ke_drv_i_temp_temp+=i_bat_buff[i];
;;;504    			}
;;;505    		ke_drv_i_avg=ke_drv_i_temp_temp/6;
;;;506    
;;;507    		I_from_t_table[0]=BAT_C_POINT_1_6*6; 	//Ток при котором батарея разрядится за 1/6 часа (0.1А)
;;;508    		I_from_t_table[1]=BAT_C_POINT_1_2*2; 	//Ток при котором батарея разрядится за 1/2 часа (0.1А)
;;;509    		I_from_t_table[2]=BAT_C_POINT_1; 		//Ток при котором батарея разрядится за 1 час (0.1А)
;;;510    		I_from_t_table[3]=BAT_C_POINT_3/3; 		//Ток при котором батарея разрядится за 3 часа (0.1А)
;;;511    		I_from_t_table[4]=BAT_C_POINT_5/5; 		//Ток при котором батарея разрядится за 5 часов (0.1А)
;;;512    		I_from_t_table[5]=BAT_C_POINT_10/10; 	//Ток при котором батарея разрядится за 10 часов (0.1А)
;;;513    		I_from_t_table[6]=BAT_C_POINT_20/20; 	//Ток при котором батарея разрядится за 20 часов (0.1А)
;;;514    		
;;;515    		U_end_from_i_table[0]=BAT_U_END_1_6;	//Конечное напряжение контроля емкости при разряде за 1/6 часа
;;;516    		U_end_from_i_table[1]=BAT_U_END_1_2;	//Конечное напряжение контроля емкости при разряде за 1/2 часа
;;;517    		U_end_from_i_table[2]=BAT_U_END_1;		//Конечное напряжение контроля емкости при разряде за 1 час
;;;518    		U_end_from_i_table[3]=BAT_U_END_3;		//Конечное напряжение контроля емкости при разряде за 3 часа
;;;519    		U_end_from_i_table[4]=BAT_U_END_5;		//Конечное напряжение контроля емкости при разряде за 5 часов
;;;520    		U_end_from_i_table[5]=BAT_U_END_10;		//Конечное напряжение контроля емкости при разряде за 10 часов
;;;521    		U_end_from_i_table[6]=BAT_U_END_20;		//Конечное напряжение контроля емкости при разряде за 20 часов		
;;;522    
;;;523    		bat_hndl_plazma[1]=ke_drv_i_avg;
;;;524    		bat_hndl_i_temp=ke_drv_i_avg;
00017e  4ca2              LDR      r4,|L1.1032|
000180  b2c9              UXTB     r1,r1                 ;492
000182  3480              ADDS     r4,r4,#0x80
000184  7171              STRB     r1,[r6,#5]            ;492
000186  290a              CMP      r1,#0xa               ;492
000188  d967              BLS      |L1.602|
00018a  7175              STRB     r5,[r6,#5]            ;494
00018c  79b1              LDRB     r1,[r6,#6]            ;496  ; i_bat_buff_cnt
00018e  f1010101          ADD      r1,r1,#1              ;496
000192  b2c9              UXTB     r1,r1                 ;496
000194  71b1              STRB     r1,[r6,#6]            ;496
000196  2906              CMP      r1,#6                 ;497
000198  d300              BCC      |L1.412|
00019a  71b5              STRB     r5,[r6,#6]            ;497
                  |L1.412|
00019c  79b1              LDRB     r1,[r6,#6]            ;498  ; i_bat_buff_cnt
00019e  6091              STR      r1,[r2,#8]            ;498  ; bat_hndl_plazma
0001a0  f8230011          STRH     r0,[r3,r1,LSL #1]     ;499
0001a4  f04f0100          MOV      r1,#0                 ;500
0001a8  4608              MOV      r0,r1                 ;501
                  |L1.426|
0001aa  f833c010          LDRH     r12,[r3,r0,LSL #1]    ;503
0001ae  4461              ADD      r1,r1,r12             ;503
0001b0  b209              SXTH     r1,r1                 ;503
0001b2  f1000001          ADD      r0,r0,#1              ;501
0001b6  b2c0              UXTB     r0,r0                 ;501
0001b8  2806              CMP      r0,#6                 ;501
0001ba  d3f6              BCC      |L1.426|
0001bc  f04f0006          MOV      r0,#6                 ;505
0001c0  fb91f0f0          SDIV     r0,r1,r0              ;505
0001c4  b201              SXTH     r1,r0                 ;505
0001c6  4899              LDR      r0,|L1.1068|
0001c8  f8df825c          LDR      r8,|L1.1064|
0001cc  8800              LDRH     r0,[r0,#0]            ;507  ; BAT_C_POINT_1_6
0001ce  f1a8081c          SUB      r8,r8,#0x1c           ;507
0001d2  eb000040          ADD      r0,r0,r0,LSL #1       ;507
0001d6  ea4f0040          LSL      r0,r0,#1              ;507
0001da  f8a80000          STRH     r0,[r8,#0]            ;507
0001de  4894              LDR      r0,|L1.1072|
0001e0  8800              LDRH     r0,[r0,#0]            ;508  ; BAT_C_POINT_1_2
0001e2  ea4f0040          LSL      r0,r0,#1              ;508
0001e6  f8a80002          STRH     r0,[r8,#2]            ;508
0001ea  4892              LDR      r0,|L1.1076|
0001ec  8800              LDRH     r0,[r0,#0]            ;509  ; BAT_C_POINT_1
0001ee  f8a80004          STRH     r0,[r8,#4]            ;509
0001f2  4891              LDR      r0,|L1.1080|
0001f4  f04f0303          MOV      r3,#3                 ;510
0001f8  f9b00000          LDRSH    r0,[r0,#0]            ;510  ; BAT_C_POINT_3
0001fc  fb90f0f3          SDIV     r0,r0,r3              ;510
000200  f8a80006          STRH     r0,[r8,#6]            ;510
000204  488d              LDR      r0,|L1.1084|
000206  f04f0305          MOV      r3,#5                 ;511
00020a  f9b00000          LDRSH    r0,[r0,#0]            ;511  ; BAT_C_POINT_5
00020e  fb90f0f3          SDIV     r0,r0,r3              ;511
000212  f8a80008          STRH     r0,[r8,#8]            ;511
000216  488a              LDR      r0,|L1.1088|
000218  f9b00000          LDRSH    r0,[r0,#0]            ;512  ; BAT_C_POINT_10
00021c  fb90f0f7          SDIV     r0,r0,r7              ;512
000220  f8a8000a          STRH     r0,[r8,#0xa]          ;512
000224  4887              LDR      r0,|L1.1092|
000226  f04f0314          MOV      r3,#0x14              ;513
00022a  f9b00000          LDRSH    r0,[r0,#0]            ;513  ; BAT_C_POINT_20
00022e  fb90f0f3          SDIV     r0,r0,r3              ;513
000232  f8a8000c          STRH     r0,[r8,#0xc]          ;513
000236  4884              LDR      r0,|L1.1096|
000238  f108090e          ADD      r9,r8,#0xe            ;515
00023c  f9b07000          LDRSH    r7,[r0,#0]            ;515  ; BAT_U_END_1_6
000240  f8a97000          STRH     r7,[r9,#0]            ;515
000244  4881              LDR      r0,|L1.1100|
000246  8800              LDRH     r0,[r0,#0]            ;516  ; BAT_U_END_1_2
000248  f8a90002          STRH     r0,[r9,#2]            ;516
00024c  4880              LDR      r0,|L1.1104|
00024e  8800              LDRH     r0,[r0,#0]            ;517  ; BAT_U_END_1
000250  f8a90004          STRH     r0,[r9,#4]            ;517
000254  487f              LDR      r0,|L1.1108|
000256  e001              B        |L1.604|
                  |L1.600|
000258  e11b              B        |L1.1170|
                  |L1.602|
00025a  e061              B        |L1.800|
                  |L1.604|
00025c  8800              LDRH     r0,[r0,#0]            ;518  ; BAT_U_END_3
00025e  f8a90006          STRH     r0,[r9,#6]            ;518
000262  487d              LDR      r0,|L1.1112|
000264  8800              LDRH     r0,[r0,#0]            ;519  ; BAT_U_END_5
000266  f8a90008          STRH     r0,[r9,#8]            ;519
00026a  487c              LDR      r0,|L1.1116|
00026c  8800              LDRH     r0,[r0,#0]            ;520  ; BAT_U_END_10
00026e  f8a9000a          STRH     r0,[r9,#0xa]          ;520
000272  487b              LDR      r0,|L1.1120|
000274  f9b0c000          LDRSH    r12,[r0,#0]           ;521  ; BAT_U_END_20
000278  f8a9c00c          STRH     r12,[r9,#0xc]         ;521
00027c  6051              STR      r1,[r2,#4]            ;523  ; bat_hndl_plazma
00027e  80e1              STRH     r1,[r4,#6]
;;;525    		
;;;526    		for(i=0;i<7;i++)
000280  f04f0000          MOV      r0,#0
                  |L1.644|
;;;527    			{
;;;528    			if(bat_hndl_i_temp>=I_from_t_table[i])
000284  f9383010          LDRSH    r3,[r8,r0,LSL #1]
000288  428b              CMP      r3,r1
00028a  dd04              BLE      |L1.662|
00028c  f1000001          ADD      r0,r0,#1              ;526
000290  b2c0              UXTB     r0,r0                 ;526
000292  2807              CMP      r0,#7                 ;526
000294  d3f6              BCC      |L1.644|
                  |L1.662|
;;;529    				{
;;;530    				break;
;;;531    				}
;;;532    			}
;;;533    
;;;534    		bat_hndl_plazma[0]=i;
000296  6010              STR      r0,[r2,#0]  ; bat_hndl_plazma
000298  f10d0a04          ADD      r10,sp,#4             ;467
;;;535    
;;;536    		 if(i==0) bat_hndl_t_razr_ke=bat_hndl_t_razr_const[0];
00029c  b1c8              CBZ      r0,|L1.722|
;;;537    		 else if((i>=1)&&(i<7))
00029e  1e42              SUBS     r2,r0,#1
0002a0  2a06              CMP      r2,#6
0002a2  d219              BCS      |L1.728|
;;;538    		 	{
;;;539    			short i1,i2;
;;;540    			i1=I_from_t_table[i-1]-bat_hndl_i_temp;
0002a4  f8383012          LDRH     r3,[r8,r2,LSL #1]
0002a8  eba30101          SUB      r1,r3,r1
0002ac  b209              SXTH     r1,r1
;;;541    			i2=I_from_t_table[i-1]-I_from_t_table[i];
0002ae  f8388010          LDRH     r8,[r8,r0,LSL #1]
0002b2  eba30308          SUB      r3,r3,r8
0002b6  b21b              SXTH     r3,r3
;;;542    			bat_hndl_t_razr_ke=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
0002b8  f85a8020          LDR      r8,[r10,r0,LSL #2]
0002bc  f85a2022          LDR      r2,[r10,r2,LSL #2]
0002c0  eba80802          SUB      r8,r8,r2
;;;543    			bat_hndl_t_razr_ke*=(long)i1;
0002c4  fb08f801          MUL      r8,r8,r1
;;;544    			bat_hndl_t_razr_ke/=(long)i2;
0002c8  fb98f1f3          SDIV     r1,r8,r3
;;;545    			bat_hndl_t_razr_ke+=bat_hndl_t_razr_const[i-1];
0002cc  4411              ADD      r1,r1,r2
0002ce  64e1              STR      r1,[r4,#0x4c]  ; bat_hndl_t_razr_ke
;;;546    			}
0002d0  e006              B        |L1.736|
                  |L1.722|
0002d2  9901              LDR      r1,[sp,#4]            ;536
0002d4  64e1              STR      r1,[r4,#0x4c]         ;536  ; bat_hndl_t_razr_ke
0002d6  e003              B        |L1.736|
                  |L1.728|
;;;547    		else if(i>=7)
0002d8  2807              CMP      r0,#7
0002da  d301              BCC      |L1.736|
;;;548    			{
;;;549    			bat_hndl_t_razr_ke=bat_hndl_t_razr_const[6];
0002dc  9907              LDR      r1,[sp,#0x1c]
0002de  64e1              STR      r1,[r4,#0x4c]  ; bat_hndl_t_razr_ke
                  |L1.736|
;;;550    			}
;;;551    
;;;552    		 if(i==0) bat_hndl_u_end=U_end_from_i_table[0];
0002e0  b1c0              CBZ      r0,|L1.788|
;;;553    		 else if((i>=1)&&(i<7))
0002e2  1e41              SUBS     r1,r0,#1
0002e4  2906              CMP      r1,#6
0002e6  d217              BCS      |L1.792|
;;;554    		 	{
;;;555    			long u1,tempL;
;;;556    
;;;557    			tempL=(long)U_end_from_i_table[i]-(long)U_end_from_i_table[i-1];
0002e8  f9393010          LDRSH    r3,[r9,r0,LSL #1]
0002ec  f9392011          LDRSH    r2,[r9,r1,LSL #1]
0002f0  eba30302          SUB      r3,r3,r2
;;;558    			u1=bat_hndl_t_razr_ke-bat_hndl_t_razr_const[i-1];
0002f4  f85a1021          LDR      r1,[r10,r1,LSL #2]
0002f8  6ce7              LDR      r7,[r4,#0x4c]  ; bat_hndl_t_razr_ke
0002fa  eba70701          SUB      r7,r7,r1
;;;559    			tempL*=u1;
0002fe  fb03f307          MUL      r3,r3,r7
;;;560    			u1=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
000302  f85a0020          LDR      r0,[r10,r0,LSL #2]
000306  eba00001          SUB      r0,r0,r1
;;;561    			tempL/=u1;
00030a  fb93f0f0          SDIV     r0,r3,r0
;;;562    			tempL+=(long)U_end_from_i_table[i-1];
00030e  4410              ADD      r0,r0,r2
;;;563    			bat_hndl_u_end=(short)tempL;
000310  8120              STRH     r0,[r4,#8]
;;;564    			}
000312  e005              B        |L1.800|
                  |L1.788|
000314  8127              STRH     r7,[r4,#8]            ;552
000316  e003              B        |L1.800|
                  |L1.792|
;;;565    		else if(i>=7)
000318  2807              CMP      r0,#7
00031a  d301              BCC      |L1.800|
;;;566    			{
;;;567    			bat_hndl_u_end=U_end_from_i_table[6];
00031c  f8a4c008          STRH     r12,[r4,#8]
                  |L1.800|
;;;568    			}
;;;569    
;;;570    		}
;;;571    
;;;572    
;;;573    
;;;574    	if(spc_phase==0)
000320  7f30              LDRB     r0,[r6,#0x1c]  ; spc_phase
;;;575    		{
;;;576    		//mess_send(MESS2BAT_HNDL,PARAM_BAT_MASK_OFF_AFTER_2SEC,(1<<(1-spc_bat)),20);
;;;577    		mess_send(MESS2BPS_HNDL,PARAM_BPS_ALL_OFF_AFTER_2SEC,0xffff,20);
;;;578    
;;;579    		bat[0]._zar_cnt_ke+=abs(bat[spc_bat]._Ib);
;;;580    	    	
;;;581    		if(bat[0]._zar_cnt_ke>=AH_CONSTANT)
;;;582    			{
;;;583    			bat[0]._zar_cnt_ke-=AH_CONSTANT;
;;;584    			lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0])+1);
000322  4f3b              LDR      r7,|L1.1040|
;;;585    			}
;;;586    
;;;587    		bat[0]._time_min_cnt_ke++;
;;;588    		if(bat[0]._time_min_cnt_ke>=60)
;;;589    			{
;;;590    			lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,lc640_read_int(EE_ZVU_BAT_MIN_CNT_KE)+1);
000324  f44f78e3          MOV      r8,#0x1c6
000328  bbe0              CBNZ     r0,|L1.932|
00032a  2314              MOVS     r3,#0x14              ;577
00032c  f04f32ff          MOV      r2,#0xffffffff        ;577
000330  21ce              MOVS     r1,#0xce              ;577
000332  20cd              MOVS     r0,#0xcd              ;577
000334  f7fffffe          BL       mess_send
000338  7ef1              LDRB     r1,[r6,#0x1b]         ;579  ; spc_bat
00033a  f8df90d0          LDR      r9,|L1.1036|
00033e  eb010041          ADD      r0,r1,r1,LSL #1       ;579
000342  eb001001          ADD      r0,r0,r1,LSL #4       ;579
000346  eb090080          ADD      r0,r9,r0,LSL #2       ;579
00034a  f9b00008          LDRSH    r0,[r0,#8]            ;579
00034e  f7fffffe          BL       abs
000352  f8d91018          LDR      r1,[r9,#0x18]         ;579  ; bat
000356  4401              ADD      r1,r1,r0              ;579
000358  f8c91018          STR      r1,[r9,#0x18]         ;579  ; bat
00035c  f64840a0          MOV      r0,#0x8ca0            ;581
000360  4281              CMP      r1,r0                 ;581
000362  db0c              BLT      |L1.894|
000364  eba10100          SUB      r1,r1,r0              ;583
000368  f8c91018          STR      r1,[r9,#0x18]         ;583  ; bat
00036c  8838              LDRH     r0,[r7,#0]            ;584  ; ADR_EE_BAT_ZAR_CNT_KE
00036e  f7fffffe          BL       lc640_read_int
000372  1c40              ADDS     r0,r0,#1              ;584
000374  b201              SXTH     r1,r0                 ;584
000376  f9b70000          LDRSH    r0,[r7,#0]            ;584  ; ADR_EE_BAT_ZAR_CNT_KE
00037a  f7fffffe          BL       lc640_write_int
                  |L1.894|
00037e  f8b9004a          LDRH     r0,[r9,#0x4a]         ;587  ; bat
000382  f1000001          ADD      r0,r0,#1              ;587
000386  b281              UXTH     r1,r0                 ;587
000388  f8a9104a          STRH     r1,[r9,#0x4a]         ;587
00038c  293c              CMP      r1,#0x3c              ;588
00038e  d309              BCC      |L1.932|
000390  4640              MOV      r0,r8
000392  f7fffffe          BL       lc640_read_int
000396  1c40              ADDS     r0,r0,#1
000398  b201              SXTH     r1,r0
00039a  4640              MOV      r0,r8
00039c  f7fffffe          BL       lc640_write_int
;;;591    			bat[0]._time_min_cnt_ke=0;
0003a0  f8a9504a          STRH     r5,[r9,#0x4a]
                  |L1.932|
;;;592    			}
;;;593    		}
;;;594    
;;;595    	else if(spc_phase==1)
;;;596    		{
;;;597    		//mess_send(MESS2BAT_HNDL,PARAM_BAT_MASK_OFF_AFTER_2SEC,(1<<(1-spc_bat)),20);
;;;598    		}
;;;599    
;;;600    	if(out_U<bat_hndl_u_end)
0003a4  482f              LDR      r0,|L1.1124|
0003a6  f9b41008          LDRSH    r1,[r4,#8]  ; bat_hndl_u_end
0003aa  f9b00000          LDRSH    r0,[r0,#0]  ; out_U
0003ae  4288              CMP      r0,r1
0003b0  da6d              BGE      |L1.1166|
;;;601    		{
;;;602    		cnt_end_ke++;
0003b2  f8b60064          LDRH     r0,[r6,#0x64]  ; cnt_end_ke
0003b6  f1000001          ADD      r0,r0,#1
0003ba  b200              SXTH     r0,r0
0003bc  f8a60064          STRH     r0,[r6,#0x64]
;;;603    		if(cnt_end_ke>=30)
0003c0  281e              CMP      r0,#0x1e
0003c2  db66              BLT      |L1.1170|
;;;604    			{
;;;605    			
;;;606    			if((spc_stat==spcKE)&&(spc_phase==0))
0003c4  7eb0              LDRB     r0,[r6,#0x1a]  ; spc_stat
0003c6  2801              CMP      r0,#1
0003c8  d156              BNE      |L1.1144|
0003ca  7f30              LDRB     r0,[r6,#0x1c]  ; spc_phase
0003cc  b9d8              CBNZ     r0,|L1.1030|
;;;607    				{
;;;608    				lc640_write_int(ADR_EE_BAT_C_REAL[0],lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0]));
0003ce  8838              LDRH     r0,[r7,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
0003d0  f7fffffe          BL       lc640_read_int
0003d4  b201              SXTH     r1,r0
0003d6  4824              LDR      r0,|L1.1128|
0003d8  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_C_REAL
0003dc  f7fffffe          BL       lc640_write_int
;;;609    				ke_zvu_mem_hndl(0,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[0]),lc640_read_int(EE_ZVU_BAT_MIN_CNT_KE));
0003e0  4640              MOV      r0,r8
0003e2  f7fffffe          BL       lc640_read_int
0003e6  b284              UXTH     r4,r0
0003e8  8838              LDRH     r0,[r7,#0]  ; ADR_EE_BAT_ZAR_CNT_KE
0003ea  f7fffffe          BL       lc640_read_int
0003ee  b281              UXTH     r1,r0
0003f0  4622              MOV      r2,r4
0003f2  2000              MOVS     r0,#0
0003f4  f7fffffe          BL       ke_zvu_mem_hndl
;;;610    				lc640_write_int(ADR_EE_BAT_ZAR_CNT[0],0);
0003f8  481c              LDR      r0,|L1.1132|
0003fa  2100              MOVS     r1,#0
0003fc  f9b00000          LDRSH    r0,[r0,#0]  ; ADR_EE_BAT_ZAR_CNT
000400  f7fffffe          BL       lc640_write_int
;;;611    				cntrl_stat=50;
000404  e034              B        |L1.1136|
                  |L1.1030|
000406  e037              B        |L1.1144|
                  |L1.1032|
                          DCD      ||area_number.25||
                  |L1.1036|
                          DCD      bat
                  |L1.1040|
                          DCD      ADR_EE_BAT_ZAR_CNT_KE
                  |L1.1044|
                          DCD      bat_u_old_cnt
                  |L1.1048|
                          DCD      0x40024020
                  |L1.1052|
                          DCD      ||area_number.19||+0x4
                  |L1.1056|
                          DCD      ||.bss||
                  |L1.1060|
                          DCD      Ib_ips_termokompensat
                  |L1.1064|
                          DCD      ||.bss||+0x468
                  |L1.1068|
                          DCD      BAT_C_POINT_1_6
                  |L1.1072|
                          DCD      BAT_C_POINT_1_2
                  |L1.1076|
                          DCD      BAT_C_POINT_1
                  |L1.1080|
                          DCD      BAT_C_POINT_3
                  |L1.1084|
                          DCD      BAT_C_POINT_5
                  |L1.1088|
                          DCD      BAT_C_POINT_10
                  |L1.1092|
                          DCD      BAT_C_POINT_20
                  |L1.1096|
                          DCD      BAT_U_END_1_6
                  |L1.1100|
                          DCD      BAT_U_END_1_2
                  |L1.1104|
                          DCD      BAT_U_END_1
                  |L1.1108|
                          DCD      BAT_U_END_3
                  |L1.1112|
                          DCD      BAT_U_END_5
                  |L1.1116|
                          DCD      BAT_U_END_10
                  |L1.1120|
                          DCD      BAT_U_END_20
                  |L1.1124|
                          DCD      out_U
                  |L1.1128|
                          DCD      ADR_EE_BAT_C_REAL
                  |L1.1132|
                          DCD      ADR_EE_BAT_ZAR_CNT
                  |L1.1136|
000470  f04f0032          MOV      r0,#0x32
000474  85b0              STRH     r0,[r6,#0x2c]
;;;612    				cntrl_stat_old=50;
000476  85f0              STRH     r0,[r6,#0x2e]
                  |L1.1144|
;;;613    				}
;;;614    
;;;615    			spc_stat=spcOFF;
000478  76b5              STRB     r5,[r6,#0x1a]
;;;616    			__ee_spc_stat=spcOFF;
00047a  f8a65068          STRH     r5,[r6,#0x68]
;;;617    			lc640_write_int(EE_SPC_STAT,spcOFF);
00047e  b008              ADD      sp,sp,#0x20
000480  2100              MOVS     r1,#0
000482  e8bd47f0          POP      {r4-r10,lr}
000486  f240209a          MOV      r0,#0x29a
00048a  f7ffbffe          B.W      lc640_write_int
                  |L1.1166|
;;;618    
;;;619    			}
;;;620    		}
;;;621    	else cnt_end_ke=0;
00048e  f8a65064          STRH     r5,[r6,#0x64]
                  |L1.1170|
;;;622    
;;;623    	}
;;;624    			
;;;625    }
000492  b008              ADD      sp,sp,#0x20
000494  e8bd87f0          POP      {r4-r10,pc}
;;;626    #endif
                          ENDP

                  vz_start PROC
;;;696    //-----------------------------------------------
;;;697    char vz_start(char hour)
000498  b570              PUSH     {r4-r6,lr}
;;;698    {          
00049a  4605              MOV      r5,r0
;;;699    char out;
;;;700    out=0;
00049c  f04f0600          MOV      r6,#0
;;;701    if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1))
0004a0  4cff              LDR      r4,|L1.2208|
0004a2  7ea0              LDRB     r0,[r4,#0x1a]  ; spc_stat
0004a4  bb90              CBNZ     r0,|L1.1292|
0004a6  48ff              LDR      r0,|L1.2212|
0004a8  8800              LDRH     r0,[r0,#0]  ; speedChrgBlckStat
0004aa  2801              CMP      r0,#1
0004ac  d02e              BEQ      |L1.1292|
;;;702    	{
;;;703    	spc_stat=spcVZ;
0004ae  f04f0102          MOV      r1,#2
0004b2  76a1              STRB     r1,[r4,#0x1a]
;;;704    	__ee_spc_stat=spcVZ; 
0004b4  f8a41068          STRH     r1,[r4,#0x68]
;;;705    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
0004b8  f240209a          MOV      r0,#0x29a
0004bc  f7fffffe          BL       lc640_write_int
;;;706    	vz_cnt_h=hour;
0004c0  f8a45060          STRH     r5,[r4,#0x60]
;;;707    	__ee_vz_cnt=hour*60;
0004c4  ebc51005          RSB      r0,r5,r5,LSL #4
0004c8  ea4f0080          LSL      r0,r0,#2
0004cc  f8a40066          STRH     r0,[r4,#0x66]
;;;708    	if(hour==0)__ee_vz_cnt=30;
0004d0  b91d              CBNZ     r5,|L1.1242|
0004d2  f04f001e          MOV      r0,#0x1e
0004d6  f8a40066          STRH     r0,[r4,#0x66]
                  |L1.1242|
;;;709    	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
0004da  f104045c          ADD      r4,r4,#0x5c
0004de  f44f7027          MOV      r0,#0x29c
0004e2  f9b4100a          LDRSH    r1,[r4,#0xa]  ; __ee_vz_cnt
0004e6  f7fffffe          BL       lc640_write_int
;;;710    	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
0004ea  f9b4100a          LDRSH    r1,[r4,#0xa]  ; __ee_vz_cnt
0004ee  f44f702a          MOV      r0,#0x2a8
0004f2  f7fffffe          BL       lc640_write_int
;;;711    	vz_cnt_h_=0;
0004f6  f04f0000          MOV      r0,#0
0004fa  80e0              STRH     r0,[r4,#6]
;;;712    	vz_cnt_s=0;
0004fc  8020              STRH     r0,[r4,#0]
;;;713    	vz_cnt_s_=0;
0004fe  8060              STRH     r0,[r4,#2]
;;;714    	out=1;
000500  f04f0601          MOV      r6,#1
;;;715    	vz_mem_hndl(1);
000504  f04f0001          MOV      r0,#1
000508  f7fffffe          BL       vz_mem_hndl
                  |L1.1292|
;;;716    	}
;;;717    //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;718    //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;719    //plazma=out;	
;;;720    return out;
00050c  4630              MOV      r0,r6
;;;721    }
00050e  bd70              POP      {r4-r6,pc}
;;;722    
                          ENDP

                  vz_stop PROC
;;;723    //-----------------------------------------------
;;;724    void vz_stop(void)
000510  b510              PUSH     {r4,lr}
;;;725    {
;;;726    if(spc_stat==spcVZ)
000512  4ce3              LDR      r4,|L1.2208|
000514  7ea0              LDRB     r0,[r4,#0x1a]  ; spc_stat
000516  2802              CMP      r0,#2
000518  d113              BNE      |L1.1346|
;;;727         {
;;;728    vz_mem_hndl(vz_cnt_h);          
00051a  f104042a          ADD      r4,r4,#0x2a
00051e  8ee0              LDRH     r0,[r4,#0x36]  ; vz_cnt_h
000520  f7fffffe          BL       vz_mem_hndl
;;;729    vz_cnt_s=0;
000524  f04f0000          MOV      r0,#0
000528  8660              STRH     r0,[r4,#0x32]
;;;730    vz_cnt_h=0;
00052a  86e0              STRH     r0,[r4,#0x36]
;;;731    vz_cnt_h_=0;
00052c  8720              STRH     r0,[r4,#0x38]
;;;732    spc_stat=spcOFF;
00052e  f8040c10          STRB     r0,[r4,#-0x10]
;;;733    
;;;734    		__ee_spc_stat=spcOFF;
000532  87e0              STRH     r0,[r4,#0x3e]
;;;735    		lc640_write_int(EE_SPC_STAT,spcOFF);
000534  4601              MOV      r1,r0
000536  e8bd4010          POP      {r4,lr}
00053a  f240209a          MOV      r0,#0x29a
00053e  f7ffbffe          B.W      lc640_write_int
                  |L1.1346|
;;;736         }
;;;737    
;;;738    }
000542  bd10              POP      {r4,pc}
;;;739    
                          ENDP

                  amper_chas_cnt_drv PROC
;;;741    //-----------------------------------------------
;;;742    void amper_chas_cnt_drv(void)
000544  b510              PUSH     {r4,lr}
;;;743    {
;;;744    
;;;745    amper_chas_cnt_drv_summ+=(long)Ib_ips_termokompensat;
000546  4ad6              LDR      r2,|L1.2208|
000548  49d7              LDR      r1,|L1.2216|
00054a  3280              ADDS     r2,r2,#0x80
00054c  f9b11000          LDRSH    r1,[r1,#0]  ; Ib_ips_termokompensat
000550  6dd0              LDR      r0,[r2,#0x5c]  ; amper_chas_cnt_drv_summ
000552  4401              ADD      r1,r1,r0
000554  65d1              STR      r1,[r2,#0x5c]  ; amper_chas_cnt_drv_summ
;;;746    
;;;747    if(amper_chas_cnt_drv_summ>=36000L)
000556  f64843a0          MOV      r3,#0x8ca0
;;;748    	{
;;;749    	amper_chas_cnt_drv_summ-=36000L;
;;;750    	lc640_write_int(EE_AMPER_CHAS_CNT,lc640_read_int(EE_AMPER_CHAS_CNT)+1);
00055a  f44f74e4          MOV      r4,#0x1c8
00055e  4299              CMP      r1,r3                 ;747
000560  db0c              BLT      |L1.1404|
000562  eba10103          SUB      r1,r1,r3              ;749
000566  65d1              STR      r1,[r2,#0x5c]         ;749  ; amper_chas_cnt_drv_summ
000568  4620              MOV      r0,r4
00056a  f7fffffe          BL       lc640_read_int
00056e  1c40              ADDS     r0,r0,#1
000570  b201              SXTH     r1,r0
000572  4620              MOV      r0,r4
000574  e8bd4010          POP      {r4,lr}
000578  f7ffbffe          B.W      lc640_write_int
                  |L1.1404|
;;;751    	}
;;;752    else if(amper_chas_cnt_drv_summ<=-36000L)
00057c  48cb              LDR      r0,|L1.2220|
00057e  4281              CMP      r1,r0
000580  dc0c              BGT      |L1.1436|
;;;753    	{
;;;754    	amper_chas_cnt_drv_summ+=36000L;
000582  eb010003          ADD      r0,r1,r3
000586  65d0              STR      r0,[r2,#0x5c]  ; amper_chas_cnt_drv_summ
;;;755    	lc640_write_int(EE_AMPER_CHAS_CNT,lc640_read_int(EE_AMPER_CHAS_CNT)-1);
000588  4620              MOV      r0,r4
00058a  f7fffffe          BL       lc640_read_int
00058e  1e40              SUBS     r0,r0,#1
000590  b201              SXTH     r1,r0
000592  4620              MOV      r0,r4
000594  e8bd4010          POP      {r4,lr}
000598  f7ffbffe          B.W      lc640_write_int
                  |L1.1436|
;;;756    	}
;;;757    }
00059c  bd10              POP      {r4,pc}
;;;758    #endif
                          ENDP

                  avz_next_date_hndl PROC
;;;760    //-----------------------------------------------
;;;761    void avz_next_date_hndl(void)
00059e  b570              PUSH     {r4-r6,lr}
;;;762    {
;;;763    if((LPC_RTC->MONTH+AVZ)>12)lc640_write_int(EE_YEAR_AVZ,LPC_RTC->YEAR+1);
0005a0  4cc3              LDR      r4,|L1.2224|
0005a2  f8940038          LDRB     r0,[r4,#0x38]
0005a6  4dc3              LDR      r5,|L1.2228|
0005a8  7829              LDRB     r1,[r5,#0]  ; AVZ
0005aa  4408              ADD      r0,r0,r1
0005ac  280c              CMP      r0,#0xc
0005ae  d906              BLS      |L1.1470|
0005b0  8fa0              LDRH     r0,[r4,#0x3c]
0005b2  1c40              ADDS     r0,r0,#1
0005b4  b201              SXTH     r1,r0
0005b6  20b8              MOVS     r0,#0xb8
0005b8  f7fffffe          BL       lc640_write_int
0005bc  e004              B        |L1.1480|
                  |L1.1470|
;;;764    else lc640_write_int(EE_YEAR_AVZ,LPC_RTC->YEAR);
0005be  f9b4103c          LDRSH    r1,[r4,#0x3c]
0005c2  20b8              MOVS     r0,#0xb8
0005c4  f7fffffe          BL       lc640_write_int
                  |L1.1480|
;;;765    
;;;766    //lc640_write_int(EE_YEAR_AVZ,6);
;;;767    
;;;768    if((LPC_RTC->MONTH+AVZ)>12)lc640_write_int(EE_MONTH_AVZ,(LPC_RTC->MONTH+AVZ)-12);
0005c8  f8941038          LDRB     r1,[r4,#0x38]
0005cc  7828              LDRB     r0,[r5,#0]  ; AVZ
0005ce  4401              ADD      r1,r1,r0
0005d0  290c              CMP      r1,#0xc
0005d2  d907              BLS      |L1.1508|
0005d4  f8941038          LDRB     r1,[r4,#0x38]
0005d8  380c              SUBS     r0,r0,#0xc
0005da  4401              ADD      r1,r1,r0
0005dc  20b6              MOVS     r0,#0xb6
0005de  f7fffffe          BL       lc640_write_int
0005e2  e005              B        |L1.1520|
                  |L1.1508|
;;;769    else lc640_write_int(EE_MONTH_AVZ,LPC_RTC->MONTH+AVZ);                                                 
0005e4  f8941038          LDRB     r1,[r4,#0x38]
0005e8  4401              ADD      r1,r1,r0
0005ea  20b6              MOVS     r0,#0xb6
0005ec  f7fffffe          BL       lc640_write_int
                  |L1.1520|
;;;770    
;;;771    //lc640_write_int(EE_MONTH_AVZ,5);
;;;772    
;;;773    if(LPC_RTC->DOM>28) lc640_write_int(EE_DATE_AVZ,28);
0005f0  f894002c          LDRB     r0,[r4,#0x2c]
0005f4  281c              CMP      r0,#0x1c
0005f6  d904              BLS      |L1.1538|
0005f8  211c              MOVS     r1,#0x1c
0005fa  20b4              MOVS     r0,#0xb4
0005fc  f7fffffe          BL       lc640_write_int
000600  e004              B        |L1.1548|
                  |L1.1538|
;;;774    else lc640_write_int(EE_DATE_AVZ,LPC_RTC->DOM);
000602  f894102c          LDRB     r1,[r4,#0x2c]
000606  20b4              MOVS     r0,#0xb4
000608  f7fffffe          BL       lc640_write_int
                  |L1.1548|
;;;775    
;;;776    //lc640_write_int(EE_DATE_AVZ,4);
;;;777    
;;;778    lc640_write_int(EE_HOUR_AVZ,LPC_RTC->HOUR);
00060c  f1040420          ADD      r4,r4,#0x20
000610  7a21              LDRB     r1,[r4,#8]
000612  f04f00ae          MOV      r0,#0xae
000616  f7fffffe          BL       lc640_write_int
;;;779    lc640_write_int(EE_MIN_AVZ,LPC_RTC->MIN);
00061a  7921              LDRB     r1,[r4,#4]
00061c  20b0              MOVS     r0,#0xb0
00061e  f7fffffe          BL       lc640_write_int
;;;780    lc640_write_int(EE_SEC_AVZ,LPC_RTC->SEC);
000622  7821              LDRB     r1,[r4,#0]
000624  e8bd4070          POP      {r4-r6,lr}
000628  20b2              MOVS     r0,#0xb2
00062a  f7ffbffe          B.W      lc640_write_int
;;;781    
;;;782    }
;;;783    
                          ENDP

                  avz_drv PROC
;;;784    //-----------------------------------------------
;;;785    void avz_drv(void)                               
00062e  b510              PUSH     {r4,lr}
;;;786    {                
;;;787    if(AVZ!=AVZ_OFF)
000630  48a0              LDR      r0,|L1.2228|
;;;788    	{
;;;789    	if((LPC_RTC->YEAR==YEAR_AVZ)&&(LPC_RTC->MONTH==MONTH_AVZ)&&(LPC_RTC->DOM==DATE_AVZ)&&(LPC_RTC->HOUR==HOUR_AVZ)&&(LPC_RTC->MIN==MIN_AVZ)&&(LPC_RTC->SEC==SEC_AVZ))
;;;790    		{
;;;791    		bAVZ=1;
000632  4c9b              LDR      r4,|L1.2208|
000634  7800              LDRB     r0,[r0,#0]            ;787  ; AVZ
000636  b330              CBZ      r0,|L1.1670|
000638  489d              LDR      r0,|L1.2224|
00063a  8f82              LDRH     r2,[r0,#0x3c]         ;789
00063c  499e              LDR      r1,|L1.2232|
00063e  8809              LDRH     r1,[r1,#0]            ;789  ; YEAR_AVZ
000640  428a              CMP      r2,r1                 ;789
000642  d120              BNE      |L1.1670|
000644  f8902038          LDRB     r2,[r0,#0x38]         ;789
000648  499c              LDR      r1,|L1.2236|
00064a  8809              LDRH     r1,[r1,#0]            ;789  ; MONTH_AVZ
00064c  428a              CMP      r2,r1                 ;789
00064e  d11a              BNE      |L1.1670|
000650  f890102c          LDRB     r1,[r0,#0x2c]         ;789
000654  4a9a              LDR      r2,|L1.2240|
000656  8812              LDRH     r2,[r2,#0]            ;789  ; DATE_AVZ
000658  4291              CMP      r1,r2                 ;789
00065a  d114              BNE      |L1.1670|
00065c  f8901028          LDRB     r1,[r0,#0x28]         ;789
000660  4a98              LDR      r2,|L1.2244|
000662  8812              LDRH     r2,[r2,#0]            ;789  ; HOUR_AVZ
000664  4291              CMP      r1,r2                 ;789
000666  d10e              BNE      |L1.1670|
000668  f8901024          LDRB     r1,[r0,#0x24]         ;789
00066c  4a96              LDR      r2,|L1.2248|
00066e  8812              LDRH     r2,[r2,#0]            ;789  ; MIN_AVZ
000670  4291              CMP      r1,r2                 ;789
000672  d108              BNE      |L1.1670|
000674  f8900020          LDRB     r0,[r0,#0x20]         ;789
000678  4994              LDR      r1,|L1.2252|
00067a  8809              LDRH     r1,[r1,#0]            ;789  ; SEC_AVZ
00067c  4288              CMP      r0,r1                 ;789
00067e  d102              BNE      |L1.1670|
000680  f04f0001          MOV      r0,#1
000684  7760              STRB     r0,[r4,#0x1d]
                  |L1.1670|
;;;792    		}
;;;793    	}
;;;794    if(bAVZ)
000686  7f60              LDRB     r0,[r4,#0x1d]  ; bAVZ
000688  2800              CMP      r0,#0
00068a  d00c              BEQ      |L1.1702|
;;;795    	{
;;;796    	if(vz_start(AVZ_TIME))
00068c  4890              LDR      r0,|L1.2256|
00068e  8800              LDRH     r0,[r0,#0]  ; AVZ_TIME
000690  b2c0              UXTB     r0,r0
000692  f7fffffe          BL       vz_start
000696  2800              CMP      r0,#0
000698  d005              BEQ      |L1.1702|
;;;797    		{
;;;798    		bAVZ=0;
00069a  f04f0000          MOV      r0,#0
00069e  7760              STRB     r0,[r4,#0x1d]
;;;799    		avz_next_date_hndl();
0006a0  e8bd4010          POP      {r4,lr}
0006a4  e7fe              B        avz_next_date_hndl
                  |L1.1702|
;;;800    		}
;;;801    	}	
;;;802    
;;;803    }
0006a6  bd10              POP      {r4,pc}
;;;804    
                          ENDP

                  vz_drv PROC
;;;805    //-----------------------------------------------
;;;806    void vz_drv(void)
0006a8  b538              PUSH     {r3-r5,lr}
;;;807    { 
;;;808    if(spc_stat==spcVZ)
0006aa  4c7d              LDR      r4,|L1.2208|
0006ac  7ea0              LDRB     r0,[r4,#0x1a]  ; spc_stat
0006ae  2802              CMP      r0,#2
0006b0  d119              BNE      |L1.1766|
;;;809    	{
;;;810    	if((sk_stat[0]==1)||(VZ_CH_VENT_BLOK==0))
0006b2  4888              LDR      r0,|L1.2260|
0006b4  7800              LDRB     r0,[r0,#0]  ; sk_stat
0006b6  2801              CMP      r0,#1
0006b8  d016              BEQ      |L1.1768|
0006ba  4887              LDR      r0,|L1.2264|
0006bc  8800              LDRH     r0,[r0,#0]  ; VZ_CH_VENT_BLOK
0006be  b198              CBZ      r0,|L1.1768|
;;;811    		{
;;;812    
;;;813    	if(vz_cnt_s_<3600)
;;;814    		{
;;;815    		vz_cnt_s_++;
;;;816    		if(vz_cnt_s_>=3600)
;;;817    			{
;;;818    			vz_cnt_s_=0;
;;;819    			if(vz_cnt_h)
;;;820    				{
;;;821    				vz_cnt_h--;
;;;822    				vz_cnt_h_++;
;;;823    				}
;;;824    			}
;;;825    		}
;;;826    
;;;827    
;;;828    	if(vz_cnt_s<60)
;;;829    		{
;;;830    		vz_cnt_s++;
;;;831    		if(vz_cnt_s>=60)
;;;832    			{
;;;833    			vz_cnt_s=0;
;;;834    			
;;;835    			__ee_vz_cnt--;
;;;836    			lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;837    			if((!__ee_vz_cnt)||(speedChrgBlckStat==1))
;;;838    				{
;;;839    				spc_stat=spcOFF;
;;;840    						__ee_spc_stat=spcOFF;
;;;841    		lc640_write_int(EE_SPC_STAT,spcOFF);
;;;842    
;;;843    //				hv_vz_stat=hvsOFF;
;;;844    //		lc640_write(EE_HV_VZ_STAT,hvsOFF);
;;;845    				vz_mem_hndl(0);
;;;846    				}
;;;847    			}
;;;848    		}
;;;849    
;;;850    		}
;;;851    	else 
;;;852    		{
;;;853    		if(((LPC_RTC->SEC)%10)==0)
0006c0  4886              LDR      r0,|L1.2268|
0006c2  7800              LDRB     r0,[r0,#0]
0006c4  f04f010a          MOV      r1,#0xa
0006c8  fbb0f2f1          UDIV     r2,r0,r1
0006cc  fb010012          MLS      r0,r1,r2,r0
0006d0  2800              CMP      r0,#0
0006d2  d108              BNE      |L1.1766|
;;;854    			{
;;;855    			show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
0006d4  f2413088          MOV      r0,#0x1388
0006d8  9000              STR      r0,[sp,#0]
0006da  a381              ADR      r3,|L1.2272|
0006dc  a286              ADR      r2,|L1.2296|
0006de  a18c              ADR      r1,|L1.2320|
0006e0  a091              ADR      r0,|L1.2344|
0006e2  f7fffffe          BL       show_mess
                  |L1.1766|
;;;856    						"    ЗАБЛОКИРОВАН    ",
;;;857    						"     НЕИСПРАВНА     ",
;;;858    						"    ВЕНТИЛЯЦИЯ!!!   ",
;;;859    						5000);			
;;;860    			}
;;;861    		}
;;;862    /*	if(vz_cnt_s_>=3)
;;;863    		{
;;;864    		if(sk_stat[0]==0)
;;;865    		} */
;;;866    
;;;867    	}
;;;868    
;;;869    
;;;870    } 
0006e6  bd38              POP      {r3-r5,pc}
                  |L1.1768|
0006e8  f8b4005e          LDRH     r0,[r4,#0x5e]         ;813  ; vz_cnt_s_
0006ec  f44f6161          MOV      r1,#0xe10             ;813
0006f0  2500              MOVS     r5,#0                 ;810
0006f2  4288              CMP      r0,r1                 ;813
0006f4  d215              BCS      |L1.1826|
0006f6  f1000001          ADD      r0,r0,#1              ;815
0006fa  b280              UXTH     r0,r0                 ;815
0006fc  f8a4005e          STRH     r0,[r4,#0x5e]         ;815
000700  4288              CMP      r0,r1                 ;816
000702  d30e              BCC      |L1.1826|
000704  f8a4505e          STRH     r5,[r4,#0x5e]         ;818
000708  f8b40060          LDRH     r0,[r4,#0x60]         ;819  ; vz_cnt_h
00070c  b148              CBZ      r0,|L1.1826|
00070e  f1a00001          SUB      r0,r0,#1              ;821
000712  f8240f60          STRH     r0,[r4,#0x60]!        ;821
000716  8860              LDRH     r0,[r4,#2]            ;822  ; vz_cnt_h_
000718  f1000001          ADD      r0,r0,#1              ;822
00071c  8060              STRH     r0,[r4,#2]            ;822
00071e  f1a40460          SUB      r4,r4,#0x60           ;822
                  |L1.1826|
000722  f8b4005c          LDRH     r0,[r4,#0x5c]         ;828  ; vz_cnt_s
000726  283c              CMP      r0,#0x3c              ;828
000728  d2dd              BCS      |L1.1766|
00072a  f1000001          ADD      r0,r0,#1              ;830
00072e  b280              UXTH     r0,r0                 ;830
000730  f8a4005c          STRH     r0,[r4,#0x5c]         ;830
000734  283c              CMP      r0,#0x3c              ;831
000736  d3d6              BCC      |L1.1766|
000738  f8245f5c          STRH     r5,[r4,#0x5c]!        ;833
00073c  8960              LDRH     r0,[r4,#0xa]          ;835  ; __ee_vz_cnt
00073e  f1a00001          SUB      r0,r0,#1              ;835
000742  b201              SXTH     r1,r0                 ;835
000744  8161              STRH     r1,[r4,#0xa]          ;835
000746  f44f7027          MOV      r0,#0x29c             ;836
00074a  f7fffffe          BL       lc640_write_int
00074e  8960              LDRH     r0,[r4,#0xa]          ;837  ; __ee_vz_cnt
000750  f1a4045c          SUB      r4,r4,#0x5c           ;837
000754  b118              CBZ      r0,|L1.1886|
000756  4853              LDR      r0,|L1.2212|
000758  8800              LDRH     r0,[r0,#0]            ;837  ; speedChrgBlckStat
00075a  2801              CMP      r0,#1                 ;837
00075c  d1c3              BNE      |L1.1766|
                  |L1.1886|
00075e  76a5              STRB     r5,[r4,#0x1a]         ;839
000760  f8a45068          STRH     r5,[r4,#0x68]         ;840
000764  2100              MOVS     r1,#0                 ;841
000766  f240209a          MOV      r0,#0x29a             ;841
00076a  f7fffffe          BL       lc640_write_int
00076e  e8bd4038          POP      {r3-r5,lr}            ;845
000772  2000              MOVS     r0,#0                 ;845
000774  f7ffbffe          B.W      vz_mem_hndl
;;;871    
                          ENDP

                  vz1_drv PROC
;;;873    //драйвер уравнительного заряда
;;;874    void vz1_drv(void)
000778  e92d4ff8          PUSH     {r3-r11,lr}
;;;875    {
;;;876    if(volt_region_cnt)volt_region_cnt--;
00077c  f8df8120          LDR      r8,|L1.2208|
000780  f9b80076          LDRSH    r0,[r8,#0x76]  ; volt_region_cnt
000784  b118              CBZ      r0,|L1.1934|
000786  f1a00001          SUB      r0,r0,#1
00078a  f8a80076          STRH     r0,[r8,#0x76]
                  |L1.1934|
;;;877    if(vz1_stat==vz1sOFF)
00078e  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000792  b928              CBNZ     r0,|L1.1952|
;;;878    	{
;;;879    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000794  2314              MOVS     r3,#0x14
000796  2200              MOVS     r2,#0
000798  2164              MOVS     r1,#0x64
00079a  20d2              MOVS     r0,#0xd2
00079c  f7fffffe          BL       mess_send
                  |L1.1952|
;;;880    	}
;;;881    if(vz1_stat==vz1sSTEP1)
0007a0  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
;;;882    	{
;;;883    	if(vz1_stat_old!=vz1_stat)
;;;884    		{
;;;885    		vz1_stat_cnt=5;
;;;886    		}
;;;887    	if(vz1_stat_cnt)
;;;888    		{
;;;889    		vz1_stat_cnt--;
;;;890    		if(vz1_stat_cnt==0)
;;;891    			{
;;;892    			vz1_stat=vz1sERR1; 	//Не включилась вентиляция;
;;;893    			lc640_write(EE_VZ1_STAT,vz1sERR1);
;;;894    			}
;;;895    		}
;;;896    	if(sk_stat[0]==1)
0007a4  4d4b              LDR      r5,|L1.2260|
0007a6  f44f7bc9          MOV      r11,#0x192            ;893
0007aa  2801              CMP      r0,#1                 ;881
0007ac  d139              BNE      |L1.2082|
0007ae  f8980027          LDRB     r0,[r8,#0x27]         ;883  ; vz1_stat_old
0007b2  2801              CMP      r0,#1                 ;883
0007b4  d003              BEQ      |L1.1982|
0007b6  f04f0005          MOV      r0,#5                 ;885
0007ba  f8a80074          STRH     r0,[r8,#0x74]         ;885
                  |L1.1982|
0007be  f9b80074          LDRSH    r0,[r8,#0x74]         ;887  ; vz1_stat_cnt
0007c2  b168              CBZ      r0,|L1.2016|
0007c4  f1a00001          SUB      r0,r0,#1              ;889
0007c8  b200              SXTH     r0,r0                 ;889
0007ca  f8a80074          STRH     r0,[r8,#0x74]         ;889
0007ce  b938              CBNZ     r0,|L1.2016|
0007d0  f04f000b          MOV      r0,#0xb               ;892
0007d4  f8880026          STRB     r0,[r8,#0x26]         ;892
0007d8  4601              MOV      r1,r0                 ;893
0007da  4658              MOV      r0,r11                ;893
0007dc  f7fffffe          BL       lc640_write
                  |L1.2016|
0007e0  7828              LDRB     r0,[r5,#0]  ; sk_stat
0007e2  2801              CMP      r0,#1
0007e4  d117              BNE      |L1.2070|
;;;897    		{
;;;898    		vz1_stat=vz1sSTEP2;
0007e6  f04f0002          MOV      r0,#2
0007ea  f8880026          STRB     r0,[r8,#0x26]
;;;899    		lc640_write(EE_VZ1_STAT,vz1sSTEP2);
0007ee  4601              MOV      r1,r0
0007f0  4658              MOV      r0,r11
0007f2  f7fffffe          BL       lc640_write
;;;900    		tree_up(iVZ1_STEP2_2,1,0,0);
0007f6  2300              MOVS     r3,#0
0007f8  461a              MOV      r2,r3
0007fa  2101              MOVS     r1,#1
0007fc  20de              MOVS     r0,#0xde
0007fe  f7fffffe          BL       tree_up
;;;901    		tree_up(iVZ1_STEP2_1,0,0,0);
000802  2300              MOVS     r3,#0
000804  461a              MOV      r2,r3
000806  4619              MOV      r1,r3
000808  20dd              MOVS     r0,#0xdd
00080a  f7fffffe          BL       tree_up
;;;902    		ret(1200);
00080e  f44f6096          MOV      r0,#0x4b0
000812  f7fffffe          BL       ||ret||
                  |L1.2070|
;;;903    		}
;;;904    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000816  2314              MOVS     r3,#0x14
000818  2200              MOVS     r2,#0
00081a  2164              MOVS     r1,#0x64
00081c  20d2              MOVS     r0,#0xd2
00081e  f7fffffe          BL       mess_send
                  |L1.2082|
;;;905    	}
;;;906    
;;;907    if(vz1_stat==vz1sSTEP2)
000822  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
;;;908    	{
;;;909    	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;910    		{
;;;911    		vz1_stat_cnt=15;
000826  f04f090f          MOV      r9,#0xf
00082a  2802              CMP      r0,#2                 ;907
00082c  d118              BNE      |L1.2144|
00082e  f8980027          LDRB     r0,[r8,#0x27]         ;909  ; vz1_stat_old
000832  2802              CMP      r0,#2                 ;909
000834  d102              BNE      |L1.2108|
000836  f8b80074          LDRH     r0,[r8,#0x74]         ;909  ; vz1_stat_cnt
00083a  b908              CBNZ     r0,|L1.2112|
                  |L1.2108|
00083c  f8a89074          STRH     r9,[r8,#0x74]
                  |L1.2112|
;;;912    		}
;;;913    	vz1_stat_cnt--;
000840  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000844  f1a00001          SUB      r0,r0,#1
000848  f8a80074          STRH     r0,[r8,#0x74]
;;;914    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
00084c  f04f0314          MOV      r3,#0x14
000850  f04f0200          MOV      r2,#0
000854  f04f0164          MOV      r1,#0x64
000858  f04f00d2          MOV      r0,#0xd2
00085c  f7fffffe          BL       mess_send
                  |L1.2144|
;;;915    	}
;;;916    
;;;917    if(vz1_stat==vz1sSTEP3)
000860  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
;;;918    	{
;;;919    	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;920    		{
;;;921    		vz1_stat_cnt=10;
000864  240a              MOVS     r4,#0xa
000866  2600              MOVS     r6,#0                 ;876
000868  f04f0a01          MOV      r10,#1                ;877
;;;922    
;;;923    		}
;;;924    	vz1_stat_cnt--;
;;;925    	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
;;;926    		{
;;;927    		show_mess(	"     ВКЛЮЧИТЕ       ",
00086c  f2413788          MOV      r7,#0x1388
000870  2803              CMP      r0,#3                 ;917
000872  d171              BNE      |L1.2392|
000874  f8980027          LDRB     r0,[r8,#0x27]         ;919  ; vz1_stat_old
000878  2803              CMP      r0,#3                 ;919
00087a  d102              BNE      |L1.2178|
00087c  f8b80074          LDRH     r0,[r8,#0x74]         ;919  ; vz1_stat_cnt
000880  b908              CBNZ     r0,|L1.2182|
                  |L1.2178|
000882  f8a84074          STRH     r4,[r8,#0x74]         ;921
                  |L1.2182|
000886  f8b80074          LDRH     r0,[r8,#0x74]         ;924  ; vz1_stat_cnt
00088a  f1a00001          SUB      r0,r0,#1              ;924
00088e  b200              SXTH     r0,r0                 ;924
000890  f8a80074          STRH     r0,[r8,#0x74]         ;924
000894  280a              CMP      r0,#0xa               ;925
000896  d001              BEQ      |L1.2204|
000898  2809              CMP      r0,#9                 ;925
00089a  d164              BNE      |L1.2406|
                  |L1.2204|
00089c  a328              ADR      r3,|L1.2368|
00089e  e05c              B        |L1.2394|
                  |L1.2208|
                          DCD      ||area_number.25||
                  |L1.2212|
                          DCD      speedChrgBlckStat
                  |L1.2216|
                          DCD      Ib_ips_termokompensat
                  |L1.2220|
                          DCD      0xffff7360
                  |L1.2224|
                          DCD      0x40024000
                  |L1.2228|
                          DCD      AVZ
                  |L1.2232|
                          DCD      YEAR_AVZ
                  |L1.2236|
                          DCD      MONTH_AVZ
                  |L1.2240|
                          DCD      DATE_AVZ
                  |L1.2244|
                          DCD      HOUR_AVZ
                  |L1.2248|
                          DCD      MIN_AVZ
                  |L1.2252|
                          DCD      SEC_AVZ
                  |L1.2256|
                          DCD      AVZ_TIME
                  |L1.2260|
                          DCD      sk_stat
                  |L1.2264|
                          DCD      VZ_CH_VENT_BLOK
                  |L1.2268|
                          DCD      0x40024020
                  |L1.2272|
0008e0  20202020          DCB      "    ",194,197,205,210,200,203,223,214,200,223,"!!!   ",0
0008e4  c2c5cdd2
0008e8  c8cbdfd6
0008ec  c8df2121
0008f0  21202020
0008f4  00      
0008f5  00                DCB      0
0008f6  00                DCB      0
0008f7  00                DCB      0
                  |L1.2296|
0008f8  20202020          DCB      "     ",205,197,200,209,207,208,192,194,205,192,"     ",0
0008fc  20cdc5c8
000900  d1cfd0c0
000904  c2cdc020
000908  20202020
00090c  00      
00090d  00                DCB      0
00090e  00                DCB      0
00090f  00                DCB      0
                  |L1.2320|
000910  20202020          DCB      "    ",199,192,193,203,206,202,200,208,206,194,192,205," "
000914  c7c0c1cb
000918  cecac8d0
00091c  cec2c0cd
000920  20      
000921  20202000          DCB      "   ",0
000925  00                DCB      0
000926  00                DCB      0
000927  00                DCB      0
                  |L1.2344|
000928  c2dbd0c0          DCB      194,219,208,192,194,205,200,194,192,222,217,200,201," ",199
00092c  c2cdc8c2
000930  c0ded9c8
000934  c920c7  
000937  c0d0dfc4          DCB      192,208,223,196," ",0
00093b  2000    
00093d  00                DCB      0
00093e  00                DCB      0
00093f  00                DCB      0
                  |L1.2368|
000940  20202020          DCB      "    ",205,192,207,208,223,198,197,205,200,223,"      ",0
000944  cdc0cfd0
000948  dfc6c5cd
00094c  c8df2020
000950  20202020
000954  00      
000955  00                DCB      0
000956  00                DCB      0
000957  00                DCB      0
                  |L1.2392|
000958  e01c              B        |L1.2452|
                  |L1.2394|
00095a  a2f4              ADR      r2,|L1.3372|
00095c  a1f9              ADR      r1,|L1.3396|
00095e  a0ff              ADR      r0,|L1.3420|
000960  9700              STR      r7,[sp,#0]
000962  f7fffffe          BL       show_mess
                  |L1.2406|
;;;928    					"      ТУМБЛЕР       ",
;;;929    					"     ВЫСОКОГО       ",
;;;930    					"    НАПРЯЖЕНИЯ      ",
;;;931    					5000);
;;;932    		}
;;;933    	if(sk_stat[1]==1)
000966  7868              LDRB     r0,[r5,#1]  ; sk_stat
000968  2801              CMP      r0,#1
00096a  d10d              BNE      |L1.2440|
;;;934    		{
;;;935    		vz1_stat=vz1sWRK;
00096c  f8884026          STRB     r4,[r8,#0x26]
;;;936    		lc640_write(EE_VZ1_STAT,vz1sWRK);
000970  210a              MOVS     r1,#0xa
000972  4658              MOV      r0,r11
000974  f7fffffe          BL       lc640_write
;;;937    		volt_region=1;
000978  f888a028          STRB     r10,[r8,#0x28]
;;;938    		cntrl_stat=0;
00097c  f8a8602c          STRH     r6,[r8,#0x2c]
;;;939    		cntrl_stat_new=0;
000980  f8a86042          STRH     r6,[r8,#0x42]
;;;940    		cntrl_stat_old=0;
000984  f8a8602e          STRH     r6,[r8,#0x2e]
                  |L1.2440|
;;;941    		}
;;;942    	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000988  2314              MOVS     r3,#0x14
00098a  2200              MOVS     r2,#0
00098c  2164              MOVS     r1,#0x64
00098e  20d2              MOVS     r0,#0xd2
000990  f7fffffe          BL       mess_send
                  |L1.2452|
;;;943    	}
;;;944    
;;;945    if(vz1_stat==vz1sWRK)
000994  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000998  280a              CMP      r0,#0xa
00099a  d17d              BNE      |L1.2712|
;;;946    	{
;;;947    	if(vz1_stat_old!=vz1_stat)
00099c  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
;;;948    		{
;;;949    		vz1_wrk_cnt=3600L/*100L*/*((long)UZ_T);
0009a0  49f4              LDR      r1,|L1.3444|
0009a2  280a              CMP      r0,#0xa               ;947
0009a4  d008              BEQ      |L1.2488|
0009a6  48f4              LDR      r0,|L1.3448|
0009a8  f44f6261          MOV      r2,#0xe10
0009ac  f9b00000          LDRSH    r0,[r0,#0]  ; UZ_T
0009b0  fb00f002          MUL      r0,r0,r2
0009b4  6388              STR      r0,[r1,#0x38]  ; vz1_wrk_cnt
;;;950    		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;951    		vz1_up_cnt=0L;
0009b6  63ce              STR      r6,[r1,#0x3c]  ; vz1_up_cnt
                  |L1.2488|
;;;952    
;;;953    		}
;;;954    	vz1_wrk_cnt--;
0009b8  6b88              LDR      r0,[r1,#0x38]  ; vz1_wrk_cnt
0009ba  f1a00001          SUB      r0,r0,#1
0009be  6388              STR      r0,[r1,#0x38]  ; vz1_wrk_cnt
;;;955    	vz1_up_cnt++;
0009c0  6bca              LDR      r2,[r1,#0x3c]  ; vz1_up_cnt
0009c2  f1020201          ADD      r2,r2,#1
0009c6  63ca              STR      r2,[r1,#0x3c]  ; vz1_up_cnt
;;;956    
;;;957    	if(vz1_wrk_cnt==0)
0009c8  b940              CBNZ     r0,|L1.2524|
;;;958    		{
;;;959    		vz1_stat=vz1sFINE;
0009ca  f8889026          STRB     r9,[r8,#0x26]
;;;960    		lc640_write(EE_VZ1_STAT,vz1sFINE);
0009ce  210f              MOVS     r1,#0xf
0009d0  4658              MOV      r0,r11
0009d2  f7fffffe          BL       lc640_write
;;;961    		uz_mem_hndl(0);
0009d6  2000              MOVS     r0,#0
0009d8  f7fffffe          BL       uz_mem_hndl
                  |L1.2524|
;;;962    		}
;;;963    	if(sk_stat[0]==0)
0009dc  7828              LDRB     r0,[r5,#0]  ; sk_stat
0009de  b938              CBNZ     r0,|L1.2544|
;;;964    		{
;;;965    		vz1_stat=vz1sERR2;
0009e0  f04f000c          MOV      r0,#0xc
0009e4  f8880026          STRB     r0,[r8,#0x26]
;;;966    		lc640_write(EE_VZ1_STAT,vz1sERR2);
0009e8  4601              MOV      r1,r0
0009ea  4658              MOV      r0,r11
0009ec  f7fffffe          BL       lc640_write
                  |L1.2544|
;;;967    		}
;;;968    	if(sk_stat[1]==0)
0009f0  7868              LDRB     r0,[r5,#1]  ; sk_stat
0009f2  b938              CBNZ     r0,|L1.2564|
;;;969    		{
;;;970    		vz1_stat=vz1sERR3;
0009f4  f04f000d          MOV      r0,#0xd
0009f8  f8880026          STRB     r0,[r8,#0x26]
;;;971    		lc640_write(EE_VZ1_STAT,vz1sERR3);
0009fc  4601              MOV      r1,r0
0009fe  4658              MOV      r0,r11
000a00  f7fffffe          BL       lc640_write
                  |L1.2564|
;;;972    		}
;;;973    	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
000a04  f9b80044          LDRSH    r0,[r8,#0x44]  ; Ibmax
000a08  f8b81046          LDRH     r1,[r8,#0x46]  ; IZMAX_
000a0c  fb90f0f4          SDIV     r0,r0,r4
;;;974    		{
;;;975    		volt_region=0;
;;;976    		cntrl_stat=1000;
000a10  f44f727a          MOV      r2,#0x3e8
000a14  4288              CMP      r0,r1                 ;973
000a16  dd16              BLE      |L1.2630|
000a18  f9b8302c          LDRSH    r3,[r8,#0x2c]         ;973  ; cntrl_stat
000a1c  2b14              CMP      r3,#0x14              ;973
000a1e  dc12              BGT      |L1.2630|
000a20  f8983028          LDRB     r3,[r8,#0x28]         ;973  ; volt_region
000a24  2b01              CMP      r3,#1                 ;973
000a26  d10e              BNE      |L1.2630|
000a28  f8b83076          LDRH     r3,[r8,#0x76]         ;973  ; volt_region_cnt
000a2c  b95b              CBNZ     r3,|L1.2630|
000a2e  f8886028          STRB     r6,[r8,#0x28]         ;975
000a32  f8a8202c          STRH     r2,[r8,#0x2c]
;;;977    		cntrl_stat_new=1000;
000a36  f8a82042          STRH     r2,[r8,#0x42]
;;;978    		cntrl_stat_old=1000;
000a3a  f8a8202e          STRH     r2,[r8,#0x2e]
;;;979    		volt_region_cnt=110;
000a3e  f04f036e          MOV      r3,#0x6e
000a42  f8a83076          STRH     r3,[r8,#0x76]
                  |L1.2630|
;;;980    		}
;;;981    	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
000a46  4288              CMP      r0,r1
000a48  da13              BGE      |L1.2674|
000a4a  f9b8002c          LDRSH    r0,[r8,#0x2c]  ; cntrl_stat
000a4e  4290              CMP      r0,r2
000a50  db0f              BLT      |L1.2674|
000a52  f8980028          LDRB     r0,[r8,#0x28]  ; volt_region
000a56  b960              CBNZ     r0,|L1.2674|
000a58  f8b80076          LDRH     r0,[r8,#0x76]  ; volt_region_cnt
000a5c  b948              CBNZ     r0,|L1.2674|
;;;982    		{
;;;983    		volt_region=1;
000a5e  f888a028          STRB     r10,[r8,#0x28]
;;;984    		cntrl_stat=10;
000a62  f8a8402c          STRH     r4,[r8,#0x2c]
;;;985    		cntrl_stat_new=10;
000a66  f8a84042          STRH     r4,[r8,#0x42]
;;;986    		cntrl_stat_old=10;
000a6a  f8a8402e          STRH     r4,[r8,#0x2e]
;;;987    		volt_region_cnt=10;
000a6e  f8a84076          STRH     r4,[r8,#0x76]
                  |L1.2674|
;;;988    		}
;;;989    	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000a72  f8980028          LDRB     r0,[r8,#0x28]  ; volt_region
000a76  b110              CBZ      r0,|L1.2686|
;;;990    	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
000a78  2801              CMP      r0,#1
000a7a  d007              BEQ      |L1.2700|
000a7c  e00c              B        |L1.2712|
                  |L1.2686|
000a7e  2314              MOVS     r3,#0x14              ;989
000a80  2200              MOVS     r2,#0                 ;989
000a82  2164              MOVS     r1,#0x64              ;989
000a84  20d2              MOVS     r0,#0xd2              ;989
000a86  f7fffffe          BL       mess_send
000a8a  e005              B        |L1.2712|
                  |L1.2700|
000a8c  2314              MOVS     r3,#0x14
000a8e  2201              MOVS     r2,#1
000a90  2164              MOVS     r1,#0x64
000a92  20d2              MOVS     r0,#0xd2
000a94  f7fffffe          BL       mess_send
                  |L1.2712|
;;;991    	}
;;;992    
;;;993    if(vz1_stat==vz1sERR1)		//Отсутствует вентиляция при включении
000a98  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000a9c  280b              CMP      r0,#0xb
000a9e  d120              BNE      |L1.2786|
;;;994    	{
;;;995    	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
000aa0  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
000aa4  280b              CMP      r0,#0xb
000aa6  d102              BNE      |L1.2734|
000aa8  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000aac  b908              CBNZ     r0,|L1.2738|
                  |L1.2734|
;;;996    		{
;;;997    		vz1_stat_cnt=10;
000aae  f8a84074          STRH     r4,[r8,#0x74]
                  |L1.2738|
;;;998    		}
;;;999    	vz1_stat_cnt--;
000ab2  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000ab6  f1a00001          SUB      r0,r0,#1
000aba  b200              SXTH     r0,r0
000abc  f8a80074          STRH     r0,[r8,#0x74]
;;;1000   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
000ac0  280a              CMP      r0,#0xa
000ac2  d001              BEQ      |L1.2760|
000ac4  2809              CMP      r0,#9
000ac6  d106              BNE      |L1.2774|
                  |L1.2760|
;;;1001   		{
;;;1002   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
000ac8  a3ac              ADR      r3,|L1.3452|
000aca  a2b2              ADR      r2,|L1.3476|
000acc  a1b7              ADR      r1,|L1.3500|
000ace  a0bd              ADR      r0,|L1.3524|
000ad0  9700              STR      r7,[sp,#0]
000ad2  f7fffffe          BL       show_mess
                  |L1.2774|
;;;1003   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;1004   					"      ВКЛЮЧЕН       ",
;;;1005   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;1006   					5000);
;;;1007   		}
;;;1008   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000ad6  2314              MOVS     r3,#0x14
000ad8  2200              MOVS     r2,#0
000ada  2164              MOVS     r1,#0x64
000adc  20d2              MOVS     r0,#0xd2
000ade  f7fffffe          BL       mess_send
                  |L1.2786|
;;;1009   	}
;;;1010   if(vz1_stat==vz1sERR2)		//Пропала вентиляция при работе
000ae2  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000ae6  280c              CMP      r0,#0xc
000ae8  d12c              BNE      |L1.2884|
;;;1011   	{
;;;1012   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
000aea  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
000aee  280c              CMP      r0,#0xc
000af0  d102              BNE      |L1.2808|
000af2  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000af6  b908              CBNZ     r0,|L1.2812|
                  |L1.2808|
;;;1013   		{
;;;1014   		vz1_stat_cnt=10;
000af8  f8a84074          STRH     r4,[r8,#0x74]
                  |L1.2812|
;;;1015   		}
;;;1016   	vz1_stat_cnt--;
000afc  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000b00  f1a00001          SUB      r0,r0,#1
000b04  b200              SXTH     r0,r0
000b06  f8a80074          STRH     r0,[r8,#0x74]
;;;1017   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
000b0a  280a              CMP      r0,#0xa
000b0c  d001              BEQ      |L1.2834|
000b0e  2809              CMP      r0,#9
000b10  d109              BNE      |L1.2854|
                  |L1.2834|
;;;1018   		{
;;;1019   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
000b12  f2af2334          ADR      r3,|L1.2272|
000b16  f2af2220          ADR      r2,|L1.2296|
000b1a  f2af210c          ADR      r1,|L1.2320|
000b1e  a0a9              ADR      r0,|L1.3524|
000b20  9700              STR      r7,[sp,#0]
000b22  f7fffffe          BL       show_mess
                  |L1.2854|
;;;1020   					"    ЗАБЛОКИРОВАН    ",
;;;1021   					"     НЕИСПРАВНА     ",
;;;1022   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;1023   					5000);
;;;1024   		}
;;;1025   	if(sk_stat[0]==1)
000b26  7828              LDRB     r0,[r5,#0]  ; sk_stat
000b28  2801              CMP      r0,#1
000b2a  d105              BNE      |L1.2872|
;;;1026   		{
;;;1027   		vz1_stat=vz1sWRK;
000b2c  f8884026          STRB     r4,[r8,#0x26]
;;;1028   		lc640_write(EE_VZ1_STAT,vz1sWRK);
000b30  210a              MOVS     r1,#0xa
000b32  4658              MOV      r0,r11
000b34  f7fffffe          BL       lc640_write
                  |L1.2872|
;;;1029   		}
;;;1030   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000b38  2314              MOVS     r3,#0x14
000b3a  2200              MOVS     r2,#0
000b3c  2164              MOVS     r1,#0x64
000b3e  20d2              MOVS     r0,#0xd2
000b40  f7fffffe          BL       mess_send
                  |L1.2884|
;;;1031   	}
;;;1032   
;;;1033   if(vz1_stat==vz1sERR3)		//Отключен тумблер "Высокое напряжение"
000b44  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000b48  280d              CMP      r0,#0xd
000b4a  d129              BNE      |L1.2976|
;;;1034   	{
;;;1035   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
000b4c  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
000b50  280d              CMP      r0,#0xd
000b52  d102              BNE      |L1.2906|
000b54  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000b58  b908              CBNZ     r0,|L1.2910|
                  |L1.2906|
;;;1036   		{
;;;1037   		vz1_stat_cnt=10;
000b5a  f8a84074          STRH     r4,[r8,#0x74]
                  |L1.2910|
;;;1038   		}
;;;1039   	vz1_stat_cnt--;
000b5e  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000b62  f1a00001          SUB      r0,r0,#1
000b66  b200              SXTH     r0,r0
000b68  f8a80074          STRH     r0,[r8,#0x74]
;;;1040   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
000b6c  280a              CMP      r0,#0xa
000b6e  d001              BEQ      |L1.2932|
000b70  2809              CMP      r0,#9
000b72  d106              BNE      |L1.2946|
                  |L1.2932|
;;;1041   		{
;;;1042   		show_mess(	"УРАВНИТЕЛЬНЫЙ ЗАРЯД ",
000b74  a399              ADR      r3,|L1.3548|
000b76  a29f              ADR      r2,|L1.3572|
000b78  a1a4              ADR      r1,|L1.3596|
000b7a  a092              ADR      r0,|L1.3524|
000b7c  9700              STR      r7,[sp,#0]
000b7e  f7fffffe          BL       show_mess
                  |L1.2946|
;;;1043   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;1044   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;1045   					"*   ТУМБЛЕРА!!!     ",
;;;1046   					5000);
;;;1047   		}
;;;1048   	if(sk_stat[1]==1)
000b82  7868              LDRB     r0,[r5,#1]  ; sk_stat
000b84  2801              CMP      r0,#1
000b86  d105              BNE      |L1.2964|
;;;1049   		{
;;;1050   		vz1_stat=vz1sWRK;
000b88  f8884026          STRB     r4,[r8,#0x26]
;;;1051   		lc640_write(EE_VZ1_STAT,vz1sWRK);
000b8c  210a              MOVS     r1,#0xa
000b8e  4658              MOV      r0,r11
000b90  f7fffffe          BL       lc640_write
                  |L1.2964|
;;;1052   		}
;;;1053   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000b94  2314              MOVS     r3,#0x14
000b96  2200              MOVS     r2,#0
000b98  2164              MOVS     r1,#0x64
000b9a  20d2              MOVS     r0,#0xd2
000b9c  f7fffffe          BL       mess_send
                  |L1.2976|
;;;1054   	}
;;;1055   if(vz1_stat==vz1sERR4)		//ВЗ закончился а тумблер включен
000ba0  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000ba4  280e              CMP      r0,#0xe
000ba6  d12b              BNE      |L1.3072|
;;;1056   	{
;;;1057   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
000ba8  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
000bac  280e              CMP      r0,#0xe
000bae  d102              BNE      |L1.2998|
000bb0  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000bb4  b908              CBNZ     r0,|L1.3002|
                  |L1.2998|
;;;1058   		{
;;;1059   		vz1_stat_cnt=10;
000bb6  f8a84074          STRH     r4,[r8,#0x74]
                  |L1.3002|
;;;1060   		}
;;;1061   	vz1_stat_cnt--;
000bba  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000bbe  f1a00001          SUB      r0,r0,#1
000bc2  b200              SXTH     r0,r0
000bc4  f8a80074          STRH     r0,[r8,#0x74]
;;;1062   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
000bc8  280a              CMP      r0,#0xa
000bca  d001              BEQ      |L1.3024|
000bcc  2809              CMP      r0,#9
000bce  d107              BNE      |L1.3040|
                  |L1.3024|
;;;1063   		{
;;;1064   		show_mess(	"*    ВЫКЛЮЧИТЕ      ",
000bd0  f2af2394          ADR      r3,|L1.2368|
000bd4  a255              ADR      r2,|L1.3372|
000bd6  a15b              ADR      r1,|L1.3396|
000bd8  a092              ADR      r0,|L1.3620|
000bda  9700              STR      r7,[sp,#0]
000bdc  f7fffffe          BL       show_mess
                  |L1.3040|
;;;1065   					"      ТУМБЛЕР       ",
;;;1066   					"     ВЫСОКОГО       ",
;;;1067   					"    НАПРЯЖЕНИЯ      ",
;;;1068   					5000);
;;;1069   		}
;;;1070   	if(sk_stat[1]==0)
000be0  7868              LDRB     r0,[r5,#1]  ; sk_stat
000be2  b938              CBNZ     r0,|L1.3060|
;;;1071   		{
;;;1072   		vz1_stat=vz1sOFF;
000be4  f8886026          STRB     r6,[r8,#0x26]
;;;1073   		lc640_write(EE_VZ1_STAT,vz1sOFF);
000be8  2100              MOVS     r1,#0
000bea  4658              MOV      r0,r11
000bec  f7fffffe          BL       lc640_write
;;;1074   		vz_stop();
000bf0  f7fffffe          BL       vz_stop
                  |L1.3060|
;;;1075   
;;;1076   		}
;;;1077   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
000bf4  2314              MOVS     r3,#0x14
000bf6  2201              MOVS     r2,#1
000bf8  2164              MOVS     r1,#0x64
000bfa  20d2              MOVS     r0,#0xd2
000bfc  f7fffffe          BL       mess_send
                  |L1.3072|
;;;1078   	}
;;;1079   if(vz1_stat==vz1sFINE)		//УЗ закончился, напоминание
000c00  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
;;;1080   	{
;;;1081   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
;;;1082   		{
;;;1083   		vz1_stat_cnt=10;
;;;1084   		}
;;;1085   	vz1_stat_cnt--;
;;;1086   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
;;;1087   		{
;;;1088   		show_mess(	"   УРАВНИТЕЛЬНЫЙ    ",
000c04  f64037b8          MOV      r7,#0xbb8
000c08  280f              CMP      r0,#0xf               ;1079
000c0a  d136              BNE      |L1.3194|
000c0c  f8980027          LDRB     r0,[r8,#0x27]         ;1081  ; vz1_stat_old
000c10  280f              CMP      r0,#0xf               ;1081
000c12  d102              BNE      |L1.3098|
000c14  f8b80074          LDRH     r0,[r8,#0x74]         ;1081  ; vz1_stat_cnt
000c18  b908              CBNZ     r0,|L1.3102|
                  |L1.3098|
000c1a  f8a84074          STRH     r4,[r8,#0x74]         ;1083
                  |L1.3102|
000c1e  f8b80074          LDRH     r0,[r8,#0x74]         ;1085  ; vz1_stat_cnt
000c22  f1a00001          SUB      r0,r0,#1              ;1085
000c26  b200              SXTH     r0,r0                 ;1085
000c28  f8a80074          STRH     r0,[r8,#0x74]         ;1085
000c2c  280a              CMP      r0,#0xa               ;1086
000c2e  d001              BEQ      |L1.3124|
000c30  2809              CMP      r0,#9                 ;1086
000c32  d106              BNE      |L1.3138|
                  |L1.3124|
000c34  a381              ADR      r3,|L1.3644|
000c36  a287              ADR      r2,|L1.3668|
000c38  a18c              ADR      r1,|L1.3692|
000c3a  a092              ADR      r0,|L1.3716|
000c3c  9700              STR      r7,[sp,#0]
000c3e  f7fffffe          BL       show_mess
                  |L1.3138|
;;;1089   					"       ЗАРЯД        ",
;;;1090   					"      УСПЕШНО       ",
;;;1091   					"     ЗАВЕРШЕН       ",
;;;1092   					3000);
;;;1093   		}
;;;1094   	if((vz1_stat_cnt==6)||(vz1_stat_cnt==5))
000c42  f9b80074          LDRSH    r0,[r8,#0x74]  ; vz1_stat_cnt
000c46  2806              CMP      r0,#6
000c48  d001              BEQ      |L1.3150|
000c4a  2805              CMP      r0,#5
000c4c  d107              BNE      |L1.3166|
                  |L1.3150|
;;;1095   		{
;;;1096   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
000c4e  f2af3310          ADR      r3,|L1.2368|
000c52  a236              ADR      r2,|L1.3372|
000c54  a13b              ADR      r1,|L1.3396|
000c56  a091              ADR      r0,|L1.3740|
000c58  9700              STR      r7,[sp,#0]
000c5a  f7fffffe          BL       show_mess
                  |L1.3166|
;;;1097   					"      ТУМБЛЕР       ",
;;;1098   					"     ВЫСОКОГО       ",
;;;1099   					"    НАПРЯЖЕНИЯ      ",
;;;1100   					3000);
;;;1101   		}
;;;1102   	if(sk_stat[1]==0)
000c5e  7868              LDRB     r0,[r5,#1]  ; sk_stat
000c60  b928              CBNZ     r0,|L1.3182|
;;;1103   		{
;;;1104   		vz1_stat=vz1sOFF;
000c62  f8886026          STRB     r6,[r8,#0x26]
;;;1105   		lc640_write(EE_VZ1_STAT,vz1sOFF);
000c66  2100              MOVS     r1,#0
000c68  4658              MOV      r0,r11
000c6a  f7fffffe          BL       lc640_write
                  |L1.3182|
;;;1106   		}
;;;1107   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000c6e  2314              MOVS     r3,#0x14
000c70  2200              MOVS     r2,#0
000c72  2164              MOVS     r1,#0x64
000c74  20d2              MOVS     r0,#0xd2
000c76  f7fffffe          BL       mess_send
                  |L1.3194|
;;;1108   	}
;;;1109   
;;;1110   if(vz1_stat==vz1sSTOP)		//УЗ прекращен, напоминание
000c7a  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000c7e  2810              CMP      r0,#0x10
000c80  d136              BNE      |L1.3312|
;;;1111   	{
;;;1112   	if((vz1_stat_old!=vz1_stat)||(vz1_stat_cnt==0))
000c82  f8980027          LDRB     r0,[r8,#0x27]  ; vz1_stat_old
000c86  2810              CMP      r0,#0x10
000c88  d102              BNE      |L1.3216|
000c8a  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000c8e  b908              CBNZ     r0,|L1.3220|
                  |L1.3216|
;;;1113   		{
;;;1114   		vz1_stat_cnt=10;
000c90  f8a84074          STRH     r4,[r8,#0x74]
                  |L1.3220|
;;;1115   		}
;;;1116   	vz1_stat_cnt--;
000c94  f8b80074          LDRH     r0,[r8,#0x74]  ; vz1_stat_cnt
000c98  f1a00001          SUB      r0,r0,#1
000c9c  b200              SXTH     r0,r0
000c9e  f8a80074          STRH     r0,[r8,#0x74]
;;;1117   	if((vz1_stat_cnt==10)||(vz1_stat_cnt==9))
000ca2  280a              CMP      r0,#0xa
000ca4  d001              BEQ      |L1.3242|
000ca6  2809              CMP      r0,#9
000ca8  d106              BNE      |L1.3256|
                  |L1.3242|
;;;1118   		{
;;;1119   		show_mess(	"   УРАВНИТЕЛЬНЫЙ    ",
000caa  a382              ADR      r3,|L1.3764|
000cac  a287              ADR      r2,|L1.3788|
000cae  a16f              ADR      r1,|L1.3692|
000cb0  a074              ADR      r0,|L1.3716|
000cb2  9700              STR      r7,[sp,#0]
000cb4  f7fffffe          BL       show_mess
                  |L1.3256|
;;;1120   					"       ЗАРЯД        ",
;;;1121   					"     ПРЕКРАЩЕН      ",
;;;1122   					"                    ",
;;;1123   					3000);
;;;1124   		}
;;;1125   	if((vz1_stat_cnt==6)||(vz1_stat_cnt==5))
000cb8  f9b80074          LDRSH    r0,[r8,#0x74]  ; vz1_stat_cnt
000cbc  2806              CMP      r0,#6
000cbe  d001              BEQ      |L1.3268|
000cc0  2805              CMP      r0,#5
000cc2  d107              BNE      |L1.3284|
                  |L1.3268|
;;;1126   		{
;;;1127   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
000cc4  f2af3388          ADR      r3,|L1.2368|
000cc8  a218              ADR      r2,|L1.3372|
000cca  a11e              ADR      r1,|L1.3396|
000ccc  a073              ADR      r0,|L1.3740|
000cce  9700              STR      r7,[sp,#0]
000cd0  f7fffffe          BL       show_mess
                  |L1.3284|
;;;1128   					"      ТУМБЛЕР       ",
;;;1129   					"     ВЫСОКОГО       ",
;;;1130   					"    НАПРЯЖЕНИЯ      ",
;;;1131   					3000);
;;;1132   		}
;;;1133   	if(sk_stat[1]==0)
000cd4  7868              LDRB     r0,[r5,#1]  ; sk_stat
000cd6  b928              CBNZ     r0,|L1.3300|
;;;1134   		{
;;;1135   		vz1_stat=vz1sOFF;
000cd8  f8886026          STRB     r6,[r8,#0x26]
;;;1136   		lc640_write(EE_VZ1_STAT,vz1sOFF);
000cdc  2100              MOVS     r1,#0
000cde  4658              MOV      r0,r11
000ce0  f7fffffe          BL       lc640_write
                  |L1.3300|
;;;1137   		}
;;;1138   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000ce4  2314              MOVS     r3,#0x14
000ce6  2200              MOVS     r2,#0
000ce8  2164              MOVS     r1,#0x64
000cea  20d2              MOVS     r0,#0xd2
000cec  f7fffffe          BL       mess_send
                  |L1.3312|
;;;1139   	}
;;;1140   
;;;1141   vz1_stat_old=vz1_stat;
000cf0  f8980026          LDRB     r0,[r8,#0x26]  ; vz1_stat
000cf4  f8880027          STRB     r0,[r8,#0x27]
;;;1142   
;;;1143   
;;;1144   
;;;1145   }
000cf8  e8bd8ff8          POP      {r3-r11,pc}
;;;1146   
                          ENDP

                  vz1_start PROC
;;;1148   //старт уравнительног заряда
;;;1149   char vz1_start(char hour)
000cfc  b510              PUSH     {r4,lr}
;;;1150   {          
;;;1151   char out;
;;;1152   out=0;
000cfe  f04f0000          MOV      r0,#0
;;;1153   if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1)&&(vz1_stat==vz1sOFF))
000d02  491c              LDR      r1,|L1.3444|
000d04  f1a10180          SUB      r1,r1,#0x80
000d08  7e8a              LDRB     r2,[r1,#0x1a]  ; spc_stat
000d0a  2a00              CMP      r2,#0
000d0c  d10d              BNE      |L1.3370|
000d0e  4a75              LDR      r2,|L1.3812|
000d10  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
000d12  2a01              CMP      r2,#1
000d14  d009              BEQ      |L1.3370|
000d16  f8912026          LDRB     r2,[r1,#0x26]  ; vz1_stat
000d1a  2a00              CMP      r2,#0
000d1c  d105              BNE      |L1.3370|
;;;1154   	{
;;;1155   	if(vz1_stat==vz1sOFF)
;;;1156   		{
;;;1157   		vz1_stat=vz1sSTEP1;
000d1e  f04f0001          MOV      r0,#1
000d22  f8810026          STRB     r0,[r1,#0x26]
;;;1158   		lc640_write(EE_VZ1_STAT,vz1sSTEP1);
000d26  4601              MOV      r1,r0
000d28  e0de              B        |L1.3816|
                  |L1.3370|
000d2a  e0e3              B        |L1.3828|
                  |L1.3372|
000d2c  20202020          DCB      "     ",194,219,209,206,202,206,195,206,"       ",0
000d30  20c2dbd1
000d34  cecacec3
000d38  ce202020
000d3c  20202020
000d40  00      
000d41  00                DCB      0
000d42  00                DCB      0
000d43  00                DCB      0
                  |L1.3396|
000d44  20202020          DCB      "      ",210,211,204,193,203,197,208,"       ",0
000d48  2020d2d3
000d4c  ccc1cbc5
000d50  d0202020
000d54  20202020
000d58  00      
000d59  00                DCB      0
000d5a  00                DCB      0
000d5b  00                DCB      0
                  |L1.3420|
000d5c  20202020          DCB      "     ",194,202,203,222,215,200,210,197,"       ",0
000d60  20c2cacb
000d64  ded7c8d2
000d68  c5202020
000d6c  20202020
000d70  00      
000d71  00                DCB      0
000d72  00                DCB      0
000d73  00                DCB      0
                  |L1.3444|
                          DCD      ||area_number.25||+0x80
                  |L1.3448|
                          DCD      UZ_T
                  |L1.3452|
000d7c  2020c1c5          DCB      "  ",193,197,199," ",194,197,205,210,200,203,223,214,200
000d80  c720c2c5
000d84  cdd2c8cb
000d88  dfd6c8  
000d8b  c8212120          DCB      200,"!!  ",0
000d8f  2000    
000d91  00                DCB      0
000d92  00                DCB      0
000d93  00                DCB      0
                  |L1.3476|
000d94  20202020          DCB      "      ",194,202,203,222,215,197,205,"       ",0
000d98  2020c2ca
000d9c  cbded7c5
000da0  cd202020
000da4  20202020
000da8  00      
000da9  00                DCB      0
000daa  00                DCB      0
000dab  00                DCB      0
                  |L1.3500|
000dac  202020cd          DCB      "   ",205,197," ",204,206,198,197,210," ",193,219,210,220
000db0  c520ccce
000db4  c6c5d220
000db8  c1dbd2dc
000dbc  20202020          DCB      "    ",0
000dc0  00      
000dc1  00                DCB      0
000dc2  00                DCB      0
000dc3  00                DCB      0
                  |L1.3524|
000dc4  d3d0c0c2          DCB      211,208,192,194,205,200,210,197,203,220,205,219,201," ",199
000dc8  cdc8d2c5
000dcc  cbdccddb
000dd0  c920c7  
000dd3  c0d0dfc4          DCB      192,208,223,196," ",0
000dd7  2000    
000dd9  00                DCB      0
000dda  00                DCB      0
000ddb  00                DCB      0
                  |L1.3548|
000ddc  2a202020          DCB      "*   ",210,211,204,193,203,197,208,192,"!!!     ",0
000de0  d2d3ccc1
000de4  cbc5d0c0
000de8  21212120
000dec  20202020
000df0  00      
000df1  00                DCB      0
000df2  00                DCB      0
000df3  00                DCB      0
                  |L1.3572|
000df4  2020cfce          DCB      "  ",207,206,209,203,197," ",194,202,203,222,215,197,205
000df8  d1cbc520
000dfc  c2cacbde
000e00  d7c5cd  
000e03  c8df2020          DCB      200,223,"   ",0
000e07  2000    
000e09  00                DCB      0
000e0a  00                DCB      0
000e0b  00                DCB      0
                  |L1.3596|
000e0c  2020c1d3          DCB      "  ",193,211,196,197,210," ",207,208,206,196,206,203,198
000e10  c4c5d220
000e14  cfd0cec4
000e18  cecbc6  
000e1b  c5cd2020          DCB      197,205,"   ",0
000e1f  2000    
000e21  00                DCB      0
000e22  00                DCB      0
000e23  00                DCB      0
                  |L1.3620|
000e24  2a202020          DCB      "*    ",194,219,202,203,222,215,200,210,197,"      ",0
000e28  20c2dbca
000e2c  cbded7c8
000e30  d2c52020
000e34  20202020
000e38  00      
000e39  00                DCB      0
000e3a  00                DCB      0
000e3b  00                DCB      0
                  |L1.3644|
000e3c  20202020          DCB      "     ",199,192,194,197,208,216,197,205,"       ",0
000e40  20c7c0c2
000e44  c5d0d8c5
000e48  cd202020
000e4c  20202020
000e50  00      
000e51  00                DCB      0
000e52  00                DCB      0
000e53  00                DCB      0
                  |L1.3668|
000e54  20202020          DCB      "      ",211,209,207,197,216,205,206,"       ",0
000e58  2020d3d1
000e5c  cfc5d8cd
000e60  ce202020
000e64  20202020
000e68  00      
000e69  00                DCB      0
000e6a  00                DCB      0
000e6b  00                DCB      0
                  |L1.3692|
000e6c  20202020          DCB      "       ",199,192,208,223,196,"        ",0
000e70  202020c7
000e74  c0d0dfc4
000e78  20202020
000e7c  20202020
000e80  00      
000e81  00                DCB      0
000e82  00                DCB      0
000e83  00                DCB      0
                  |L1.3716|
000e84  202020d3          DCB      "   ",211,208,192,194,205,200,210,197,203,220,205,219,201
000e88  d0c0c2cd
000e8c  c8d2c5cb
000e90  dccddbc9
000e94  20202020          DCB      "    ",0
000e98  00      
000e99  00                DCB      0
000e9a  00                DCB      0
000e9b  00                DCB      0
                  |L1.3740|
000e9c  20202020          DCB      "     ",194,219,202,203,222,215,200,210,197,"      ",0
000ea0  20c2dbca
000ea4  cbded7c8
000ea8  d2c52020
000eac  20202020
000eb0  00      
000eb1  00                DCB      0
000eb2  00                DCB      0
000eb3  00                DCB      0
                  |L1.3764|
000eb4  20202020          DCB      "                    ",0
000eb8  20202020
000ebc  20202020
000ec0  20202020
000ec4  20202020
000ec8  00      
000ec9  00                DCB      0
000eca  00                DCB      0
000ecb  00                DCB      0
                  |L1.3788|
000ecc  20202020          DCB      "     ",207,208,197,202,208,192,217,197,205,"      ",0
000ed0  20cfd0c5
000ed4  cad0c0d9
000ed8  c5cd2020
000edc  20202020
000ee0  00      
000ee1  00                DCB      0
000ee2  00                DCB      0
000ee3  00                DCB      0
                  |L1.3812|
                          DCD      speedChrgBlckStat
                  |L1.3816|
000ee8  f44f70c9          MOV      r0,#0x192
000eec  f7fffffe          BL       lc640_write
;;;1159   		out=1;
000ef0  f04f0001          MOV      r0,#1
                  |L1.3828|
;;;1160   		
;;;1161   		}
;;;1162   /*	spc_stat=spcVZ;
;;;1163   	__ee_spc_stat=spcVZ; 
;;;1164   	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
;;;1165   	vz_cnt_h=hour;
;;;1166   	__ee_vz_cnt=hour*60;
;;;1167   	if(hour==0)__ee_vz_cnt=30;
;;;1168   	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;1169   	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
;;;1170   	vz_cnt_h_=0;
;;;1171   	vz_cnt_s=0;
;;;1172   	vz_cnt_s_=0;
;;;1173   	
;;;1174   		*/
;;;1175   	}
;;;1176   //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;1177   //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;1178   //plazma=out;	
;;;1179   return out;
;;;1180   }
000ef4  bd10              POP      {r4,pc}
;;;1181   
                          ENDP

                  vz1_stop PROC
;;;1183   //стоп уравнительног заряда
;;;1184   void vz1_stop(void)
000ef6  48fb              LDR      r0,|L1.4836|
;;;1185   {
;;;1186   if(vz1_stat!=vz1sOFF)
000ef8  f8901026          LDRB     r1,[r0,#0x26]  ; vz1_stat
000efc  2900              CMP      r1,#0
000efe  d007              BEQ      |L1.3856|
;;;1187   	{
;;;1188   	vz1_stat=vz1sSTOP;
000f00  f04f0110          MOV      r1,#0x10
000f04  f8801026          STRB     r1,[r0,#0x26]
;;;1189   	lc640_write(EE_VZ1_STAT,vz1sSTOP);
000f08  f44f70c9          MOV      r0,#0x192
000f0c  f7ffbffe          B.W      lc640_write
                  |L1.3856|
;;;1190   	}
;;;1191   }
000f10  4770              BX       lr
;;;1192   
                          ENDP

                  vz2_drv PROC
;;;1194   //драйвер формовочного заряда
;;;1195   void vz2_drv(void)
000f12  e92d4ff8          PUSH     {r3-r11,lr}
;;;1196   {
;;;1197   
;;;1198   if(vz2_stat==vz2sSTEP1)
000f16  4ef3              LDR      r6,|L1.4836|
;;;1199   	{
;;;1200   	if(vz2_stat_old!=vz2_stat)
;;;1201   		{
;;;1202   		vz2_stat_cnt=5;
;;;1203   		}
;;;1204   	if(vz2_stat_cnt)
;;;1205   		{
;;;1206   		vz2_stat_cnt--;
;;;1207   		if(vz2_stat_cnt==0)
;;;1208   			{
;;;1209   			vz2_stat=vz2sERR1; 	//Не включилась вентиляция;
;;;1210   			lc640_write(EE_VZ2_STAT,vz2sERR1);
;;;1211   			}
;;;1212   		}
;;;1213   	if(sk_stat[0]==1)
000f18  4df3              LDR      r5,|L1.4840|
000f1a  f8960029          LDRB     r0,[r6,#0x29]         ;1198  ; vz2_stat
000f1e  2801              CMP      r0,#1                 ;1198
000f20  d13b              BNE      |L1.3994|
000f22  f896002a          LDRB     r0,[r6,#0x2a]         ;1200  ; vz2_stat_old
000f26  2801              CMP      r0,#1                 ;1200
000f28  d003              BEQ      |L1.3890|
000f2a  f04f0005          MOV      r0,#5                 ;1202
000f2e  f8a60078          STRH     r0,[r6,#0x78]         ;1202
                  |L1.3890|
000f32  f9b60078          LDRSH    r0,[r6,#0x78]         ;1204  ; vz2_stat_cnt
000f36  b170              CBZ      r0,|L1.3926|
000f38  f1a00001          SUB      r0,r0,#1              ;1206
000f3c  b200              SXTH     r0,r0                 ;1206
000f3e  f8a60078          STRH     r0,[r6,#0x78]         ;1206
000f42  b940              CBNZ     r0,|L1.3926|
000f44  f04f000c          MOV      r0,#0xc               ;1209
000f48  f8860029          STRB     r0,[r6,#0x29]         ;1209
000f4c  4601              MOV      r1,r0                 ;1210
000f4e  f44f70ca          MOV      r0,#0x194             ;1210
000f52  f7fffffe          BL       lc640_write
                  |L1.3926|
000f56  7828              LDRB     r0,[r5,#0]  ; sk_stat
000f58  2801              CMP      r0,#1
000f5a  d118              BNE      |L1.3982|
;;;1214   		{
;;;1215   		vz2_stat=vz2sSTEP2;
000f5c  f04f0002          MOV      r0,#2
000f60  f8860029          STRB     r0,[r6,#0x29]
;;;1216   		lc640_write(EE_VZ2_STAT,vz2sSTEP2);
000f64  4601              MOV      r1,r0
000f66  f44f70ca          MOV      r0,#0x194
000f6a  f7fffffe          BL       lc640_write
;;;1217   		tree_up(iVZ2_STEP2_2,1,0,0);
000f6e  2300              MOVS     r3,#0
000f70  461a              MOV      r2,r3
000f72  2101              MOVS     r1,#1
000f74  20e0              MOVS     r0,#0xe0
000f76  f7fffffe          BL       tree_up
;;;1218   		tree_up(iVZ2_STEP2_1,0,0,0);
000f7a  2300              MOVS     r3,#0
000f7c  461a              MOV      r2,r3
000f7e  4619              MOV      r1,r3
000f80  20df              MOVS     r0,#0xdf
000f82  f7fffffe          BL       tree_up
;;;1219   		ret(1200);
000f86  f44f6096          MOV      r0,#0x4b0
000f8a  f7fffffe          BL       ||ret||
                  |L1.3982|
;;;1220   		}
;;;1221   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000f8e  2314              MOVS     r3,#0x14
000f90  2200              MOVS     r2,#0
000f92  2164              MOVS     r1,#0x64
000f94  20d2              MOVS     r0,#0xd2
000f96  f7fffffe          BL       mess_send
                  |L1.3994|
;;;1222   	}
;;;1223   
;;;1224   if(vz2_stat==vz2sSTEP2)
000f9a  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
000f9e  2802              CMP      r0,#2
000fa0  d11a              BNE      |L1.4056|
;;;1225   	{
;;;1226   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
000fa2  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
000fa6  2802              CMP      r0,#2
000fa8  d102              BNE      |L1.4016|
000faa  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
000fae  b918              CBNZ     r0,|L1.4024|
                  |L1.4016|
;;;1227   		{
;;;1228   		vz2_stat_cnt=15;
000fb0  f04f000f          MOV      r0,#0xf
000fb4  f8a60078          STRH     r0,[r6,#0x78]
                  |L1.4024|
;;;1229   		}
;;;1230   	vz2_stat_cnt--;
000fb8  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
000fbc  f1a00001          SUB      r0,r0,#1
000fc0  f8a60078          STRH     r0,[r6,#0x78]
;;;1231   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
000fc4  f04f0314          MOV      r3,#0x14
000fc8  f04f0200          MOV      r2,#0
000fcc  f04f0164          MOV      r1,#0x64
000fd0  f04f00d2          MOV      r0,#0xd2
000fd4  f7fffffe          BL       mess_send
                  |L1.4056|
;;;1232   	}
;;;1233   
;;;1234   if(vz2_stat==vz2sSTEP3)
000fd8  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
;;;1235   	{
;;;1236   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
;;;1237   		{
;;;1238   		vz2_stat_cnt=10;
000fdc  240a              MOVS     r4,#0xa
000fde  2700              MOVS     r7,#0
;;;1239   		cntrl_stat=0;
;;;1240   		cntrl_stat_new=0;
;;;1241   		cntrl_stat_old=0;
;;;1242   		}
;;;1243   	vz2_stat_cnt--;
;;;1244   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
;;;1245   		{
;;;1246   		show_mess(	"     ВКЛЮЧИТЕ       ",
000fe0  f2413888          MOV      r8,#0x1388
000fe4  2803              CMP      r0,#3                 ;1234
000fe6  d13d              BNE      |L1.4196|
000fe8  f896002a          LDRB     r0,[r6,#0x2a]         ;1236  ; vz2_stat_old
000fec  2803              CMP      r0,#3                 ;1236
000fee  d102              BNE      |L1.4086|
000ff0  f8b60078          LDRH     r0,[r6,#0x78]         ;1236  ; vz2_stat_cnt
000ff4  b928              CBNZ     r0,|L1.4098|
                  |L1.4086|
000ff6  f8a64078          STRH     r4,[r6,#0x78]         ;1238
000ffa  85b7              STRH     r7,[r6,#0x2c]         ;1239
000ffc  f8a67042          STRH     r7,[r6,#0x42]         ;1240
001000  85f7              STRH     r7,[r6,#0x2e]         ;1241
                  |L1.4098|
001002  f8b60078          LDRH     r0,[r6,#0x78]         ;1243  ; vz2_stat_cnt
001006  f1a00001          SUB      r0,r0,#1              ;1243
00100a  b200              SXTH     r0,r0                 ;1243
00100c  f8a60078          STRH     r0,[r6,#0x78]         ;1243
001010  280a              CMP      r0,#0xa               ;1244
001012  d001              BEQ      |L1.4120|
001014  2809              CMP      r0,#9                 ;1244
001016  d10b              BNE      |L1.4144|
                  |L1.4120|
001018  f2af63dc          ADR      r3,|L1.2368|
00101c  f2af22f4          ADR      r2,|L1.3372|
001020  f2af21e0          ADR      r1,|L1.3396|
001024  f2af20cc          ADR      r0,|L1.3420|
001028  f8cd8000          STR      r8,[sp,#0]
00102c  f7fffffe          BL       show_mess
                  |L1.4144|
;;;1247   					"      ТУМБЛЕР       ",
;;;1248   					"     ВЫСОКОГО       ",
;;;1249   					"    НАПРЯЖЕНИЯ      ",
;;;1250   					5000);
;;;1251   		}
;;;1252   	if(sk_stat[1]==1)
001030  7868              LDRB     r0,[r5,#1]  ; sk_stat
001032  2801              CMP      r0,#1
001034  d110              BNE      |L1.4184|
;;;1253   		{
;;;1254   		vz2_stat=vz2sWRK1;
001036  f1060628          ADD      r6,r6,#0x28
00103a  7074              STRB     r4,[r6,#1]
;;;1255   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
00103c  f04f010a          MOV      r1,#0xa
001040  f44f70ca          MOV      r0,#0x194
001044  f7fffffe          BL       lc640_write
;;;1256   		volt_region=1;
001048  f04f0001          MOV      r0,#1
00104c  7030              STRB     r0,[r6,#0]
;;;1257   		cntrl_stat=0;
00104e  80b7              STRH     r7,[r6,#4]
;;;1258   		cntrl_stat_new=0;
001050  8377              STRH     r7,[r6,#0x1a]
;;;1259   		cntrl_stat_old=0;
001052  80f7              STRH     r7,[r6,#6]
001054  f1a60628          SUB      r6,r6,#0x28
                  |L1.4184|
;;;1260   		}
;;;1261   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001058  2314              MOVS     r3,#0x14
00105a  2200              MOVS     r2,#0
00105c  2164              MOVS     r1,#0x64
00105e  20d2              MOVS     r0,#0xd2
001060  f7fffffe          BL       mess_send
                  |L1.4196|
;;;1262   	}
;;;1263   
;;;1264   if(vz2_stat==vz2sWRK1)
001064  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
;;;1265   	{
;;;1266   
;;;1267   	if(vz2_stat_old!=vz2_stat)
;;;1268   		{
;;;1269   		vz2_wrk_cnt=3600L/*100L*/*((long)FZ_T1);
001068  f8df9278          LDR      r9,|L1.4836|
;;;1270   		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;1271   		vz2_up_cnt=0L;
;;;1272   
;;;1273   		}
;;;1274   	vz2_wrk_cnt--;
;;;1275   	vz2_up_cnt++;
;;;1276   
;;;1277   	if(vz2_wrk_cnt==0)
;;;1278   		{
;;;1279   		vz2_stat=vz2sWRK2;
;;;1280   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
;;;1281   		}
;;;1282   	if(sk_stat[0]==0)
;;;1283   		{
;;;1284   		vz2_stat=vz2sERR2;
;;;1285   		lc640_write(EE_VZ2_STAT,vz2sERR2);
;;;1286   		}
;;;1287   	if(sk_stat[1]==0)
;;;1288   		{
;;;1289   		vz2_stat=vz2sERR3;
;;;1290   		lc640_write(EE_VZ2_STAT,vz2sERR3);
;;;1291   		}
;;;1292   	//if(abs(out_U-FZ_U1)<10)
;;;1293   	if((out_U<(FZ_U1+30))&&(out_U>(FZ_U1-10)))
;;;1294   		{
;;;1295   		if((Ib_ips_termokompensat/10)<FZ_ISW12)
;;;1296   			{
;;;1297   			if(vz2_stat_ph2_cnt)
;;;1298   				{
;;;1299   				vz2_stat_ph2_cnt--;
;;;1300   				if(vz2_stat_ph2_cnt==0)
;;;1301   					{
;;;1302   					vz2_stat=vz2sWRK2;
;;;1303   					lc640_write(EE_VZ2_STAT,vz2sWRK2);
;;;1304   					}
;;;1305   				}
;;;1306   			}
;;;1307   		else
;;;1308   			{
;;;1309   			vz2_stat_ph2_cnt=60;
;;;1310   			}
;;;1311   		}
;;;1312   	else
;;;1313   		{
;;;1314   		vz2_stat_ph2_cnt=60;
;;;1315   		}
;;;1316   	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
;;;1317   		{
;;;1318   		volt_region=0;
;;;1319   		cntrl_stat=1000;
00106c  f44f7b7a          MOV      r11,#0x3e8
001070  f1090980          ADD      r9,r9,#0x80           ;1269
001074  f04f0a0b          MOV      r10,#0xb              ;1279
001078  280a              CMP      r0,#0xa               ;1264
00107a  d17e              BNE      |L1.4474|
00107c  f896002a          LDRB     r0,[r6,#0x2a]         ;1267  ; vz2_stat_old
001080  280a              CMP      r0,#0xa               ;1267
001082  d00a              BEQ      |L1.4250|
001084  4899              LDR      r0,|L1.4844|
001086  f44f6161          MOV      r1,#0xe10             ;1269
00108a  f9b00000          LDRSH    r0,[r0,#0]            ;1269  ; FZ_T1
00108e  fb00f001          MUL      r0,r0,r1              ;1269
001092  f8c90040          STR      r0,[r9,#0x40]         ;1269  ; vz2_wrk_cnt
001096  f8c97044          STR      r7,[r9,#0x44]         ;1271  ; vz2_up_cnt
                  |L1.4250|
00109a  f8d90040          LDR      r0,[r9,#0x40]         ;1274  ; vz2_wrk_cnt
00109e  f1a00001          SUB      r0,r0,#1              ;1274
0010a2  f8c90040          STR      r0,[r9,#0x40]         ;1274  ; vz2_wrk_cnt
0010a6  f8d91044          LDR      r1,[r9,#0x44]         ;1275  ; vz2_up_cnt
0010aa  f1010101          ADD      r1,r1,#1              ;1275
0010ae  f8c91044          STR      r1,[r9,#0x44]         ;1275  ; vz2_up_cnt
0010b2  b930              CBNZ     r0,|L1.4290|
0010b4  f886a029          STRB     r10,[r6,#0x29]        ;1279
0010b8  210b              MOVS     r1,#0xb               ;1280
0010ba  f44f70ca          MOV      r0,#0x194             ;1280
0010be  f7fffffe          BL       lc640_write
                  |L1.4290|
0010c2  7828              LDRB     r0,[r5,#0]            ;1282  ; sk_stat
0010c4  b940              CBNZ     r0,|L1.4312|
0010c6  f04f000d          MOV      r0,#0xd               ;1284
0010ca  f8860029          STRB     r0,[r6,#0x29]         ;1284
0010ce  4601              MOV      r1,r0                 ;1285
0010d0  f44f70ca          MOV      r0,#0x194             ;1285
0010d4  f7fffffe          BL       lc640_write
                  |L1.4312|
0010d8  7868              LDRB     r0,[r5,#1]            ;1287  ; sk_stat
0010da  b940              CBNZ     r0,|L1.4334|
0010dc  f04f000e          MOV      r0,#0xe               ;1289
0010e0  f8860029          STRB     r0,[r6,#0x29]         ;1289
0010e4  4601              MOV      r1,r0                 ;1290
0010e6  f44f70ca          MOV      r0,#0x194             ;1290
0010ea  f7fffffe          BL       lc640_write
                  |L1.4334|
0010ee  4880              LDR      r0,|L1.4848|
0010f0  223c              MOVS     r2,#0x3c              ;1309
0010f2  f9b01000          LDRSH    r1,[r0,#0]            ;1293  ; out_U
0010f6  487f              LDR      r0,|L1.4852|
0010f8  f9b00000          LDRSH    r0,[r0,#0]            ;1293  ; FZ_U1
0010fc  f100031e          ADD      r3,r0,#0x1e           ;1293
001100  4299              CMP      r1,r3                 ;1293
001102  da20              BGE      |L1.4422|
001104  380a              SUBS     r0,r0,#0xa            ;1293
001106  4281              CMP      r1,r0                 ;1293
001108  dd1d              BLE      |L1.4422|
00110a  487b              LDR      r0,|L1.4856|
00110c  497b              LDR      r1,|L1.4860|
00110e  f9b00000          LDRSH    r0,[r0,#0]            ;1295  ; Ib_ips_termokompensat
001112  f9b11000          LDRSH    r1,[r1,#0]            ;1295  ; FZ_ISW12
001116  fb90f0f4          SDIV     r0,r0,r4              ;1295
00111a  4288              CMP      r0,r1                 ;1295
00111c  da10              BGE      |L1.4416|
00111e  f9b6007a          LDRSH    r0,[r6,#0x7a]         ;1297  ; vz2_stat_ph2_cnt
001122  b190              CBZ      r0,|L1.4426|
001124  f1a00001          SUB      r0,r0,#1              ;1299
001128  b200              SXTH     r0,r0                 ;1299
00112a  f8a6007a          STRH     r0,[r6,#0x7a]         ;1299
00112e  b960              CBNZ     r0,|L1.4426|
001130  f886a029          STRB     r10,[r6,#0x29]        ;1302
001134  210b              MOVS     r1,#0xb               ;1303
001136  f44f70ca          MOV      r0,#0x194             ;1303
00113a  f7fffffe          BL       lc640_write
00113e  e004              B        |L1.4426|
                  |L1.4416|
001140  f8a6207a          STRH     r2,[r6,#0x7a]         ;1309
001144  e001              B        |L1.4426|
                  |L1.4422|
001146  f8a6207a          STRH     r2,[r6,#0x7a]         ;1314
                  |L1.4426|
00114a  f9b60044          LDRSH    r0,[r6,#0x44]         ;1316  ; Ibmax
00114e  f8b61046          LDRH     r1,[r6,#0x46]         ;1316  ; IZMAX_
001152  fb90f0f4          SDIV     r0,r0,r4              ;1316
001156  4288              CMP      r0,r1                 ;1316
001158  dd18              BLE      |L1.4492|
00115a  f9b6202c          LDRSH    r2,[r6,#0x2c]         ;1316  ; cntrl_stat
00115e  2a14              CMP      r2,#0x14              ;1316
001160  dc14              BGT      |L1.4492|
001162  f8962028          LDRB     r2,[r6,#0x28]         ;1316  ; volt_region
001166  2a01              CMP      r2,#1                 ;1316
001168  d110              BNE      |L1.4492|
00116a  f8b62076          LDRH     r2,[r6,#0x76]         ;1316  ; volt_region_cnt
00116e  b96a              CBNZ     r2,|L1.4492|
001170  f8867028          STRB     r7,[r6,#0x28]         ;1318
001174  f8a6b02c          STRH     r11,[r6,#0x2c]
;;;1320   		cntrl_stat_new=1000;
001178  e000              B        |L1.4476|
                  |L1.4474|
00117a  e030              B        |L1.4574|
                  |L1.4476|
00117c  f8a6b042          STRH     r11,[r6,#0x42]
;;;1321   		cntrl_stat_old=1000;
001180  f8a6b02e          STRH     r11,[r6,#0x2e]
;;;1322   		volt_region_cnt=110;
001184  f04f026e          MOV      r2,#0x6e
001188  f8a62076          STRH     r2,[r6,#0x76]
                  |L1.4492|
;;;1323   		}
;;;1324   	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
00118c  4288              CMP      r0,r1
00118e  da13              BGE      |L1.4536|
001190  f9b6002c          LDRSH    r0,[r6,#0x2c]  ; cntrl_stat
001194  4558              CMP      r0,r11
001196  db0f              BLT      |L1.4536|
001198  f8960028          LDRB     r0,[r6,#0x28]  ; volt_region
00119c  b960              CBNZ     r0,|L1.4536|
00119e  f8b60076          LDRH     r0,[r6,#0x76]  ; volt_region_cnt
0011a2  b948              CBNZ     r0,|L1.4536|
;;;1325   		{
;;;1326   		volt_region=1;
0011a4  f04f0001          MOV      r0,#1
0011a8  f8860028          STRB     r0,[r6,#0x28]
;;;1327   		cntrl_stat=10;
0011ac  85b4              STRH     r4,[r6,#0x2c]
;;;1328   		cntrl_stat_new=10;
0011ae  f8a64042          STRH     r4,[r6,#0x42]
;;;1329   		cntrl_stat_old=10;
0011b2  85f4              STRH     r4,[r6,#0x2e]
;;;1330   		volt_region_cnt=10;
0011b4  f8a64076          STRH     r4,[r6,#0x76]
                  |L1.4536|
;;;1331   		}
;;;1332   	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0011b8  f8960028          LDRB     r0,[r6,#0x28]  ; volt_region
0011bc  b110              CBZ      r0,|L1.4548|
;;;1333   	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
0011be  2801              CMP      r0,#1
0011c0  d007              BEQ      |L1.4562|
0011c2  e00c              B        |L1.4574|
                  |L1.4548|
0011c4  2314              MOVS     r3,#0x14              ;1332
0011c6  2200              MOVS     r2,#0                 ;1332
0011c8  2164              MOVS     r1,#0x64              ;1332
0011ca  20d2              MOVS     r0,#0xd2              ;1332
0011cc  f7fffffe          BL       mess_send
0011d0  e005              B        |L1.4574|
                  |L1.4562|
0011d2  2314              MOVS     r3,#0x14
0011d4  2201              MOVS     r2,#1
0011d6  2164              MOVS     r1,#0x64
0011d8  20d2              MOVS     r0,#0xd2
0011da  f7fffffe          BL       mess_send
                  |L1.4574|
;;;1334   	}
;;;1335   
;;;1336   if(vz2_stat==vz2sWRK2)
0011de  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
0011e2  280b              CMP      r0,#0xb
0011e4  d175              BNE      |L1.4818|
;;;1337   	{
;;;1338   	if(vz2_stat_old!=vz2_stat)
0011e6  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
0011ea  280b              CMP      r0,#0xb
0011ec  d008              BEQ      |L1.4608|
;;;1339   		{
;;;1340   		vz2_wrk_cnt=3600L/*100L*/*((long)FZ_T2);
0011ee  4844              LDR      r0,|L1.4864|
0011f0  f44f6161          MOV      r1,#0xe10
0011f4  f9b00000          LDRSH    r0,[r0,#0]  ; FZ_T2
0011f8  fb00f001          MUL      r0,r0,r1
0011fc  f8c90040          STR      r0,[r9,#0x40]  ; vz2_wrk_cnt
                  |L1.4608|
;;;1341   		//if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;1342   		//vz2_up_cnt=0L;
;;;1343   		}
;;;1344   	vz2_wrk_cnt--;
001200  f8d90040          LDR      r0,[r9,#0x40]  ; vz2_wrk_cnt
001204  f1a00001          SUB      r0,r0,#1
001208  f8c90040          STR      r0,[r9,#0x40]  ; vz2_wrk_cnt
;;;1345   	vz2_up_cnt++;
00120c  f8d91044          LDR      r1,[r9,#0x44]  ; vz2_up_cnt
001210  f1010101          ADD      r1,r1,#1
001214  f8c91044          STR      r1,[r9,#0x44]  ; vz2_up_cnt
;;;1346   
;;;1347   	if(vz2_wrk_cnt==0)
001218  b958              CBNZ     r0,|L1.4658|
;;;1348   		{
;;;1349   		vz2_stat=vz2sFINE;
00121a  f04f0012          MOV      r0,#0x12
00121e  f8860029          STRB     r0,[r6,#0x29]
;;;1350   		lc640_write(EE_VZ2_STAT,vz2sFINE);
001222  4601              MOV      r1,r0
001224  f44f70ca          MOV      r0,#0x194
001228  f7fffffe          BL       lc640_write
;;;1351   		fz_mem_hndl(0);
00122c  2000              MOVS     r0,#0
00122e  f7fffffe          BL       fz_mem_hndl
                  |L1.4658|
;;;1352   		}
;;;1353   	if(sk_stat[0]==0)
001232  7828              LDRB     r0,[r5,#0]  ; sk_stat
001234  b940              CBNZ     r0,|L1.4680|
;;;1354   		{
;;;1355   		vz2_stat=vz2sERR5;
001236  f04f0010          MOV      r0,#0x10
00123a  f8860029          STRB     r0,[r6,#0x29]
;;;1356   		lc640_write(EE_VZ2_STAT,vz2sERR5);
00123e  4601              MOV      r1,r0
001240  f44f70ca          MOV      r0,#0x194
001244  f7fffffe          BL       lc640_write
                  |L1.4680|
;;;1357   		}
;;;1358   	if(sk_stat[1]==0)
001248  7868              LDRB     r0,[r5,#1]  ; sk_stat
00124a  b940              CBNZ     r0,|L1.4702|
;;;1359   		{
;;;1360   		vz2_stat=vz2sERR6;
00124c  f04f0011          MOV      r0,#0x11
001250  f8860029          STRB     r0,[r6,#0x29]
;;;1361   		lc640_write(EE_VZ2_STAT,vz2sERR6);
001254  4601              MOV      r1,r0
001256  f44f70ca          MOV      r0,#0x194
00125a  f7fffffe          BL       lc640_write
                  |L1.4702|
;;;1362   		}
;;;1363   	if(((Ibmax/10)>IZMAX_)&&(cntrl_stat<=20)&&(volt_region==1)&&(volt_region_cnt==0))
00125e  f9b60044          LDRSH    r0,[r6,#0x44]  ; Ibmax
001262  f8b61046          LDRH     r1,[r6,#0x46]  ; IZMAX_
001266  fb90f0f4          SDIV     r0,r0,r4
00126a  4288              CMP      r0,r1
00126c  dd16              BLE      |L1.4764|
00126e  f9b6202c          LDRSH    r2,[r6,#0x2c]  ; cntrl_stat
001272  2a14              CMP      r2,#0x14
001274  dc12              BGT      |L1.4764|
001276  f8962028          LDRB     r2,[r6,#0x28]  ; volt_region
00127a  2a01              CMP      r2,#1
00127c  d10e              BNE      |L1.4764|
00127e  f8b62076          LDRH     r2,[r6,#0x76]  ; volt_region_cnt
001282  b95a              CBNZ     r2,|L1.4764|
;;;1364   		{
;;;1365   		volt_region=0;
001284  f8867028          STRB     r7,[r6,#0x28]
;;;1366   		cntrl_stat=1000;
001288  f8a6b02c          STRH     r11,[r6,#0x2c]
;;;1367   		cntrl_stat_new=1000;
00128c  f8a6b042          STRH     r11,[r6,#0x42]
;;;1368   		cntrl_stat_old=1000;
001290  f8a6b02e          STRH     r11,[r6,#0x2e]
;;;1369   		volt_region_cnt=110;
001294  f04f026e          MOV      r2,#0x6e
001298  f8a62076          STRH     r2,[r6,#0x76]
                  |L1.4764|
;;;1370   		}
;;;1371   	if(((Ibmax/10)<IZMAX_)&&(cntrl_stat>=1000)&&(volt_region==0)&&(volt_region_cnt==0))
00129c  4288              CMP      r0,r1
00129e  da13              BGE      |L1.4808|
0012a0  f9b6002c          LDRSH    r0,[r6,#0x2c]  ; cntrl_stat
0012a4  4558              CMP      r0,r11
0012a6  db0f              BLT      |L1.4808|
0012a8  f8960028          LDRB     r0,[r6,#0x28]  ; volt_region
0012ac  b960              CBNZ     r0,|L1.4808|
0012ae  f8b60076          LDRH     r0,[r6,#0x76]  ; volt_region_cnt
0012b2  b948              CBNZ     r0,|L1.4808|
;;;1372   		{
;;;1373   		volt_region=1;
0012b4  f04f0001          MOV      r0,#1
0012b8  f8860028          STRB     r0,[r6,#0x28]
;;;1374   		cntrl_stat=10;
0012bc  85b4              STRH     r4,[r6,#0x2c]
;;;1375   		cntrl_stat_new=10;
0012be  f8a64042          STRH     r4,[r6,#0x42]
;;;1376   		cntrl_stat_old=10;
0012c2  85f4              STRH     r4,[r6,#0x2e]
;;;1377   		volt_region_cnt=10;
0012c4  f8a64076          STRH     r4,[r6,#0x76]
                  |L1.4808|
;;;1378   		}
;;;1379   	if(volt_region==0) 		mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0012c8  f8960028          LDRB     r0,[r6,#0x28]  ; volt_region
0012cc  b110              CBZ      r0,|L1.4820|
;;;1380   	else if(volt_region==1) mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,20);
0012ce  2801              CMP      r0,#1
0012d0  d018              BEQ      |L1.4868|
                  |L1.4818|
0012d2  e01d              B        |L1.4880|
                  |L1.4820|
0012d4  2314              MOVS     r3,#0x14              ;1379
0012d6  2200              MOVS     r2,#0                 ;1379
0012d8  2164              MOVS     r1,#0x64              ;1379
0012da  20d2              MOVS     r0,#0xd2              ;1379
0012dc  f7fffffe          BL       mess_send
0012e0  e016              B        |L1.4880|
0012e2  0000              DCW      0x0000
                  |L1.4836|
                          DCD      ||area_number.25||
                  |L1.4840|
                          DCD      sk_stat
                  |L1.4844|
                          DCD      FZ_T1
                  |L1.4848|
                          DCD      out_U
                  |L1.4852|
                          DCD      FZ_U1
                  |L1.4856|
                          DCD      Ib_ips_termokompensat
                  |L1.4860|
                          DCD      FZ_ISW12
                  |L1.4864|
                          DCD      FZ_T2
                  |L1.4868|
001304  2314              MOVS     r3,#0x14
001306  2201              MOVS     r2,#1
001308  2164              MOVS     r1,#0x64
00130a  20d2              MOVS     r0,#0xd2
00130c  f7fffffe          BL       mess_send
                  |L1.4880|
;;;1381   	}
;;;1382   
;;;1383   if(vz2_stat==vz2sERR1)		//Отсутствует вентиляция при включении
001310  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
001314  280c              CMP      r0,#0xc
001316  d124              BNE      |L1.4962|
;;;1384   	{
;;;1385   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
001318  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
00131c  280c              CMP      r0,#0xc
00131e  d102              BNE      |L1.4902|
001320  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001324  b908              CBNZ     r0,|L1.4906|
                  |L1.4902|
;;;1386   		{
;;;1387   		vz2_stat_cnt=10;
001326  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.4906|
;;;1388   		}
;;;1389   	vz2_stat_cnt--;
00132a  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
00132e  f1a00001          SUB      r0,r0,#1
001332  b200              SXTH     r0,r0
001334  f8a60078          STRH     r0,[r6,#0x78]
;;;1390   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
001338  280a              CMP      r0,#0xa
00133a  d001              BEQ      |L1.4928|
00133c  2809              CMP      r0,#9
00133e  d10a              BNE      |L1.4950|
                  |L1.4928|
;;;1391   		{
;;;1392   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
001340  f2af53c8          ADR      r3,|L1.3452|
001344  f2af52b4          ADR      r2,|L1.3476|
001348  f2af51a0          ADR      r1,|L1.3500|
00134c  a0ff              ADR      r0,|L1.5964|
00134e  f8cd8000          STR      r8,[sp,#0]
001352  f7fffffe          BL       show_mess
                  |L1.4950|
;;;1393   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;1394   					"      ВКЛЮЧЕН       ",
;;;1395   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;1396   					5000);
;;;1397   		}
;;;1398   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001356  2314              MOVS     r3,#0x14
001358  2200              MOVS     r2,#0
00135a  2164              MOVS     r1,#0x64
00135c  20d2              MOVS     r0,#0xd2
00135e  f7fffffe          BL       mess_send
                  |L1.4962|
;;;1399   	}
;;;1400   if(vz2_stat==vz2sERR2)		//Пропала вентиляция при работе в первой фазе ФЗ
001362  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
001366  280d              CMP      r0,#0xd
001368  d12e              BNE      |L1.5064|
;;;1401   	{
;;;1402   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00136a  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
00136e  280d              CMP      r0,#0xd
001370  d102              BNE      |L1.4984|
001372  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001376  b908              CBNZ     r0,|L1.4988|
                  |L1.4984|
;;;1403   		{
;;;1404   		vz2_stat_cnt=10;
001378  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.4988|
;;;1405   		}
;;;1406   	vz2_stat_cnt--;
00137c  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001380  f1a00001          SUB      r0,r0,#1
001384  b200              SXTH     r0,r0
001386  f8a60078          STRH     r0,[r6,#0x78]
;;;1407   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
00138a  280a              CMP      r0,#0xa
00138c  d001              BEQ      |L1.5010|
00138e  2809              CMP      r0,#9
001390  d10a              BNE      |L1.5032|
                  |L1.5010|
;;;1408   		{
;;;1409   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
001392  f6af23b4          ADR      r3,|L1.2272|
001396  f6af22a0          ADR      r2,|L1.2296|
00139a  f6af218c          ADR      r1,|L1.2320|
00139e  a0eb              ADR      r0,|L1.5964|
0013a0  f8cd8000          STR      r8,[sp,#0]
0013a4  f7fffffe          BL       show_mess
                  |L1.5032|
;;;1410   					"    ЗАБЛОКИРОВАН    ",
;;;1411   					"     НЕИСПРАВНА     ",
;;;1412   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;1413   					5000);
;;;1414   		}
;;;1415   	if(sk_stat[0]==1)
0013a8  7828              LDRB     r0,[r5,#0]  ; sk_stat
0013aa  2801              CMP      r0,#1
0013ac  d106              BNE      |L1.5052|
;;;1416   		{
;;;1417   		vz2_stat=vz2sWRK1;
0013ae  f8864029          STRB     r4,[r6,#0x29]
;;;1418   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
0013b2  210a              MOVS     r1,#0xa
0013b4  f44f70ca          MOV      r0,#0x194
0013b8  f7fffffe          BL       lc640_write
                  |L1.5052|
;;;1419   		}
;;;1420   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0013bc  2314              MOVS     r3,#0x14
0013be  2200              MOVS     r2,#0
0013c0  2164              MOVS     r1,#0x64
0013c2  20d2              MOVS     r0,#0xd2
0013c4  f7fffffe          BL       mess_send
                  |L1.5064|
;;;1421   	}
;;;1422   
;;;1423   if(vz2_stat==vz2sERR3)		//Отключен тумблер "Выравнивающий заряд" при работе в первой фазе ФЗ
0013c8  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
0013cc  280e              CMP      r0,#0xe
0013ce  d12d              BNE      |L1.5164|
;;;1424   	{
;;;1425   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
0013d0  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
0013d4  280e              CMP      r0,#0xe
0013d6  d102              BNE      |L1.5086|
0013d8  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
0013dc  b908              CBNZ     r0,|L1.5090|
                  |L1.5086|
;;;1426   		{
;;;1427   		vz2_stat_cnt=10;
0013de  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.5090|
;;;1428   		}
;;;1429   	vz2_stat_cnt--;
0013e2  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
0013e6  f1a00001          SUB      r0,r0,#1
0013ea  b200              SXTH     r0,r0
0013ec  f8a60078          STRH     r0,[r6,#0x78]
;;;1430   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
0013f0  280a              CMP      r0,#0xa
0013f2  d001              BEQ      |L1.5112|
0013f4  2809              CMP      r0,#9
0013f6  d109              BNE      |L1.5132|
                  |L1.5112|
;;;1431   		{
;;;1432   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
0013f8  a3da              ADR      r3,|L1.5988|
0013fa  f2af6208          ADR      r2,|L1.3572|
0013fe  f2af51f4          ADR      r1,|L1.3596|
001402  a0d2              ADR      r0,|L1.5964|
001404  f8cd8000          STR      r8,[sp,#0]
001408  f7fffffe          BL       show_mess
                  |L1.5132|
;;;1433   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;1434   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;1435   					"    ТУМБЛЕРА!!!     ",
;;;1436   					5000);
;;;1437   		}
;;;1438   	if(sk_stat[1]==1)
00140c  7868              LDRB     r0,[r5,#1]  ; sk_stat
00140e  2801              CMP      r0,#1
001410  d106              BNE      |L1.5152|
;;;1439   		{
;;;1440   		vz2_stat=vz2sWRK1;
001412  f8864029          STRB     r4,[r6,#0x29]
;;;1441   		lc640_write(EE_VZ2_STAT,vz2sWRK1);
001416  210a              MOVS     r1,#0xa
001418  f44f70ca          MOV      r0,#0x194
00141c  f7fffffe          BL       lc640_write
                  |L1.5152|
;;;1442   		}
;;;1443   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001420  2314              MOVS     r3,#0x14
001422  2200              MOVS     r2,#0
001424  2164              MOVS     r1,#0x64
001426  20d2              MOVS     r0,#0xd2
001428  f7fffffe          BL       mess_send
                  |L1.5164|
;;;1444   	}
;;;1445   if(vz2_stat==vz2sERR5)		//Пропала вентиляция при работе
00142c  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
001430  2810              CMP      r0,#0x10
001432  d12e              BNE      |L1.5266|
;;;1446   	{
;;;1447   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
001434  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
001438  2810              CMP      r0,#0x10
00143a  d102              BNE      |L1.5186|
00143c  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001440  b908              CBNZ     r0,|L1.5190|
                  |L1.5186|
;;;1448   		{
;;;1449   		vz2_stat_cnt=10;
001442  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.5190|
;;;1450   		}
;;;1451   	vz2_stat_cnt--;
001446  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
00144a  f1a00001          SUB      r0,r0,#1
00144e  b200              SXTH     r0,r0
001450  f8a60078          STRH     r0,[r6,#0x78]
;;;1452   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
001454  280a              CMP      r0,#0xa
001456  d001              BEQ      |L1.5212|
001458  2809              CMP      r0,#9
00145a  d10a              BNE      |L1.5234|
                  |L1.5212|
;;;1453   		{
;;;1454   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
00145c  f6af3380          ADR      r3,|L1.2272|
001460  f6af326c          ADR      r2,|L1.2296|
001464  f6af3158          ADR      r1,|L1.2320|
001468  a0b8              ADR      r0,|L1.5964|
00146a  f8cd8000          STR      r8,[sp,#0]
00146e  f7fffffe          BL       show_mess
                  |L1.5234|
;;;1455   					"    ЗАБЛОКИРОВАН    ",
;;;1456   					"     НЕИСПРАВНА     ",
;;;1457   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;1458   					5000);
;;;1459   		}
;;;1460   	if(sk_stat[0]==1)
001472  7828              LDRB     r0,[r5,#0]  ; sk_stat
001474  2801              CMP      r0,#1
001476  d106              BNE      |L1.5254|
;;;1461   		{
;;;1462   		vz2_stat=vz2sWRK2;
001478  f886a029          STRB     r10,[r6,#0x29]
;;;1463   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
00147c  210b              MOVS     r1,#0xb
00147e  f44f70ca          MOV      r0,#0x194
001482  f7fffffe          BL       lc640_write
                  |L1.5254|
;;;1464   		}
;;;1465   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001486  2314              MOVS     r3,#0x14
001488  2200              MOVS     r2,#0
00148a  2164              MOVS     r1,#0x64
00148c  20d2              MOVS     r0,#0xd2
00148e  f7fffffe          BL       mess_send
                  |L1.5266|
;;;1466   	}
;;;1467   
;;;1468   if(vz2_stat==vz2sERR6)		//Отключен тумблер "Выравнивающий заряд"
001492  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
001496  2811              CMP      r0,#0x11
001498  d12d              BNE      |L1.5366|
;;;1469   	{
;;;1470   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
00149a  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
00149e  2811              CMP      r0,#0x11
0014a0  d102              BNE      |L1.5288|
0014a2  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
0014a6  b908              CBNZ     r0,|L1.5292|
                  |L1.5288|
;;;1471   		{
;;;1472   		vz2_stat_cnt=10;
0014a8  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.5292|
;;;1473   		}
;;;1474   	vz2_stat_cnt--;
0014ac  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
0014b0  f1a00001          SUB      r0,r0,#1
0014b4  b200              SXTH     r0,r0
0014b6  f8a60078          STRH     r0,[r6,#0x78]
;;;1475   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
0014ba  280a              CMP      r0,#0xa
0014bc  d001              BEQ      |L1.5314|
0014be  2809              CMP      r0,#9
0014c0  d109              BNE      |L1.5334|
                  |L1.5314|
;;;1476   		{
;;;1477   		show_mess(	" ФОРМОВОЧНЫЙ ЗАРЯД  ",
0014c2  a3a8              ADR      r3,|L1.5988|
0014c4  f2af62d4          ADR      r2,|L1.3572|
0014c8  f2af61c0          ADR      r1,|L1.3596|
0014cc  a09f              ADR      r0,|L1.5964|
0014ce  f8cd8000          STR      r8,[sp,#0]
0014d2  f7fffffe          BL       show_mess
                  |L1.5334|
;;;1478   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;1479   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;1480   					"    ТУМБЛЕРА!!!     ",
;;;1481   					5000);
;;;1482   		}
;;;1483   	if(sk_stat[1]==1)
0014d6  7868              LDRB     r0,[r5,#1]  ; sk_stat
0014d8  2801              CMP      r0,#1
0014da  d106              BNE      |L1.5354|
;;;1484   		{
;;;1485   		vz2_stat=vz2sWRK2;
0014dc  f886a029          STRB     r10,[r6,#0x29]
;;;1486   		lc640_write(EE_VZ2_STAT,vz2sWRK2);
0014e0  210b              MOVS     r1,#0xb
0014e2  f44f70ca          MOV      r0,#0x194
0014e6  f7fffffe          BL       lc640_write
                  |L1.5354|
;;;1487   		}
;;;1488   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0014ea  2314              MOVS     r3,#0x14
0014ec  2200              MOVS     r2,#0
0014ee  2164              MOVS     r1,#0x64
0014f0  20d2              MOVS     r0,#0xd2
0014f2  f7fffffe          BL       mess_send
                  |L1.5366|
;;;1489   	}
;;;1490   if(vz2_stat==vz2sERR4)		//ВЗ закончился а тумблер включен
0014f6  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
0014fa  280f              CMP      r0,#0xf
0014fc  d130              BNE      |L1.5472|
;;;1491   	{
;;;1492   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
0014fe  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
001502  280f              CMP      r0,#0xf
001504  d102              BNE      |L1.5388|
001506  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
00150a  b908              CBNZ     r0,|L1.5392|
                  |L1.5388|
;;;1493   		{
;;;1494   		vz2_stat_cnt=10;
00150c  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.5392|
;;;1495   		}
;;;1496   	vz2_stat_cnt--;
001510  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001514  f1a00001          SUB      r0,r0,#1
001518  b200              SXTH     r0,r0
00151a  f8a60078          STRH     r0,[r6,#0x78]
;;;1497   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
00151e  280a              CMP      r0,#0xa
001520  d001              BEQ      |L1.5414|
001522  2809              CMP      r0,#9
001524  d10b              BNE      |L1.5438|
                  |L1.5414|
;;;1498   		{
;;;1499   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
001526  f6af33e8          ADR      r3,|L1.2368|
00152a  f6af0200          ADR      r2,|L1.3372|
00152e  f2af71ec          ADR      r1,|L1.3396|
001532  f2af6098          ADR      r0,|L1.3740|
001536  f8cd8000          STR      r8,[sp,#0]
00153a  f7fffffe          BL       show_mess
                  |L1.5438|
;;;1500   					"      ТУМБЛЕР       ",
;;;1501   					"     ВЫСОКОГО       ",
;;;1502   					"    НАПРЯЖЕНИЯ      ",
;;;1503   					5000);
;;;1504   		}
;;;1505   	if(sk_stat[1]==0)
00153e  7868              LDRB     r0,[r5,#1]  ; sk_stat
001540  b940              CBNZ     r0,|L1.5460|
;;;1506   		{
;;;1507   		vz2_stat=vz2sOFF;
001542  f8867029          STRB     r7,[r6,#0x29]
;;;1508   		lc640_write(EE_VZ2_STAT,vz2sOFF);
001546  2100              MOVS     r1,#0
001548  f44f70ca          MOV      r0,#0x194
00154c  f7fffffe          BL       lc640_write
;;;1509   		vz_stop();
001550  f7fffffe          BL       vz_stop
                  |L1.5460|
;;;1510   
;;;1511   		}
;;;1512   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001554  2314              MOVS     r3,#0x14
001556  2200              MOVS     r2,#0
001558  2164              MOVS     r1,#0x64
00155a  20d2              MOVS     r0,#0xd2
00155c  f7fffffe          BL       mess_send
                  |L1.5472|
;;;1513   	}
;;;1514   if(vz2_stat==vz2sFINE)		//ФЗ закончился, напоминание
001560  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
;;;1515   	{
;;;1516   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
;;;1517   		{
;;;1518   		vz2_stat_cnt=10;
;;;1519   		}
;;;1520   	vz2_stat_cnt--;
;;;1521   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
;;;1522   		{
;;;1523   		show_mess(	"    ФОРМОВОЧНЫЙ     ",
001564  f64038b8          MOV      r8,#0xbb8
001568  2812              CMP      r0,#0x12              ;1514
00156a  d13f              BNE      |L1.5612|
00156c  f896002a          LDRB     r0,[r6,#0x2a]         ;1516  ; vz2_stat_old
001570  2812              CMP      r0,#0x12              ;1516
001572  d102              BNE      |L1.5498|
001574  f8b60078          LDRH     r0,[r6,#0x78]         ;1516  ; vz2_stat_cnt
001578  b908              CBNZ     r0,|L1.5502|
                  |L1.5498|
00157a  f8a64078          STRH     r4,[r6,#0x78]         ;1518
                  |L1.5502|
00157e  f8b60078          LDRH     r0,[r6,#0x78]         ;1520  ; vz2_stat_cnt
001582  f1a00001          SUB      r0,r0,#1              ;1520
001586  b200              SXTH     r0,r0                 ;1520
001588  f8a60078          STRH     r0,[r6,#0x78]         ;1520
00158c  280a              CMP      r0,#0xa               ;1521
00158e  d001              BEQ      |L1.5524|
001590  2809              CMP      r0,#9                 ;1521
001592  d10a              BNE      |L1.5546|
                  |L1.5524|
001594  f2af735c          ADR      r3,|L1.3644|
001598  f2af7248          ADR      r2,|L1.3668|
00159c  f2af7134          ADR      r1,|L1.3692|
0015a0  a076              ADR      r0,|L1.6012|
0015a2  f8cd8000          STR      r8,[sp,#0]
0015a6  f7fffffe          BL       show_mess
                  |L1.5546|
;;;1524   					"       ЗАРЯД        ",
;;;1525   					"      УСПЕШНО       ",
;;;1526   					"     ЗАВЕРШЕН       ",
;;;1527   					3000);
;;;1528   		}
;;;1529   	if((vz2_stat_cnt==6)||(vz2_stat_cnt==5))
0015aa  f9b60078          LDRSH    r0,[r6,#0x78]  ; vz2_stat_cnt
0015ae  2806              CMP      r0,#6
0015b0  d001              BEQ      |L1.5558|
0015b2  2805              CMP      r0,#5
0015b4  d10b              BNE      |L1.5582|
                  |L1.5558|
;;;1530   		{
;;;1531   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
0015b6  f6af4378          ADR      r3,|L1.2368|
0015ba  f6af0290          ADR      r2,|L1.3372|
0015be  f6af017c          ADR      r1,|L1.3396|
0015c2  f2af7028          ADR      r0,|L1.3740|
0015c6  f8cd8000          STR      r8,[sp,#0]
0015ca  f7fffffe          BL       show_mess
                  |L1.5582|
;;;1532   					"      ТУМБЛЕР       ",
;;;1533   					"     ВЫСОКОГО       ",
;;;1534   					"    НАПРЯЖЕНИЯ      ",
;;;1535   					3000);
;;;1536   		}
;;;1537   	if(sk_stat[1]==0)
0015ce  7868              LDRB     r0,[r5,#1]  ; sk_stat
0015d0  b930              CBNZ     r0,|L1.5600|
;;;1538   		{
;;;1539   		vz2_stat=vz2sOFF;
0015d2  f8867029          STRB     r7,[r6,#0x29]
;;;1540   		lc640_write(EE_VZ2_STAT,vz2sOFF);
0015d6  2100              MOVS     r1,#0
0015d8  f44f70ca          MOV      r0,#0x194
0015dc  f7fffffe          BL       lc640_write
                  |L1.5600|
;;;1541   		}
;;;1542   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
0015e0  2314              MOVS     r3,#0x14
0015e2  2200              MOVS     r2,#0
0015e4  2164              MOVS     r1,#0x64
0015e6  20d2              MOVS     r0,#0xd2
0015e8  f7fffffe          BL       mess_send
                  |L1.5612|
;;;1543   	}
;;;1544   if(vz2_stat==vz2sSTOP)		//ФЗ прекращен, напоминание
0015ec  f8960029          LDRB     r0,[r6,#0x29]  ; vz2_stat
0015f0  2813              CMP      r0,#0x13
0015f2  d13f              BNE      |L1.5748|
;;;1545   	{
;;;1546   	if((vz2_stat_old!=vz2_stat)||(vz2_stat_cnt==0))
0015f4  f896002a          LDRB     r0,[r6,#0x2a]  ; vz2_stat_old
0015f8  2813              CMP      r0,#0x13
0015fa  d102              BNE      |L1.5634|
0015fc  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
001600  b908              CBNZ     r0,|L1.5638|
                  |L1.5634|
;;;1547   		{
;;;1548   		vz2_stat_cnt=10;
001602  f8a64078          STRH     r4,[r6,#0x78]
                  |L1.5638|
;;;1549   		}
;;;1550   	vz2_stat_cnt--;
001606  f8b60078          LDRH     r0,[r6,#0x78]  ; vz2_stat_cnt
00160a  f1a00001          SUB      r0,r0,#1
00160e  b200              SXTH     r0,r0
001610  f8a60078          STRH     r0,[r6,#0x78]
;;;1551   	if((vz2_stat_cnt==10)||(vz2_stat_cnt==9))
001614  280a              CMP      r0,#0xa
001616  d001              BEQ      |L1.5660|
001618  2809              CMP      r0,#9
00161a  d10a              BNE      |L1.5682|
                  |L1.5660|
;;;1552   		{
;;;1553   		show_mess(	"    ФОРМОВОЧНЫЙ     ",
00161c  f2af736c          ADR      r3,|L1.3764|
001620  f2af7258          ADR      r2,|L1.3788|
001624  f2af71bc          ADR      r1,|L1.3692|
001628  a054              ADR      r0,|L1.6012|
00162a  f8cd8000          STR      r8,[sp,#0]
00162e  f7fffffe          BL       show_mess
                  |L1.5682|
;;;1554   					"       ЗАРЯД        ",
;;;1555   					"     ПРЕКРАЩЕН      ",
;;;1556   					"                    ",
;;;1557   					3000);
;;;1558   		}
;;;1559   	if((vz2_stat_cnt==6)||(vz2_stat_cnt==5))
001632  f9b60078          LDRSH    r0,[r6,#0x78]  ; vz2_stat_cnt
001636  2806              CMP      r0,#6
001638  d001              BEQ      |L1.5694|
00163a  2805              CMP      r0,#5
00163c  d10b              BNE      |L1.5718|
                  |L1.5694|
;;;1560   		{
;;;1561   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
00163e  f6af5300          ADR      r3,|L1.2368|
001642  f6af1218          ADR      r2,|L1.3372|
001646  f6af1104          ADR      r1,|L1.3396|
00164a  f2af70b0          ADR      r0,|L1.3740|
00164e  f8cd8000          STR      r8,[sp,#0]
001652  f7fffffe          BL       show_mess
                  |L1.5718|
;;;1562   					"      ТУМБЛЕР       ",
;;;1563   					"     ВЫСОКОГО       ",
;;;1564   					"    НАПРЯЖЕНИЯ      ",
;;;1565   					3000);
;;;1566   		}
;;;1567   	if(sk_stat[1]==0)
001656  7868              LDRB     r0,[r5,#1]  ; sk_stat
001658  b930              CBNZ     r0,|L1.5736|
;;;1568   		{
;;;1569   		vz2_stat=vz2sOFF;
00165a  f8867029          STRB     r7,[r6,#0x29]
;;;1570   		lc640_write(EE_VZ2_STAT,vz2sOFF);
00165e  2100              MOVS     r1,#0
001660  f44f70ca          MOV      r0,#0x194
001664  f7fffffe          BL       lc640_write
                  |L1.5736|
;;;1571   		}
;;;1572   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,0,20);
001668  2314              MOVS     r3,#0x14
00166a  2200              MOVS     r2,#0
00166c  2164              MOVS     r1,#0x64
00166e  20d2              MOVS     r0,#0xd2
001670  f7fffffe          BL       mess_send
                  |L1.5748|
;;;1573   	}
;;;1574   vz2_stat_old=vz2_stat;
001674  f8160f29          LDRB     r0,[r6,#0x29]!  ; vz2_stat
001678  7070              STRB     r0,[r6,#1]
;;;1575   
;;;1576   }
00167a  e8bd8ff8          POP      {r3-r11,pc}
;;;1577   
                          ENDP

                  vz2_start PROC
;;;1579   //старт уравнительног заряда
;;;1580   char vz2_start(char hour)
00167e  b510              PUSH     {r4,lr}
;;;1581   {          
;;;1582   char out;
;;;1583   out=0;
001680  f04f0000          MOV      r0,#0
;;;1584   if((spc_stat==spcOFF)&&(speedChrgBlckStat!=1)&&(vz1_stat==vz1sOFF))
001684  4943              LDR      r1,|L1.6036|
001686  7e8a              LDRB     r2,[r1,#0x1a]  ; spc_stat
001688  2a00              CMP      r2,#0
00168a  d112              BNE      |L1.5810|
00168c  4a42              LDR      r2,|L1.6040|
00168e  8812              LDRH     r2,[r2,#0]  ; speedChrgBlckStat
001690  2a01              CMP      r2,#1
001692  d00e              BEQ      |L1.5810|
001694  f8912026          LDRB     r2,[r1,#0x26]  ; vz1_stat
001698  2a00              CMP      r2,#0
00169a  d10a              BNE      |L1.5810|
;;;1585   	{
;;;1586   	if(vz1_stat==vz1sOFF)
;;;1587   		{
;;;1588   		vz2_stat=vz2sSTEP1;
00169c  f04f0001          MOV      r0,#1
0016a0  f8810029          STRB     r0,[r1,#0x29]
;;;1589   		lc640_write(EE_VZ2_STAT,vz2sSTEP1);
0016a4  4601              MOV      r1,r0
0016a6  f44f70ca          MOV      r0,#0x194
0016aa  f7fffffe          BL       lc640_write
;;;1590   		out=1;
0016ae  f04f0001          MOV      r0,#1
                  |L1.5810|
;;;1591   		
;;;1592   		}
;;;1593   /*	spc_stat=spcVZ;
;;;1594   	__ee_spc_stat=spcVZ; 
;;;1595   	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);   
;;;1596   	vz_cnt_h=hour;
;;;1597   	__ee_vz_cnt=hour*60;
;;;1598   	if(hour==0)__ee_vz_cnt=30;
;;;1599   	lc640_write_int(EE_VZ_CNT,__ee_vz_cnt);
;;;1600   	lc640_write_int(EE_SPC_VZ_LENGT,__ee_vz_cnt);	
;;;1601   	vz_cnt_h_=0;
;;;1602   	vz_cnt_s=0;
;;;1603   	vz_cnt_s_=0;
;;;1604   	
;;;1605   		*/
;;;1606   	}
;;;1607   //else if((spc_stat==spc_KE1p1)||(spc_stat==spc_KE1p2)) out=22; 
;;;1608   //else if((spc_stat==spc_KE2p1)||(spc_stat==spc_KE2p2)) out=33;
;;;1609   //plazma=out;	
;;;1610   return out;
;;;1611   }
0016b2  bd10              POP      {r4,pc}
;;;1612   //-----------------------------------------------
                          ENDP

                  vz2_stop PROC
;;;1613   //стоп формовочного заряда
;;;1614   void vz2_stop(void)
0016b4  4837              LDR      r0,|L1.6036|
;;;1615   {
;;;1616   if(vz2_stat!=vz2sOFF)
0016b6  f8901029          LDRB     r1,[r0,#0x29]  ; vz2_stat
0016ba  2900              CMP      r1,#0
0016bc  d007              BEQ      |L1.5838|
;;;1617   	{
;;;1618   	vz2_stat=vz2sSTOP;
0016be  f04f0113          MOV      r1,#0x13
0016c2  f8801029          STRB     r1,[r0,#0x29]
;;;1619   	lc640_write(EE_VZ2_STAT,vz2sSTOP);
0016c6  f44f70ca          MOV      r0,#0x194
0016ca  f7ffbffe          B.W      lc640_write
                  |L1.5838|
;;;1620   	}
;;;1621   }
0016ce  4770              BX       lr
;;;1622   
                          ENDP

                  kb_init PROC
;;;1623   //-----------------------------------------------
;;;1624   void kb_init(void)
0016d0  4832              LDR      r0,|L1.6044|
;;;1625   {
;;;1626   main_kb_cnt=(TBAT*60)-60/*120*/;
0016d2  f06f013b          MVN      r1,#0x3b
0016d6  8800              LDRH     r0,[r0,#0]  ; TBAT
0016d8  ebc01000          RSB      r0,r0,r0,LSL #4
0016dc  eb010080          ADD      r0,r1,r0,LSL #2
0016e0  492c              LDR      r1,|L1.6036|
0016e2  f8a1004c          STRH     r0,[r1,#0x4c]
;;;1627   }
0016e6  4770              BX       lr
;;;1628   
                          ENDP

                  kb_hndl PROC
;;;1629   //-----------------------------------------------
;;;1630   void kb_hndl(void)
0016e8  e92d5ff0          PUSH     {r4-r12,lr}
;;;1631   {
;;;1632   
;;;1633   static signed short ibat[2],ibat_[2];
;;;1634   #ifdef UKU_TELECORE2015
;;;1635   if(((++main_kb_cnt>=TBAT*60)&&(TBAT))&&(BAT_TYPE==0))
;;;1636   #else 
;;;1637   if(((++main_kb_cnt>=TBAT*60)&&(TBAT)))
0016ec  f8df80a4          LDR      r8,|L1.6036|
;;;1638   #endif
;;;1639   	{
;;;1640   	main_kb_cnt=0;
;;;1641   	
;;;1642   	kb_start[0]=0;
;;;1643   	kb_start[1]=0;
;;;1644   	kb_start_ips=0;
;;;1645   
;;;1646   	if( (BAT_IS_ON[0]==bisON) && (bat[0]._Ub>80) && ( (abs(bat[0]._Ib)<IKB) || (bat[0]._av&1) ) ) kb_start[0]=1;
;;;1647   	if( (BAT_IS_ON[1]==bisON) && (bat[1]._Ub>80) && ( (abs(bat[1]._Ib)<IKB) || (bat[1]._av&1) ) ) kb_start[1]=1;
;;;1648   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1649   	if( (!ips_bat_av_vzvod)                      && ((abs(Ib_ips_termokompensat)<IKB) || (bat_ips._av&1) ) ) kb_start_ips=1;
0016f0  f8dfa0ac          LDR      r10,|L1.6048|
0016f4  2500              MOVS     r5,#0                 ;1637
0016f6  f8b8004c          LDRH     r0,[r8,#0x4c]         ;1637  ; main_kb_cnt
0016fa  4e2a              LDR      r6,|L1.6052|
0016fc  1c40              ADDS     r0,r0,#1              ;1637
0016fe  b201              SXTH     r1,r0                 ;1637
001700  4826              LDR      r0,|L1.6044|
001702  f8a8104c          STRH     r1,[r8,#0x4c]         ;1637
001706  f8df90a0          LDR      r9,|L1.6056|
00170a  f9b00000          LDRSH    r0,[r0,#0]            ;1637  ; TBAT
;;;1650   #endif	
;;;1651   	if( (net_av) || (num_of_wrks_bps==0) || ( (spc_stat!=spcOFF) && (spc_stat!=spcVZ) ) 
;;;1652   	  ||(vz1_stat!=vz1sOFF)||(vz2_stat!=vz2sOFF)||(sp_ch_stat!=scsOFF) 	)
;;;1653    
;;;1654   		{
;;;1655   		kb_start[0]=0;
;;;1656   		kb_start[1]=0;
;;;1657   		kb_start_ips=0;
;;;1658   		}
;;;1659   
;;;1660   	if((kb_start[0]==1)||(kb_start[1]==1)||(kb_start_ips==1))
;;;1661   		{
;;;1662   		kb_cnt_1lev=10;
00170e  270a              MOVS     r7,#0xa
001710  ebc01200          RSB      r2,r0,r0,LSL #4       ;1637
001714  f04f0b01          MOV      r11,#1                ;1646
001718  f1080452          ADD      r4,r8,#0x52           ;1642
00171c  ebb10f82          CMP      r1,r2,LSL #2          ;1637
001720  db7e              BLT      |L1.6176|
001722  2800              CMP      r0,#0                 ;1637
001724  d07c              BEQ      |L1.6176|
001726  f8a8504c          STRH     r5,[r8,#0x4c]         ;1640
00172a  7025              STRB     r5,[r4,#0]            ;1642
00172c  7065              STRB     r5,[r4,#1]            ;1643
00172e  f8885014          STRB     r5,[r8,#0x14]         ;1644
001732  481e              LDR      r0,|L1.6060|
001734  7800              LDRB     r0,[r0,#0]            ;1646  ; BAT_IS_ON
001736  2855              CMP      r0,#0x55              ;1646
001738  d144              BNE      |L1.6084|
00173a  f9b60002          LDRSH    r0,[r6,#2]            ;1646  ; bat
00173e  2850              CMP      r0,#0x50              ;1646
001740  dd40              BLE      |L1.6084|
001742  f9b60008          LDRSH    r0,[r6,#8]            ;1646  ; bat
001746  f7fffffe          BL       abs
00174a  e031              B        |L1.6064|
                  |L1.5964|
00174c  20d4ced0          DCB      " ",212,206,208,204,206,194,206,215,205,219,201," ",199,192
001750  cccec2ce
001754  d7cddbc9
001758  20c7c0  
00175b  d0dfc420          DCB      208,223,196,"  ",0
00175f  2000    
001761  00                DCB      0
001762  00                DCB      0
001763  00                DCB      0
                  |L1.5988|
001764  20202020          DCB      "    ",210,211,204,193,203,197,208,192,"!!!     ",0
001768  d2d3ccc1
00176c  cbc5d0c0
001770  21212120
001774  20202020
001778  00      
001779  00                DCB      0
00177a  00                DCB      0
00177b  00                DCB      0
                  |L1.6012|
00177c  20202020          DCB      "    ",212,206,208,204,206,194,206,215,205,219,201,"    "
001780  d4ced0cc
001784  cec2ced7
001788  cddbc920
00178c  202020  
00178f  2000              DCB      " ",0
001791  00                DCB      0
001792  00                DCB      0
001793  00                DCB      0
                  |L1.6036|
                          DCD      ||area_number.25||
                  |L1.6040|
                          DCD      speedChrgBlckStat
                  |L1.6044|
                          DCD      TBAT
                  |L1.6048|
                          DCD      Ib_ips_termokompensat
                  |L1.6052|
                          DCD      bat
                  |L1.6056|
                          DCD      IKB
                  |L1.6060|
                          DCD      BAT_IS_ON
                  |L1.6064|
0017b0  f9b91000          LDRSH    r1,[r9,#0]            ;1646  ; IKB
0017b4  4288              CMP      r0,r1                 ;1646
0017b6  db03              BLT      |L1.6080|
0017b8  f896003d          LDRB     r0,[r6,#0x3d]         ;1646  ; bat
0017bc  07c0              LSLS     r0,r0,#31             ;1646
0017be  d001              BEQ      |L1.6084|
                  |L1.6080|
0017c0  f884b000          STRB     r11,[r4,#0]           ;1646
                  |L1.6084|
0017c4  48ff              LDR      r0,|L1.7108|
0017c6  7840              LDRB     r0,[r0,#1]            ;1647  ; BAT_IS_ON
0017c8  2855              CMP      r0,#0x55              ;1647
0017ca  d111              BNE      |L1.6128|
0017cc  f9b6004e          LDRSH    r0,[r6,#0x4e]         ;1647  ; bat
0017d0  2850              CMP      r0,#0x50              ;1647
0017d2  dd0d              BLE      |L1.6128|
0017d4  f9b60054          LDRSH    r0,[r6,#0x54]         ;1647  ; bat
0017d8  f7fffffe          BL       abs
0017dc  f9b91000          LDRSH    r1,[r9,#0]            ;1647  ; IKB
0017e0  4288              CMP      r0,r1                 ;1647
0017e2  db03              BLT      |L1.6124|
0017e4  f8960089          LDRB     r0,[r6,#0x89]         ;1647  ; bat
0017e8  07c0              LSLS     r0,r0,#31             ;1647
0017ea  d001              BEQ      |L1.6128|
                  |L1.6124|
0017ec  f884b001          STRB     r11,[r4,#1]           ;1647
                  |L1.6128|
0017f0  48f5              LDR      r0,|L1.7112|
0017f2  7800              LDRB     r0,[r0,#0]            ;1649  ; ips_bat_av_vzvod
0017f4  b970              CBNZ     r0,|L1.6164|
0017f6  f9ba0000          LDRSH    r0,[r10,#0]           ;1649  ; Ib_ips_termokompensat
0017fa  f7fffffe          BL       abs
0017fe  f9b91000          LDRSH    r1,[r9,#0]            ;1649  ; IKB
001802  4288              CMP      r0,r1                 ;1649
001804  db04              BLT      |L1.6160|
001806  48f1              LDR      r0,|L1.7116|
001808  f890003d          LDRB     r0,[r0,#0x3d]         ;1649  ; bat_ips
00180c  07c0              LSLS     r0,r0,#31             ;1649
00180e  d001              BEQ      |L1.6164|
                  |L1.6160|
001810  f888b014          STRB     r11,[r8,#0x14]        ;1649
                  |L1.6164|
001814  48ee              LDR      r0,|L1.7120|
001816  7800              LDRB     r0,[r0,#0]            ;1651  ; net_av
001818  b990              CBNZ     r0,|L1.6208|
00181a  f8980015          LDRB     r0,[r8,#0x15]         ;1651  ; num_of_wrks_bps
00181e  e000              B        |L1.6178|
                  |L1.6176|
001820  e01e              B        |L1.6240|
                  |L1.6178|
001822  b168              CBZ      r0,|L1.6208|
001824  f898001a          LDRB     r0,[r8,#0x1a]         ;1651  ; spc_stat
001828  b108              CBZ      r0,|L1.6190|
00182a  2802              CMP      r0,#2                 ;1651
00182c  d108              BNE      |L1.6208|
                  |L1.6190|
00182e  f8980026          LDRB     r0,[r8,#0x26]         ;1652  ; vz1_stat
001832  b928              CBNZ     r0,|L1.6208|
001834  f8980029          LDRB     r0,[r8,#0x29]         ;1652  ; vz2_stat
001838  b910              CBNZ     r0,|L1.6208|
00183a  48e6              LDR      r0,|L1.7124|
00183c  7800              LDRB     r0,[r0,#0]            ;1652  ; sp_ch_stat
00183e  b118              CBZ      r0,|L1.6216|
                  |L1.6208|
001840  7025              STRB     r5,[r4,#0]            ;1655
001842  7065              STRB     r5,[r4,#1]            ;1656
001844  f8885014          STRB     r5,[r8,#0x14]         ;1657
                  |L1.6216|
001848  7820              LDRB     r0,[r4,#0]            ;1660  ; kb_start
00184a  2801              CMP      r0,#1                 ;1660
00184c  d01e              BEQ      |L1.6284|
00184e  7860              LDRB     r0,[r4,#1]            ;1660  ; kb_start
001850  2801              CMP      r0,#1                 ;1660
001852  d01b              BEQ      |L1.6284|
001854  f8980014          LDRB     r0,[r8,#0x14]         ;1660  ; kb_start_ips
001858  2801              CMP      r0,#1                 ;1660
00185a  d017              BEQ      |L1.6284|
;;;1663   		}
;;;1664   	else kb_cnt_1lev=0;
00185c  f8a8504e          STRH     r5,[r8,#0x4e]
                  |L1.6240|
;;;1665   	}
;;;1666   
;;;1667   if(kb_cnt_1lev)
001860  4641              MOV      r1,r8
001862  f9b8004e          LDRSH    r0,[r8,#0x4e]  ; kb_cnt_1lev
;;;1668   	{
;;;1669   	kb_cnt_1lev--;
;;;1670   
;;;1671   	if(kb_cnt_1lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,30,15);
;;;1672   	else if(kb_cnt_1lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,30,15);
;;;1673   
;;;1674   
;;;1675   	if(kb_cnt_1lev==5)
;;;1676   		{
;;;1677   		ibat[0]=abs(bat[0]._Ib);
001866  f8df8370          LDR      r8,|L1.7128|
00186a  2800              CMP      r0,#0                 ;1667
00186c  d07e              BEQ      |L1.6508|
00186e  f1a00001          SUB      r0,r0,#1              ;1669
001872  b200              SXTH     r0,r0                 ;1669
001874  468b              MOV      r11,r1                ;1669
001876  f8a1004e          STRH     r0,[r1,#0x4e]         ;1669
00187a  2805              CMP      r0,#5                 ;1671
00187c  dd09              BLE      |L1.6290|
00187e  230f              MOVS     r3,#0xf               ;1671
001880  221e              MOVS     r2,#0x1e              ;1671
001882  2164              MOVS     r1,#0x64              ;1671
001884  20e1              MOVS     r0,#0xe1              ;1671
001886  f7fffffe          BL       mess_send
00188a  e00a              B        |L1.6306|
                  |L1.6284|
00188c  f8a8704e          STRH     r7,[r8,#0x4e]         ;1662
001890  e7e6              B        |L1.6240|
                  |L1.6290|
001892  2800              CMP      r0,#0                 ;1672
001894  dd05              BLE      |L1.6306|
001896  230f              MOVS     r3,#0xf               ;1672
001898  221e              MOVS     r2,#0x1e              ;1672
00189a  2169              MOVS     r1,#0x69              ;1672
00189c  20e1              MOVS     r0,#0xe1              ;1672
00189e  f7fffffe          BL       mess_send
                  |L1.6306|
0018a2  f8bb004e          LDRH     r0,[r11,#0x4e]        ;1675  ; kb_cnt_1lev
0018a6  2805              CMP      r0,#5                 ;1675
0018a8  d111              BNE      |L1.6350|
0018aa  f9b60008          LDRSH    r0,[r6,#8]  ; bat
0018ae  f7fffffe          BL       abs
0018b2  f8a80000          STRH     r0,[r8,#0]
;;;1678   		ibat[1]=abs(bat[1]._Ib);
0018b6  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
0018ba  f7fffffe          BL       abs
0018be  f8a80002          STRH     r0,[r8,#2]
;;;1679   		ibat_ips=abs(Ib_ips_termokompensat);
0018c2  f9ba0000          LDRSH    r0,[r10,#0]  ; Ib_ips_termokompensat
0018c6  f7fffffe          BL       abs
0018ca  f8ab0054          STRH     r0,[r11,#0x54]
                  |L1.6350|
;;;1680   		}
;;;1681   	
;;;1682   	if(kb_cnt_1lev==0)
0018ce  48c2              LDR      r0,|L1.7128|
0018d0  3890              SUBS     r0,r0,#0x90
0018d2  f8b0004e          LDRH     r0,[r0,#0x4e]  ; kb_cnt_1lev
0018d6  2800              CMP      r0,#0
0018d8  d158              BNE      |L1.6540|
;;;1683   		{
;;;1684   		ibat_[0]=abs(bat[0]._Ib);
0018da  f9b60008          LDRSH    r0,[r6,#8]  ; bat
0018de  f7fffffe          BL       abs
0018e2  f8dfb2f4          LDR      r11,|L1.7128|
0018e6  f10b0b04          ADD      r11,r11,#4
0018ea  f8ab0000          STRH     r0,[r11,#0]
;;;1685   		ibat_[1]=abs(bat[1]._Ib);
0018ee  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
0018f2  f7fffffe          BL       abs
0018f6  f8ab0002          STRH     r0,[r11,#2]
;;;1686   		ibat_ips_=abs(Ib_ips_termokompensat);
0018fa  f9ba0000          LDRSH    r0,[r10,#0]  ; Ib_ips_termokompensat
0018fe  f7fffffe          BL       abs
001902  f1ab0a94          SUB      r10,r11,#0x94
001906  f8aa0056          STRH     r0,[r10,#0x56]
;;;1687   
;;;1688   		kb_cnt_2lev=0;
00190a  f8aa5050          STRH     r5,[r10,#0x50]
;;;1689   
;;;1690   
;;;1691   		if(( (ibat[0]+ibat_[0]) < IKB )&& (kb_start[0]==1))
00190e  f9b80000          LDRSH    r0,[r8,#0]  ; ibat
001912  f9bb1000          LDRSH    r1,[r11,#0]  ; ibat_
001916  4408              ADD      r0,r0,r1
001918  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
00191c  4288              CMP      r0,r1
00191e  da02              BGE      |L1.6438|
001920  7820              LDRB     r0,[r4,#0]  ; kb_start
001922  2801              CMP      r0,#1
001924  d034              BEQ      |L1.6544|
                  |L1.6438|
;;;1692   			{
;;;1693   			kb_cnt_2lev=10;  
;;;1694   			}
;;;1695   		else if(bat[0]._Ub>200)
001926  f9b60002          LDRSH    r0,[r6,#2]  ; bat
00192a  28c8              CMP      r0,#0xc8
00192c  dd04              BLE      |L1.6456|
;;;1696   			{
;;;1697   			kb_start[0]=0;
00192e  7025              STRB     r5,[r4,#0]
;;;1698   			avar_bat_hndl(0,0);
001930  2100              MOVS     r1,#0
001932  4608              MOV      r0,r1
001934  f7fffffe          BL       avar_bat_hndl
                  |L1.6456|
;;;1699   			}
;;;1700   		
;;;1701   		if(( (ibat[1]+ibat_[1]) < IKB ) && (kb_start[1]==1))
001938  f9b80002          LDRSH    r0,[r8,#2]  ; ibat
00193c  f9bb1002          LDRSH    r1,[r11,#2]  ; ibat_
001940  4408              ADD      r0,r0,r1
001942  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
001946  4288              CMP      r0,r1
001948  da02              BGE      |L1.6480|
00194a  7860              LDRB     r0,[r4,#1]  ; kb_start
00194c  2801              CMP      r0,#1
00194e  d022              BEQ      |L1.6550|
                  |L1.6480|
;;;1702   			{
;;;1703   			kb_cnt_2lev=10;     
;;;1704   			}
;;;1705   		else  if(bat[1]._Ub>200)
001950  f9b6004e          LDRSH    r0,[r6,#0x4e]  ; bat
001954  28c8              CMP      r0,#0xc8
001956  dd04              BLE      |L1.6498|
;;;1706   			{
;;;1707   			kb_start[1]=0;
001958  7065              STRB     r5,[r4,#1]
;;;1708   			avar_bat_hndl(1,0);
00195a  2100              MOVS     r1,#0
00195c  2001              MOVS     r0,#1
00195e  f7fffffe          BL       avar_bat_hndl
                  |L1.6498|
;;;1709   			}
;;;1710   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1711   		if(( (ibat_ips+ibat_ips_) < IKB ) && (kb_start_ips==1))
001962  f9ba0054          LDRSH    r0,[r10,#0x54]  ; ibat_ips
001966  f9ba1056          LDRSH    r1,[r10,#0x56]  ; ibat_ips_
00196a  e000              B        |L1.6510|
                  |L1.6508|
00196c  e01c              B        |L1.6568|
                  |L1.6510|
00196e  4408              ADD      r0,r0,r1
001970  f9b91000          LDRSH    r1,[r9,#0]  ; IKB
001974  4288              CMP      r0,r1
001976  da09              BGE      |L1.6540|
001978  f89a0014          LDRB     r0,[r10,#0x14]  ; kb_start_ips
00197c  2801              CMP      r0,#1
00197e  d105              BNE      |L1.6540|
;;;1712   			{
;;;1713   			if(KB_ALGORITM==1)
001980  4896              LDR      r0,|L1.7132|
001982  8800              LDRH     r0,[r0,#0]  ; KB_ALGORITM
001984  2801              CMP      r0,#1
001986  d009              BEQ      |L1.6556|
;;;1714   				{
;;;1715   				avar_bat_ips_hndl(1);
;;;1716   				kb_start_ips=0;
;;;1717   				}
;;;1718   			else
;;;1719   				{
;;;1720   				kb_cnt_2lev=10;     
001988  f8aa7050          STRH     r7,[r10,#0x50]
                  |L1.6540|
;;;1721   				}
;;;1722   			}
;;;1723   #endif
;;;1724   		}	
;;;1725   
;;;1726   
;;;1727   	}
;;;1728   else if(kb_cnt_2lev)
;;;1729   	{
;;;1730   	kb_cnt_2lev--;
;;;1731   
;;;1732   	if(kb_cnt_2lev>5)mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_PLUS,200,15);
;;;1733   	else if(kb_cnt_2lev>0) mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_MINUS,200,15);
;;;1734   
;;;1735   
;;;1736   	if(kb_cnt_2lev==5)
;;;1737   		{
;;;1738   		ibat[0]=abs(bat[0]._Ib);
;;;1739   		ibat[1]=abs(bat[1]._Ib);
;;;1740   		ibat_ips=abs(Ib_ips_termokompensat);
;;;1741   		}
;;;1742   	
;;;1743   	if(kb_cnt_2lev==0)
;;;1744   		{
;;;1745   		ibat_[0]=abs(bat[0]._Ib);
;;;1746   		ibat_[1]=abs(bat[1]._Ib);
;;;1747   		ibat_ips_=abs(Ib_ips_termokompensat);
;;;1748   
;;;1749   		kb_full_ver=0;
;;;1750   
;;;1751   		if(( (ibat[0]+ibat_[0]) < IKB ) && (kb_start[0]==1))
;;;1752   			{
;;;1753   			kb_full_ver=1;  
;;;1754   			}
;;;1755   		else if(bat[0]._Ub>200)			
;;;1756   			{
;;;1757   			kb_start[0]=0;
;;;1758   			avar_bat_hndl(0,0);
;;;1759   			}
;;;1760   
;;;1761   		if(( (ibat[1]+ibat_[1]) < IKB ) && (kb_start[1]==1))
;;;1762   			{
;;;1763   			kb_full_ver=1;     
;;;1764   			}
;;;1765   		else	if(bat[1]._Ub>200)		
;;;1766   			{
;;;1767   			kb_start[1]=0;
;;;1768   			avar_bat_hndl(1,0);
;;;1769   			}
;;;1770   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1771   		if(( (ibat_ips+ibat_ips_) < IKB )  && (kb_start_ips==1))
;;;1772   			{
;;;1773   			if(KB_ALGORITM==2)
;;;1774   				{
;;;1775   				avar_bat_ips_hndl(1);
;;;1776   				kb_start_ips=0;
;;;1777   				}
;;;1778   			else
;;;1779   				{
;;;1780   				kb_full_ver=1;     
;;;1781   				}
;;;1782   			}
;;;1783   #endif
;;;1784   		}	
;;;1785   	}
;;;1786   
;;;1787   else if(kb_full_ver)
;;;1788   	{
;;;1789   	
;;;1790   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_STEP_DOWN,0,15);
;;;1791   
;;;1792   	if( abs(bat[0]._Ib) > IKB ) 
;;;1793   		{
;;;1794   		if(kb_start[0]==1)
;;;1795   			{
;;;1796   			kb_start[0]=0;
;;;1797   			avar_bat_hndl(0,0);
;;;1798   			}
;;;1799   		}
;;;1800   
;;;1801   	if( abs(bat[1]._Ib) > IKB ) 
;;;1802   		{
;;;1803   		if(kb_start[1]==1)
;;;1804   			{
;;;1805   			kb_start[1]=0;
;;;1806   			avar_bat_hndl(1,0);
;;;1807   			}
;;;1808   		}
;;;1809   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1810   	if( abs(Ib_ips_termokompensat) > IKB ) 
;;;1811   		{
;;;1812   		if(kb_start_ips==1)
;;;1813   			{
;;;1814   			kb_start_ips=0;
;;;1815   			avar_bat_ips_hndl(0);
;;;1816   			}
;;;1817   		}
;;;1818   #endif
;;;1819   
;;;1820   	if ((kb_start[0]==0) && (kb_start[1]==0) && (kb_start_ips==0)) 
;;;1821   		{
;;;1822   		kb_full_ver=0;
;;;1823   		}
;;;1824   
;;;1825   	if(( (mess_find(MESS2KB_HNDL))	&& (mess_data[0]==PARAM_CNTRL_IS_DOWN) ) || (load_U<(USIGN*10)) )
;;;1826   		{
;;;1827   		kb_full_ver=0;
;;;1828   		if((kb_start[0]==1)&&((load_I>(2*IKB)/10))&&(!(bat[0]._av&0x01))) avar_bat_hndl(0,1);
;;;1829   		if((kb_start[1]==1)&&((load_I>(2*IKB)/10))&&(!(bat[1]._av&0x01))) avar_bat_hndl(1,1);
;;;1830   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;1831   		if((kb_start_ips==1)&&((load_I>(2*IKB)/10))&&(!(bat_ips._av&0x01))) avar_bat_ips_hndl(1);
;;;1832   #endif
;;;1833   		}
;;;1834   	}
;;;1835   
;;;1836   }
00198c  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.6544|
001990  f8aa7050          STRH     r7,[r10,#0x50]        ;1693
001994  e7d0              B        |L1.6456|
                  |L1.6550|
001996  f8aa7050          STRH     r7,[r10,#0x50]        ;1703
00199a  e7e2              B        |L1.6498|
                  |L1.6556|
00199c  2001              MOVS     r0,#1                 ;1715
00199e  f7fffffe          BL       avar_bat_ips_hndl
0019a2  f88a5014          STRB     r5,[r10,#0x14]        ;1716
                  |L1.6566|
0019a6  e7f1              B        |L1.6540|
                  |L1.6568|
0019a8  f9b10050          LDRSH    r0,[r1,#0x50]         ;1728  ; kb_cnt_2lev
0019ac  b3f0              CBZ      r0,|L1.6700|
0019ae  f1a00001          SUB      r0,r0,#1              ;1730
0019b2  b200              SXTH     r0,r0                 ;1730
0019b4  460f              MOV      r7,r1                 ;1730
0019b6  f8a10050          STRH     r0,[r1,#0x50]         ;1730
0019ba  2805              CMP      r0,#5                 ;1732
0019bc  dd06              BLE      |L1.6604|
0019be  230f              MOVS     r3,#0xf               ;1732
0019c0  22c8              MOVS     r2,#0xc8              ;1732
0019c2  2164              MOVS     r1,#0x64              ;1732
0019c4  20e1              MOVS     r0,#0xe1              ;1732
0019c6  f7fffffe          BL       mess_send
0019ca  e007              B        |L1.6620|
                  |L1.6604|
0019cc  2800              CMP      r0,#0                 ;1733
0019ce  dd05              BLE      |L1.6620|
0019d0  230f              MOVS     r3,#0xf               ;1733
0019d2  22c8              MOVS     r2,#0xc8              ;1733
0019d4  2169              MOVS     r1,#0x69              ;1733
0019d6  20e1              MOVS     r0,#0xe1              ;1733
0019d8  f7fffffe          BL       mess_send
                  |L1.6620|
0019dc  f8b70050          LDRH     r0,[r7,#0x50]         ;1736  ; kb_cnt_2lev
0019e0  2805              CMP      r0,#5                 ;1736
0019e2  d111              BNE      |L1.6664|
0019e4  f9b60008          LDRSH    r0,[r6,#8]            ;1738  ; bat
0019e8  f7fffffe          BL       abs
0019ec  f8a80000          STRH     r0,[r8,#0]            ;1738
0019f0  f9b60054          LDRSH    r0,[r6,#0x54]         ;1739  ; bat
0019f4  f7fffffe          BL       abs
0019f8  f8a80002          STRH     r0,[r8,#2]            ;1739
0019fc  f9ba0000          LDRSH    r0,[r10,#0]           ;1740  ; Ib_ips_termokompensat
001a00  f7fffffe          BL       abs
001a04  f8a70054          STRH     r0,[r7,#0x54]         ;1740
                  |L1.6664|
001a08  4873              LDR      r0,|L1.7128|
001a0a  3890              SUBS     r0,r0,#0x90           ;1743
001a0c  f8b00050          LDRH     r0,[r0,#0x50]         ;1743  ; kb_cnt_2lev
001a10  2800              CMP      r0,#0                 ;1743
                  |L1.6674|
001a12  d1bb              BNE      |L1.6540|
001a14  f9b60008          LDRSH    r0,[r6,#8]            ;1745  ; bat
001a18  f7fffffe          BL       abs
001a1c  4f6e              LDR      r7,|L1.7128|
001a1e  1d3f              ADDS     r7,r7,#4              ;1745
001a20  8038              STRH     r0,[r7,#0]            ;1745
001a22  f9b60054          LDRSH    r0,[r6,#0x54]         ;1746  ; bat
001a26  f7fffffe          BL       abs
001a2a  e000              B        |L1.6702|
                  |L1.6700|
001a2c  e055              B        |L1.6874|
                  |L1.6702|
001a2e  8078              STRH     r0,[r7,#2]            ;1746
001a30  f9ba0000          LDRSH    r0,[r10,#0]           ;1747  ; Ib_ips_termokompensat
001a34  f7fffffe          BL       abs
001a38  f1a70a94          SUB      r10,r7,#0x94          ;1747
001a3c  f8aa0056          STRH     r0,[r10,#0x56]        ;1747
001a40  f88a5013          STRB     r5,[r10,#0x13]        ;1749
001a44  f9b80000          LDRSH    r0,[r8,#0]            ;1751  ; ibat
001a48  f9b71000          LDRSH    r1,[r7,#0]            ;1751  ; ibat_
001a4c  4408              ADD      r0,r0,r1              ;1751
001a4e  f9b91000          LDRSH    r1,[r9,#0]            ;1751  ; IKB
001a52  4288              CMP      r0,r1                 ;1751
001a54  da02              BGE      |L1.6748|
001a56  7820              LDRB     r0,[r4,#0]            ;1751  ; kb_start
001a58  2801              CMP      r0,#1                 ;1751
001a5a  d032              BEQ      |L1.6850|
                  |L1.6748|
001a5c  f9b60002          LDRSH    r0,[r6,#2]            ;1755  ; bat
001a60  28c8              CMP      r0,#0xc8              ;1755
001a62  dd04              BLE      |L1.6766|
001a64  7025              STRB     r5,[r4,#0]            ;1757
001a66  2100              MOVS     r1,#0                 ;1758
001a68  4608              MOV      r0,r1                 ;1758
001a6a  f7fffffe          BL       avar_bat_hndl
                  |L1.6766|
001a6e  f9b80002          LDRSH    r0,[r8,#2]            ;1761  ; ibat
001a72  f9b71002          LDRSH    r1,[r7,#2]            ;1761  ; ibat_
001a76  4408              ADD      r0,r0,r1              ;1761
001a78  f9b91000          LDRSH    r1,[r9,#0]            ;1761  ; IKB
001a7c  4288              CMP      r0,r1                 ;1761
001a7e  da02              BGE      |L1.6790|
001a80  7860              LDRB     r0,[r4,#1]            ;1761  ; kb_start
001a82  2801              CMP      r0,#1                 ;1761
001a84  d020              BEQ      |L1.6856|
                  |L1.6790|
001a86  f9b6004e          LDRSH    r0,[r6,#0x4e]         ;1765  ; bat
001a8a  28c8              CMP      r0,#0xc8              ;1765
001a8c  dd04              BLE      |L1.6808|
001a8e  7065              STRB     r5,[r4,#1]            ;1767
001a90  2100              MOVS     r1,#0                 ;1768
001a92  2001              MOVS     r0,#1                 ;1768
001a94  f7fffffe          BL       avar_bat_hndl
                  |L1.6808|
001a98  f9ba0054          LDRSH    r0,[r10,#0x54]        ;1771  ; ibat_ips
001a9c  f9ba1056          LDRSH    r1,[r10,#0x56]        ;1771  ; ibat_ips_
001aa0  4408              ADD      r0,r0,r1              ;1771
001aa2  f9b91000          LDRSH    r1,[r9,#0]            ;1771  ; IKB
001aa6  4288              CMP      r0,r1                 ;1771
001aa8  f6bfaf7d          BGE      |L1.6566|
001aac  f89a0014          LDRB     r0,[r10,#0x14]        ;1771  ; kb_start_ips
001ab0  2801              CMP      r0,#1                 ;1771
001ab2  d1ae              BNE      |L1.6674|
001ab4  4849              LDR      r0,|L1.7132|
001ab6  8800              LDRH     r0,[r0,#0]            ;1773  ; KB_ALGORITM
001ab8  2802              CMP      r0,#2                 ;1773
001aba  d008              BEQ      |L1.6862|
001abc  f88ab013          STRB     r11,[r10,#0x13]       ;1780
                  |L1.6848|
001ac0  e764              B        |L1.6540|
                  |L1.6850|
001ac2  f88ab013          STRB     r11,[r10,#0x13]       ;1753
001ac6  e7d2              B        |L1.6766|
                  |L1.6856|
001ac8  f88ab013          STRB     r11,[r10,#0x13]       ;1763
001acc  e7e4              B        |L1.6808|
                  |L1.6862|
001ace  2001              MOVS     r0,#1                 ;1775
001ad0  f7fffffe          BL       avar_bat_ips_hndl
001ad4  f88a5014          STRB     r5,[r10,#0x14]        ;1776
001ad8  e758              B        |L1.6540|
                  |L1.6874|
001ada  7cc8              LDRB     r0,[r1,#0x13]         ;1787  ; kb_full_ver
001adc  4688              MOV      r8,r1                 ;1787
001ade  2800              CMP      r0,#0                 ;1787
001ae0  d0ee              BEQ      |L1.6848|
001ae2  230f              MOVS     r3,#0xf               ;1790
001ae4  2200              MOVS     r2,#0                 ;1790
001ae6  216e              MOVS     r1,#0x6e              ;1790
001ae8  20e1              MOVS     r0,#0xe1              ;1790
001aea  f7fffffe          BL       mess_send
001aee  f9b60008          LDRSH    r0,[r6,#8]            ;1792  ; bat
001af2  f7fffffe          BL       abs
001af6  f9b91000          LDRSH    r1,[r9,#0]            ;1792  ; IKB
001afa  4288              CMP      r0,r1                 ;1792
001afc  dd07              BLE      |L1.6926|
001afe  7820              LDRB     r0,[r4,#0]            ;1794  ; kb_start
001b00  2801              CMP      r0,#1                 ;1794
001b02  d104              BNE      |L1.6926|
001b04  7025              STRB     r5,[r4,#0]            ;1796
001b06  2100              MOVS     r1,#0                 ;1797
001b08  4608              MOV      r0,r1                 ;1797
001b0a  f7fffffe          BL       avar_bat_hndl
                  |L1.6926|
001b0e  f9b60054          LDRSH    r0,[r6,#0x54]         ;1801  ; bat
001b12  f7fffffe          BL       abs
001b16  f9b91000          LDRSH    r1,[r9,#0]            ;1801  ; IKB
001b1a  4288              CMP      r0,r1                 ;1801
001b1c  dd06              BLE      |L1.6956|
001b1e  7860              LDRB     r0,[r4,#1]            ;1803  ; kb_start
001b20  2801              CMP      r0,#1                 ;1803
001b22  d103              BNE      |L1.6956|
001b24  7065              STRB     r5,[r4,#1]            ;1805
001b26  2100              MOVS     r1,#0                 ;1806
001b28  f7fffffe          BL       avar_bat_hndl
                  |L1.6956|
001b2c  f9ba0000          LDRSH    r0,[r10,#0]           ;1810  ; Ib_ips_termokompensat
001b30  f7fffffe          BL       abs
001b34  f9b91000          LDRSH    r1,[r9,#0]            ;1810  ; IKB
001b38  4288              CMP      r0,r1                 ;1810
001b3a  dd08              BLE      |L1.6990|
001b3c  f8980014          LDRB     r0,[r8,#0x14]         ;1812  ; kb_start_ips
001b40  2801              CMP      r0,#1                 ;1812
001b42  d104              BNE      |L1.6990|
001b44  f8885014          STRB     r5,[r8,#0x14]         ;1814
001b48  2000              MOVS     r0,#0                 ;1815
001b4a  f7fffffe          BL       avar_bat_ips_hndl
                  |L1.6990|
001b4e  7820              LDRB     r0,[r4,#0]            ;1820  ; kb_start
001b50  b930              CBNZ     r0,|L1.7008|
001b52  7860              LDRB     r0,[r4,#1]            ;1820  ; kb_start
001b54  b920              CBNZ     r0,|L1.7008|
001b56  f8980014          LDRB     r0,[r8,#0x14]         ;1820  ; kb_start_ips
001b5a  b908              CBNZ     r0,|L1.7008|
001b5c  f8885013          STRB     r5,[r8,#0x13]         ;1822
                  |L1.7008|
001b60  20e6              MOVS     r0,#0xe6              ;1825
001b62  f7fffffe          BL       mess_find
001b66  b118              CBZ      r0,|L1.7024|
001b68  481d              LDR      r0,|L1.7136|
001b6a  6800              LDR      r0,[r0,#0]            ;1825  ; mess_data
001b6c  28e7              CMP      r0,#0xe7              ;1825
001b6e  d00a              BEQ      |L1.7046|
                  |L1.7024|
001b70  481c              LDR      r0,|L1.7140|
001b72  491d              LDR      r1,|L1.7144|
001b74  f9b00000          LDRSH    r0,[r0,#0]            ;1825  ; USIGN
001b78  f9b11000          LDRSH    r1,[r1,#0]            ;1825  ; load_U
001b7c  eb000080          ADD      r0,r0,r0,LSL #2       ;1825
001b80  ebb10f40          CMP      r1,r0,LSL #1          ;1825
                  |L1.7044|
001b84  da9c              BGE      |L1.6848|
                  |L1.7046|
001b86  f8885013          STRB     r5,[r8,#0x13]         ;1827
001b8a  7820              LDRB     r0,[r4,#0]            ;1828  ; kb_start
001b8c  4d17              LDR      r5,|L1.7148|
001b8e  2801              CMP      r0,#1                 ;1828
001b90  d10f              BNE      |L1.7090|
001b92  f9b90000          LDRSH    r0,[r9,#0]            ;1828  ; IKB
001b96  0040              LSLS     r0,r0,#1              ;1828
001b98  fb90f1f7          SDIV     r1,r0,r7              ;1828
001b9c  f9b50000          LDRSH    r0,[r5,#0]            ;1828  ; load_I
001ba0  4281              CMP      r1,r0                 ;1828
001ba2  da06              BGE      |L1.7090|
001ba4  f896003d          LDRB     r0,[r6,#0x3d]         ;1828  ; bat
001ba8  07c0              LSLS     r0,r0,#31             ;1828
001baa  d102              BNE      |L1.7090|
001bac  2101              MOVS     r1,#1                 ;1828
001bae  f7fffffe          BL       avar_bat_hndl
                  |L1.7090|
001bb2  7860              LDRB     r0,[r4,#1]            ;1829  ; kb_start
001bb4  2801              CMP      r0,#1                 ;1829
001bb6  d127              BNE      |L1.7176|
001bb8  f9b90000          LDRSH    r0,[r9,#0]            ;1829  ; IKB
001bbc  0040              LSLS     r0,r0,#1              ;1829
001bbe  fb90f0f7          SDIV     r0,r0,r7              ;1829
001bc2  e015              B        |L1.7152|
                  |L1.7108|
                          DCD      BAT_IS_ON
                  |L1.7112|
                          DCD      ips_bat_av_vzvod
                  |L1.7116|
                          DCD      bat_ips
                  |L1.7120|
                          DCD      net_av
                  |L1.7124|
                          DCD      sp_ch_stat
                  |L1.7128|
                          DCD      ||area_number.25||+0x90
                  |L1.7132|
                          DCD      KB_ALGORITM
                  |L1.7136|
                          DCD      mess_data
                  |L1.7140|
                          DCD      USIGN
                  |L1.7144|
                          DCD      load_U
                  |L1.7148|
                          DCD      load_I
                  |L1.7152|
001bf0  f9b51000          LDRSH    r1,[r5,#0]            ;1829  ; load_I
001bf4  4288              CMP      r0,r1                 ;1829
001bf6  da07              BGE      |L1.7176|
001bf8  f8960089          LDRB     r0,[r6,#0x89]         ;1829  ; bat
001bfc  07c0              LSLS     r0,r0,#31             ;1829
001bfe  d103              BNE      |L1.7176|
001c00  2101              MOVS     r1,#1                 ;1829
001c02  4608              MOV      r0,r1                 ;1829
001c04  f7fffffe          BL       avar_bat_hndl
                  |L1.7176|
001c08  f8980014          LDRB     r0,[r8,#0x14]         ;1831  ; kb_start_ips
001c0c  2801              CMP      r0,#1                 ;1831
                  |L1.7182|
001c0e  f47faeca          BNE      |L1.6566|
001c12  f9b90000          LDRSH    r0,[r9,#0]            ;1831  ; IKB
001c16  f9b51000          LDRSH    r1,[r5,#0]            ;1831  ; load_I
001c1a  0040              LSLS     r0,r0,#1              ;1831
001c1c  fb90f0f7          SDIV     r0,r0,r7              ;1831
001c20  4288              CMP      r0,r1                 ;1831
001c22  daaf              BGE      |L1.7044|
001c24  48ff              LDR      r0,|L1.8228|
001c26  f890003d          LDRB     r0,[r0,#0x3d]         ;1831  ; bat_ips
001c2a  07c0              LSLS     r0,r0,#31             ;1831
001c2c  d1ef              BNE      |L1.7182|
001c2e  e8bd5ff0          POP      {r4-r12,lr}           ;1831
001c32  2001              MOVS     r0,#1                 ;1831
001c34  f7ffbffe          B.W      avar_bat_ips_hndl
;;;1837   
                          ENDP

                  samokalibr_hndl PROC
;;;1846   //-----------------------------------------------
;;;1847   void samokalibr_hndl(void)
001c38  4770              BX       lr
;;;1848   {
;;;1849   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;1850   if(++samokalibr_cnt>=1800)samokalibr_cnt=0;
;;;1851   
;;;1852   if((samokalibr_cnt>=1785U)&&(vz2_stat==vz2sOFF))
;;;1853   	{
;;;1854   	mess_send(MESS2RELE_HNDL,PARAM_RELE_SAMOKALIBR,1,15);
;;;1855   	mess_send(MESS2IND_HNDL,PARAM_SAMOKALIBR,0,15);
;;;1856   	mess_send(MESS2MATEMAT,PARAM_SAMOKALIBR,0,15);
;;;1857   	} 
;;;1858   
;;;1859   if((samokalibr_cnt==1799U)&&(vz2_stat==vz2sOFF))
;;;1860   	{
;;;1861   	if((Kibat0[0]!=ad7705_buff_[0])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[0],ad7705_buff_[0]);
;;;1862   	if((Kibat0[1]!=ad7705_buff_[1])&&(abs(bat[0]._Ib/10)<IZMAX)) lc640_write_int(ADR_KI0BAT[1],ad7705_buff_[1]);
;;;1863   	
;;;1864   	}
;;;1865   #endif	 	
;;;1866   }
;;;1867   
                          ENDP

                  ubat_old_drv PROC
;;;1870   //-----------------------------------------------
;;;1871   void ubat_old_drv(void)
001c3a  b510              PUSH     {r4,lr}
;;;1872   {        
;;;1873   bat_u_old_cnt++;
001c3c  4cfa              LDR      r4,|L1.8232|
001c3e  8820              LDRH     r0,[r4,#0]  ; bat_u_old_cnt
001c40  f1000001          ADD      r0,r0,#1
001c44  8020              STRH     r0,[r4,#0]
;;;1874   gran_ring(&bat_u_old_cnt,0,8);
001c46  f04f0208          MOV      r2,#8
001c4a  f04f0100          MOV      r1,#0
001c4e  4620              MOV      r0,r4
001c50  f7fffffe          BL       gran_ring
;;;1875   
;;;1876   bat[0]._u_old[bat_u_old_cnt]=bat[0]._Ub;
001c54  49f5              LDR      r1,|L1.8236|
001c56  f9b40000          LDRSH    r0,[r4,#0]  ; bat_u_old_cnt
001c5a  eb010040          ADD      r0,r1,r0,LSL #1
001c5e  884a              LDRH     r2,[r1,#2]  ; bat
001c60  8402              STRH     r2,[r0,#0x20]
;;;1877   bat[1]._u_old[bat_u_old_cnt]=bat[1]._Ub;
001c62  f8b1104e          LDRH     r1,[r1,#0x4e]  ; bat
001c66  f8a0106c          STRH     r1,[r0,#0x6c]
;;;1878   }
001c6a  bd10              POP      {r4,pc}
;;;1879   
                          ENDP

                  unet_drv PROC
;;;1880   //-----------------------------------------------
;;;1881   void unet_drv(void)
001c6c  b570              PUSH     {r4-r6,lr}
;;;1882   {
;;;1883   if(net_U<UMN)
001c6e  4df0              LDR      r5,|L1.8240|
001c70  48f0              LDR      r0,|L1.8244|
;;;1884   	{
;;;1885   	if((unet_drv_cnt<10)&&(main_1Hz_cnt>15))
001c72  4af1              LDR      r2,|L1.8248|
001c74  f9b51000          LDRSH    r1,[r5,#0]            ;1883  ; net_U
001c78  f9b03000          LDRSH    r3,[r0,#0]            ;1883  ; UMN
001c7c  f9920000          LDRSB    r0,[r2,#0]
001c80  4299              CMP      r1,r3                 ;1883
001c82  da1f              BGE      |L1.7364|
;;;1886   		{
;;;1887   		unet_drv_cnt++;
;;;1888   		if(unet_drv_cnt>=10)
;;;1889   			{
;;;1890   			net_Ustore=net_U;
001c84  4ced              LDR      r4,|L1.8252|
001c86  280a              CMP      r0,#0xa               ;1885
001c88  da0f              BGE      |L1.7338|
001c8a  4bed              LDR      r3,|L1.8256|
001c8c  f9b33000          LDRSH    r3,[r3,#0]            ;1885  ; main_1Hz_cnt
001c90  2b0f              CMP      r3,#0xf               ;1885
001c92  dd0a              BLE      |L1.7338|
001c94  f1000001          ADD      r0,r0,#1              ;1887
001c98  b240              SXTB     r0,r0                 ;1887
001c9a  7010              STRB     r0,[r2,#0]            ;1887
001c9c  280a              CMP      r0,#0xa               ;1888
001c9e  db09              BLT      |L1.7348|
001ca0  8021              STRH     r1,[r4,#0]
;;;1891   		 	avar_unet_hndl(1);
001ca2  2001              MOVS     r0,#1
001ca4  f7fffffe          BL       avar_unet_hndl
001ca8  e004              B        |L1.7348|
                  |L1.7338|
;;;1892   			
;;;1893   			}
;;;1894   		}
;;;1895   	else if(unet_drv_cnt>=10)unet_drv_cnt=10;
001caa  280a              CMP      r0,#0xa
001cac  db02              BLT      |L1.7348|
001cae  f04f000a          MOV      r0,#0xa
001cb2  7010              STRB     r0,[r2,#0]
                  |L1.7348|
;;;1896   
;;;1897   	if(net_U<net_Ustore) net_Ustore=net_U;	
001cb4  f9b50000          LDRSH    r0,[r5,#0]  ; net_U
001cb8  f9b41000          LDRSH    r1,[r4,#0]  ; net_Ustore
001cbc  4288              CMP      r0,r1
001cbe  da00              BGE      |L1.7362|
001cc0  8020              STRH     r0,[r4,#0]
                  |L1.7362|
;;;1898   	}
;;;1899   
;;;1900   else if(net_U>UMN)
;;;1901   	{                 
;;;1902   	if(unet_drv_cnt)
;;;1903   		{
;;;1904   		unet_drv_cnt--;
;;;1905   		if(unet_drv_cnt<=0)
;;;1906   			{
;;;1907   			avar_unet_hndl(0);
;;;1908   			}
;;;1909   		}
;;;1910   	else if(unet_drv_cnt<0)unet_drv_cnt=0;
;;;1911   	
;;;1912   	}
;;;1913   
;;;1914   }
001cc2  bd70              POP      {r4-r6,pc}
                  |L1.7364|
001cc4  ddfd              BLE      |L1.7362|
001cc6  2800              CMP      r0,#0                 ;1902
001cc8  d0fb              BEQ      |L1.7362|
001cca  f1a00001          SUB      r0,r0,#1              ;1904
001cce  b240              SXTB     r0,r0                 ;1904
001cd0  7010              STRB     r0,[r2,#0]            ;1904
001cd2  2800              CMP      r0,#0                 ;1905
001cd4  dcf5              BGT      |L1.7362|
001cd6  e8bd4070          POP      {r4-r6,lr}            ;1907
001cda  2000              MOVS     r0,#0                 ;1907
001cdc  f7ffbffe          B.W      avar_unet_hndl
;;;1915   
                          ENDP

                  matemat PROC
;;;1916   //-----------------------------------------------
;;;1917   void matemat(void)
001ce0  e92d4ff0          PUSH     {r4-r11,lr}
;;;1918   {
001ce4  b087              SUB      sp,sp,#0x1c
;;;1919   //signed short temp_SS;
;;;1920   signed long temp_SL/*,temp_SL_*/;
;;;1921   char /*temp,*/i;
;;;1922   //signed short temp_SS;
;;;1923   
;;;1924   #ifdef UKU_MGTS
;;;1925   //напряжение сети
;;;1926   temp_SL=(signed long)net_buff_;
;;;1927   temp_SL*=Kunet;
;;;1928   temp_SL/=110000L;
;;;1929   net_U=(signed short)temp_SL;
;;;1930   #endif
;;;1931   
;;;1932   #ifdef UKU_RSTKM
;;;1933   //напряжение сети
;;;1934   temp_SL=(signed long)net_buff_;
;;;1935   temp_SL*=Kunet;
;;;1936   temp_SL/=110000L;
;;;1937   net_U=(signed short)temp_SL;
;;;1938   #endif
;;;1939   
;;;1940   #ifdef UKU_3U
;;;1941   //напряжение сети
;;;1942   temp_SL=(signed long)net_buff_;
;;;1943   temp_SL*=Kunet;
;;;1944   temp_SL/=36000L;
;;;1945   net_U=(signed short)temp_SL;
;;;1946   #endif
;;;1947   
;;;1948   #ifdef UKU_6U
;;;1949   //напряжение сети
;;;1950   
;;;1951   if((AUSW_MAIN%10)||(AUSW_MAIN==2400)||(AUSW_MAIN==4800)||(AUSW_MAIN==6000))
;;;1952   	{
;;;1953   
;;;1954   	if(bps[11]._device==dNET_METR)
;;;1955   		{
;;;1956   		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;1957   		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;1958   		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;1959   
;;;1960   		temp_SL=(signed long)net_metr_buff_[0];
;;;1961   		temp_SL*=KunetA;
;;;1962   		temp_SL/=6000L;
;;;1963   		net_Ua=(signed short)temp_SL;
;;;1964   	
;;;1965   		temp_SL=(signed long)net_metr_buff_[1];
;;;1966   		temp_SL*=KunetB;
;;;1967   		temp_SL/=6000L;
;;;1968   		net_Ub=(signed short)temp_SL;
;;;1969   	
;;;1970   		temp_SL=(signed long)net_metr_buff_[2];
;;;1971   		temp_SL*=KunetC;
;;;1972   		temp_SL/=6000L;
;;;1973   		net_Uc=(signed short)temp_SL;
;;;1974   		}
;;;1975   	else
;;;1976   		{
;;;1977   		temp_SL=(signed long)net_buff_;
;;;1978   		temp_SL*=KunetA;
;;;1979   		temp_SL/=110000L;
;;;1980   		net_Ua=(signed short)temp_SL;
;;;1981   	
;;;1982   		temp_SL=(signed long)adc_buff_[3];
;;;1983   		temp_SL*=KunetB;
;;;1984   		temp_SL/=6000L;
;;;1985   		net_Ub=(signed short)temp_SL;
;;;1986   	
;;;1987   		temp_SL=(signed long)adc_buff_[10];
;;;1988   		temp_SL*=KunetC;
;;;1989   		temp_SL/=6000L;
;;;1990   		net_Uc=(signed short)temp_SL;
;;;1991   		}
;;;1992   
;;;1993   	net_U=net_Ua;
;;;1994   	if(net_Ub<net_U)net_U=net_Ub;
;;;1995   	if(net_Uc<net_U)net_U=net_Uc;
;;;1996   	}
;;;1997   else 
;;;1998   	{
;;;1999   	temp_SL=(signed long)net_buff_;
;;;2000   	temp_SL*=Kunet;
;;;2001   	temp_SL/=110000L;
;;;2002   	net_U=(signed short)temp_SL;
;;;2003   	}
;;;2004   
;;;2005   
;;;2006   
;;;2007   
;;;2008   #endif
;;;2009   
;;;2010   #ifdef UKU_GLONASS
;;;2011   //напряжение сети
;;;2012   temp_SL=(signed long)net_buff_;
;;;2013   temp_SL*=Kunet;
;;;2014   temp_SL/=110000L;
;;;2015   net_U=(signed short)temp_SL;
;;;2016   #endif
;;;2017   
;;;2018   #ifdef UKU_KONTUR
;;;2019   //напряжение сети
;;;2020   temp_SL=(signed long)net_buff_;
;;;2021   temp_SL*=Kunet;
;;;2022   temp_SL/=110000L;
;;;2023   net_U=(signed short)temp_SL;
;;;2024   #endif
;;;2025   
;;;2026   #ifdef IPS_SGEP_GAZPROM
;;;2027   //напряжение сети
;;;2028   temp_SL=(signed long)net_buff_;
;;;2029   temp_SL*=Kunet;
;;;2030   temp_SL/=110000L;
;;;2031   net_U=(signed short)temp_SL;
;;;2032   #endif
;;;2033   
;;;2034   #ifdef UKU_220_V2
;;;2035   //напряжение сети
;;;2036   
;;;2037   if(AUSW_MAIN==22033)
;;;2038   	{
;;;2039   	temp_SL=(signed long)net_buff_;
;;;2040   	temp_SL*=KunetA;
;;;2041   	temp_SL/=6000L;
;;;2042   	net_Ua=(signed short)temp_SL;
;;;2043   
;;;2044   	temp_SL=(signed long)adc_buff_[3];
;;;2045   	temp_SL*=KunetB;
;;;2046   	temp_SL/=6000L;
;;;2047   	net_Ub=(signed short)temp_SL;
;;;2048   
;;;2049   	temp_SL=(signed long)adc_buff_[10];
;;;2050   	temp_SL*=KunetC;
;;;2051   	temp_SL/=6000L;
;;;2052   	net_Uc=(signed short)temp_SL;
;;;2053   
;;;2054   	net_U=net_Ua;
;;;2055   	if(net_Ub<net_U)net_U=net_Ub;
;;;2056   	if(net_Uc<net_U)net_U=net_Uc;
;;;2057   	}
;;;2058   else
;;;2059   	{
;;;2060   	temp_SL=(signed long)net_buff_;
;;;2061   	temp_SL*=Kunet;
;;;2062   	temp_SL/=5000L;
;;;2063   	net_U=(signed short)temp_SL;
;;;2064   	}
;;;2065   #endif
;;;2066   
;;;2067   
;;;2068   #ifdef UKU_220
;;;2069   //напряжение сети
;;;2070   
;;;2071   if(AUSW_MAIN==22035)
;;;2072   	{
;;;2073   	temp_SL=(signed long)net_buff_;
;;;2074   	temp_SL*=KunetA;
;;;2075   	temp_SL/=6000L;
;;;2076   	net_Ua=(signed short)temp_SL;
;;;2077   
;;;2078   	temp_SL=(signed long)adc_buff_[3];
;;;2079   	temp_SL*=KunetB;
;;;2080   	temp_SL/=6000L;
;;;2081   	net_Ub=(signed short)temp_SL;
;;;2082   
;;;2083   	temp_SL=(signed long)adc_buff_[10];
;;;2084   	temp_SL*=KunetC;
;;;2085   	temp_SL/=6000L;
;;;2086   	net_Uc=(signed short)temp_SL;
;;;2087   
;;;2088   	net_U=net_Ua;
;;;2089   	if(net_Ub<net_U)net_U=net_Ub;
;;;2090   	if(net_Uc<net_U)net_U=net_Uc;
;;;2091   	}
;;;2092   else
;;;2093   	{
;;;2094   	temp_SL=(signed long)net_buff_;
;;;2095   	temp_SL*=Kunet;
;;;2096   	#ifdef _ACDC_
;;;2097   	temp_SL/=500L;
;;;2098   	#else
;;;2099   	temp_SL/=5000L;
;;;2100   	#endif
;;;2101   	net_U=(signed short)temp_SL;
;;;2102   	
;;;2103   	}
;;;2104   #endif
;;;2105   
;;;2106   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2107   //напряжение сети
;;;2108   
;;;2109   
;;;2110   	if(bps[11]._device==dNET_METR)
001ce6  48d7              LDR      r0,|L1.8260|
;;;2111   		{
;;;2112   		net_metr_buff_[0]=((signed short)bps[11]._buff[0])+(((signed short)bps[11]._buff[1])<<8);
;;;2113   		net_metr_buff_[1]=((signed short)bps[11]._buff[2])+(((signed short)bps[11]._buff[3])<<8);
;;;2114   		net_metr_buff_[2]=((signed short)bps[11]._buff[4])+(((signed short)bps[11]._buff[5])<<8);
;;;2115   
;;;2116   		temp_SL=(signed long)net_metr_buff_[2];
;;;2117   		temp_SL*=KunetA;
001ce8  4bd7              LDR      r3,|L1.8264|
;;;2118   		temp_SL/=6000L;
;;;2119   		net_Ua=(signed short)temp_SL;
;;;2120   	
;;;2121   		temp_SL=(signed long)net_metr_buff_[1];
;;;2122   		temp_SL*=KunetB;
001cea  49d9              LDR      r1,|L1.8272|
001cec  f89003f4          LDRB     r0,[r0,#0x3f4]        ;2110  ; bps
;;;2123   		temp_SL/=6000L;
;;;2124   		net_Ub=(signed short)temp_SL;
;;;2125   	
;;;2126   		temp_SL=(signed long)net_metr_buff_[0];
;;;2127   		temp_SL*=KunetC;
001cf0  4ad8              LDR      r2,|L1.8276|
001cf2  9006              STR      r0,[sp,#0x18]         ;2117
001cf4  f8dfc354          LDR      r12,|L1.8268|
001cf8  f9b39000          LDRSH    r9,[r3,#0]            ;2117
001cfc  f9b1b000          LDRSH    r11,[r1,#0]           ;2122
001d00  f9b2a000          LDRSH    r10,[r2,#0]
001d04  4fd4              LDR      r7,|L1.8280|
;;;2128   		temp_SL/=6000L;
;;;2129   		net_Uc=(signed short)temp_SL;
001d06  4cd5              LDR      r4,|L1.8284|
;;;2130   
;;;2131   		net_F3=((signed short)bps[11]._buff[6])+(((signed short)bps[11]._buff[7])<<8);
;;;2132   
;;;2133   		net_U=net_Ua;
;;;2134   		if(net_Ub<net_U)net_U=net_Ub;
;;;2135   		if(net_Uc<net_U)net_U=net_Uc;
;;;2136   		}
;;;2137   	  else if(AUSW_MAIN==22033)
;;;2138   	{
;;;2139   	temp_SL=(signed long)net_buff_;
001d08  4ed5              LDR      r6,|L1.8288|
001d0a  f2456511          MOV      r5,#0x5611            ;2137
001d0e  2807              CMP      r0,#7                 ;2110
001d10  d036              BEQ      |L1.7552|
001d12  4631              MOV      r1,r6
001d14  f8df8338          LDR      r8,|L1.8272|
001d18  8e8a              LDRH     r2,[r1,#0x34]
001d1a  4619              MOV      r1,r3                 ;2117
;;;2140   	temp_SL*=KunetA;
;;;2141   	temp_SL/=4000L;
;;;2142   	net_Ua=(signed short)temp_SL;
;;;2143   
;;;2144   	temp_SL=(signed long)adc_buff_[3];
001d1c  4bd2              LDR      r3,|L1.8296|
001d1e  f9b11000          LDRSH    r1,[r1,#0]            ;2117
001d22  f9b88000          LDRSH    r8,[r8,#0]            ;2122
001d26  434a              MULS     r2,r1,r2              ;2140
001d28  f9b31006          LDRSH    r1,[r3,#6]
001d2c  f8df9324          LDR      r9,|L1.8276|
;;;2145   	temp_SL*=KunetB;
001d30  fb01f108          MUL      r1,r1,r8
001d34  f2417870          MOV      r8,#0x1770            ;2118
;;;2146   	temp_SL/=6000L;
;;;2147   	net_Ub=(signed short)temp_SL;
;;;2148   
;;;2149   	temp_SL=(signed long)adc_buff_[10];
001d38  f9b33014          LDRSH    r3,[r3,#0x14]
001d3c  f9b99000          LDRSH    r9,[r9,#0]            ;2127
001d40  fb91f1f8          SDIV     r1,r1,r8              ;2146
;;;2150   	temp_SL*=KunetC;
001d44  fb03f309          MUL      r3,r3,r9
;;;2151   	temp_SL/=6000L;
001d48  fb93f3f8          SDIV     r3,r3,r8
001d4c  48c5              LDR      r0,|L1.8292|
001d4e  b209              SXTH     r1,r1                 ;2147
;;;2152   	net_Uc=(signed short)temp_SL;
001d50  b21b              SXTH     r3,r3
001d52  8800              LDRH     r0,[r0,#0]            ;2137  ; AUSW_MAIN
001d54  42a8              CMP      r0,r5                 ;2137
001d56  d154              BNE      |L1.7682|
001d58  f44f607a          MOV      r0,#0xfa0             ;2141
001d5c  fb92f0f0          SDIV     r0,r2,r0              ;2141
001d60  b200              SXTH     r0,r0                 ;2142
001d62  f8ac0000          STRH     r0,[r12,#0]           ;2142
001d66  8039              STRH     r1,[r7,#0]            ;2147
001d68  8023              STRH     r3,[r4,#0]
;;;2153   
;;;2154   	net_U=net_Ua;
001d6a  4ab1              LDR      r2,|L1.8240|
001d6c  8010              STRH     r0,[r2,#0]
;;;2155   	if(net_Ub<net_U)net_U=net_Ub;
001d6e  4281              CMP      r1,r0
001d70  da00              BGE      |L1.7540|
001d72  8011              STRH     r1,[r2,#0]
                  |L1.7540|
;;;2156   	if(net_Uc<net_U)net_U=net_Uc;
001d74  f9b20000          LDRSH    r0,[r2,#0]  ; net_U
001d78  4283              CMP      r3,r0
001d7a  da00              BGE      |L1.7550|
001d7c  8013              STRH     r3,[r2,#0]
                  |L1.7550|
001d7e  e07e              B        |L1.7806|
                  |L1.7552|
001d80  48ba              LDR      r0,|L1.8300|
001d82  4bb7              LDR      r3,|L1.8288|
001d84  7801              LDRB     r1,[r0,#0]            ;2112  ; bps
001d86  7842              LDRB     r2,[r0,#1]            ;2112  ; bps
001d88  f10303e4          ADD      r3,r3,#0xe4           ;2112
001d8c  eb012102          ADD      r1,r1,r2,LSL #8       ;2112
001d90  fa1ff881          UXTH     r8,r1                 ;2112
001d94  f8a38000          STRH     r8,[r3,#0]            ;2112
001d98  7881              LDRB     r1,[r0,#2]            ;2113  ; bps
001d9a  78c2              LDRB     r2,[r0,#3]            ;2113  ; bps
001d9c  eb012102          ADD      r1,r1,r2,LSL #8       ;2113
001da0  b289              UXTH     r1,r1                 ;2113
001da2  8059              STRH     r1,[r3,#2]            ;2113
001da4  7902              LDRB     r2,[r0,#4]            ;2114  ; bps
001da6  f890e005          LDRB     lr,[r0,#5]            ;2114  ; bps
001daa  eb02220e          ADD      r2,r2,lr,LSL #8       ;2114
001dae  b292              UXTH     r2,r2                 ;2114
001db0  809a              STRH     r2,[r3,#4]            ;2114
001db2  fb02f209          MUL      r2,r2,r9              ;2117
001db6  f2417370          MOV      r3,#0x1770            ;2118
001dba  fb92f2f3          SDIV     r2,r2,r3              ;2118
001dbe  fa0ff982          SXTH     r9,r2                 ;2119
001dc2  f8ac9000          STRH     r9,[r12,#0]           ;2119
001dc6  fb01f10b          MUL      r1,r1,r11             ;2122
001dca  fb91f1f3          SDIV     r1,r1,r3              ;2123
001dce  b209              SXTH     r1,r1                 ;2124
001dd0  8039              STRH     r1,[r7,#0]            ;2124
001dd2  fb08f80a          MUL      r8,r8,r10             ;2127
001dd6  fb98f2f3          SDIV     r2,r8,r3              ;2128
001dda  b212              SXTH     r2,r2                 ;2129
001ddc  8022              STRH     r2,[r4,#0]            ;2129
001dde  7983              LDRB     r3,[r0,#6]            ;2131  ; bps
001de0  79c0              LDRB     r0,[r0,#7]            ;2131  ; bps
001de2  eb032000          ADD      r0,r3,r0,LSL #8       ;2131
001de6  4ba2              LDR      r3,|L1.8304|
001de8  8018              STRH     r0,[r3,#0]            ;2131
001dea  4891              LDR      r0,|L1.8240|
001dec  f8a09000          STRH     r9,[r0,#0]            ;2133
001df0  4549              CMP      r1,r9                 ;2134
001df2  da00              BGE      |L1.7670|
001df4  8001              STRH     r1,[r0,#0]            ;2134
                  |L1.7670|
001df6  f9b01000          LDRSH    r1,[r0,#0]            ;2135  ; net_U
001dfa  428a              CMP      r2,r1                 ;2135
001dfc  da3f              BGE      |L1.7806|
001dfe  8002              STRH     r2,[r0,#0]            ;2135
001e00  e03d              B        |L1.7806|
                  |L1.7682|
;;;2157   	}
;;;2158   else if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22044)||(AUSW_MAIN==22018))
001e02  f5a048ac          SUB      r8,r0,#0x5600
001e06  f1b8082f          SUBS     r8,r8,#0x2f
001e0a  d00b              BEQ      |L1.7716|
001e0c  f1180828          ADDS     r8,r8,#0x28
001e10  d008              BEQ      |L1.7716|
001e12  f1b80814          SUBS     r8,r8,#0x14
001e16  d005              BEQ      |L1.7716|
001e18  f1b80801          SUBS     r8,r8,#1
001e1c  d002              BEQ      |L1.7716|
001e1e  f118081a          ADDS     r8,r8,#0x1a
001e22  d113              BNE      |L1.7756|
                  |L1.7716|
;;;2159   	{
;;;2160   	temp_SL=(signed long)net_buff_;
;;;2161   	temp_SL*=KunetA;
;;;2162   	temp_SL/=40000L;
001e24  f6494040          MOV      r0,#0x9c40
001e28  fb92f0f0          SDIV     r0,r2,r0
;;;2163   	net_Ua=(signed short)temp_SL;
001e2c  b200              SXTH     r0,r0
001e2e  f8ac0000          STRH     r0,[r12,#0]
;;;2164   
;;;2165   	temp_SL=(signed long)adc_buff_[3];
;;;2166   	temp_SL*=KunetB;
;;;2167   	temp_SL/=6000L;
;;;2168   	net_Ub=(signed short)temp_SL;
001e32  8039              STRH     r1,[r7,#0]
;;;2169   
;;;2170   	temp_SL=(signed long)adc_buff_[10];
;;;2171   	temp_SL*=KunetC;
;;;2172   	temp_SL/=6000L;
;;;2173   	net_Uc=(signed short)temp_SL;
001e34  8023              STRH     r3,[r4,#0]
;;;2174   
;;;2175   	net_U=net_Ua;
001e36  4a7e              LDR      r2,|L1.8240|
001e38  8010              STRH     r0,[r2,#0]
;;;2176   	if(net_Ub<net_U)net_U=net_Ub;
001e3a  4281              CMP      r1,r0
001e3c  da00              BGE      |L1.7744|
001e3e  8011              STRH     r1,[r2,#0]
                  |L1.7744|
;;;2177   	if(net_Uc<net_U)net_U=net_Uc;
001e40  f9b20000          LDRSH    r0,[r2,#0]  ; net_U
001e44  4283              CMP      r3,r0
001e46  da1a              BGE      |L1.7806|
001e48  8013              STRH     r3,[r2,#0]
001e4a  e018              B        |L1.7806|
                  |L1.7756|
;;;2178   	}
;;;2179   else	if((AUSW_MAIN==22010)||(AUSW_MAIN==22011) )
;;;2180   	{
;;;2181   	temp_SL=(signed long)net_buff_;
;;;2182   	temp_SL*=Kunet;
001e4c  4989              LDR      r1,|L1.8308|
001e4e  f5a043aa          SUB      r3,r0,#0x5500         ;2179
001e52  f9b12000          LDRSH    r2,[r1,#0]
001e56  4982              LDR      r1,|L1.8288|
001e58  8e89              LDRH     r1,[r1,#0x34]         ;2139
001e5a  4351              MULS     r1,r2,r1
001e5c  3bfa              SUBS     r3,r3,#0xfa           ;2179
001e5e  d001              BEQ      |L1.7780|
001e60  1e5a              SUBS     r2,r3,#1              ;2179
001e62  d106              BNE      |L1.7794|
                  |L1.7780|
;;;2183   	temp_SL/=35000L;
001e64  f64800b8          MOV      r0,#0x88b8
001e68  fb91f0f0          SDIV     r0,r1,r0
;;;2184   	net_U=(signed short)temp_SL;
001e6c  4970              LDR      r1,|L1.8240|
001e6e  8008              STRH     r0,[r1,#0]
001e70  e005              B        |L1.7806|
                  |L1.7794|
;;;2185   	
;;;2186   	}
;;;2187   else
;;;2188   	{
;;;2189   	temp_SL=(signed long)net_buff_;
;;;2190   	temp_SL*=Kunet;
;;;2191   	#ifdef _ACDC_
;;;2192   	temp_SL/=500L;
001e72  f44f70fa          MOV      r0,#0x1f4
001e76  fb91f0f0          SDIV     r0,r1,r0
;;;2193   	#else
;;;2194   	temp_SL/=5000L;
;;;2195   	#endif
;;;2196   	net_U=(signed short)temp_SL;
001e7a  496d              LDR      r1,|L1.8240|
001e7c  8008              STRH     r0,[r1,#0]
                  |L1.7806|
;;;2197   	
;;;2198   	}
;;;2199   if(bps[11]._device!=dNET_METR) net_F3=net_F;
001e7e  9806              LDR      r0,[sp,#0x18]
001e80  2807              CMP      r0,#7
001e82  d003              BEQ      |L1.7820|
001e84  487c              LDR      r0,|L1.8312|
001e86  8801              LDRH     r1,[r0,#0]  ; net_F
001e88  4879              LDR      r0,|L1.8304|
001e8a  8001              STRH     r1,[r0,#0]
                  |L1.7820|
;;;2200   #endif
;;;2201   
;;;2202   #ifdef UKU_TELECORE2015
;;;2203   //напряжение сети
;;;2204   temp_SL=(signed long)net_buff_;
;;;2205   temp_SL*=Kunet;
;;;2206   temp_SL/=110000L;
;;;2207   net_U=(signed short)temp_SL;
;;;2208   #endif
;;;2209   
;;;2210   #ifdef UKU_TELECORE2017
;;;2211   //напряжение сети
;;;2212   temp_SL=(signed long)net_buff_;
;;;2213   temp_SL*=Kunet;
;;;2214   temp_SL/=110000L;
;;;2215   net_U=(signed short)temp_SL;
;;;2216   #endif
;;;2217   
;;;2218   //Напряжения батарей
;;;2219   temp_SL=(signed long)adc_buff_[0];
001e8c  4f76              LDR      r7,|L1.8296|
001e8e  f9b72000          LDRSH    r2,[r7,#0]  ; adc_buff_
;;;2220   temp_SL*=Kubat[0];
001e92  497a              LDR      r1,|L1.8316|
001e94  f9b10000          LDRSH    r0,[r1,#0]  ; Kubat
001e98  4350              MULS     r0,r2,r0
;;;2221   temp_SL/=2000L;
001e9a  f44f68fa          MOV      r8,#0x7d0
001e9e  fb90f0f8          SDIV     r0,r0,r8
;;;2222   bat[0]._Ub=(signed short)temp_SL;
001ea2  4c62              LDR      r4,|L1.8236|
001ea4  8060              STRH     r0,[r4,#2]
;;;2223   
;;;2224   #ifdef UKU_220
;;;2225   //Напряжения батарей
;;;2226   temp_SL=(signed long)adc_buff_[0];
;;;2227   temp_SL*=Kubat[0];
;;;2228   temp_SL/=400L;
;;;2229   bat[0]._Ub=(signed short)temp_SL;
;;;2230   #endif
;;;2231   
;;;2232   #ifdef UKU_220_V2
;;;2233   //Напряжения батарей
;;;2234   temp_SL=(signed long)adc_buff_[0];
;;;2235   temp_SL*=Kubat[0];
;;;2236   temp_SL/=400L;
;;;2237   bat[0]._Ub=(signed short)temp_SL;
;;;2238   #endif
;;;2239   
;;;2240   //adc_buff_[4]=300;
;;;2241   
;;;2242   temp_SL=(signed long)adc_buff_[4];
001ea6  f9b73008          LDRSH    r3,[r7,#8]  ; adc_buff_
;;;2243   temp_SL*=Kubatm[0];
001eaa  4a75              LDR      r2,|L1.8320|
001eac  f9b20000          LDRSH    r0,[r2,#0]  ; Kubatm
001eb0  fb00f003          MUL      r0,r0,r3
;;;2244   temp_SL/=700L;
001eb4  f44f732f          MOV      r3,#0x2bc
001eb8  fb90f0f3          SDIV     r0,r0,r3
;;;2245   bat[0]._Ubm=(signed short)temp_SL;
001ebc  80a0              STRH     r0,[r4,#4]
;;;2246   
;;;2247   #ifdef UKU_KONTUR
;;;2248   temp_SL=(signed long)adc_buff_[4];
;;;2249   temp_SL*=Kubatm[0];
;;;2250   temp_SL/=2000L;
;;;2251   bat[0]._Ubm=(signed short)temp_SL;
;;;2252   #endif
;;;2253   
;;;2254   #ifdef UKU_6U
;;;2255   temp_SL=(signed long)adc_buff_[4];
;;;2256   temp_SL*=Kubatm[0];
;;;2257   temp_SL/=2000L;
;;;2258   bat[0]._Ubm=(signed short)temp_SL;
;;;2259   #endif
;;;2260   
;;;2261   temp_SL=(signed long)adc_buff_[12];
001ebe  f9b70018          LDRSH    r0,[r7,#0x18]  ; adc_buff_
;;;2262   temp_SL*=Kubat[1];
001ec2  f9b11002          LDRSH    r1,[r1,#2]  ; Kubat
001ec6  fb01f100          MUL      r1,r1,r0
;;;2263   temp_SL/=2000L;
001eca  fb91f0f8          SDIV     r0,r1,r8
;;;2264   bat[1]._Ub=(signed short)temp_SL;
001ece  f8a4004e          STRH     r0,[r4,#0x4e]
;;;2265   
;;;2266   #ifdef UKU_220
;;;2267   temp_SL=(signed long)adc_buff_[12];
;;;2268   temp_SL*=Kubat[1];
;;;2269   temp_SL/=400L;
;;;2270   bat[1]._Ub=(signed short)temp_SL;
;;;2271   #endif
;;;2272   
;;;2273   #ifdef UKU_220_V2
;;;2274   temp_SL=(signed long)adc_buff_[12];
;;;2275   temp_SL*=Kubat[1];
;;;2276   temp_SL/=400L;
;;;2277   bat[1]._Ub=(signed short)temp_SL;
;;;2278   #endif
;;;2279   
;;;2280   //adc_buff_[1]=300;
;;;2281   
;;;2282   temp_SL=(signed long)adc_buff_[1];
001ed2  f9b71002          LDRSH    r1,[r7,#2]  ; adc_buff_
;;;2283   temp_SL*=Kubatm[1];
001ed6  f9b20002          LDRSH    r0,[r2,#2]  ; Kubatm
001eda  fb00f001          MUL      r0,r0,r1
;;;2284   temp_SL/=700L;
001ede  fb90f0f3          SDIV     r0,r0,r3
;;;2285   bat[1]._Ubm=(signed short)temp_SL;
001ee2  f8a40050          STRH     r0,[r4,#0x50]
;;;2286   #ifdef UKU_KONTUR
;;;2287   temp_SL=(signed long)adc_buff_[1];
;;;2288   temp_SL*=Kubatm[1];
;;;2289   temp_SL/=2000L;
;;;2290   bat[1]._Ubm=(signed short)temp_SL;
;;;2291   #endif
;;;2292   #ifdef UKU_6U
;;;2293   temp_SL=(signed long)adc_buff_[1];
;;;2294   temp_SL*=Kubatm[1];
;;;2295   temp_SL/=2000L;
;;;2296   bat[1]._Ubm=(signed short)temp_SL;
;;;2297   #endif
;;;2298   
;;;2299   #ifdef UKU_TELECORE2015
;;;2300   temp_SL=(signed long)adc_buff_[2];
;;;2301   temp_SL*=Kubat[0];
;;;2302   temp_SL/=2000L;
;;;2303   bat[0]._Ub=(signed short)temp_SL;
;;;2304   #endif
;;;2305   
;;;2306   /*
;;;2307   //Токи батарей
;;;2308   if(!mess_find_unvol(MESS2MATEMAT))
;;;2309   	{
;;;2310   	temp_SL=(signed long)ad7705_buff_[0];
;;;2311   	temp_SL-=(signed long)Kibat0[0];
;;;2312   	temp_SL*=(signed long)Kibat1[0];
;;;2313   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;2314   	else temp_SL/=1000L;
;;;2315   	bat[0]._Ib=(signed short)temp_SL;
;;;2316   
;;;2317   	temp_SL=(signed long)ad7705_buff_[1];
;;;2318   	temp_SL-=(signed long)Kibat0[1];
;;;2319   	temp_SL*=(signed long)Kibat1[1];
;;;2320   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;2321   	else temp_SL/=1000L;
;;;2322   	bat[1]._Ib=(signed short)temp_SL;
;;;2323   	}
;;;2324   */
;;;2325   
;;;2326   
;;;2327   //Токи батарей
;;;2328   if(!mess_find_unvol(MESS2MATEMAT))
001ee6  f04f00dc          MOV      r0,#0xdc
001eea  f7fffffe          BL       mess_find_unvol
;;;2329   	{
;;;2330   	temp_SL=(signed long)ad7705_buff_[0];
;;;2331   	temp_SL-=(signed long)Kibat0[0];
;;;2332   	temp_SL*=(signed long)Kibat1[0];
;;;2333   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
;;;2334   	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
001eee  f2456c13          MOV      r12,#0x5613
001ef2  bbe8              CBNZ     r0,|L1.8048|
001ef4  f8dfa18c          LDR      r10,|L1.8324|
001ef8  f8ba0000          LDRH     r0,[r10,#0]           ;2330  ; ad7705_buff_
001efc  f8dfb188          LDR      r11,|L1.8328|
001f00  f8bb1000          LDRH     r1,[r11,#0]           ;2331  ; Kibat0
001f04  eba00001          SUB      r0,r0,r1              ;2331
001f08  4a60              LDR      r2,|L1.8332|
001f0a  f9b21000          LDRSH    r1,[r2,#0]            ;2332  ; Kibat1
001f0e  fb01f100          MUL      r1,r1,r0              ;2332
001f12  4854              LDR      r0,|L1.8292|
001f14  f6456338          MOV      r3,#0x5e38            ;2333
001f18  f6456992          MOV      r9,#0x5e92            ;2333
001f1c  8800              LDRH     r0,[r0,#0]            ;2333  ; AUSW_MAIN
001f1e  4298              CMP      r0,r3                 ;2333
001f20  d001              BEQ      |L1.7974|
001f22  4548              CMP      r0,r9                 ;2333
001f24  d104              BNE      |L1.7984|
                  |L1.7974|
001f26  f44f7e96          MOV      lr,#0x12c             ;2333
001f2a  fb91f1fe          SDIV     r1,r1,lr              ;2333
001f2e  e00f              B        |L1.8016|
                  |L1.7984|
001f30  f5a04ea8          SUB      lr,r0,#0x5400
001f34  f5be7efd          SUBS     lr,lr,#0x1fa
001f38  d003              BEQ      |L1.8002|
001f3a  4560              CMP      r0,r12
001f3c  d001              BEQ      |L1.8002|
001f3e  42a8              CMP      r0,r5
001f40  d102              BNE      |L1.8008|
                  |L1.8002|
001f42  fb91f1f8          SDIV     r1,r1,r8
001f46  e003              B        |L1.8016|
                  |L1.8008|
;;;2335   	else temp_SL/=1000L;
001f48  f44f7e7a          MOV      lr,#0x3e8
001f4c  fb91f1fe          SDIV     r1,r1,lr
                  |L1.8016|
;;;2336   	#ifdef UKU_TELECORE2015
;;;2337   	temp_SL/=2L;
;;;2338   	//temp_SL=-temp_SL;
;;;2339   	#endif
;;;2340   	//#ifdef UKU_TELECORE2017
;;;2341   	//temp_SL/=-2L;
;;;2342   	//temp_SL=-temp_SL;
;;;2343   	//#endif
;;;2344   	bat[0]._Ib=(signed short)temp_SL;
001f50  8121              STRH     r1,[r4,#8]
;;;2345   
;;;2346   	temp_SL=(signed long)ad7705_buff_[1];
001f52  f8ba1002          LDRH     r1,[r10,#2]  ; ad7705_buff_
;;;2347   	temp_SL-=(signed long)Kibat0[1];
001f56  f8bba002          LDRH     r10,[r11,#2]  ; Kibat0
001f5a  eba10a0a          SUB      r10,r1,r10
;;;2348   	temp_SL*=(signed long)Kibat1[1];
001f5e  f9b21002          LDRSH    r1,[r2,#2]  ; Kibat1
001f62  fb01f10a          MUL      r1,r1,r10
;;;2349   	if((AUSW_MAIN==24120)||(AUSW_MAIN==24210))temp_SL/=300L;
001f66  4298              CMP      r0,r3
001f68  d001              BEQ      |L1.8046|
001f6a  4548              CMP      r0,r9
001f6c  d106              BNE      |L1.8060|
                  |L1.8046|
001f6e  e000              B        |L1.8050|
                  |L1.8048|
001f70  e015              B        |L1.8094|
                  |L1.8050|
001f72  f44f7096          MOV      r0,#0x12c
001f76  fb91f0f0          SDIV     r0,r1,r0
001f7a  e00e              B        |L1.8090|
                  |L1.8060|
;;;2350   	else if((AUSW_MAIN==22010)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033))temp_SL/=2000L;
001f7c  f5a042aa          SUB      r2,r0,#0x5500
001f80  3afa              SUBS     r2,r2,#0xfa
001f82  d003              BEQ      |L1.8076|
001f84  4560              CMP      r0,r12
001f86  d001              BEQ      |L1.8076|
001f88  42a8              CMP      r0,r5
001f8a  d102              BNE      |L1.8082|
                  |L1.8076|
001f8c  fb91f0f8          SDIV     r0,r1,r8
001f90  e003              B        |L1.8090|
                  |L1.8082|
;;;2351   	else temp_SL/=1000L;
001f92  f44f707a          MOV      r0,#0x3e8
001f96  fb91f0f0          SDIV     r0,r1,r0
                  |L1.8090|
;;;2352   	bat[1]._Ib=(signed short)temp_SL;
001f9a  f8a40054          STRH     r0,[r4,#0x54]
                  |L1.8094|
;;;2353   	}
;;;2354   
;;;2355   
;;;2356   
;;;2357   
;;;2358   
;;;2359   //Температуры батарей
;;;2360   
;;;2361   #ifdef UKU_KONTUR
;;;2362   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
;;;2363   else bat[0]._nd=1;
;;;2364   temp_SL=(signed long)adc_buff_[6];
;;;2365   temp_SL*=Ktbat[0];
;;;2366   temp_SL/=20000L;
;;;2367   temp_SL-=273L;
;;;2368   bat[0]._Tb=(signed short)temp_SL;
;;;2369   #else
;;;2370   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))bat[0]._nd=0;
001f9e  f9b7000c          LDRSH    r0,[r7,#0xc]  ; adc_buff_
001fa2  f6403ab7          MOV      r10,#0xbb7
001fa6  4681              MOV      r9,r0
001fa8  f2a03021          SUB      r0,r0,#0x321
;;;2371   else bat[0]._nd=1;
001fac  2201              MOVS     r2,#1
001fae  2300              MOVS     r3,#0                 ;2370
001fb0  9005              STR      r0,[sp,#0x14]         ;2370
001fb2  4550              CMP      r0,r10                ;2370
001fb4  d201              BCS      |L1.8122|
001fb6  7323              STRB     r3,[r4,#0xc]          ;2370
001fb8  e000              B        |L1.8124|
                  |L1.8122|
001fba  7322              STRB     r2,[r4,#0xc]
                  |L1.8124|
;;;2372   temp_SL=(signed long)adc_buff_[6];
;;;2373   temp_SL*=Ktbat[0];
001fbc  4934              LDR      r1,|L1.8336|
001fbe  f9b10000          LDRSH    r0,[r1,#0]  ; Ktbat
001fc2  fb00f009          MUL      r0,r0,r9
;;;2374   temp_SL/=20000L;
001fc6  f6446e20          MOV      lr,#0x4e20
001fca  fb90f0fe          SDIV     r0,r0,lr
;;;2375   temp_SL-=273L;
001fce  f2a01011          SUB      r0,r0,#0x111
;;;2376   bat[0]._Tb=(signed short)temp_SL;
001fd2  8160              STRH     r0,[r4,#0xa]
;;;2377   #endif
;;;2378   
;;;2379   #ifdef UKU_KONTUR
;;;2380   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
;;;2381   else bat[1]._nd=1;
;;;2382   temp_SL=(signed long)adc_buff_[7];
;;;2383   temp_SL*=Ktbat[1];
;;;2384   temp_SL/=20000L;
;;;2385   temp_SL-=273L;
;;;2386   bat[1]._Tb=(signed short)temp_SL;
;;;2387   #else
;;;2388   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))bat[1]._nd=0;
001fd4  f9b7000e          LDRSH    r0,[r7,#0xe]  ; adc_buff_
001fd8  f2a03b21          SUB      r11,r0,#0x321
001fdc  45d3              CMP      r11,r10
001fde  d202              BCS      |L1.8166|
001fe0  f8843058          STRB     r3,[r4,#0x58]
001fe4  e001              B        |L1.8170|
                  |L1.8166|
;;;2389   else bat[1]._nd=1;
001fe6  f8842058          STRB     r2,[r4,#0x58]
                  |L1.8170|
;;;2390   temp_SL=(signed long)adc_buff_[7];
;;;2391   temp_SL*=Ktbat[1];
001fea  f9b11002          LDRSH    r1,[r1,#2]  ; Ktbat
001fee  4341              MULS     r1,r0,r1
;;;2392   temp_SL/=20000L;
001ff0  f6446020          MOV      r0,#0x4e20
001ff4  fb91f0f0          SDIV     r0,r1,r0
;;;2393   temp_SL-=273L;
001ff8  f2a01011          SUB      r0,r0,#0x111
;;;2394   bat[1]._Tb=(signed short)temp_SL;
001ffc  490b              LDR      r1,|L1.8236|
001ffe  f8a10056          STRH     r0,[r1,#0x56]
;;;2395   #endif
;;;2396   
;;;2397   #ifdef UKU_6U
;;;2398   
;;;2399   if(NUMMAKB==2)
;;;2400   	{
;;;2401   	if(makb[0]._cnt<5)
;;;2402   		{
;;;2403   		if(makb[0]._T_nd[0]==0)
;;;2404   			{
;;;2405   			bat[0]._Tb=makb[0]._T[0];
;;;2406   			bat[0]._nd=0;
;;;2407   			}
;;;2408   		}
;;;2409   
;;;2410   	if(makb[1]._cnt<5)
;;;2411   		{
;;;2412   		if(makb[1]._T_nd[0]==0)
;;;2413   			{
;;;2414   			bat[1]._Tb=makb[1]._T[0];
;;;2415   			bat[1]._nd=0;
;;;2416   			}
;;;2417   		}
;;;2418   
;;;2419   	}
;;;2420   else if(NUMMAKB==4)
;;;2421   	{
;;;2422   	signed short temp_t;
;;;2423   	temp_t=-20;
;;;2424   	if(makb[0]._cnt<5)
;;;2425   		{
;;;2426   		if(makb[0]._T_nd[0]==0)
;;;2427   			{
;;;2428   			temp_t=makb[0]._T[0];
;;;2429   			bat[0]._nd=0;
;;;2430   			}
;;;2431   		}
;;;2432   	if(makb[1]._cnt<5)
;;;2433   		{
;;;2434   		if(makb[1]._T_nd[0]==0)
;;;2435   			{
;;;2436   			if(temp_t<makb[1]._T[0])
;;;2437   				{
;;;2438   				bat[0]._nd=0;
;;;2439   				temp_t=makb[1]._T[0];
;;;2440   				}
;;;2441   			}
;;;2442   		}
;;;2443   	if(temp_t!=-20)bat[0]._Tb = temp_t;
;;;2444   
;;;2445    	temp_t=-20;
;;;2446   	if(makb[2]._cnt<5)
;;;2447   		{
;;;2448   		if(makb[2]._T_nd[0]==0)
;;;2449   			{
;;;2450   			temp_t=makb[2]._T[0];
;;;2451   			bat[1]._nd=0;
;;;2452   			}
;;;2453   		}
;;;2454   	if(makb[3]._cnt<5)
;;;2455   		{
;;;2456   		if(makb[3]._T_nd[0]==0)
;;;2457   			{
;;;2458   			if(temp_t<makb[3]._T[0])
;;;2459   				{
;;;2460   				bat[1]._nd=0;
;;;2461   				temp_t=makb[3]._T[0];
;;;2462   				}
;;;2463   			}
;;;2464   		}
;;;2465   	if(temp_t!=-20)bat[1]._Tb = temp_t;
;;;2466   	}
;;;2467   
;;;2468   #endif
;;;2469   
;;;2470   
;;;2471   //Напряжение нагрузки
;;;2472   temp_SL=(signed long)adc_buff_[2];
002002  f9b71004          LDRSH    r1,[r7,#4]  ; adc_buff_
;;;2473   temp_SL*=Kuload;
002006  4823              LDR      r0,|L1.8340|
002008  f9b00000          LDRSH    r0,[r0,#0]  ; Kuload
00200c  fb01f000          MUL      r0,r1,r0
;;;2474   temp_SL/=2000L;
002010  f44f64fa          MOV      r4,#0x7d0
002014  fb90f0f4          SDIV     r0,r0,r4
;;;2475   load_U=(signed short)temp_SL;
002018  4c1f              LDR      r4,|L1.8344|
00201a  8020              STRH     r0,[r4,#0]
;;;2476   
;;;2477   #ifdef UKU_220 
;;;2478   //Напряжение нагрузки
;;;2479   temp_SL=(signed long)adc_buff_[2];
;;;2480   temp_SL*=Kuload;
;;;2481   temp_SL/=350L;
;;;2482   load_U=(signed short)temp_SL;
;;;2483   #endif
;;;2484   
;;;2485   #ifdef UKU_220_V2 
;;;2486   //Напряжение нагрузки
;;;2487   temp_SL=(signed long)adc_buff_[2];
;;;2488   temp_SL*=Kuload;
;;;2489   temp_SL/=350L;
;;;2490   load_U=(signed short)temp_SL;
;;;2491   #endif
;;;2492   
;;;2493   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2494   //Напряжение шины
;;;2495   temp_SL=(signed long)adc_buff_[1];
00201c  f9b78002          LDRSH    r8,[r7,#2]  ; adc_buff_
;;;2496   temp_SL*=Kuout;
002020  481e              LDR      r0,|L1.8348|
002022  e03d              B        |L1.8352|
                  |L1.8228|
                          DCD      bat_ips
                  |L1.8232|
                          DCD      bat_u_old_cnt
                  |L1.8236|
                          DCD      bat
                  |L1.8240|
                          DCD      net_U
                  |L1.8244|
                          DCD      UMN
                  |L1.8248|
                          DCD      unet_drv_cnt
                  |L1.8252|
                          DCD      net_Ustore
                  |L1.8256|
                          DCD      main_1Hz_cnt
                  |L1.8260|
                          DCD      bps
                  |L1.8264|
                          DCD      KunetA
                  |L1.8268|
                          DCD      net_Ua
                  |L1.8272|
                          DCD      KunetB
                  |L1.8276|
                          DCD      KunetC
                  |L1.8280|
                          DCD      net_Ub
                  |L1.8284|
                          DCD      net_Uc
                  |L1.8288|
                          DCD      ||area_number.25||
                  |L1.8292|
                          DCD      AUSW_MAIN
                  |L1.8296|
                          DCD      ||.bss||+0x40c
                  |L1.8300|
                          DCD      bps+0x3fa
                  |L1.8304|
                          DCD      net_F3
                  |L1.8308|
                          DCD      Kunet
                  |L1.8312|
                          DCD      net_F
                  |L1.8316|
                          DCD      Kubat
                  |L1.8320|
                          DCD      Kubatm
                  |L1.8324|
                          DCD      ad7705_buff_
                  |L1.8328|
                          DCD      Kibat0
                  |L1.8332|
                          DCD      Kibat1
                  |L1.8336|
                          DCD      Ktbat
                  |L1.8340|
                          DCD      Kuload
                  |L1.8344|
                          DCD      load_U
                  |L1.8348|
                          DCD      Kuout
                  |L1.8352|
0020a0  f9b00000          LDRSH    r0,[r0,#0]  ; Kuout
0020a4  fb08f800          MUL      r8,r8,r0
;;;2497   if(AUSW_MAIN==22010)temp_SL/=400L;
0020a8  48fa              LDR      r0,|L1.9364|
0020aa  f24554fa          MOV      r4,#0x55fa
0020ae  f44f7bc8          MOV      r11,#0x190
0020b2  8800              LDRH     r0,[r0,#0]  ; AUSW_MAIN
0020b4  42a0              CMP      r0,r4
0020b6  d102              BNE      |L1.8382|
0020b8  fb98f8fb          SDIV     r8,r8,r11
0020bc  e003              B        |L1.8390|
                  |L1.8382|
;;;2498   else temp_SL/=500L;
0020be  f44f7efa          MOV      lr,#0x1f4
0020c2  fb98f8fe          SDIV     r8,r8,lr
                  |L1.8390|
;;;2499   out_U=(signed short)temp_SL;
0020c6  f8dfe3d0          LDR      lr,|L1.9368|
0020ca  fa0ff888          SXTH     r8,r8
0020ce  f8ae8000          STRH     r8,[lr,#0]
;;;2500   load_U=out_U;
0020d2  f8dfe3c8          LDR      lr,|L1.9372|
0020d6  f8ae8000          STRH     r8,[lr,#0]
;;;2501   
;;;2502   //Напряжение выпрямителей
;;;2503   temp_SL=(signed long)adc_buff_[2];
;;;2504   temp_SL*=Kubps;
0020da  4ff1              LDR      r7,|L1.9376|
0020dc  f9b77000          LDRSH    r7,[r7,#0]  ; Kubps
0020e0  fb01f107          MUL      r1,r1,r7
;;;2505   if(AUSW_MAIN==22010)temp_SL/=400L;
0020e4  d102              BNE      |L1.8428|
0020e6  fb91f1fb          SDIV     r1,r1,r11
0020ea  e003              B        |L1.8436|
                  |L1.8428|
;;;2506   else temp_SL/=500L;
0020ec  f44f74fa          MOV      r4,#0x1f4
0020f0  fb91f1f4          SDIV     r1,r1,r4
                  |L1.8436|
;;;2507   bps_U=(signed short)temp_SL;
0020f4  4ceb              LDR      r4,|L1.9380|
0020f6  b209              SXTH     r1,r1
0020f8  8021              STRH     r1,[r4,#0]
;;;2508   
;;;2509   if(bps_U<100)
0020fa  2964              CMP      r1,#0x64
0020fc  da19              BGE      |L1.8498|
;;;2510   	{
;;;2511   	char i;
;;;2512   	for(i=0;i<NUMIST;i++)
0020fe  f04f0100          MOV      r1,#0
002102  46a6              MOV      lr,r4                 ;2507
002104  4ce8              LDR      r4,|L1.9384|
002106  f9b4b000          LDRSH    r11,[r4,#0]
00210a  e010              B        |L1.8494|
                  |L1.8460|
;;;2513   		{
;;;2514   		if(bps[i]._Uin>bps_U)bps_U=bps[i]._Uin;
00210c  ebc104c1          RSB      r4,r1,r1,LSL #3
002110  eb041701          ADD      r7,r4,r1,LSL #4
002114  4ce5              LDR      r4,|L1.9388|
002116  eb040487          ADD      r4,r4,r7,LSL #2
00211a  f9be7000          LDRSH    r7,[lr,#0]  ; bps_U
00211e  6a24              LDR      r4,[r4,#0x20]
002120  42bc              CMP      r4,r7
002122  dd01              BLE      |L1.8488|
002124  f8ae4000          STRH     r4,[lr,#0]
                  |L1.8488|
002128  f1010101          ADD      r1,r1,#1              ;2512
00212c  b2c9              UXTB     r1,r1                 ;2512
                  |L1.8494|
00212e  4559              CMP      r1,r11                ;2512
002130  dbec              BLT      |L1.8460|
                  |L1.8498|
;;;2515   		}
;;;2516   	}
;;;2517   
;;;2518   //Суммарный ток выпрямителей
;;;2519   temp_SL=0;
002132  f04f0b00          MOV      r11,#0
;;;2520   for (i=0;i<NUMIST;i++)
002136  4659              MOV      r1,r11
002138  4cdb              LDR      r4,|L1.9384|
00213a  f9b47000          LDRSH    r7,[r4,#0]            ;2512
00213e  4cdb              LDR      r4,|L1.9388|
002140  e00b              B        |L1.8538|
                  |L1.8514|
;;;2521   	{
;;;2522   	temp_SL+=((signed long)bps[i]._Ii);
002142  ebc10ec1          RSB      lr,r1,r1,LSL #3
002146  eb0e1e01          ADD      lr,lr,r1,LSL #4
00214a  eb040e8e          ADD      lr,r4,lr,LSL #2
00214e  f8dee024          LDR      lr,[lr,#0x24]
002152  44f3              ADD      r11,r11,lr
002154  f1010101          ADD      r1,r1,#1              ;2520
002158  b2c9              UXTB     r1,r1                 ;2520
                  |L1.8538|
00215a  42b9              CMP      r1,r7                 ;2520
00215c  dbf1              BLT      |L1.8514|
;;;2523   	}
;;;2524   bps_I=(signed short)temp_SL;
00215e  49d4              LDR      r1,|L1.9392|
002160  f8a1b000          STRH     r11,[r1,#0]
;;;2525   
;;;2526   
;;;2527   #endif
;;;2528   
;;;2529   
;;;2530   #ifdef UKU_KONTUR
;;;2531   //Внешний датчик температуры №1(температура внешнего воздуха)
;;;2532   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
;;;2533   else ND_EXT[0]=1;
;;;2534   temp_SL=(signed long)adc_buff_[5];
;;;2535   temp_SL*=Ktext[0];
;;;2536   temp_SL/=20000L;
;;;2537   temp_SL-=273L;
;;;2538   t_ext[0]=(signed short)temp_SL;
;;;2539   #else 
;;;2540   //Внешний датчик температуры №1(температура внешнего воздуха)
;;;2541   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[0]=0;
002164  49d3              LDR      r1,|L1.9396|
002166  f6403ab7          MOV      r10,#0xbb7
00216a  f9b1b00a          LDRSH    r11,[r1,#0xa]  ; adc_buff_
00216e  49d2              LDR      r1,|L1.9400|
002170  f2ab3e21          SUB      lr,r11,#0x321
002174  f8cde010          STR      lr,[sp,#0x10]
002178  45d6              CMP      lr,r10
00217a  d201              BCS      |L1.8576|
00217c  700b              STRB     r3,[r1,#0]
00217e  e000              B        |L1.8578|
                  |L1.8576|
;;;2542   else ND_EXT[0]=1;
002180  700a              STRB     r2,[r1,#0]
                  |L1.8578|
;;;2543   temp_SL=(signed long)adc_buff_[5];
;;;2544   temp_SL*=Ktext[0];
002182  f8dfa338          LDR      r10,|L1.9404|
002186  f9baa000          LDRSH    r10,[r10,#0]  ; Ktext
00218a  f8cda00c          STR      r10,[sp,#0xc]
00218e  fb0afa0b          MUL      r10,r10,r11
;;;2545   temp_SL/=20000L;
002192  f6446e20          MOV      lr,#0x4e20
002196  fb9afafe          SDIV     r10,r10,lr
;;;2546   temp_SL-=273L;
00219a  f2aa1a11          SUB      r10,r10,#0x111
;;;2547   t_ext[0]=(signed short)temp_SL;
00219e  f8dfe320          LDR      lr,|L1.9408|
0021a2  f8aea000          STRH     r10,[lr,#0]
;;;2548   /*
;;;2549   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;2550   else ND_EXT[1]=1;
;;;2551   temp_SL=(signed long)adc_buff_[6];
;;;2552   temp_SL*=Ktext[1];
;;;2553   temp_SL/=20000L;
;;;2554   temp_SL-=273L;
;;;2555   t_ext[1]=(signed short)temp_SL;	*/
;;;2556   #endif
;;;2557   
;;;2558   #ifdef UKU_220
;;;2559   
;;;2560   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;2561   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;2562   else ND_EXT[1]=1;
;;;2563   temp_SL=(signed long)adc_buff_[3];
;;;2564   temp_SL*=Ktext[1];
;;;2565   temp_SL/=20000L;
;;;2566   temp_SL-=273L;
;;;2567   t_ext[1]=(signed short)temp_SL;
;;;2568   
;;;2569   //Внешний датчик температуры №3(температура отсека MSAN)
;;;2570   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;2571   else ND_EXT[2]=1;
;;;2572   temp_SL=(signed long)adc_buff_[10];
;;;2573   temp_SL*=Ktext[2];
;;;2574   temp_SL/=20000L;
;;;2575   temp_SL-=273L;
;;;2576   t_ext[2]=(signed short)temp_SL;
;;;2577   
;;;2578   #else
;;;2579   
;;;2580   
;;;2581   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2582   
;;;2583   //Внешний датчик температуры 
;;;2584   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[0]=0;
0021a6  f8dda014          LDR      r10,[sp,#0x14]
0021aa  f6403eb7          MOV      lr,#0xbb7
0021ae  45f2              CMP      r10,lr
0021b0  d201              BCS      |L1.8630|
0021b2  700b              STRB     r3,[r1,#0]
0021b4  e000              B        |L1.8632|
                  |L1.8630|
;;;2585   else ND_EXT[0]=1;
0021b6  700a              STRB     r2,[r1,#0]
                  |L1.8632|
;;;2586   temp_SL=(signed long)adc_buff_[6];
;;;2587   temp_SL*=Ktext[0];
0021b8  f8dda00c          LDR      r10,[sp,#0xc]
0021bc  fb0afa09          MUL      r10,r10,r9
;;;2588   temp_SL/=20000L;
0021c0  f6446920          MOV      r9,#0x4e20
0021c4  fb9af9f9          SDIV     r9,r10,r9
;;;2589   temp_SL-=273L;
0021c8  f2a91911          SUB      r9,r9,#0x111
;;;2590   t_ext[0]=(signed short)temp_SL;
0021cc  f8dfe2f0          LDR      lr,|L1.9408|
0021d0  f8ae9000          STRH     r9,[lr,#0]
;;;2591   
;;;2592   //Внешний датчик температуры №2
;;;2593   if((adc_buff_[5]>800)&&(adc_buff_[5]<3800))ND_EXT[1]=0;
0021d4  f8dd9010          LDR      r9,[sp,#0x10]
0021d8  f6403ab7          MOV      r10,#0xbb7
0021dc  45d1              CMP      r9,r10
0021de  d201              BCS      |L1.8676|
0021e0  704b              STRB     r3,[r1,#1]
0021e2  e000              B        |L1.8678|
                  |L1.8676|
;;;2594   else ND_EXT[1]=1;
0021e4  704a              STRB     r2,[r1,#1]
                  |L1.8678|
;;;2595   temp_SL=(signed long)adc_buff_[5];
;;;2596   temp_SL*=Ktext[1];
0021e6  4ab5              LDR      r2,|L1.9404|
0021e8  f9b22002          LDRSH    r2,[r2,#2]  ; Ktext
0021ec  fb02f20b          MUL      r2,r2,r11
;;;2597   temp_SL/=20000L;
0021f0  f6446920          MOV      r9,#0x4e20
0021f4  fb92f2f9          SDIV     r2,r2,r9
;;;2598   temp_SL-=273L;
0021f8  f2a21211          SUB      r2,r2,#0x111
;;;2599   t_ext[1]=(signed short)temp_SL;
0021fc  fa0ffa82          SXTH     r10,r2
002200  4aaf              LDR      r2,|L1.9408|
002202  f8a2a002          STRH     r10,[r2,#2]
;;;2600   #else
;;;2601   
;;;2602   
;;;2603   
;;;2604   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;2605   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;2606   else ND_EXT[1]=1;
;;;2607   temp_SL=(signed long)adc_buff_[6];
;;;2608   temp_SL*=Ktext[1];
;;;2609   temp_SL/=20000L;
;;;2610   temp_SL-=273L;
;;;2611   t_ext[1]=(signed short)temp_SL;
;;;2612   
;;;2613   //Внешний датчик температуры №3(температура отсека MSAN)
;;;2614   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[2]=0;
;;;2615   else ND_EXT[2]=1;
;;;2616   temp_SL=(signed long)adc_buff_[3];
;;;2617   temp_SL*=Ktext[2];
;;;2618   temp_SL/=20000L;
;;;2619   temp_SL-=273L;
;;;2620   t_ext[2]=(signed short)temp_SL;
;;;2621   
;;;2622   #endif
;;;2623   #endif
;;;2624   
;;;2625   #ifdef UKU_220_V2
;;;2626   
;;;2627   //Внешний датчик температуры №2(температура отсека ЭПУ)
;;;2628   if((adc_buff_[3]>800)&&(adc_buff_[3]<3800))ND_EXT[1]=0;
;;;2629   else ND_EXT[1]=1;
;;;2630   temp_SL=(signed long)adc_buff_[3];
;;;2631   temp_SL*=Ktext[1];
;;;2632   temp_SL/=20000L;
;;;2633   temp_SL-=273L;
;;;2634   t_ext[1]=(signed short)temp_SL;
;;;2635   
;;;2636   //Внешний датчик температуры №3(температура отсека MSAN)
;;;2637   if((adc_buff_[10]>800)&&(adc_buff_[10]<3800))ND_EXT[2]=0;
;;;2638   else ND_EXT[2]=1;
;;;2639   temp_SL=(signed long)adc_buff_[10];
;;;2640   temp_SL*=Ktext[2];
;;;2641   temp_SL/=20000L;
;;;2642   temp_SL-=273L;
;;;2643   t_ext[2]=(signed short)temp_SL;
;;;2644   
;;;2645   #else
;;;2646   
;;;2647   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2648   //Ток батареи
;;;2649   if(bps[8]._device==dIBAT_METR)
002206  f89422e0          LDRB     r2,[r4,#0x2e0]  ; bps
;;;2650   	{
;;;2651   	ibat_metr_buff_[0]=((signed long)bps[8]._buff[0])+(((signed long)bps[8]._buff[1])<<8);
;;;2652   	ibat_metr_buff_[1]=((signed long)bps[8]._buff[2])+(((signed long)bps[8]._buff[3])<<8);
;;;2653   	bIBAT_SMKLBR=((signed short)bps[8]._buff[4])+(((signed short)bps[8]._buff[5])<<8);
;;;2654   	if(bIBAT_SMKLBR) bIBAT_SMKLBR_cnt=50;
;;;2655   	if(!bIBAT_SMKLBR)
;;;2656   		{
;;;2657   		signed long temp_SL;
;;;2658   		temp_SL=(signed long)ibat_metr_buff_[0];
;;;2659   		temp_SL-=(signed long)ibat_metr_buff_[1];
;;;2660   		temp_SL*=(signed long)Kibat1[0];
;;;2661   		if((AUSW_MAIN==22010)||(AUSW_MAIN==22011)||(AUSW_MAIN==22035)||(AUSW_MAIN==22033)||(AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043)||(AUSW_MAIN==22044))temp_SL/=2000L;
;;;2662   	
;;;2663   		Ib_ips_termokompensat =(signed short)temp_SL;
00220a  f8df92b8          LDR      r9,|L1.9412|
00220e  2a09              CMP      r2,#9                 ;2649
002210  d15f              BNE      |L1.8914|
002212  f89422e6          LDRB     r2,[r4,#0x2e6]        ;2651  ; bps
002216  f894b2e7          LDRB     r11,[r4,#0x2e7]       ;2651  ; bps
00221a  f8dfe2ac          LDR      lr,|L1.9416|
00221e  eb02220b          ADD      r2,r2,r11,LSL #8      ;2651
002222  f8ce2000          STR      r2,[lr,#0]            ;2651  ; ibat_metr_buff_
002226  9202              STR      r2,[sp,#8]            ;2651
002228  f89422e8          LDRB     r2,[r4,#0x2e8]        ;2652  ; bps
00222c  f894b2e9          LDRB     r11,[r4,#0x2e9]       ;2652  ; bps
002230  eb02220b          ADD      r2,r2,r11,LSL #8      ;2652
002234  f8ce2004          STR      r2,[lr,#4]            ;2652  ; ibat_metr_buff_
002238  f894b2ea          LDRB     r11,[r4,#0x2ea]       ;2653  ; bps
00223c  f894e2eb          LDRB     lr,[r4,#0x2eb]        ;2653  ; bps
002240  eb0b2b0e          ADD      r11,r11,lr,LSL #8     ;2653
002244  f8dfe284          LDR      lr,|L1.9420|
002248  fa0ffb8b          SXTH     r11,r11               ;2653
00224c  f8aeb000          STRH     r11,[lr,#0]           ;2653
002250  f1bb0f00          CMP      r11,#0                ;2654
002254  d005              BEQ      |L1.8802|
002256  f8dfb278          LDR      r11,|L1.9424|
00225a  f04f0e32          MOV      lr,#0x32              ;2654
00225e  f8abe000          STRH     lr,[r11,#0]           ;2654
                  |L1.8802|
002262  d136              BNE      |L1.8914|
002264  f8ddb008          LDR      r11,[sp,#8]           ;2658
002268  ebab0b02          SUB      r11,r11,r2            ;2659
00226c  4a99              LDR      r2,|L1.9428|
00226e  f9b22000          LDRSH    r2,[r2,#0]            ;2660  ; Kibat1
002272  fb02f20b          MUL      r2,r2,r11             ;2660
002276  f5a04ba8          SUB      r11,r0,#0x5400        ;2661
00227a  f5bb7bfd          SUBS     r11,r11,#0x1fa        ;2661
00227e  d00f              BEQ      |L1.8864|
002280  f1bb0b01          SUBS     r11,r11,#1            ;2661
002284  d00c              BEQ      |L1.8864|
002286  4560              CMP      r0,r12                ;2661
002288  d00a              BEQ      |L1.8864|
00228a  42a8              CMP      r0,r5                 ;2661
00228c  d008              BEQ      |L1.8864|
00228e  f1bb0534          SUBS     r5,r11,#0x34          ;2661
002292  d005              BEQ      |L1.8864|
002294  3528              ADDS     r5,r5,#0x28           ;2661
002296  d003              BEQ      |L1.8864|
002298  3d14              SUBS     r5,r5,#0x14           ;2661
00229a  d001              BEQ      |L1.8864|
00229c  1e6d              SUBS     r5,r5,#1              ;2661
00229e  d103              BNE      |L1.8872|
                  |L1.8864|
0022a0  f44f65fa          MOV      r5,#0x7d0             ;2661
0022a4  fb92f2f5          SDIV     r2,r2,r5              ;2661
                  |L1.8872|
0022a8  b215              SXTH     r5,r2
0022aa  f8a95000          STRH     r5,[r9,#0]
;;;2664   		if(bIBAT_SMKLBR_cnt)
0022ae  f8dfc220          LDR      r12,|L1.9424|
;;;2665   			{
;;;2666   			bIBAT_SMKLBR_cnt--;
;;;2667   			Ib_ips_termokompensat=Ib_ips_termokompensat_temp;
0022b2  f8dfb224          LDR      r11,|L1.9432|
0022b6  f9bc2000          LDRSH    r2,[r12,#0]           ;2664  ; bIBAT_SMKLBR_cnt
0022ba  b142              CBZ      r2,|L1.8910|
0022bc  f1a20201          SUB      r2,r2,#1              ;2666
0022c0  f8ac2000          STRH     r2,[r12,#0]           ;2666
0022c4  f8bb2000          LDRH     r2,[r11,#0]  ; Ib_ips_termokompensat_temp
0022c8  f8a92000          STRH     r2,[r9,#0]
0022cc  e001              B        |L1.8914|
                  |L1.8910|
;;;2668   			}
;;;2669   		else 
;;;2670   			{
;;;2671   			Ib_ips_termokompensat_temp=Ib_ips_termokompensat;
0022ce  f8ab5000          STRH     r5,[r11,#0]
                  |L1.8914|
;;;2672   			}
;;;2673   		}
;;;2674   	}
;;;2675   
;;;2676   bat[0]._Ub=load_U;
0022d2  4a82              LDR      r2,|L1.9436|
0022d4  f8a28002          STRH     r8,[r2,#2]
0022d8  f8cd8004          STR      r8,[sp,#4]
;;;2677   if(AUSW_MAIN==22018) Ib_ips_termokompensat=bat[0]._Ib;
0022dc  f5a045ac          SUB      r5,r0,#0x5600
0022e0  3d02              SUBS     r5,#2
0022e2  d103              BNE      |L1.8940|
0022e4  8910              LDRH     r0,[r2,#8]  ; bat
0022e6  f8a90000          STRH     r0,[r9,#0]
0022ea  e002              B        |L1.8946|
                  |L1.8940|
;;;2678   else bat[0]._Ib=Ib_ips_termokompensat;
0022ec  f8b90000          LDRH     r0,[r9,#0]  ; Ib_ips_termokompensat
0022f0  8110              STRH     r0,[r2,#8]
                  |L1.8946|
;;;2679   
;;;2680   #endif
;;;2681   #endif
;;;2682   
;;;2683   
;;;2684   #ifdef UKU_TELECORE2015
;;;2685   
;;;2686   //Внешний датчик температуры №1
;;;2687   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;2688   else ND_EXT[0]=1;
;;;2689   temp_SL=(signed long)adc_buff_[7];
;;;2690   temp_SL*=Ktext[0];
;;;2691   temp_SL/=20000L;
;;;2692   temp_SL-=273L;
;;;2693   t_ext[0]=(signed short)temp_SL;
;;;2694   
;;;2695   
;;;2696   //Внешний датчик температуры №2
;;;2697   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;2698   else ND_EXT[1]=1;
;;;2699   temp_SL=(signed long)adc_buff_[6];
;;;2700   temp_SL*=Ktext[1];
;;;2701   temp_SL/=20000L;
;;;2702   temp_SL-=273L;
;;;2703   t_ext[1]=(signed short)temp_SL;
;;;2704   
;;;2705   #endif
;;;2706   
;;;2707   #ifdef UKU_TELECORE2017
;;;2708   
;;;2709   //Внешний датчик температуры №1
;;;2710   if((adc_buff_[7]>800)&&(adc_buff_[7]<3800))ND_EXT[0]=0;
;;;2711   else ND_EXT[0]=1;
;;;2712   temp_SL=(signed long)adc_buff_[7];
;;;2713   temp_SL*=Ktext[0];
;;;2714   temp_SL/=20000L;
;;;2715   temp_SL-=273L;
;;;2716   t_ext[0]=(signed short)temp_SL;
;;;2717   
;;;2718   
;;;2719   //Внешний датчик температуры №2
;;;2720   if((adc_buff_[6]>800)&&(adc_buff_[6]<3800))ND_EXT[1]=0;
;;;2721   else ND_EXT[1]=1;
;;;2722   temp_SL=(signed long)adc_buff_[6];
;;;2723   temp_SL*=Ktext[1];
;;;2724   temp_SL/=20000L;
;;;2725   temp_SL-=273L;
;;;2726   t_ext[1]=(signed short)temp_SL;
;;;2727   
;;;2728   #endif
;;;2729   
;;;2730   //напряжение ввода
;;;2731   temp_SL=(signed long)adc_buff_ext_[0];
0022f2  f8dfc1ec          LDR      r12,|L1.9440|
0022f6  f8bc5000          LDRH     r5,[r12,#0]  ; adc_buff_ext_
;;;2732   temp_SL*=Kunet_ext[0];
0022fa  f8df81e8          LDR      r8,|L1.9444|
0022fe  f9b80000          LDRSH    r0,[r8,#0]  ; Kunet_ext
002302  4368              MULS     r0,r5,r0
;;;2733   temp_SL/=4000L;
002304  f44f6b7a          MOV      r11,#0xfa0
002308  fb90f0fb          SDIV     r0,r0,r11
;;;2734   Uvv[0]=(signed short)temp_SL;
00230c  4d76              LDR      r5,|L1.9448|
00230e  b280              UXTH     r0,r0
002310  8028              STRH     r0,[r5,#0]
;;;2735   if(Uvv[0]<100) Uvv0=Uvv[0];
002312  f8dfe1d8          LDR      lr,|L1.9452|
002316  2864              CMP      r0,#0x64
002318  d202              BCS      |L1.8992|
00231a  f8ae0000          STRH     r0,[lr,#0]
00231e  e003              B        |L1.9000|
                  |L1.8992|
;;;2736   else Uvv0=net_U;
002320  4873              LDR      r0,|L1.9456|
002322  8800              LDRH     r0,[r0,#0]  ; net_U
002324  f8ae0000          STRH     r0,[lr,#0]
                  |L1.9000|
;;;2737   
;;;2738   //напряжение пэс
;;;2739   temp_SL=(signed long)adc_buff_ext_[1];
002328  f8bcc002          LDRH     r12,[r12,#2]  ; adc_buff_ext_
;;;2740   temp_SL*=Kunet_ext[1];
00232c  f9b80002          LDRSH    r0,[r8,#2]  ; Kunet_ext
002330  fb00f00c          MUL      r0,r0,r12
;;;2741   temp_SL/=4000L;
002334  fb90f0fb          SDIV     r0,r0,r11
;;;2742   Uvv[1]=(signed short)temp_SL;
002338  8068              STRH     r0,[r5,#2]
;;;2743   
;;;2744   
;;;2745   //напряжение ввода трехфазное
;;;2746   temp_SL=(signed long)eb2_data_short[0];
00233a  4d6e              LDR      r5,|L1.9460|
00233c  f9b50000          LDRSH    r0,[r5,#0]  ; eb2_data_short
;;;2747   temp_SL*=Kvv_eb2[0];
002340  f8dfc1b4          LDR      r12,|L1.9464|
002344  f9bc8000          LDRSH    r8,[r12,#0]  ; Kvv_eb2
002348  fb08f800          MUL      r8,r8,r0
;;;2748   temp_SL/=6000L;
00234c  f2417070          MOV      r0,#0x1770
002350  fb98fbf0          SDIV     r11,r8,r0
;;;2749   Uvv_eb2[0]=(signed short)temp_SL;
002354  f8df81a4          LDR      r8,|L1.9468|
002358  f8a8b000          STRH     r11,[r8,#0]
;;;2750   
;;;2751   temp_SL=(signed long)eb2_data_short[1];
00235c  f9b5b002          LDRSH    r11,[r5,#2]  ; eb2_data_short
;;;2752   temp_SL*=Kvv_eb2[1];
002360  f9bce002          LDRSH    lr,[r12,#2]  ; Kvv_eb2
002364  fb0efe0b          MUL      lr,lr,r11
;;;2753   temp_SL/=6000L;
002368  fb9efbf0          SDIV     r11,lr,r0
;;;2754   Uvv_eb2[1]=(signed short)temp_SL;
00236c  f8a8b002          STRH     r11,[r8,#2]
;;;2755   
;;;2756   temp_SL=(signed long)eb2_data_short[2];
002370  f9b5b004          LDRSH    r11,[r5,#4]  ; eb2_data_short
;;;2757   temp_SL*=Kvv_eb2[2];
002374  f9bcc004          LDRSH    r12,[r12,#4]  ; Kvv_eb2
002378  fb0cfc0b          MUL      r12,r12,r11
;;;2758   temp_SL/=6000L;
00237c  fb9cfcf0          SDIV     r12,r12,r0
;;;2759   Uvv_eb2[2]=(signed short)temp_SL;
002380  f8a8c004          STRH     r12,[r8,#4]
;;;2760   
;;;2761   //напряжение пэс трехфазное
;;;2762   temp_SL=(signed long)eb2_data_short[3];
002384  f9b5b006          LDRSH    r11,[r5,#6]  ; eb2_data_short
;;;2763   temp_SL*=Kpes_eb2[0];
002388  f8dfc174          LDR      r12,|L1.9472|
00238c  f9bc8000          LDRSH    r8,[r12,#0]  ; Kpes_eb2
002390  fb08f80b          MUL      r8,r8,r11
;;;2764   temp_SL/=6000L;
002394  fb98fbf0          SDIV     r11,r8,r0
;;;2765   Upes_eb2[0]=(signed short)temp_SL;
002398  f8df8168          LDR      r8,|L1.9476|
00239c  f8a8b000          STRH     r11,[r8,#0]
;;;2766   
;;;2767   temp_SL=(signed long)eb2_data_short[4];
0023a0  f9b5b008          LDRSH    r11,[r5,#8]  ; eb2_data_short
;;;2768   temp_SL*=Kpes_eb2[1];
0023a4  f9bce002          LDRSH    lr,[r12,#2]  ; Kpes_eb2
0023a8  fb0efe0b          MUL      lr,lr,r11
;;;2769   temp_SL/=6000L;
0023ac  fb9efbf0          SDIV     r11,lr,r0
;;;2770   Upes_eb2[1]=(signed short)temp_SL;
0023b0  f8a8b002          STRH     r11,[r8,#2]
;;;2771   
;;;2772   temp_SL=(signed long)eb2_data_short[5];
0023b4  f9b5b00a          LDRSH    r11,[r5,#0xa]  ; eb2_data_short
;;;2773   temp_SL*=Kpes_eb2[2];
0023b8  f9bc5004          LDRSH    r5,[r12,#4]  ; Kpes_eb2
0023bc  fb05f50b          MUL      r5,r5,r11
;;;2774   temp_SL/=6000L;
0023c0  fb95f0f0          SDIV     r0,r5,r0
;;;2775   Upes_eb2[2]=(signed short)temp_SL;
0023c4  f8a80004          STRH     r0,[r8,#4]
;;;2776   
;;;2777   //Вычисление температуры шкафа
;;;2778   
;;;2779   ibt._T[0]=t_ext[1]+273;
0023c8  f20a1a11          ADD      r10,r10,#0x111
0023cc  fa0ffc8a          SXTH     r12,r10
0023d0  f8dfa134          LDR      r10,|L1.9480|
0023d4  483a              LDR      r0,|L1.9408|
0023d6  f8aac000          STRH     r12,[r10,#0]
;;;2780   ibt._T[1]=t_ext[2]+273;
0023da  8880              LDRH     r0,[r0,#4]  ; t_ext
0023dc  f2001011          ADD      r0,r0,#0x111
0023e0  fa0ff880          SXTH     r8,r0
0023e4  f8aa8002          STRH     r8,[r10,#2]
;;;2781   
;;;2782   ibt._nd[0]=ND_EXT[1];
0023e8  784d              LDRB     r5,[r1,#1]  ; ND_EXT
0023ea  f88a5008          STRB     r5,[r10,#8]
;;;2783   ibt._nd[1]=ND_EXT[2];
0023ee  7888              LDRB     r0,[r1,#2]  ; ND_EXT
0023f0  f88a0009          STRB     r0,[r10,#9]
;;;2784   
;;;2785   #ifndef UKU_TELECORE2015
;;;2786   if((ibt._nd[0]==0) &&  (ibt._nd[1]==0))
;;;2787   	{
;;;2788   	t_box=((ibt._T[0]+ibt._T[1])/2)-273;
0023f4  4945              LDR      r1,|L1.9484|
0023f6  b905              CBNZ     r5,|L1.9210|
0023f8  b110              CBZ      r0,|L1.9216|
                  |L1.9210|
;;;2789   	}
;;;2790   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==0))
0023fa  2d01              CMP      r5,#1
0023fc  d00a              BEQ      |L1.9236|
0023fe  e00a              B        |L1.9238|
                  |L1.9216|
002400  eb0c0008          ADD      r0,r12,r8             ;2788
002404  eb0075d0          ADD      r5,r0,r0,LSR #31      ;2788
002408  f46f7088          MVN      r0,#0x110             ;2788
00240c  eb000065          ADD      r0,r0,r5,ASR #1       ;2788
002410  8008              STRH     r0,[r1,#0]            ;2788
002412  e01e              B        |L1.9298|
                  |L1.9236|
002414  b108              CBZ      r0,|L1.9242|
                  |L1.9238|
;;;2791   	{
;;;2792   	t_box=ibt._T[1]-273;
;;;2793   	}
;;;2794   else if((ibt._nd[0]==0) &&  (ibt._nd[1]==1))
002416  b12d              CBZ      r5,|L1.9252|
002418  e006              B        |L1.9256|
                  |L1.9242|
00241a  f2a81811          SUB      r8,r8,#0x111          ;2792
00241e  f8a18000          STRH     r8,[r1,#0]            ;2792
002422  e016              B        |L1.9298|
                  |L1.9252|
002424  2801              CMP      r0,#1
002426  d002              BEQ      |L1.9262|
                  |L1.9256|
;;;2795   	{
;;;2796   	t_box=ibt._T[0]-273;
;;;2797   	}
;;;2798   else if((ibt._nd[0]==1) &&  (ibt._nd[1]==1))
002428  2d01              CMP      r5,#1
00242a  d005              BEQ      |L1.9272|
00242c  e011              B        |L1.9298|
                  |L1.9262|
00242e  f2ac1c11          SUB      r12,r12,#0x111        ;2796
002432  f8a1c000          STRH     r12,[r1,#0]           ;2796
002436  e00c              B        |L1.9298|
                  |L1.9272|
002438  2801              CMP      r0,#1
00243a  d10a              BNE      |L1.9298|
;;;2799   	{
;;;2800   	if(t_ext_can_nd<5)t_box= t_ext_can;
00243c  4834              LDR      r0,|L1.9488|
00243e  7800              LDRB     r0,[r0,#0]  ; t_ext_can_nd
002440  2805              CMP      r0,#5
002442  d203              BCS      |L1.9292|
002444  4833              LDR      r0,|L1.9492|
002446  8800              LDRH     r0,[r0,#0]  ; t_ext_can
002448  8008              STRH     r0,[r1,#0]
00244a  e002              B        |L1.9298|
                  |L1.9292|
;;;2801   	else t_box=20;
00244c  f04f0014          MOV      r0,#0x14
002450  8008              STRH     r0,[r1,#0]
                  |L1.9298|
;;;2802   	}
;;;2803   #endif
;;;2804   /*
;;;2805   //Вычисление температуры шкафа
;;;2806   
;;;2807   ibt._T[0]=bat[0]._Tb+273;
;;;2808   ibt._T[1]=bat[1]._Tb+273;
;;;2809   ibt._T[2]=t_ext[1]+273;
;;;2810   ibt._T[3]=t_ext[2]+273;
;;;2811   
;;;2812   ibt._nd[0]=bat[0]._nd;
;;;2813   ibt._nd[1]=bat[1]._nd;
;;;2814   ibt._nd[2]=ND_EXT[1];
;;;2815   ibt._nd[3]=ND_EXT[2];
;;;2816   
;;;2817   ibt._avg1=0;
;;;2818   ibt._avg_cnt=4;
;;;2819   
;;;2820   if(ibt._nd[0]==0)
;;;2821   	{
;;;2822   	ibt._avg1+=ibt._T[0];
;;;2823   	}
;;;2824   else 
;;;2825   	{
;;;2826   	ibt._avg_cnt--;
;;;2827   	}
;;;2828   
;;;2829   if(ibt._nd[1]==0)
;;;2830   	{
;;;2831   	ibt._avg1+=ibt._T[1];
;;;2832   	}
;;;2833   else 
;;;2834   	{
;;;2835   	ibt._avg_cnt--;
;;;2836   	}
;;;2837   
;;;2838   if(ibt._nd[2]==0)
;;;2839   	{
;;;2840   	ibt._avg1+=ibt._T[2];
;;;2841   	}
;;;2842   else 
;;;2843   	{
;;;2844   	ibt._avg_cnt--;
;;;2845   	}
;;;2846   
;;;2847   if(ibt._nd[3]==0)
;;;2848   	{
;;;2849   	ibt._avg1+=ibt._T[3];
;;;2850   	}
;;;2851   else 
;;;2852   	{
;;;2853   	ibt._avg_cnt--;
;;;2854   	}
;;;2855   
;;;2856   if(ibt._avg_cnt==0)
;;;2857   	{
;;;2858   	}
;;;2859   else
;;;2860   	{
;;;2861   	ibt._avg1/=ibt._avg_cnt;
;;;2862   	}
;;;2863   
;;;2864   
;;;2865   if(ibt._nd[0]!=0)
;;;2866   	{
;;;2867   	ibt._T_dispers[0]=0;
;;;2868   	}
;;;2869   else 
;;;2870   	{
;;;2871   	ibt._T_dispers[0]=abs(ibt._T[0]-ibt._avg1);
;;;2872   	}
;;;2873   
;;;2874   if(ibt._nd[1]!=0)
;;;2875   	{
;;;2876   	ibt._T_dispers[1]=0;
;;;2877   	}
;;;2878   else 
;;;2879   	{
;;;2880   	ibt._T_dispers[1]=abs(ibt._T[1]-ibt._avg1);
;;;2881   	}
;;;2882   
;;;2883   if(ibt._nd[2]!=0)
;;;2884   	{
;;;2885   	ibt._T_dispers[2]=0;
;;;2886   	}
;;;2887   else 
;;;2888   	{
;;;2889   	ibt._T_dispers[2]=abs(ibt._T[2]-ibt._avg1);
;;;2890   	}
;;;2891   
;;;2892   if(ibt._nd[3]!=0)
;;;2893   	{
;;;2894   	ibt._T_dispers[3]=0;
;;;2895   	}
;;;2896   else 
;;;2897   	{
;;;2898   	ibt._T_dispers[3]=abs(ibt._T[3]-ibt._avg1);
;;;2899   	}
;;;2900   
;;;2901   if(	ibt._nd[0]&&
;;;2902   	ibt._nd[1]&&
;;;2903   	ibt._nd[2]&&
;;;2904   	ibt._nd[3]
;;;2905   	)
;;;2906   	{
;;;2907   	t_box=(bps[0]._Ti);
;;;2908   	}
;;;2909   
;;;2910   else if(	ibt._nd[0]||
;;;2911   	ibt._nd[1]||
;;;2912   	ibt._nd[2]||
;;;2913   	ibt._nd[3]
;;;2914   	)
;;;2915   	{
;;;2916   	t_box=(ibt._avg1-273);
;;;2917   	}
;;;2918   else 
;;;2919   	{
;;;2920   	ibt._max_dispers_num=0;
;;;2921   	ibt._max_dispers=ibt._T_dispers[0];
;;;2922   
;;;2923   	if(ibt._T_dispers[1]>ibt._max_dispers)
;;;2924   		{
;;;2925   		ibt._max_dispers_num=1;
;;;2926   		ibt._max_dispers=ibt._T_dispers[1];
;;;2927   		}
;;;2928   	if(ibt._T_dispers[2]>ibt._max_dispers)
;;;2929   		{
;;;2930   		ibt._max_dispers_num=2;
;;;2931   		ibt._max_dispers=ibt._T_dispers[2];
;;;2932   		}
;;;2933   	if(ibt._T_dispers[3]>ibt._max_dispers)
;;;2934   		{
;;;2935   		ibt._max_dispers_num=3;
;;;2936   		ibt._max_dispers=ibt._T_dispers[3];
;;;2937   		}
;;;2938   
;;;2939   	ibt._avg2=0;
;;;2940   
;;;2941   	if(ibt._max_dispers_num!=0)
;;;2942   		{
;;;2943   		ibt._avg2+=ibt._T[0];
;;;2944   		}
;;;2945   	if(ibt._max_dispers_num!=1)
;;;2946   		{
;;;2947   		ibt._avg2+=ibt._T[1];
;;;2948   		}
;;;2949   	if(ibt._max_dispers_num!=2)
;;;2950   		{
;;;2951   		ibt._avg2+=ibt._T[2];
;;;2952   		}
;;;2953   	if(ibt._max_dispers_num!=3)
;;;2954   		{
;;;2955   		ibt._avg2+=ibt._T[3];
;;;2956   		}
;;;2957   
;;;2958   	t_box=(ibt._avg2/3)-273;
;;;2959   
;;;2960   	}*/
;;;2961   
;;;2962   
;;;2963   //*********************************************
;;;2964   
;;;2965   #ifndef TELECORE
;;;2966   if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib;
002452  4931              LDR      r1,|L1.9496|
002454  7808              LDRB     r0,[r1,#0]  ; BAT_IS_ON
002456  2855              CMP      r0,#0x55
002458  d105              BNE      |L1.9318|
00245a  9801              LDR      r0,[sp,#4]
00245c  28c8              CMP      r0,#0xc8
00245e  dd02              BLE      |L1.9318|
002460  8910              LDRH     r0,[r2,#8]  ; bat
002462  f8a60044          STRH     r0,[r6,#0x44]
                  |L1.9318|
;;;2967   if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
002466  7848              LDRB     r0,[r1,#1]  ; BAT_IS_ON
002468  2855              CMP      r0,#0x55
00246a  d10b              BNE      |L1.9348|
00246c  f9b2004e          LDRSH    r0,[r2,#0x4e]  ; bat
002470  28c8              CMP      r0,#0xc8
002472  dd07              BLE      |L1.9348|
002474  f9b20054          LDRSH    r0,[r2,#0x54]  ; bat
002478  f9b21008          LDRSH    r1,[r2,#8]  ; bat
00247c  4288              CMP      r0,r1
00247e  dd01              BLE      |L1.9348|
002480  f8a60044          STRH     r0,[r6,#0x44]
                  |L1.9348|
;;;2968   #endif
;;;2969   
;;;2970   #ifdef TELECORE
;;;2971   Ibmax=0;
;;;2972   /*
;;;2973   if((NUMBAT_TELECORE>0)&&(lakb[0]._communicationFullErrorStat==0)&&(lakb[0]._ch_curr/10>Ibmax))Ibmax=lakb[0]._ch_curr/10;
;;;2974   if((NUMBAT_TELECORE>1)&&(lakb[1]._communicationFullErrorStat==0)&&(lakb[1]._ch_curr/10>Ibmax))Ibmax=lakb[1]._ch_curr/10;
;;;2975   if((NUMBAT_TELECORE>2)&&(lakb[2]._communicationFullErrorStat==0)&&(lakb[2]._ch_curr/10>Ibmax))Ibmax=lakb[2]._ch_curr/10;
;;;2976   */
;;;2977   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;2978   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;2979   //if((BAT_IS_ON[0]==bisON)&&(bat[0]._Ub>200)) Ibmax=bat[0]._Ib/1;
;;;2980   //if((BAT_IS_ON[1]==bisON)&&(bat[1]._Ub>200)&&(bat[1]._Ib>bat[0]._Ib)) Ibmax=bat[1]._Ib;
;;;2981   #endif
;;;2982   //Ibmax=bat[0]._Ib;
;;;2983   //if((AUSW_MAIN==22063)||(AUSW_MAIN==22023)||(AUSW_MAIN==22043))Ibmax=Ib_ips_termokompensat;
;;;2984   
;;;2985   #ifdef UKU_TELECORE2017
;;;2986   Ibmax=0;
;;;2987   if((NUMBAT_TELECORE>0)&&(bat[0]._Ib/10>Ibmax))Ibmax=bat[0]._Ib/10;
;;;2988   if((NUMBAT_TELECORE>1)&&(bat[1]._Ib/10>Ibmax))Ibmax=bat[1]._Ib/10;
;;;2989   #endif
;;;2990   
;;;2991   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;2992   Ibmax=Ib_ips_termokompensat;
002484  f8b90000          LDRH     r0,[r9,#0]  ; Ib_ips_termokompensat
002488  f8a60044          STRH     r0,[r6,#0x44]
;;;2993   #endif
;;;2994   for(i=0;i<NUMIST;i++)
00248c  f04f0100          MOV      r1,#0
002490  e074              B        |L1.9596|
002492  0000              DCW      0x0000
                  |L1.9364|
                          DCD      AUSW_MAIN
                  |L1.9368|
                          DCD      out_U
                  |L1.9372|
                          DCD      load_U
                  |L1.9376|
                          DCD      Kubps
                  |L1.9380|
                          DCD      bps_U
                  |L1.9384|
                          DCD      NUMIST
                  |L1.9388|
                          DCD      bps
                  |L1.9392|
                          DCD      bps_I
                  |L1.9396|
                          DCD      ||.bss||+0x40c
                  |L1.9400|
                          DCD      ND_EXT
                  |L1.9404|
                          DCD      Ktext
                  |L1.9408|
                          DCD      t_ext
                  |L1.9412|
                          DCD      Ib_ips_termokompensat
                  |L1.9416|
                          DCD      ibat_metr_buff_
                  |L1.9420|
                          DCD      bIBAT_SMKLBR
                  |L1.9424|
                          DCD      bIBAT_SMKLBR_cnt
                  |L1.9428|
                          DCD      Kibat1
                  |L1.9432|
                          DCD      Ib_ips_termokompensat_temp
                  |L1.9436|
                          DCD      bat
                  |L1.9440|
                          DCD      adc_buff_ext_
                  |L1.9444|
                          DCD      Kunet_ext
                  |L1.9448|
                          DCD      Uvv
                  |L1.9452|
                          DCD      Uvv0
                  |L1.9456|
                          DCD      net_U
                  |L1.9460|
                          DCD      eb2_data_short
                  |L1.9464|
                          DCD      Kvv_eb2
                  |L1.9468|
                          DCD      Uvv_eb2
                  |L1.9472|
                          DCD      Kpes_eb2
                  |L1.9476|
                          DCD      Upes_eb2
                  |L1.9480|
                          DCD      ibt
                  |L1.9484|
                          DCD      t_box
                  |L1.9488|
                          DCD      t_ext_can_nd
                  |L1.9492|
                          DCD      t_ext_can
                  |L1.9496|
                          DCD      BAT_IS_ON
                  |L1.9500|
;;;2995   	{
;;;2996   	if(bps[i]._cnt<25)
00251c  ebc100c1          RSB      r0,r1,r1,LSL #3
002520  eb001001          ADD      r0,r0,r1,LSL #4
002524  eb040080          ADD      r0,r4,r0,LSL #2
002528  78c5              LDRB     r5,[r0,#3]
00252a  2d19              CMP      r5,#0x19
00252c  d21c              BCS      |L1.9576|
;;;2997        	{
;;;2998        	bps[i]._Ii=bps[i]._buff[0]+(bps[i]._buff[1]*256);
00252e  7985              LDRB     r5,[r0,#6]
002530  79c6              LDRB     r6,[r0,#7]
002532  eb052506          ADD      r5,r5,r6,LSL #8
002536  6245              STR      r5,[r0,#0x24]
;;;2999        	bps[i]._Uin=bps[i]._buff[2]+(bps[i]._buff[3]*256);
002538  7a05              LDRB     r5,[r0,#8]
00253a  7a46              LDRB     r6,[r0,#9]
00253c  eb052506          ADD      r5,r5,r6,LSL #8
002540  6205              STR      r5,[r0,#0x20]
;;;3000        	bps[i]._Uii=bps[i]._buff[4]+(bps[i]._buff[5]*256);
002542  7a85              LDRB     r5,[r0,#0xa]
002544  7ac6              LDRB     r6,[r0,#0xb]
002546  eb052506          ADD      r5,r5,r6,LSL #8
00254a  61c5              STR      r5,[r0,#0x1c]
;;;3001        	bps[i]._Ti=(signed)(bps[i]._buff[6]);
00254c  7b05              LDRB     r5,[r0,#0xc]
00254e  6285              STR      r5,[r0,#0x28]
;;;3002        	bps[i]._adr_ee=bps[i]._buff[7];
002550  7b45              LDRB     r5,[r0,#0xd]
002552  f8805052          STRB     r5,[r0,#0x52]
;;;3003        	bps[i]._flags_tm=bps[i]._buff[8];
002556  7b85              LDRB     r5,[r0,#0xe]
002558  f8805042          STRB     r5,[r0,#0x42]
;;;3004   	     bps[i]._rotor=bps[i]._buff[10]+(bps[i]._buff[11]*256);    
00255c  7c05              LDRB     r5,[r0,#0x10]
00255e  7c46              LDRB     r6,[r0,#0x11]
002560  eb052506          ADD      r5,r5,r6,LSL #8
002564  64c5              STR      r5,[r0,#0x4c]
002566  e006              B        |L1.9590|
                  |L1.9576|
;;;3005        	} 
;;;3006   	else 
;;;3007        	{
;;;3008        	bps[i]._Uii=0; 
002568  61c3              STR      r3,[r0,#0x1c]
;;;3009        	bps[i]._Ii=0;
00256a  6243              STR      r3,[r0,#0x24]
;;;3010        	bps[i]._Uin=0;
00256c  6203              STR      r3,[r0,#0x20]
;;;3011        	bps[i]._Ti=0;
00256e  6283              STR      r3,[r0,#0x28]
;;;3012        	bps[i]._flags_tm=0; 
002570  f8803042          STRB     r3,[r0,#0x42]
;;;3013   	     bps[i]._rotor=0;    
002574  64c3              STR      r3,[r0,#0x4c]
                  |L1.9590|
002576  f1010101          ADD      r1,r1,#1              ;2994
00257a  b2c9              UXTB     r1,r1                 ;2994
                  |L1.9596|
00257c  42b9              CMP      r1,r7                 ;2994
00257e  dbcd              BLT      |L1.9500|
;;;3014        	}
;;;3015        
;;;3016        }
;;;3017   
;;;3018   load_I=0;
002580  4df9              LDR      r5,|L1.10600|
;;;3019   #ifdef TELECORE
;;;3020   
;;;3021   /*for(i=0;i<NUMBAT_TELECORE;i++)
;;;3022   	{
;;;3023   	load_I-=lakb[i]._ch_curr/10;
;;;3024   	}*/
;;;3025   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;3026   #elif UKU_TELECORE2017
;;;3027   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
;;;3028   #else
;;;3029   load_I=-(bat[0]._Ib/10)-(bat[1]._Ib/10);
002582  f9b21008          LDRSH    r1,[r2,#8]  ; bat
002586  f04f000a          MOV      r0,#0xa
00258a  fb91f1f0          SDIV     r1,r1,r0
00258e  f9b22054          LDRSH    r2,[r2,#0x54]  ; bat
002592  fb92f0f0          SDIV     r0,r2,r0
002596  4408              ADD      r0,r0,r1
002598  f1c00000          RSB      r0,r0,#0
00259c  b206              SXTH     r6,r0
00259e  802e              STRH     r6,[r5,#0]
;;;3030   #endif
;;;3031   Isumm=0;
0025a0  4af2              LDR      r2,|L1.10604|
0025a2  8013              STRH     r3,[r2,#0]
;;;3032   
;;;3033   for(i=0;i<NUMIST;i++)
0025a4  f04f0000          MOV      r0,#0
0025a8  e012              B        |L1.9680|
                  |L1.9642|
;;;3034        {
;;;3035        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
0025aa  ebc001c0          RSB      r1,r0,r0,LSL #3
0025ae  eb011100          ADD      r1,r1,r0,LSL #4
0025b2  eb040181          ADD      r1,r4,r1,LSL #2
0025b6  f891c003          LDRB     r12,[r1,#3]
0025ba  f1bc0f05          CMP      r12,#5
0025be  d204              BCS      |L1.9674|
0025c0  6a49              LDR      r1,[r1,#0x24]
0025c2  f8b2c000          LDRH     r12,[r2,#0]  ; Isumm
0025c6  4461              ADD      r1,r1,r12
0025c8  8011              STRH     r1,[r2,#0]
                  |L1.9674|
0025ca  f1000001          ADD      r0,r0,#1              ;3033
0025ce  b2c0              UXTB     r0,r0                 ;3033
                  |L1.9680|
0025d0  42b8              CMP      r0,r7                 ;3033
0025d2  dbea              BLT      |L1.9642|
;;;3036        }  
;;;3037        
;;;3038   load_I=load_I+Isumm;
0025d4  8810              LDRH     r0,[r2,#0]  ; Isumm
0025d6  4430              ADD      r0,r0,r6
0025d8  b200              SXTH     r0,r0
0025da  8028              STRH     r0,[r5,#0]
;;;3039   if(load_I<0)load_I=0;
0025dc  2800              CMP      r0,#0
0025de  da00              BGE      |L1.9698|
0025e0  802b              STRH     r3,[r5,#0]
                  |L1.9698|
;;;3040   
;;;3041   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;3042   load_I=0;
0025e2  802b              STRH     r3,[r5,#0]
;;;3043   
;;;3044   Isumm=0;
0025e4  8013              STRH     r3,[r2,#0]
;;;3045   
;;;3046   for(i=0;i<NUMIST;i++)
0025e6  f04f0000          MOV      r0,#0
0025ea  e00f              B        |L1.9740|
                  |L1.9708|
;;;3047        {
;;;3048        if(bps[i]._cnt<5)Isumm+=bps[i]._Ii;
0025ec  ebc001c0          RSB      r1,r0,r0,LSL #3
0025f0  eb011100          ADD      r1,r1,r0,LSL #4
0025f4  eb040181          ADD      r1,r4,r1,LSL #2
0025f8  78ce              LDRB     r6,[r1,#3]
0025fa  2e05              CMP      r6,#5
0025fc  d203              BCS      |L1.9734|
0025fe  6a49              LDR      r1,[r1,#0x24]
002600  8816              LDRH     r6,[r2,#0]  ; Isumm
002602  4431              ADD      r1,r1,r6
002604  8011              STRH     r1,[r2,#0]
                  |L1.9734|
002606  f1000001          ADD      r0,r0,#1              ;3046
00260a  b2c0              UXTB     r0,r0                 ;3046
                  |L1.9740|
00260c  42b8              CMP      r0,r7                 ;3046
00260e  dbed              BLT      |L1.9708|
;;;3049        }  
;;;3050        
;;;3051   load_I=load_I+Isumm;
002610  8811              LDRH     r1,[r2,#0]  ; Isumm
002612  eb030001          ADD      r0,r3,r1
002616  b200              SXTH     r0,r0
002618  8028              STRH     r0,[r5,#0]
;;;3052   if(load_I<0)load_I=0;
00261a  2800              CMP      r0,#0
00261c  da00              BGE      |L1.9760|
00261e  802b              STRH     r3,[r5,#0]
                  |L1.9760|
;;;3053   
;;;3054   #endif
;;;3055   #ifdef IPS_SGEP_GAZPROM
;;;3056   load_I=Isumm;
;;;3057   #endif
;;;3058   
;;;3059   
;;;3060   #ifdef UKU_GLONASS
;;;3061   inv[0]._Uio=6;
;;;3062   if (NUMINV)
;;;3063   	{
;;;3064   	for(i=0;i<NUMINV;i++)
;;;3065   		{
;;;3066   		if(bps[i+first_inv_slot]._cnt<25)
;;;3067        		{
;;;3068        		inv[i]._Ii=bps[i+first_inv_slot]._buff[0]+(bps[i+first_inv_slot]._buff[1]*256);
;;;3069        		inv[i]._Uin=bps[i+first_inv_slot]._buff[2]+(bps[i+first_inv_slot]._buff[3]*256);
;;;3070        		inv[i]._Uio=bps[i+first_inv_slot]._buff[4]+(bps[i+first_inv_slot]._buff[5]*256);
;;;3071        		inv[i]._Ti=(signed)(bps[i+first_inv_slot]._buff[6]);
;;;3072        		inv[i]._flags_tm=bps[i+first_inv_slot]._buff[8];
;;;3073   	    	//	inv[i]._rotor=bps[i+first_inv_slot]._buff[10]+(bps[i+first_inv_slot]._buff[11]*256);
;;;3074   			inv[i]._cnt=0;    
;;;3075        		} 
;;;3076   		else 
;;;3077        		{
;;;3078        		inv[i]._Uio=0; 
;;;3079        		inv[i]._Ii=0;
;;;3080        		inv[i]._Uin=0;
;;;3081        		inv[i]._Ti=0;
;;;3082        		inv[i]._flags_tm=0; 
;;;3083   //	     	inv[i]._rotor0;
;;;3084   			inv[i]._cnt=25;    
;;;3085        		}
;;;3086        	}
;;;3087      	}
;;;3088   #endif
;;;3089   
;;;3090   #ifndef UKU_GLONASS
;;;3091   if (NUMINV)
002620  48d3              LDR      r0,|L1.10608|
002622  f9b05000          LDRSH    r5,[r0,#0]  ; NUMINV
002626  2d00              CMP      r5,#0
002628  d066              BEQ      |L1.9976|
;;;3092   	{
;;;3093   	for(i=0;i<NUMINV;i++)
00262a  f04f0200          MOV      r2,#0
;;;3094   		{
;;;3095   		if(bps[i+20]._cnt<25)
;;;3096        		{
;;;3097        		inv[i]._Ii=bps[i+20]._buff[0]+(bps[i+20]._buff[1]*256);
00262e  4ed1              LDR      r6,|L1.10612|
002630  e060              B        |L1.9972|
                  |L1.9778|
002632  f1020014          ADD      r0,r2,#0x14           ;3095
002636  ebc001c0          RSB      r1,r0,r0,LSL #3       ;3095
00263a  eb011000          ADD      r0,r1,r0,LSL #4       ;3095
00263e  eb040080          ADD      r0,r4,r0,LSL #2       ;3095
002642  78c1              LDRB     r1,[r0,#3]            ;3095
002644  2919              CMP      r1,#0x19              ;3095
002646  d239              BCS      |L1.9916|
002648  7981              LDRB     r1,[r0,#6]
00264a  79c7              LDRB     r7,[r0,#7]
00264c  eb012707          ADD      r7,r1,r7,LSL #8
002650  eb020142          ADD      r1,r2,r2,LSL #1
002654  eb061141          ADD      r1,r6,r1,LSL #5
002658  61cf              STR      r7,[r1,#0x1c]
;;;3098        		inv[i]._Pio=bps[i+20]._buff[2]+(bps[i+20]._buff[3]*256);
00265a  7a07              LDRB     r7,[r0,#8]
00265c  f890c009          LDRB     r12,[r0,#9]
002660  eb07270c          ADD      r7,r7,r12,LSL #8
002664  62cf              STR      r7,[r1,#0x2c]
;;;3099        		inv[i]._Uio=bps[i+20]._buff[4]+(bps[i+20]._buff[5]*256);
002666  7a87              LDRB     r7,[r0,#0xa]
002668  f890c00b          LDRB     r12,[r0,#0xb]
00266c  eb07270c          ADD      r7,r7,r12,LSL #8
002670  618f              STR      r7,[r1,#0x18]
;;;3100        		inv[i]._Ti=(signed)(bps[i+20]._buff[6]);
002672  7b07              LDRB     r7,[r0,#0xc]
002674  620f              STR      r7,[r1,#0x20]
;;;3101        		inv[i]._flags_tm=bps[i+20]._buff[7];
002676  7b47              LDRB     r7,[r0,#0xd]
002678  f8817046          STRB     r7,[r1,#0x46]
;;;3102        		inv[i]._Uin=bps[i+20]._buff[8]+(bps[i+20]._buff[9]*256);
00267c  7b87              LDRB     r7,[r0,#0xe]
00267e  f890c00f          LDRB     r12,[r0,#0xf]
002682  eb07270c          ADD      r7,r7,r12,LSL #8
002686  628f              STR      r7,[r1,#0x28]
;;;3103        		inv[i]._Uil=bps[i+20]._buff[10]+(bps[i+20]._buff[11]*256);
002688  7c07              LDRB     r7,[r0,#0x10]
00268a  f890c011          LDRB     r12,[r0,#0x11]
00268e  eb07270c          ADD      r7,r7,r12,LSL #8
002692  624f              STR      r7,[r1,#0x24]
;;;3104   			inv[i]._cnt=0;
002694  708b              STRB     r3,[r1,#2]
;;;3105   			inv[i]._Uoutmin=bps[i+20]._buff[12]; 
002696  7c87              LDRB     r7,[r0,#0x12]
002698  f8817059          STRB     r7,[r1,#0x59]
;;;3106   			inv[i]._Uoutmax=bps[i+20]._buff[13]; 
00269c  7cc7              LDRB     r7,[r0,#0x13]
00269e  f881705a          STRB     r7,[r1,#0x5a]
;;;3107   			inv[i]._Pnom=bps[i+20]._buff[14]; 
0026a2  7d07              LDRB     r7,[r0,#0x14]
0026a4  f8817058          STRB     r7,[r1,#0x58]
;;;3108   			inv[i]._net_contr_en=bps[i+20]._buff[15];
0026a8  7d47              LDRB     r7,[r0,#0x15]
0026aa  f881705b          STRB     r7,[r1,#0x5b]
;;;3109   			inv[i]._pwm_en=bps[i+20]._buff[16];  
0026ae  7d87              LDRB     r7,[r0,#0x16]
0026b0  f881705c          STRB     r7,[r1,#0x5c]
;;;3110   			inv[i]._phase_mode=bps[i+20]._buff[17];  
0026b4  7dc0              LDRB     r0,[r0,#0x17]
0026b6  f881005d          STRB     r0,[r1,#0x5d]
0026ba  e018              B        |L1.9966|
                  |L1.9916|
;;;3111        		} 
;;;3112   		else 
;;;3113        		{
;;;3114         		inv[i]._Ii=0;
0026bc  eb020042          ADD      r0,r2,r2,LSL #1
0026c0  eb061040          ADD      r0,r6,r0,LSL #5
0026c4  61c3              STR      r3,[r0,#0x1c]
;;;3115   			inv[i]._Pio=0;
0026c6  62c3              STR      r3,[r0,#0x2c]
;;;3116   			inv[i]._Uio=0;
0026c8  6183              STR      r3,[r0,#0x18]
;;;3117        		inv[i]._Ti=0;
0026ca  6203              STR      r3,[r0,#0x20]
;;;3118        		inv[i]._flags_tm=0; 
0026cc  f8803046          STRB     r3,[r0,#0x46]
;;;3119        		inv[i]._Uil=0;
0026d0  6243              STR      r3,[r0,#0x24]
;;;3120        		inv[i]._Uin=0;
0026d2  6283              STR      r3,[r0,#0x28]
;;;3121   			inv[i]._cnt=25; 
0026d4  f04f0119          MOV      r1,#0x19
0026d8  7081              STRB     r1,[r0,#2]
;;;3122   			inv[i]._Uoutmin=0; 
0026da  f8803059          STRB     r3,[r0,#0x59]
;;;3123   			inv[i]._Uoutmax=0; 
0026de  f880305a          STRB     r3,[r0,#0x5a]
;;;3124   			inv[i]._Pnom=0; 
0026e2  f8803058          STRB     r3,[r0,#0x58]
;;;3125   			inv[i]._net_contr_en=0;
0026e6  f880305b          STRB     r3,[r0,#0x5b]
;;;3126   			inv[i]._pwm_en=0;   
0026ea  f880305c          STRB     r3,[r0,#0x5c]
                  |L1.9966|
0026ee  f1020201          ADD      r2,r2,#1              ;3093
0026f2  b2d2              UXTB     r2,r2                 ;3093
                  |L1.9972|
0026f4  42aa              CMP      r2,r5                 ;3093
0026f6  db9c              BLT      |L1.9778|
                  |L1.9976|
;;;3127   			   
;;;3128        		}
;;;3129        	}
;;;3130      	}
;;;3131   #endif
;;;3132   
;;;3133   #ifdef GLADKOV
;;;3134   inv[0]._Ii=bps[4]._buff[0]+(bps[4]._buff[1]*256);
;;;3135   inv[0]._Pio=bps[4]._buff[2]+(bps[4]._buff[3]*256);
;;;3136   inv[0]._Uio=bps[4]._buff[4]+(bps[4]._buff[5]*256);
;;;3137   inv[0]._Ti=(signed)(bps[4]._buff[6]);
;;;3138   inv[0]._flags_tm=bps[4]._buff[7];
;;;3139   inv[0]._Uin=bps[4]._buff[8]+(bps[4]._buff[9]*256);
;;;3140   inv[0]._Uil=bps[4]._buff[10]+(bps[4]._buff[11]*256);
;;;3141   inv[0]._cnt=0;    
;;;3142   
;;;3143   inv[1]._Ii=bps[21]._buff[0]+(bps[21]._buff[1]*256);
;;;3144   inv[1]._Pio=bps[21]._buff[2]+(bps[21]._buff[3]*256);
;;;3145   inv[1]._Uio=bps[21]._buff[4]+(bps[21]._buff[5]*256);
;;;3146   inv[1]._Ti=(signed)(bps[21]._buff[6]);
;;;3147   inv[1]._flags_tm=bps[21]._buff[7];
;;;3148   inv[1]._Uin=bps[21]._buff[8]+(bps[21]._buff[9]*256);
;;;3149   inv[1]._Uil=bps[21]._buff[10]+(bps[21]._buff[11]*256);
;;;3150   inv[1]._cnt=0;    
;;;3151   #endif
;;;3152   
;;;3153   /*
;;;3154   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE==1))
;;;3155   	{
;;;3156   	lakb[0]._battCommState=0;
;;;3157   	if(lakb[0]._cnt>10)lakb[0]._battCommState=2;
;;;3158   	else if(lakb[0]._bRS485ERR==1)lakb[0]._battCommState=1;
;;;3159   	
;;;3160   	if(lakb[0]._battCommState==0)
;;;3161   		{	
;;;3162   		bat[0]._Ub=(signed short)((lakb[0]._tot_bat_volt+5)/10);
;;;3163   		bat[0]._Ib=(signed short)lakb[0]._ch_curr;
;;;3164   		if(lakb[0]._dsch_curr) bat[0]._Ib=(signed short) (-lakb[0]._dsch_curr);
;;;3165   		bat[0]._Tb=(signed short)lakb[0]._max_cell_temp;
;;;3166   		}
;;;3167   	}
;;;3168   */
;;;3169   
;;;3170   #ifdef UKU_TELECORE2015
;;;3171   
;;;3172   	if(BAT_TYPE==2)
;;;3173   		{
;;;3174   		lakb[0]._ch_curr/*temp_SS*/=((ascii2halFhex(liBatteryInBuff[113]))<<12)+
;;;3175   					 		((ascii2halFhex(liBatteryInBuff[114]))<<8)+
;;;3176   							((ascii2halFhex(liBatteryInBuff[115]))<<4)+
;;;3177   							((ascii2halFhex(liBatteryInBuff[116])));
;;;3178   		
;;;3179   		/*if(temp_SS&0x8000)		lakb[0]._ch_curr=~temp_SS;
;;;3180   		else 				lakb[0]._ch_curr=temp_SS;*/
;;;3181   	
;;;3182   		lakb[0]._tot_bat_volt=	(unsigned short)(((ascii2halFhex(liBatteryInBuff[117]))<<12)+
;;;3183   							((ascii2halFhex(liBatteryInBuff[118]))<<8)+
;;;3184   							((ascii2halFhex(liBatteryInBuff[119]))<<4)+
;;;3185   							((ascii2halFhex(liBatteryInBuff[120]))))/100;
;;;3186   	
;;;3187   		lakb[0]._max_cell_temp= 	(((ascii2halFhex(liBatteryInBuff[93]))<<12)+
;;;3188   							((ascii2halFhex(liBatteryInBuff[94]))<<8)+
;;;3189   							((ascii2halFhex(liBatteryInBuff[95]))<<4)+
;;;3190   							((ascii2halFhex(liBatteryInBuff[96]))))/10-273;
;;;3191   	
;;;3192   		lakb[0]._s_o_c_abs=		(unsigned short)((ascii2halFhex(liBatteryInBuff[121]))<<12)+
;;;3193   							((ascii2halFhex(liBatteryInBuff[122]))<<8)+
;;;3194   							((ascii2halFhex(liBatteryInBuff[123]))<<4)+
;;;3195   							((ascii2halFhex(liBatteryInBuff[124])));
;;;3196   	
;;;3197   		lakb[0]._rat_cap=		(unsigned short)((ascii2halFhex(liBatteryInBuff[127]))<<12)+
;;;3198   							((ascii2halFhex(liBatteryInBuff[128]))<<8)+
;;;3199   							((ascii2halFhex(liBatteryInBuff[129]))<<4)+
;;;3200   							((ascii2halFhex(liBatteryInBuff[130])));
;;;3201   	
;;;3202   		lakb[0]._s_o_c=		lakb[0]._s_o_c_abs/(lakb[0]._rat_cap/100);
;;;3203   	
;;;3204   	
;;;3205   	/*	lakb[0]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;3206   		lakb[0]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;3207   		lakb[0]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;3208   		lakb[0]._max_cell_temp= lakb_damp[i][4];
;;;3209   		lakb[0]._min_cell_temp= lakb_damp[i][5];
;;;3210   		lakb[0]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;3211   		lakb[0]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][8];
;;;3212   		lakb[0]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;3213   		lakb[0]._s_o_c= lakb_damp[i][12];
;;;3214   		lakb[0]._r_b_t= lakb_damp[i][15];
;;;3215   		lakb[0]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;3216   		lakb[0]._s_o_h= lakb_damp[i][18];
;;;3217   	
;;;3218   		if(lakb[i]._rat_cap==0)
;;;3219   			{
;;;3220   			if(lakb[i]._isOnCnt)
;;;3221   				{
;;;3222   				lakb[i]._isOnCnt--;
;;;3223   				if(lakb[i]._isOnCnt==0)
;;;3224   					{
;;;3225   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;3226   					}
;;;3227   				}
;;;3228   			}
;;;3229   		else 
;;;3230   			{
;;;3231   			if(lakb[i]._isOnCnt<50)
;;;3232   				{
;;;3233   				lakb[i]._isOnCnt++;
;;;3234   				if(lakb[i]._isOnCnt==50)
;;;3235   					{
;;;3236   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;3237   					}
;;;3238   				}
;;;3239   			}
;;;3240   		gran(&lakb[i]._isOnCnt,0,50);*/
;;;3241   		}
;;;3242   	else if(BAT_TYPE==3)
;;;3243   		{
;;;3244   		//short numOfPacks;
;;;3245   		//short numOfCells, numOfTemperCells, baseOfData;
;;;3246   		
;;;3247   		#ifndef UKU_TELECORE2016
;;;3248   		numOfCells=((ascii2halFhex(liBatteryInBuff[17]))<<4)+((ascii2halFhex(liBatteryInBuff[18])));
;;;3249   		numOfTemperCells=((ascii2halFhex(liBatteryInBuff[17+(numOfCells*4)+2]))<<4)+((ascii2halFhex(liBatteryInBuff[18+(numOfCells*4)+2])));
;;;3250   		numOfPacks=((ascii2halFhex(liBatteryInBuff[15]))<<4)+((ascii2halFhex(liBatteryInBuff[16])));
;;;3251   		if(numOfPacks)numOfPacks-=1;
;;;3252   		if((numOfPacks<0)||(numOfPacks>NUMBAT_TELECORE))numOfPacks=0;
;;;3253   		plazma_numOfCells=numOfCells;
;;;3254   		plazma_numOfTemperCells=numOfTemperCells;
;;;3255   		plazma_numOfPacks=numOfPacks;
;;;3256   
;;;3257   
;;;3258   		baseOfData=16+(numOfCells*4)+2+(numOfTemperCells*4)+2;
;;;3259   
;;;3260   		lakb[numOfPacks]._ch_curr=(signed short)(
;;;3261   							((ascii2halFhex(liBatteryInBuff[1+baseOfData]))<<12)+
;;;3262   							((ascii2halFhex(liBatteryInBuff[2+baseOfData]))<<8)+
;;;3263   							((ascii2halFhex(liBatteryInBuff[3+baseOfData]))<<4)+
;;;3264   							((ascii2halFhex(liBatteryInBuff[4+baseOfData])))
;;;3265   							);	  
;;;3266   
;;;3267   		lakb[numOfPacks]._tot_bat_volt=(signed short)(
;;;3268   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+4]))<<12)+
;;;3269   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+4]))<<8)+
;;;3270   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+4]))<<4)+
;;;3271   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+4])))
;;;3272   							)/10;
;;;3273   
;;;3274   		lakb[numOfPacks]._max_cell_temp=(signed short)(
;;;3275   							((ascii2halFhex(liBatteryInBuff[1+baseOfData-4]))<<12)+
;;;3276   							((ascii2halFhex(liBatteryInBuff[2+baseOfData-4]))<<8)+
;;;3277   							((ascii2halFhex(liBatteryInBuff[3+baseOfData-4]))<<4)+
;;;3278   							((ascii2halFhex(liBatteryInBuff[4+baseOfData-4])))
;;;3279   							)-2730;
;;;3280   
;;;3281   		lakb[numOfPacks]._s_o_c=(signed short)(
;;;3282   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+8]))<<12)+
;;;3283   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+8]))<<8)+
;;;3284   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+8]))<<4)+
;;;3285   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+8])))
;;;3286   							)/10;
;;;3287   
;;;3288   		lakb[numOfPacks]._s_o_h=(signed short)(
;;;3289   							((ascii2halFhex(liBatteryInBuff[1+baseOfData+14]))<<12)+
;;;3290   							((ascii2halFhex(liBatteryInBuff[2+baseOfData+14]))<<8)+
;;;3291   							((ascii2halFhex(liBatteryInBuff[3+baseOfData+14]))<<4)+
;;;3292   							((ascii2halFhex(liBatteryInBuff[4+baseOfData+14])))
;;;3293   							)/10;
;;;3294   		#endif
;;;3295   		
;;;3296   		#ifdef UKU_TELECORE2016
;;;3297   		{
;;;3298   		char i;
;;;3299   		
;;;3300   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;3301   			{
;;;3302   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;3303   			}
;;;3304   		}
;;;3305   		#endif
;;;3306   		
;;;3307   										  
;;;3308   		}
;;;3309   	
;;;3310   if(sacredSunSilentCnt<3) 
;;;3311   	{
;;;3312       	bat[0]._Ub=lakb[0]._tot_bat_volt;
;;;3313       	bat[0]._Tb=lakb[0]._max_cell_temp;
;;;3314      	//bat[0]._Ib=lakb[0]._ch_curr/10;
;;;3315   	}
;;;3316   else 
;;;3317   	{
;;;3318       	//bat[0]._Ub=0;
;;;3319       	//bat[0]._Tb=0;
;;;3320      	//bat[0]._Ib=0;
;;;3321   	}
;;;3322   
;;;3323   if(BAT_TYPE==1)
;;;3324   	{
;;;3325   	char i;
;;;3326   	for(i=0;i<1;i++)
;;;3327   		{
;;;3328   		lakb[i]._rat_cap= (lakb_damp[i][13]*256)+ lakb_damp[i][14];
;;;3329   		lakb[i]._max_cell_volt= (lakb_damp[i][0]*256)+ lakb_damp[i][1];
;;;3330   		lakb[i]._min_cell_volt= (lakb_damp[i][2]*256)+ lakb_damp[i][3];
;;;3331   		lakb[i]._max_cell_temp= lakb_damp[i][4];
;;;3332   		lakb[i]._min_cell_temp= lakb_damp[i][5];
;;;3333   		lakb[i]._tot_bat_volt= (lakb_damp[i][6]*256)+ lakb_damp[i][7];
;;;3334   		lakb[i]._ch_curr= (lakb_damp[i][8]*256)+ lakb_damp[i][9];
;;;3335   		lakb[i]._dsch_curr= (lakb_damp[i][10]*256)+ lakb_damp[i][11];
;;;3336   		lakb[i]._s_o_c= lakb_damp[i][12];
;;;3337   		lakb[i]._r_b_t= lakb_damp[i][15];
;;;3338   		lakb[i]._c_c_l_v= (lakb_damp[i][16]*256)+ lakb_damp[i][17];
;;;3339   		lakb[i]._s_o_h= lakb_damp[i][18];
;;;3340   		lakb[i]._flags1= lakb_damp[i][34];
;;;3341   		lakb[i]._flags2= lakb_damp[i][35];
;;;3342   		lakb[i]._b_p_ser_num= lakb_damp[i][36];
;;;3343   
;;;3344   /*		if(lakb[i]._rat_cap==0)
;;;3345   			{
;;;3346   			if(lakb[i]._isOnCnt)
;;;3347   				{
;;;3348   				lakb[i]._isOnCnt--;
;;;3349   				if(lakb[i]._isOnCnt==0)
;;;3350   					{
;;;3351   					if(lakb[i]._battIsOn!=0) bLAKB_KONF_CH=1;
;;;3352   					}
;;;3353   				}
;;;3354   			}
;;;3355   		else 
;;;3356   			{
;;;3357   			if(lakb[i]._isOnCnt<50)
;;;3358   				{
;;;3359   				lakb[i]._isOnCnt++;
;;;3360   				if(lakb[i]._isOnCnt==50)
;;;3361   					{
;;;3362   					if(lakb[i]._battIsOn!=1) bLAKB_KONF_CH=1;
;;;3363   					}
;;;3364   				}
;;;3365   			} */
;;;3366   		gran(&lakb[i]._isOnCnt,0,50);
;;;3367   	 	}
;;;3368   
;;;3369   	if(lakb_damp[0][41]==100)
;;;3370   		{
;;;3371   		li_bat._485Error=1;
;;;3372   		}
;;;3373   	if(lakb_damp[0][41]==0)
;;;3374   		{
;;;3375   		//if(bRS485ERR)bLAKB_KONF_CH=1;
;;;3376   		li_bat._485Error=0;
;;;3377   		}
;;;3378   	li_bat._485ErrorCnt=lakb_damp[0][41];
;;;3379   
;;;3380   
;;;3381   	}
;;;3382   
;;;3383   
;;;3384   #endif
;;;3385   
;;;3386   		#ifdef UKU_TELECORE2017
;;;3387   		{
;;;3388   		char i;
;;;3389   		
;;;3390   		for(i=0;i<NUMBAT_TELECORE;i++)
;;;3391   			{
;;;3392   			lakb[i]._s_o_c_percent= (signed short)(((unsigned long)lakb[i]._s_o_c*100UL)/(unsigned long)lakb[i]._s_o_h);
;;;3393   			}
;;;3394   		}
;;;3395   		#endif
;;;3396   #ifdef UKU_TELECORE2015
;;;3397   //вычисление параметров работы батареи
;;;3398   //TODO дописать для всех батарей все параметры и при отцепке батарей
;;;3399   li_bat._batStat=bsOK;
;;;3400   if(BAT_TYPE==1) //COSLIGHT
;;;3401   	{
;;;3402   	if(li_bat._batStat==bsOK)
;;;3403   		{
;;;3404   		li_bat._Ub=lakb[0]._tot_bat_volt/10;
;;;3405   
;;;3406   		if(lakb[0]._ch_curr)li_bat._Ib=lakb[0]._ch_curr/10;
;;;3407   		else if(lakb[0]._dsch_curr) li_bat._Ib=bat[0]._Ib/10;//lakb[0]._dsch_curr/10;
;;;3408   	
;;;3409   		li_bat._ratCap=lakb[0]._rat_cap/100;
;;;3410   		li_bat._soc=lakb[0]._s_o_c;
;;;3411   		li_bat._soh=lakb[0]._s_o_h;
;;;3412   		li_bat._cclv=lakb[0]._c_c_l_v/10;
;;;3413   		li_bat._Tb=lakb[0]._max_cell_temp;
;;;3414   		li_bat._rbt=lakb[0]._r_b_t;
;;;3415   		}
;;;3416   	else 
;;;3417   		{
;;;3418   		li_bat._Ub=bat[0]._Ub;
;;;3419   		li_bat._Ib=bat[0]._Ib/10;
;;;3420   		li_bat._Tb=bat[0]._Tb;
;;;3421   		}
;;;3422   
;;;3423   	if((li_bat._485Error)||(li_bat._canError))
;;;3424   		{
;;;3425   		li_bat._batStat=bsOFF;
;;;3426   		}
;;;3427   	else li_bat._batStat=bsOK;
;;;3428   	}
;;;3429   else if(BAT_TYPE==2) //SACRED SUN
;;;3430   	{
;;;3431   	}
;;;3432   else if(BAT_TYPE==3) //ZTT
;;;3433   	{
;;;3434   	if(li_bat._batStat==bsOK)
;;;3435   		{
;;;3436   
;;;3437   		}
;;;3438   	}
;;;3439   #endif
;;;3440   
;;;3441   
;;;3442   /*
;;;3443   if((BAT_IS_ON[0]==bisON)&&(BAT_TYPE[0]==1)&&(BAT_LINK==0))
;;;3444   	{
;;;3445   
;;;3446   
;;;3447   	if(bat_drv_rx_buff[13]<=0x39)bbb[0]=bat_drv_rx_buff[13]-0x30;
;;;3448   	else bbb[0]=bat_drv_rx_buff[13]-55;
;;;3449   	if(bat_drv_rx_buff[14]<=0x39)bbb[1]=bat_drv_rx_buff[14]-0x30;
;;;3450   	else bbb[1]=bat_drv_rx_buff[14]-55;
;;;3451   	if(bat_drv_rx_buff[15]<=0x39)bbb[2]=bat_drv_rx_buff[15]-0x30;
;;;3452   	else bbb[2]=bat_drv_rx_buff[15]-55;
;;;3453   	if(bat_drv_rx_buff[16]<=0x39)bbb[3]=bat_drv_rx_buff[16]-0x30;
;;;3454   	else bbb[3]=bat_drv_rx_buff[16]-55;
;;;3455   
;;;3456   	tempSS=0;
;;;3457   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;3458   
;;;3459   	bat[0]._max_cell_volt=(tempSS+5)/10;
;;;3460   
;;;3461   	if(bat_drv_rx_buff[17]<=0x39)bbb[0]=bat_drv_rx_buff[17]-0x30;
;;;3462   	else bbb[0]=bat_drv_rx_buff[17]-55;
;;;3463   	if(bat_drv_rx_buff[18]<=0x39)bbb[1]=bat_drv_rx_buff[18]-0x30;
;;;3464   	else bbb[1]=bat_drv_rx_buff[18]-55;
;;;3465   	if(bat_drv_rx_buff[19]<=0x39)bbb[2]=bat_drv_rx_buff[19]-0x30;
;;;3466   	else bbb[2]=bat_drv_rx_buff[19]-55;
;;;3467   	if(bat_drv_rx_buff[20]<=0x39)bbb[3]=bat_drv_rx_buff[20]-0x30;
;;;3468   	else bbb[3]=bat_drv_rx_buff[20]-55;
;;;3469   
;;;3470   	tempSS=0;
;;;3471   	tempSS=((bbb[0]*4096)+(bbb[1]*256)+(bbb[2]*16)+bbb[3]);
;;;3472   
;;;3473   	bat[0]._min_cell_volt=(tempSS+5)/10;
;;;3474   
;;;3475   
;;;3476   	}*/
;;;3477   
;;;3478   
;;;3479   
;;;3480   }
0026f8  b007              ADD      sp,sp,#0x1c
0026fa  e8bd8ff0          POP      {r4-r11,pc}
;;;3481   
                          ENDP

                  mnemo_hndl PROC
;;;3482   //-----------------------------------------------
;;;3483   void mnemo_hndl(void)
0026fe  4a9e              LDR      r2,|L1.10616|
;;;3484   {
;;;3485   if(((ind==iMn_220)||(ind==iMn))&&(sub_ind==0)&&(MNEMO_ON==mnON))
;;;3486   	{
;;;3487   	if(mnemo_cnt)mnemo_cnt--;
002700  499e              LDR      r1,|L1.10620|
002702  7810              LDRB     r0,[r2,#0]            ;3485  ; a_ind
002704  2804              CMP      r0,#4                 ;3485
002706  d001              BEQ      |L1.9996|
002708  2801              CMP      r0,#1                 ;3485
00270a  d105              BNE      |L1.10008|
                  |L1.9996|
00270c  7850              LDRB     r0,[r2,#1]            ;3485  ; a_ind
00270e  b918              CBNZ     r0,|L1.10008|
002710  489b              LDR      r0,|L1.10624|
002712  7800              LDRB     r0,[r0,#0]            ;3485  ; MNEMO_ON
002714  2855              CMP      r0,#0x55              ;3485
002716  d003              BEQ      |L1.10016|
                  |L1.10008|
;;;3488   	}
;;;3489   else mnemo_cnt=MNEMO_TIME;
002718  489a              LDR      r0,|L1.10628|
00271a  8800              LDRH     r0,[r0,#0]  ; MNEMO_TIME
00271c  7008              STRB     r0,[r1,#0]
                  |L1.10014|
;;;3490   }
00271e  4770              BX       lr
                  |L1.10016|
002720  7808              LDRB     r0,[r1,#0]            ;3487  ; mnemo_cnt
002722  2800              CMP      r0,#0                 ;3487
002724  d0fb              BEQ      |L1.10014|
002726  f1a00001          SUB      r0,r0,#1              ;3487
00272a  7008              STRB     r0,[r1,#0]            ;3487
00272c  4770              BX       lr
;;;3491   
                          ENDP

                  adc_init PROC
;;;3492   //-----------------------------------------------
;;;3493   void adc_init(void)
00272e  4896              LDR      r0,|L1.10632|
;;;3494   {
;;;3495   
;;;3496   SET_REG(LPC_PINCON->PINSEL1,1,(25-16)*2,2);
002730  6841              LDR      r1,[r0,#4]
002732  f4212140          BIC      r1,r1,#0xc0000
002736  f4412180          ORR      r1,r1,#0x40000
00273a  6041              STR      r1,[r0,#4]
;;;3497   SET_REG(LPC_PINCON->PINSEL1,1,(24-16)*2,2);
00273c  6841              LDR      r1,[r0,#4]
00273e  f4213140          BIC      r1,r1,#0x30000
002742  f4413180          ORR      r1,r1,#0x10000
002746  6041              STR      r1,[r0,#4]
;;;3498   SET_REG(LPC_PINCON->PINSEL1,1,(23-16)*2,2);
002748  6841              LDR      r1,[r0,#4]
00274a  f4214140          BIC      r1,r1,#0xc000
00274e  f4414180          ORR      r1,r1,#0x4000
002752  6041              STR      r1,[r0,#4]
;;;3499   
;;;3500   
;;;3501   SET_REG(LPC_PINCON->PINMODE1,2,(25-16)*2,2);
002754  6c41              LDR      r1,[r0,#0x44]
002756  f4212140          BIC      r1,r1,#0xc0000
00275a  f4412100          ORR      r1,r1,#0x80000
00275e  6441              STR      r1,[r0,#0x44]
;;;3502   SET_REG(LPC_PINCON->PINMODE1,2,(24-16)*2,2);
002760  6c41              LDR      r1,[r0,#0x44]
002762  f4213140          BIC      r1,r1,#0x30000
002766  f4413100          ORR      r1,r1,#0x20000
00276a  6441              STR      r1,[r0,#0x44]
;;;3503   SET_REG(LPC_PINCON->PINMODE1,2,(23-16)*2,2);
00276c  6c41              LDR      r1,[r0,#0x44]
00276e  f4214140          BIC      r1,r1,#0xc000
002772  f4414100          ORR      r1,r1,#0x8000
002776  6441              STR      r1,[r0,#0x44]
;;;3504   
;;;3505   SET_REG(LPC_ADC->ADCR,0,24,3);
002778  4884              LDR      r0,|L1.10636|
00277a  6801              LDR      r1,[r0,#0]
00277c  f02161e0          BIC      r1,r1,#0x7000000
002780  6001              STR      r1,[r0,#0]
;;;3506   
;;;3507   SET_REG(LPC_ADC->ADCR,1,21,1);
002782  6801              LDR      r1,[r0,#0]
002784  f4411100          ORR      r1,r1,#0x200000
002788  6001              STR      r1,[r0,#0]
;;;3508   SET_REG(LPC_ADC->ADCR,0,16,1);
00278a  6801              LDR      r1,[r0,#0]
00278c  f4213180          BIC      r1,r1,#0x10000
002790  6001              STR      r1,[r0,#0]
;;;3509   SET_REG(LPC_ADC->ADCR,1,8,8);
002792  6801              LDR      r1,[r0,#0]
002794  f421417f          BIC      r1,r1,#0xff00
002798  f4417180          ORR      r1,r1,#0x100
00279c  6001              STR      r1,[r0,#0]
;;;3510   
;;;3511   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;3512   //SET_REG(LPC_GPIO0->FIOPIN,4,5,3);
;;;3513   	
;;;3514   	/*if(adc_ch<=7)*///SET_REG(LPC_ADC->ADCR,1<<5,0,8);
;;;3515        /*else if(adc_ch==8) SET_REG(LPC_ADC->ADCR,1<<2,0,8);
;;;3516        else SET_REG(LPC_ADC->ADCR,1<<4,0,8);*/
;;;3517   
;;;3518   LPC_ADC->ADINTEN     =  (1<< 8);      /* global enable interrupt            */
00279e  f44f7180          MOV      r1,#0x100
0027a2  60c1              STR      r1,[r0,#0xc]
0027a4  487a              LDR      r0,|L1.10640|
0027a6  f44f0180          MOV      r1,#0x400000
0027aa  6001              STR      r1,[r0,#0]
;;;3519   
;;;3520   NVIC_EnableIRQ(ADC_IRQn);             /* enable ADC Interrupt               */
;;;3521   
;;;3522   
;;;3523   }
0027ac  4770              BX       lr
;;;3524   
                          ENDP

                  adc_drv7 PROC
;;;3525   //-----------------------------------------------
;;;3526   void adc_drv7(void) //(Uсети - постоянка)
0027ae  e92d41f0          PUSH     {r4-r8,lr}
;;;3527   {
;;;3528   //int temp_S;
;;;3529   //char i;
;;;3530   //signed short temp_SS;
;;;3531   
;;;3532   adc_self_ch_disp[0]=abs_pal(adc_self_ch_buff[1]-adc_self_ch_buff[0]);//adc_self_ch_buff[0]&0x0f80;
0027b2  4c78              LDR      r4,|L1.10644|
0027b4  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
0027b6  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
0027b8  1a40              SUBS     r0,r0,r1
0027ba  b200              SXTH     r0,r0
0027bc  f7fffffe          BL       abs_pal
0027c0  1da6              ADDS     r6,r4,#6
0027c2  8030              STRH     r0,[r6,#0]
;;;3533   adc_self_ch_disp[1]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[1]);//adc_self_ch_buff[1]&0x0f80;
0027c4  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0027c6  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
0027c8  1a40              SUBS     r0,r0,r1
0027ca  b200              SXTH     r0,r0
0027cc  f7fffffe          BL       abs_pal
0027d0  8070              STRH     r0,[r6,#2]
;;;3534   adc_self_ch_disp[2]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[0]);//adc_self_ch_buff[2]&0x0f80;
0027d2  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0027d4  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
0027d6  1a40              SUBS     r0,r0,r1
0027d8  b200              SXTH     r0,r0
0027da  f7fffffe          BL       abs_pal
0027de  80b0              STRH     r0,[r6,#4]
;;;3535   
;;;3536   //adc_self_ch_disp[0]=adc_self_ch_buff[0]&0x0ff0;
;;;3537   //adc_self_ch_disp[1]=adc_self_ch_buff[1]&0x0ff0;
;;;3538   //adc_self_ch_disp[2]=adc_self_ch_buff[2]&0x0ff0;
;;;3539   
;;;3540   
;;;3541   if(adc_self_ch_disp[2]<300)//==adc_self_ch_disp[2])
0027e0  f44f7196          MOV      r1,#0x12c
;;;3542   	{
;;;3543   	adc_result=adc_self_ch_buff[2];
0027e4  f1a405ea          SUB      r5,r4,#0xea
0027e8  4288              CMP      r0,r1                 ;3541
0027ea  da02              BGE      |L1.10226|
0027ec  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0027ee  86e8              STRH     r0,[r5,#0x36]
0027f0  e00c              B        |L1.10252|
                  |L1.10226|
;;;3544   	} 
;;;3545   else if(adc_self_ch_disp[1]<300)//==adc_self_ch_disp[2])
0027f2  f9b60002          LDRSH    r0,[r6,#2]  ; adc_self_ch_disp
0027f6  4288              CMP      r0,r1
0027f8  da02              BGE      |L1.10240|
;;;3546   	{
;;;3547   	adc_result=adc_self_ch_buff[1];
0027fa  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
0027fc  86e8              STRH     r0,[r5,#0x36]
0027fe  e005              B        |L1.10252|
                  |L1.10240|
;;;3548   	}
;;;3549   else if(adc_self_ch_disp[0]<300)//==adc_self_ch_disp[1])
002800  f9b60000          LDRSH    r0,[r6,#0]  ; adc_self_ch_disp
002804  4288              CMP      r0,r1
002806  da01              BGE      |L1.10252|
;;;3550   	{
;;;3551   	adc_result=adc_self_ch_buff[0];
002808  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
00280a  86e8              STRH     r0,[r5,#0x36]
                  |L1.10252|
;;;3552   	}
;;;3553       //adc_result=92;
;;;3554   
;;;3555   if(adc_ch_net)
00280c  7a6f              LDRB     r7,[r5,#9]  ; adc_ch_net
00280e  2600              MOVS     r6,#0
002810  b32f              CBZ      r7,|L1.10334|
;;;3556   	{
;;;3557   
;;;3558   	main_power_buffer[0]+=(long)(adc_result);
002812  4861              LDR      r0,|L1.10648|
002814  f9b51036          LDRSH    r1,[r5,#0x36]  ; adc_result
002818  6802              LDR      r2,[r0,#0]  ; main_power_buffer
00281a  440a              ADD      r2,r2,r1
00281c  6002              STR      r2,[r0,#0]  ; main_power_buffer
;;;3559   	main_power_buffer[1]+=(long)(adc_result);
00281e  6842              LDR      r2,[r0,#4]  ; main_power_buffer
002820  440a              ADD      r2,r2,r1
002822  6042              STR      r2,[r0,#4]  ; main_power_buffer
;;;3560   	main_power_buffer[2]+=(long)(adc_result);
002824  6882              LDR      r2,[r0,#8]  ; main_power_buffer
002826  440a              ADD      r2,r2,r1
002828  6082              STR      r2,[r0,#8]  ; main_power_buffer
;;;3561   	main_power_buffer[3]+=(long)(adc_result);
00282a  68c2              LDR      r2,[r0,#0xc]  ; main_power_buffer
00282c  4411              ADD      r1,r1,r2
00282e  60c1              STR      r1,[r0,#0xc]  ; main_power_buffer
;;;3562   
;;;3563   	adc_net_buff_cnt++;
002830  8fe9              LDRH     r1,[r5,#0x3e]  ; adc_net_buff_cnt
002832  f1010101          ADD      r1,r1,#1
002836  b209              SXTH     r1,r1
002838  87e9              STRH     r1,[r5,#0x3e]
;;;3564   	if(adc_net_buff_cnt>=0x1000)
00283a  f5b15f80          CMP      r1,#0x1000
00283e  db00              BLT      |L1.10306|
;;;3565   		{
;;;3566   		adc_net_buff_cnt=0;
002840  87ee              STRH     r6,[r5,#0x3e]
                  |L1.10306|
;;;3567   		}
;;;3568   	if((adc_net_buff_cnt&0x03ff)==0)
002842  f9b5103e          LDRSH    r1,[r5,#0x3e]  ; adc_net_buff_cnt
002846  058a              LSLS     r2,r1,#22
002848  d131              BNE      |L1.10414|
;;;3569   		{
;;;3570   		#ifdef UKU_220
;;;3571   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;3572   		#else
;;;3573   		#ifdef UKU_220_V2
;;;3574   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;3575   		#else
;;;3576   		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>8);
00284a  ea4f21a1          ASR      r1,r1,#10
00284e  f8502021          LDR      r2,[r0,r1,LSL #2]
002852  ea4f2222          ASR      r2,r2,#8
002856  86aa              STRH     r2,[r5,#0x34]
;;;3577   		#endif
;;;3578   		#endif
;;;3579   		main_power_buffer[adc_net_buff_cnt>>10]=0;
002858  f8406021          STR      r6,[r0,r1,LSL #2]
00285c  e027              B        |L1.10414|
                  |L1.10334|
;;;3580   		}
;;;3581   
;;;3582   
;;;3583   	} 
;;;3584   else if(!adc_ch_net)
;;;3585   	{
;;;3586   	adc_buff[adc_ch][adc_ch_cnt]=(long)adc_result;
00285e  484f              LDR      r0,|L1.10652|
002860  7aac              LDRB     r4,[r5,#0xa]  ; adc_ch
002862  7aea              LDRB     r2,[r5,#0xb]  ; adc_ch_cnt
002864  eb001384          ADD      r3,r0,r4,LSL #6
002868  f9b51036          LDRSH    r1,[r5,#0x36]  ; adc_result
00286c  f8431022          STR      r1,[r3,r2,LSL #2]
;;;3587   	
;;;3588   	if((adc_ch_cnt&0x03)==0)
002870  0790              LSLS     r0,r2,#30
002872  d10f              BNE      |L1.10388|
;;;3589   		{
;;;3590   		long temp_L;
;;;3591   		char i;
;;;3592   		temp_L=0;
002874  4601              MOV      r1,r0
                  |L1.10358|
;;;3593   		for(i=0;i<16;i++)
;;;3594   			{
;;;3595   			temp_L+=adc_buff[adc_ch][i];
002876  f853c020          LDR      r12,[r3,r0,LSL #2]
00287a  4461              ADD      r1,r1,r12
00287c  f1000001          ADD      r0,r0,#1              ;3593
002880  b2c0              UXTB     r0,r0                 ;3593
002882  2810              CMP      r0,#0x10              ;3593
002884  d3f7              BCC      |L1.10358|
;;;3596   			}
;;;3597   		adc_buff_[adc_ch]= (short)(temp_L>>4);
002886  ea4f1021          ASR      r0,r1,#4
00288a  4943              LDR      r1,|L1.10648|
00288c  f1a10120          SUB      r1,r1,#0x20
002890  f8210014          STRH     r0,[r1,r4,LSL #1]
                  |L1.10388|
;;;3598   
;;;3599   		//adc_buff_[3]=346;
;;;3600   		}
;;;3601   	if(++adc_ch>=16) 
002894  1c64              ADDS     r4,r4,#1
002896  b2e0              UXTB     r0,r4
002898  72a8              STRB     r0,[r5,#0xa]
00289a  2810              CMP      r0,#0x10
00289c  d307              BCC      |L1.10414|
;;;3602   		{
;;;3603   		adc_ch=0;
00289e  72ae              STRB     r6,[r5,#0xa]
;;;3604   		adc_ch_cnt++;
0028a0  f1020201          ADD      r2,r2,#1
0028a4  b2d0              UXTB     r0,r2
0028a6  72e8              STRB     r0,[r5,#0xb]
;;;3605   		if(adc_ch_cnt>=16)adc_ch_cnt=0;
0028a8  2810              CMP      r0,#0x10
0028aa  d300              BCC      |L1.10414|
0028ac  72ee              STRB     r6,[r5,#0xb]
                  |L1.10414|
;;;3606   		}
;;;3607   	}
;;;3608   
;;;3609   //adc_buff[adc_ch][adc_cnt1]=(adc_self_ch_buff[2]+adc_self_ch_buff[1])/2;
;;;3610   
;;;3611   //if(adc_buff[adc_ch][adc_cnt1]<adc_buff_min[adc_ch])adc_buff_min[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;3612   //if(adc_buff[adc_ch][adc_cnt1]>adc_buff_max[adc_ch])adc_buff_max[adc_ch]=adc_buff[adc_ch][adc_cnt1];
;;;3613   /*
;;;3614   	{
;;;3615   	if((adc_cnt1&0x03)==0)
;;;3616   		{
;;;3617   		temp_S=0;
;;;3618   		for(i=0;i<16;i++)
;;;3619   			{
;;;3620   			temp_S+=adc_buff[adc_ch][i];
;;;3621   			} 
;;;3622            	adc_buff_[adc_ch]=temp_S>>4;
;;;3623             }
;;;3624   	}*/
;;;3625   
;;;3626   
;;;3627   		  
;;;3628   
;;;3629   adc_self_ch_cnt=0;
0028ae  722e              STRB     r6,[r5,#8]
;;;3630   
;;;3631   adc_ch_net++;
0028b0  f1070701          ADD      r7,r7,#1
;;;3632   adc_ch_net&=1;
0028b4  f0070001          AND      r0,r7,#1
0028b8  7268              STRB     r0,[r5,#9]
;;;3633   
;;;3634   //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;3635   //SET_REG(LPC_GPIO0->FIOPIN,adc_ch,5,3);
;;;3636   
;;;3637   if(adc_ch_net)
;;;3638   	{
;;;3639   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;3640   	//LPC_GPIO2->FIOPIN|=(1<<7);
;;;3641   	SET_REG(LPC_ADC->ADCR,1<<2,0,8);
0028ba  4a34              LDR      r2,|L1.10636|
0028bc  b130              CBZ      r0,|L1.10444|
0028be  6810              LDR      r0,[r2,#0]
0028c0  f02000ff          BIC      r0,r0,#0xff
0028c4  f1000004          ADD      r0,r0,#4
0028c8  6010              STR      r0,[r2,#0]
0028ca  e03d              B        |L1.10568|
                  |L1.10444|
;;;3642   	}
;;;3643   else
;;;3644   	{
;;;3645   	//LPC_GPIO2->FIODIR|=(1<<7);
;;;3646   	//LPC_GPIO2->FIOPIN&=~(1<<7);
;;;3647   	if(!(adc_ch&(1<<3)))SET_REG(LPC_ADC->ADCR,1<<0,0,8);
0028cc  7aa9              LDRB     r1,[r5,#0xa]  ; adc_ch
0028ce  0708              LSLS     r0,r1,#28
0028d0  d406              BMI      |L1.10464|
0028d2  6810              LDR      r0,[r2,#0]
0028d4  f02000ff          BIC      r0,r0,#0xff
0028d8  f1000001          ADD      r0,r0,#1
0028dc  6010              STR      r0,[r2,#0]
0028de  e005              B        |L1.10476|
                  |L1.10464|
;;;3648   	else 			SET_REG(LPC_ADC->ADCR,1<<1,0,8);
0028e0  6810              LDR      r0,[r2,#0]
0028e2  f02000ff          BIC      r0,r0,#0xff
0028e6  f1000002          ADD      r0,r0,#2
0028ea  6010              STR      r0,[r2,#0]
                  |L1.10476|
;;;3649   
;;;3650   
;;;3651   	SET_REG(LPC_GPIO0->FIODIR,1,28,1);
0028ec  482c              LDR      r0,|L1.10656|
0028ee  6803              LDR      r3,[r0,#0]
0028f0  f0435380          ORR      r3,r3,#0x10000000
0028f4  6003              STR      r3,[r0,#0]
;;;3652   	SET_REG(LPC_GPIO1->FIODIR,1,30,1);
0028f6  6a03              LDR      r3,[r0,#0x20]
0028f8  f0434380          ORR      r3,r3,#0x40000000
0028fc  6203              STR      r3,[r0,#0x20]
;;;3653   	SET_REG(LPC_GPIO3->FIODIR,1,26,1);
0028fe  6e03              LDR      r3,[r0,#0x60]
002900  f0436380          ORR      r3,r3,#0x4000000
002904  6603              STR      r3,[r0,#0x60]
;;;3654   
;;;3655   	if(!(adc_ch&(1<<0)))SET_REG(LPC_GPIO0->FIOPIN,0,28,1);
002906  07cb              LSLS     r3,r1,#31
002908  d00a              BEQ      |L1.10528|
;;;3656   	else 			SET_REG(LPC_GPIO0->FIOPIN,1,28,1);
00290a  6943              LDR      r3,[r0,#0x14]
00290c  f0435380          ORR      r3,r3,#0x10000000
002910  6143              STR      r3,[r0,#0x14]
                  |L1.10514|
;;;3657   
;;;3658   	if(!(adc_ch&(1<<1)))SET_REG(LPC_GPIO1->FIOPIN,0,30,1);
002912  078b              LSLS     r3,r1,#30
002914  d409              BMI      |L1.10538|
002916  6b43              LDR      r3,[r0,#0x34]
002918  f0234380          BIC      r3,r3,#0x40000000
00291c  6343              STR      r3,[r0,#0x34]
00291e  e008              B        |L1.10546|
                  |L1.10528|
002920  6943              LDR      r3,[r0,#0x14]         ;3655
002922  f0235380          BIC      r3,r3,#0x10000000     ;3655
002926  6143              STR      r3,[r0,#0x14]         ;3655
002928  e7f3              B        |L1.10514|
                  |L1.10538|
;;;3659   	else 			SET_REG(LPC_GPIO1->FIOPIN,1,30,1);
00292a  6b43              LDR      r3,[r0,#0x34]
00292c  f0434380          ORR      r3,r3,#0x40000000
002930  6343              STR      r3,[r0,#0x34]
                  |L1.10546|
;;;3660   
;;;3661   	if(!(adc_ch&(1<<2)))SET_REG(LPC_GPIO3->FIOPIN,0,26,1);
002932  0749              LSLS     r1,r1,#29
002934  d404              BMI      |L1.10560|
002936  6f41              LDR      r1,[r0,#0x74]
002938  f0216180          BIC      r1,r1,#0x4000000
00293c  6741              STR      r1,[r0,#0x74]
00293e  e003              B        |L1.10568|
                  |L1.10560|
;;;3662   	else 			SET_REG(LPC_GPIO3->FIOPIN,1,26,1);
002940  6f41              LDR      r1,[r0,#0x74]
002942  f0416180          ORR      r1,r1,#0x4000000
002946  6741              STR      r1,[r0,#0x74]
                  |L1.10568|
;;;3663   	}
;;;3664   	
;;;3665   
;;;3666   
;;;3667   
;;;3668   LPC_ADC->ADCR |=  (1<<24);
002948  6810              LDR      r0,[r2,#0]
00294a  f0407080          ORR      r0,r0,#0x1000000
00294e  6010              STR      r0,[r2,#0]
;;;3669   
;;;3670   }
002950  e8bd81f0          POP      {r4-r8,pc}
;;;3671   
                          ENDP

                  avg_hndl PROC
;;;3928   //-----------------------------------------------
;;;3929   void avg_hndl(void)
002954  b5f0              PUSH     {r4-r7,lr}
;;;3930   { 
;;;3931   char i;
;;;3932   
;;;3933   //#define AVGCNTMAX	5
;;;3934   if(avg_main_cnt)
002956  4d0f              LDR      r5,|L1.10644|
002958  3dea              SUBS     r5,r5,#0xea
00295a  f9b50030          LDRSH    r0,[r5,#0x30]  ; avg_main_cnt
00295e  b308              CBZ      r0,|L1.10660|
;;;3935   	{
;;;3936   	avg_main_cnt--;
002960  f1a00001          SUB      r0,r0,#1
002964  8628              STRH     r0,[r5,#0x30]
;;;3937   	goto avg_hndl_end;
002966  e0b2              B        |L1.10958|
                  |L1.10600|
                          DCD      load_I
                  |L1.10604|
                          DCD      Isumm
                  |L1.10608|
                          DCD      NUMINV
                  |L1.10612|
                          DCD      inv
                  |L1.10616|
                          DCD      a_ind
                  |L1.10620|
                          DCD      mnemo_cnt
                  |L1.10624|
                          DCD      MNEMO_ON
                  |L1.10628|
                          DCD      MNEMO_TIME
                  |L1.10632|
                          DCD      0x4002c000
                  |L1.10636|
                          DCD      0x40034000
                  |L1.10640|
                          DCD      0xe000e100
                  |L1.10644|
                          DCD      ||area_number.25||+0xea
                  |L1.10648|
                          DCD      ||.bss||+0x42c
                  |L1.10652|
                          DCD      ||.bss||+0xc
                  |L1.10656|
                          DCD      0x2009c000
                  |L1.10660|
;;;3938   	}                 
;;;3939   
;;;3940   avg_num=0;
0029a4  f04f0600          MOV      r6,#0
0029a8  74ae              STRB     r6,[r5,#0x12]
;;;3941   
;;;3942   for(i=0;i<NUMIST;i++)
0029aa  4630              MOV      r0,r6
0029ac  49ff              LDR      r1,|L1.11692|
;;;3943   	{
;;;3944   	if((bps[i]._state==bsWRK)&&(bps[i]._cnt<20))avg_num++;
0029ae  4bfe              LDR      r3,|L1.11688|
0029b0  f9b12000          LDRSH    r2,[r1,#0]            ;3942
0029b4  e012              B        |L1.10716|
                  |L1.10678|
0029b6  ebc001c0          RSB      r1,r0,r0,LSL #3
0029ba  eb011100          ADD      r1,r1,r0,LSL #4
0029be  eb030181          ADD      r1,r3,r1,LSL #2
0029c2  788c              LDRB     r4,[r1,#2]
0029c4  2c01              CMP      r4,#1
0029c6  d106              BNE      |L1.10710|
0029c8  78c9              LDRB     r1,[r1,#3]
0029ca  2914              CMP      r1,#0x14
0029cc  d203              BCS      |L1.10710|
0029ce  7ca9              LDRB     r1,[r5,#0x12]  ; avg_num
0029d0  f1010101          ADD      r1,r1,#1
0029d4  74a9              STRB     r1,[r5,#0x12]
                  |L1.10710|
0029d6  f1000001          ADD      r0,r0,#1              ;3942
0029da  b2c0              UXTB     r0,r0                 ;3942
                  |L1.10716|
0029dc  4290              CMP      r0,r2                 ;3942
0029de  dbea              BLT      |L1.10678|
;;;3945   	}
;;;3946   
;;;3947   /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;3948   if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;3949   if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;3950   
;;;3951   	
;;;3952   if(avg_num<2)
0029e0  7caf              LDRB     r7,[r5,#0x12]  ; avg_num
0029e2  2f02              CMP      r7,#2
0029e4  d373              BCC      |L1.10958|
;;;3953   	{
;;;3954   	goto avg_hndl_end;
;;;3955   	}
;;;3956   	
;;;3957   else
;;;3958   	{
;;;3959   	i_avg_min=5000;
0029e6  4cf2              LDR      r4,|L1.11696|
0029e8  f2413088          MOV      r0,#0x1388
0029ec  61e0              STR      r0,[r4,#0x1c]  ; i_avg_min
;;;3960   	i_avg_max=0;
0029ee  61a6              STR      r6,[r4,#0x18]  ; i_avg_max
;;;3961   	i_avg_summ=0;
0029f0  6226              STR      r6,[r4,#0x20]  ; i_avg_summ
;;;3962   	for(i=0;i<NUMIST;i++)
0029f2  f04f0100          MOV      r1,#0
0029f6  e01c              B        |L1.10802|
                  |L1.10744|
;;;3963   		{
;;;3964   		if(bps[i]._state==bsWRK)
0029f8  ebc100c1          RSB      r0,r1,r1,LSL #3
0029fc  eb001001          ADD      r0,r0,r1,LSL #4
002a00  eb030080          ADD      r0,r3,r0,LSL #2
002a04  f890c002          LDRB     r12,[r0,#2]
002a08  f1bc0f01          CMP      r12,#1
002a0c  d10e              BNE      |L1.10796|
;;;3965   			{
;;;3966   			if(bps[i]._Ii>i_avg_max)i_avg_max=bps[i]._Ii;
002a0e  6a40              LDR      r0,[r0,#0x24]
002a10  f8d4c018          LDR      r12,[r4,#0x18]  ; i_avg_max
002a14  4560              CMP      r0,r12
002a16  dd00              BLE      |L1.10778|
002a18  61a0              STR      r0,[r4,#0x18]  ; i_avg_max
                  |L1.10778|
;;;3967   			if(bps[i]._Ii<i_avg_min)i_avg_min=bps[i]._Ii;
002a1a  f8d4c01c          LDR      r12,[r4,#0x1c]  ; i_avg_min
002a1e  4560              CMP      r0,r12
002a20  da00              BGE      |L1.10788|
002a22  61e0              STR      r0,[r4,#0x1c]  ; i_avg_min
                  |L1.10788|
;;;3968   			
;;;3969   			i_avg_summ+=bps[i]._Ii;
002a24  f8d4c020          LDR      r12,[r4,#0x20]  ; i_avg_summ
002a28  4460              ADD      r0,r0,r12
002a2a  6220              STR      r0,[r4,#0x20]  ; i_avg_summ
                  |L1.10796|
002a2c  f1010101          ADD      r1,r1,#1              ;3962
002a30  b2c9              UXTB     r1,r1                 ;3962
                  |L1.10802|
002a32  4291              CMP      r1,r2                 ;3962
002a34  dbe0              BLT      |L1.10744|
;;;3970   			}
;;;3971   		}
;;;3972   	i_avg=i_avg_summ/avg_num;	
002a36  6a20              LDR      r0,[r4,#0x20]  ; i_avg_summ
002a38  fb90f7f7          SDIV     r7,r0,r7
002a3c  6267              STR      r7,[r4,#0x24]  ; i_avg
;;;3973   	
;;;3974   	if(i_avg_min==0)i_avg_min=1;
002a3e  69e0              LDR      r0,[r4,#0x1c]  ; i_avg_min
002a40  2101              MOVS     r1,#1                 ;3944
002a42  b900              CBNZ     r0,|L1.10822|
002a44  61e1              STR      r1,[r4,#0x1c]  ; i_avg_min
                  |L1.10822|
;;;3975   
;;;3976   	avg=i_avg_max;
002a46  69a0              LDR      r0,[r4,#0x18]  ; i_avg_max
;;;3977   	avg*=100;
002a48  f04f0c64          MOV      r12,#0x64
002a4c  fb00f00c          MUL      r0,r0,r12
;;;3978   	avg/=i_avg_min;
002a50  f8d4c01c          LDR      r12,[r4,#0x1c]  ; i_avg_min
002a54  fb90f0fc          SDIV     r0,r0,r12
002a58  62a0              STR      r0,[r4,#0x28]  ; avg
;;;3979   
;;;3980   	if(avg>160) bAVG=1;
002a5a  28a0              CMP      r0,#0xa0
002a5c  dd00              BLE      |L1.10848|
002a5e  7469              STRB     r1,[r5,#0x11]
                  |L1.10848|
;;;3981   	if(avg<120) bAVG=0;
002a60  2878              CMP      r0,#0x78
002a62  da00              BGE      |L1.10854|
002a64  746e              STRB     r6,[r5,#0x11]
                  |L1.10854|
;;;3982   
;;;3983   	if(bAVG==1)
002a66  7c68              LDRB     r0,[r5,#0x11]  ; bAVG
002a68  2801              CMP      r0,#1
002a6a  d130              BNE      |L1.10958|
;;;3984   		{
;;;3985   		for(i=0;i<NUMIST;i++)
002a6c  f04f0100          MOV      r1,#0
;;;3986   			{
;;;3987   			if(bps[i]._state==bsWRK)
;;;3988   				{
;;;3989   				if(bps[i]._Ii>i_avg)bps[i]._x_--;
;;;3990   				if(bps[i]._Ii<i_avg)bps[i]._x_++;
;;;3991   			
;;;3992   				if(bps[i]._x_<-50)bps[i]._x_=-50;
002a70  f06f0431          MVN      r4,#0x31
002a74  e029              B        |L1.10954|
                  |L1.10870|
002a76  ebc100c1          RSB      r0,r1,r1,LSL #3       ;3987
002a7a  eb001001          ADD      r0,r0,r1,LSL #4       ;3987
002a7e  eb030080          ADD      r0,r3,r0,LSL #2       ;3987
002a82  7885              LDRB     r5,[r0,#2]            ;3987
002a84  2d01              CMP      r5,#1                 ;3987
002a86  d11d              BNE      |L1.10948|
002a88  6a45              LDR      r5,[r0,#0x24]         ;3989
002a8a  42bd              CMP      r5,r7                 ;3989
002a8c  dd05              BLE      |L1.10906|
002a8e  f8b05050          LDRH     r5,[r0,#0x50]         ;3989
002a92  f1a50501          SUB      r5,r5,#1              ;3989
002a96  f8a05050          STRH     r5,[r0,#0x50]         ;3989
                  |L1.10906|
002a9a  da05              BGE      |L1.10920|
002a9c  f8b05050          LDRH     r5,[r0,#0x50]         ;3990
002aa0  f1050501          ADD      r5,r5,#1              ;3990
002aa4  f8a05050          STRH     r5,[r0,#0x50]         ;3990
                  |L1.10920|
002aa8  f9b05050          LDRSH    r5,[r0,#0x50]
002aac  42a5              CMP      r5,r4
002aae  da01              BGE      |L1.10932|
002ab0  f8a04050          STRH     r4,[r0,#0x50]
                  |L1.10932|
;;;3993   				if(bps[i]._x_>50)bps[i]._x_=50;	
002ab4  f9b05050          LDRSH    r5,[r0,#0x50]
002ab8  2d32              CMP      r5,#0x32
002aba  dd03              BLE      |L1.10948|
002abc  f04f0532          MOV      r5,#0x32
002ac0  f8a05050          STRH     r5,[r0,#0x50]
                  |L1.10948|
002ac4  f1010101          ADD      r1,r1,#1              ;3985
002ac8  b2c9              UXTB     r1,r1                 ;3985
                  |L1.10954|
002aca  4291              CMP      r1,r2                 ;3985
002acc  dbd3              BLT      |L1.10870|
                  |L1.10958|
;;;3994   				}
;;;3995   			}		
;;;3996   		}			
;;;3997   	}   	 
;;;3998   
;;;3999   
;;;4000   avg_hndl_end:
;;;4001   __nop();  
002ace  bf00              NOP      
;;;4002   }
002ad0  bdf0              POP      {r4-r7,pc}
;;;4003   
                          ENDP

                  rele_hndl PROC
;;;4016   //*************-----------------------------------------------
;;;4017   void rele_hndl(void)
002ad2  e92d5ff0          PUSH     {r4-r12,lr}
;;;4018   {
;;;4019   //static char cnt_rel_sam;
;;;4020   //char temp;
;;;4021   
;;;4022   //temp=0;
;;;4023   
;;;4024   
;;;4025   SET_REG(LPC_PINCON->PINSEL0,0,4*2,6*2);
002ad6  48b7              LDR      r0,|L1.11700|
002ad8  6801              LDR      r1,[r0,#0]
002ada  4ab7              LDR      r2,|L1.11704|
002adc  ea010102          AND      r1,r1,r2
002ae0  6001              STR      r1,[r0,#0]
;;;4026   SET_REG(LPC_GPIO0->FIODIR,63,4,6);
002ae2  4cb6              LDR      r4,|L1.11708|
002ae4  6821              LDR      r1,[r4,#0]
002ae6  f441717c          ORR      r1,r1,#0x3f0
002aea  6021              STR      r1,[r4,#0]
;;;4027   SET_REG(LPC_PINCON->PINSEL7,0,(25-16)*2,2);
002aec  69c1              LDR      r1,[r0,#0x1c]
002aee  f4212140          BIC      r1,r1,#0xc0000
002af2  61c1              STR      r1,[r0,#0x1c]
;;;4028   SET_REG(LPC_GPIO3->FIODIR,1,25,1);
002af4  6e21              LDR      r1,[r4,#0x60]
002af6  f0417100          ORR      r1,r1,#0x2000000
002afa  6621              STR      r1,[r4,#0x60]
;;;4029   SET_REG(LPC_PINCON->PINSEL1,0,(29-16)*2,2);
002afc  6841              LDR      r1,[r0,#4]
002afe  f0216140          BIC      r1,r1,#0xc000000
002b02  6041              STR      r1,[r0,#4]
;;;4030   SET_REG(LPC_GPIO0->FIODIR,1,29,1);
002b04  6820              LDR      r0,[r4,#0]
002b06  f0405000          ORR      r0,r0,#0x20000000
002b0a  6020              STR      r0,[r4,#0]
;;;4031   
;;;4032   
;;;4033   
;;;4034   
;;;4035   
;;;4036   
;;;4037   if((((bat[0]._rel_stat)  || (tbatdisable_stat!=tbdsON))&&(tbatdisable_cmnd))	&& (main_1Hz_cnt>5))
002b0c  48ad              LDR      r0,|L1.11716|
002b0e  4dac              LDR      r5,|L1.11712|
002b10  49ae              LDR      r1,|L1.11724|
002b12  7802              LDRB     r2,[r0,#0]  ; tbatdisable_stat
002b14  48ac              LDR      r0,|L1.11720|
002b16  f895303c          LDRB     r3,[r5,#0x3c]  ; bat
002b1a  f9b11000          LDRSH    r1,[r1,#0]
002b1e  7800              LDRB     r0,[r0,#0]
002b20  4313              ORRS     r3,r3,r2
002b22  d007              BEQ      |L1.11060|
002b24  b130              CBZ      r0,|L1.11060|
002b26  2905              CMP      r1,#5
002b28  dd04              BLE      |L1.11060|
;;;4038   	{
;;;4039   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_BAT1,1);
002b2a  69a3              LDR      r3,[r4,#0x18]
002b2c  f4437380          ORR      r3,r3,#0x100
002b30  61a3              STR      r3,[r4,#0x18]
002b32  e003              B        |L1.11068|
                  |L1.11060|
;;;4040   	}
;;;4041   else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_BAT1,1);	  	
002b34  69e3              LDR      r3,[r4,#0x1c]
002b36  f4437380          ORR      r3,r3,#0x100
002b3a  61e3              STR      r3,[r4,#0x1c]
                  |L1.11068|
;;;4042   
;;;4043   if((((bat[1]._rel_stat) || (tbatdisable_stat!=tbdsON))&&(tbatdisable_cmnd))	&& (main_1Hz_cnt>5))
002b3c  f8953088          LDRB     r3,[r5,#0x88]  ; bat
002b40  4313              ORRS     r3,r3,r2
002b42  d007              BEQ      |L1.11092|
002b44  b130              CBZ      r0,|L1.11092|
002b46  2905              CMP      r1,#5
002b48  dd04              BLE      |L1.11092|
;;;4044   	{
;;;4045   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_BAT2,1);
002b4a  69a0              LDR      r0,[r4,#0x18]
002b4c  f0400040          ORR      r0,r0,#0x40
002b50  61a0              STR      r0,[r4,#0x18]
002b52  e003              B        |L1.11100|
                  |L1.11092|
;;;4046   	}
;;;4047   else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_BAT2,1);
002b54  69e0              LDR      r0,[r4,#0x1c]
002b56  f0400040          ORR      r0,r0,#0x40
002b5a  61e0              STR      r0,[r4,#0x1c]
                  |L1.11100|
;;;4048   
;;;4049   
;;;4050   if(mess_find_unvol((MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_SAMOKALIBR)) 
002b5c  20d2              MOVS     r0,#0xd2
002b5e  f7fffffe          BL       mess_find_unvol
002b62  4d9b              LDR      r5,|L1.11728|
002b64  b110              CBZ      r0,|L1.11116|
002b66  6828              LDR      r0,[r5,#0]  ; mess_data
002b68  2864              CMP      r0,#0x64
002b6a  d048              BEQ      |L1.11262|
                  |L1.11116|
;;;4051   	{
;;;4052   	if(mess_data[1]==1)SET_REG(LPC_GPIO0->FIOSET,1,29,1);
;;;4053   	else if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,29,1);
;;;4054   	}
;;;4055   else SET_REG(LPC_GPIO0->FIOCLR,1,29,1);
002b6c  69e0              LDR      r0,[r4,#0x1c]
002b6e  f0405000          ORR      r0,r0,#0x20000000
002b72  61e0              STR      r0,[r4,#0x1c]
                  |L1.11124|
;;;4056   
;;;4057   
;;;4058   #ifndef UKU2071x
;;;4059   //Реле аварии сети
;;;4060   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4061   	{
;;;4062   	if(mess_data[1]==0) 			SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4063   	else 						SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4064   	}
;;;4065   else	if(!(avar_ind_stat&0x00000001)) 	SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4066   else 							SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4067   #endif
;;;4068   #ifdef UKU2071x
;;;4069   //Реле аварии сети
;;;4070   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
002b74  20d2              MOVS     r0,#0xd2
002b76  f7fffffe          BL       mess_find_unvol
;;;4071   	{
;;;4072   	if(mess_data[1]==0)				SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1); 
;;;4073   	else 						SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4074   	}
;;;4075   else	if(!(avar_ind_stat&0x00000001))	SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
002b7a  4e96              LDR      r6,|L1.11732|
002b7c  b110              CBZ      r0,|L1.11140|
002b7e  6828              LDR      r0,[r5,#0]            ;4070  ; mess_data
002b80  2866              CMP      r0,#0x66              ;4070
002b82  d04b              BEQ      |L1.11292|
                  |L1.11140|
002b84  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002b86  07c0              LSLS     r0,r0,#31
002b88  d054              BEQ      |L1.11316|
;;;4076   else 					  		SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
002b8a  6fa0              LDR      r0,[r4,#0x78]
002b8c  f0407000          ORR      r0,r0,#0x2000000
002b90  67a0              STR      r0,[r4,#0x78]
                  |L1.11154|
;;;4077   #endif
;;;4078   
;;;4079   #ifdef UKU_3U
;;;4080   //Реле аварий батарей
;;;4081   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;4082   	{
;;;4083   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4084   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4085        }
;;;4086   else 
;;;4087   	{
;;;4088   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4089        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4090   	} 
;;;4091   
;;;4092   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;4093   	{
;;;4094   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4095   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4096        }
;;;4097   else 
;;;4098   	{
;;;4099   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4100        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4101   	} 
;;;4102   
;;;4103   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4104   	{
;;;4105   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4106   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4107        }
;;;4108   else 
;;;4109   	{
;;;4110   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4111        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4112   	} 
;;;4113   
;;;4114   #endif
;;;4115   
;;;4116   
;;;4117   #ifdef UKU_GLONASS
;;;4118   //Реле аварий батарей
;;;4119   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;4120   	{
;;;4121   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4122   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4123        }
;;;4124   else 
;;;4125   	{
;;;4126   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4127        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4128   	} 
;;;4129   
;;;4130   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;4131   	{
;;;4132   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4133   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4134        }
;;;4135   else 
;;;4136   	{
;;;4137   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4138        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4139   	} 
;;;4140   
;;;4141   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4142   	{
;;;4143   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4144   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4145        }
;;;4146   else 
;;;4147   	{
;;;4148   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4149        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4150   	} 
;;;4151   
;;;4152   #endif
;;;4153   
;;;4154   #ifdef U 
;;;4155   
;;;4156   #endif
;;;4157   
;;;4158   #ifdef UKU_RSTKM
;;;4159   
;;;4160   //Реле общей аварии
;;;4161   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;4162   	{
;;;4163   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4164   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4165   	}
;;;4166   else 
;;;4167   	{
;;;4168        if(  (!(avar_ind_stat&0x00007fff))/* &&
;;;4169             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;4170             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;4171             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  &&
;;;4172             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4173        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4174   	}
;;;4175   	
;;;4176   
;;;4177   //Реле освещения
;;;4178   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;4179   	{
;;;4180   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4181   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4182        }
;;;4183   else 
;;;4184   	{
;;;4185   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4186        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4187   	}
;;;4188   
;;;4189   
;;;4190   //Реле выключения нагрузки
;;;4191   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;4192   	{
;;;4193   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4194   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4195        }
;;;4196   else if(tloaddisable_cmnd==0)
;;;4197   	{
;;;4198   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4199   	}
;;;4200   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;4201   	{
;;;4202   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4203   	}
;;;4204   
;;;4205   else 
;;;4206   	{
;;;4207   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4208        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4209   	} 
;;;4210   
;;;4211   //Реле осевого вентилятора
;;;4212   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;4213   	{
;;;4214   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4215   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4216   	}
;;;4217   else 
;;;4218   	{
;;;4219   	if(mixer_vent_stat==mvsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4220        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4221   	} 
;;;4222   
;;;4223   #endif
;;;4224   
;;;4225   #ifdef UKU_KONTUR
;;;4226   
;;;4227   //Реле общей аварии
;;;4228   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;4229   	{
;;;4230   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4231   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4232   	}
;;;4233   else 
;;;4234   	{
;;;4235        if(  (!(avar_ind_stat&0x00007fff)) &&
;;;4236             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;4237             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;4238             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  /*&&
;;;4239             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4240        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4241   	}
;;;4242   
;;;4243   	
;;;4244   //rel_warm_plazma=0;
;;;4245   //Реле освещения   
;;;4246   /*
;;;4247   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_WARM))
;;;4248   	{
;;;4249   	if(mess_data[1]==0)
;;;4250   		{
;;;4251   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4252   		rel_warm_plazma=1;
;;;4253   		}
;;;4254   	else if(mess_data[1]==1) 
;;;4255   		{
;;;4256   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4257   		rel_warm_plazma=2;
;;;4258   		}
;;;4259        }
;;;4260   else 
;;;4261   	{
;;;4262   	if(warm_stat_k==wsOFF) 
;;;4263   		{
;;;4264   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4265   		rel_warm_plazma=3;
;;;4266   		}
;;;4267        else 
;;;4268   		{
;;;4269   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4270   		rel_warm_plazma=4;
;;;4271   		}
;;;4272   	}
;;;4273   */
;;;4274   //Реле освещения
;;;4275   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;4276   	{
;;;4277   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4278   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4279        }
;;;4280   else 
;;;4281   	{
;;;4282   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4283        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4284   	}
;;;4285   
;;;4286   
;;;4287   
;;;4288   //Реле выключения нагрузки
;;;4289   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;4290   	{
;;;4291   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4292   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4293        }
;;;4294   else if(tloaddisable_cmnd==0)
;;;4295   	{
;;;4296   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4297   	}
;;;4298   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;4299   	{
;;;4300   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4301   	}
;;;4302   
;;;4303   else 
;;;4304   	{
;;;4305   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4306        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4307   	} 
;;;4308   
;;;4309   //Реле осевого вентилятора или отопителя
;;;4310   if(RELE_LOG)
;;;4311   	{
;;;4312   	if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;4313   		{
;;;4314   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4315   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4316   		}
;;;4317   	else 
;;;4318   		{
;;;4319   		if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4320   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4321   		} 
;;;4322   
;;;4323   	}
;;;4324   else 
;;;4325   	{
;;;4326   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;4327   		{
;;;4328   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4329   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4330   		}
;;;4331   	else 
;;;4332   		{
;;;4333   		if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4334   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4335   		} 
;;;4336   	}
;;;4337   #endif
;;;4338   
;;;4339   #ifdef UKU_6U
;;;4340   //Реле аварий батарей
;;;4341   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT1))
;;;4342   	{
;;;4343   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4344   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4345        }
;;;4346   else 
;;;4347   	{
;;;4348   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT1,1);
;;;4349        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT1,1);
;;;4350   	} 
;;;4351   
;;;4352   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT2))
;;;4353   	{
;;;4354   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4355   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4356       }
;;;4357   else if(NPN_OUT==npnoRELEAVBAT2)
;;;4358   	{
;;;4359   	if(npn_stat==npnsOFF)//&&(mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_NPN))
;;;4360   		{
;;;4361   		/*if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4362   		else if(mess_data[1]==1)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4363        	}
;;;4364   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4365   	}
;;;4366   else 
;;;4367   	{
;;;4368   	if(!(avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT2,1);
;;;4369       else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT2,1);
;;;4370   	} 
;;;4371   
;;;4372   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4373   	{
;;;4374   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4375   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4376        }
;;;4377   else 
;;;4378   	{
;;;4379   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4380        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4381   	} 
;;;4382   
;;;4383   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;4384   	{
;;;4385   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4386   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4387   	}
;;;4388   else if((NPN_OUT==npnoRELEVENT))
;;;4389   	{
;;;4390   	if(npn_stat==npnsOFF)//&&(mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_NPN))
;;;4391   		{
;;;4392   		/*if(mess_data[1]==0)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4393   		//else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4394       	}
;;;4395   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4396   	}
;;;4397   else 
;;;4398   	{
;;;4399   	if(!vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4400   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4401   	}
;;;4402   
;;;4403   #endif
;;;4404   
;;;4405   #ifdef UKU_220
;;;4406   //Реле аварий батарей
;;;4407   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;4408   	{
;;;4409   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;4410   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;4411        }
;;;4412   else 
;;;4413   	{
;;;4414   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;4415        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;4416   	} 
;;;4417   
;;;4418   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4419   	{
;;;4420   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4421   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4422        }
;;;4423   else 
;;;4424   	{
;;;4425   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4426        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4427   	} 
;;;4428   
;;;4429   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;4430   	{
;;;4431   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4432   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4433   	}
;;;4434   else 
;;;4435   	{
;;;4436   	if((RELE_VENT_LOGIC==0)||(RELE_VENT_LOGIC==1))
;;;4437   		{
;;;4438   		if(vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4439   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4440   		}
;;;4441   	else 
;;;4442   		{
;;;4443   		if((avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4444        	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4445   		}
;;;4446   	}
;;;4447   
;;;4448   #endif
;;;4449   
;;;4450   #ifdef UKU_220_V2
;;;4451   //Реле аварий батарей
;;;4452   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;4453   	{
;;;4454   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;4455   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;4456        }
;;;4457   else 
;;;4458   	{
;;;4459   	if(!(avar_ind_stat&0x00000002)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BAT,1);
;;;4460        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BAT,1);
;;;4461   	} 
;;;4462   
;;;4463   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4464   	{
;;;4465   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4466   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4467        }
;;;4468   else 
;;;4469   	{
;;;4470   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4471        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4472   	} 
;;;4473   
;;;4474   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;4475   	{
;;;4476   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4477   	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4478   	}
;;;4479   else 
;;;4480   	{
;;;4481   	if((RELE_VENT_LOGIC==0)||(RELE_VENT_LOGIC==1))
;;;4482   		{
;;;4483   		if(vent_stat) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4484   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4485   		}
;;;4486   	else 
;;;4487   		{
;;;4488   		if((avar_ind_stat&0x00000004)) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4489        	else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4490   		}
;;;4491   	}
;;;4492   
;;;4493   #endif
;;;4494   
;;;4495   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;4496   
;;;4497   if((AUSW_MAIN==22010)||(AUSW_MAIN==22011))
002b92  4891              LDR      r0,|L1.11736|
;;;4498   	{
;;;4499   	#ifndef UKU2071x
;;;4500   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4501   		{
;;;4502   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4503   		else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4504   		}
;;;4505   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4506   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4507   	#endif
;;;4508   
;;;4509   	#ifdef UKU2071x
;;;4510   		#ifndef APSENERGIA
;;;4511   		if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4512   			{
;;;4513   			if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4514   			else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4515   			}
;;;4516   		else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4517   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4518   		#endif
;;;4519   
;;;4520   		#ifdef APSENERGIA
;;;4521   		if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4522   			{
;;;4523   			if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4524   			else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4525   			}
;;;4526   		else if((mess_find_unvol(MESS2RELE_HNDL))&& (mess_data[0]==PARAM_RELE_BAT_IS_DISCHARGED))  SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4527   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4528   		#endif
;;;4529   
;;;4530   	#endif
;;;4531   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;4532   		{
;;;4533   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;4534   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;4535   	     }
;;;4536   	else 
;;;4537   		{
;;;4538   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;4539   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;4540   		} 
;;;4541   
;;;4542   	//Реле аварий батарей
;;;4543   	#ifndef APSENERGIA
;;;4544   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;4545   		{
;;;4546   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4547   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4548        	}
;;;4549   	else 
;;;4550   		{
;;;4551   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
002b94  f8df8244          LDR      r8,|L1.11740|
002b98  4f91              LDR      r7,|L1.11744|
002b9a  8800              LDRH     r0,[r0,#0]            ;4497  ; AUSW_MAIN
002b9c  f5a041aa          SUB      r1,r0,#0x5500         ;4497
002ba0  39fa              SUBS     r1,r1,#0xfa           ;4497
002ba2  d001              BEQ      |L1.11176|
002ba4  1e49              SUBS     r1,r1,#1              ;4497
002ba6  d16f              BNE      |L1.11400|
                  |L1.11176|
002ba8  20d2              MOVS     r0,#0xd2              ;4511
002baa  f7fffffe          BL       mess_find_unvol
002bae  b110              CBZ      r0,|L1.11190|
002bb0  6828              LDR      r0,[r5,#0]            ;4511  ; mess_data
002bb2  2866              CMP      r0,#0x66              ;4511
002bb4  d043              BEQ      |L1.11326|
                  |L1.11190|
002bb6  6830              LDR      r0,[r6,#0]            ;4516  ; avar_ind_stat
002bb8  07c0              LSLS     r0,r0,#31             ;4516
002bba  d04d              BEQ      |L1.11352|
002bbc  6fa0              LDR      r0,[r4,#0x78]         ;4517
002bbe  f0407000          ORR      r0,r0,#0x2000000      ;4517
002bc2  67a0              STR      r0,[r4,#0x78]         ;4517
                  |L1.11204|
002bc4  20d2              MOVS     r0,#0xd2              ;4531
002bc6  f7fffffe          BL       mess_find_unvol
002bca  b110              CBZ      r0,|L1.11218|
002bcc  6828              LDR      r0,[r5,#0]            ;4531  ; mess_data
002bce  286a              CMP      r0,#0x6a              ;4531
002bd0  d047              BEQ      |L1.11362|
                  |L1.11218|
002bd2  6830              LDR      r0,[r6,#0]            ;4538  ; avar_ind_stat
002bd4  4238              TST      r0,r7                 ;4538
002bd6  d052              BEQ      |L1.11390|
002bd8  69a0              LDR      r0,[r4,#0x18]         ;4539
002bda  f0400080          ORR      r0,r0,#0x80           ;4539
002bde  61a0              STR      r0,[r4,#0x18]         ;4539
                  |L1.11232|
002be0  20d2              MOVS     r0,#0xd2              ;4544
002be2  f7fffffe          BL       mess_find_unvol
002be6  b110              CBZ      r0,|L1.11246|
002be8  6828              LDR      r0,[r5,#0]            ;4544  ; mess_data
002bea  2867              CMP      r0,#0x67              ;4544
002bec  d04d              BEQ      |L1.11402|
                  |L1.11246|
002bee  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
002bf2  b380              CBZ      r0,|L1.11350|
;;;4552        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
002bf4  69a0              LDR      r0,[r4,#0x18]
002bf6  f0400010          ORR      r0,r0,#0x10
002bfa  61a0              STR      r0,[r4,#0x18]
002bfc  e1f2              B        |L1.12260|
                  |L1.11262|
002bfe  6868              LDR      r0,[r5,#4]            ;4052  ; mess_data
002c00  2801              CMP      r0,#1                 ;4052
002c02  d006              BEQ      |L1.11282|
002c04  2800              CMP      r0,#0                 ;4053
002c06  d1b5              BNE      |L1.11124|
002c08  69e0              LDR      r0,[r4,#0x1c]         ;4053
002c0a  f0405000          ORR      r0,r0,#0x20000000     ;4053
002c0e  61e0              STR      r0,[r4,#0x1c]         ;4053
002c10  e7b0              B        |L1.11124|
                  |L1.11282|
002c12  69a0              LDR      r0,[r4,#0x18]         ;4052
002c14  f0405000          ORR      r0,r0,#0x20000000     ;4052
002c18  61a0              STR      r0,[r4,#0x18]         ;4052
002c1a  e7ab              B        |L1.11124|
                  |L1.11292|
002c1c  6868              LDR      r0,[r5,#4]            ;4072  ; mess_data
002c1e  b120              CBZ      r0,|L1.11306|
002c20  6fa0              LDR      r0,[r4,#0x78]         ;4073
002c22  f0407000          ORR      r0,r0,#0x2000000      ;4073
002c26  67a0              STR      r0,[r4,#0x78]         ;4073
002c28  e7b3              B        |L1.11154|
                  |L1.11306|
002c2a  6fe0              LDR      r0,[r4,#0x7c]         ;4072
002c2c  f0407000          ORR      r0,r0,#0x2000000      ;4072
002c30  67e0              STR      r0,[r4,#0x7c]         ;4072
002c32  e7ae              B        |L1.11154|
                  |L1.11316|
002c34  6fe0              LDR      r0,[r4,#0x7c]         ;4075
002c36  f0407000          ORR      r0,r0,#0x2000000      ;4075
002c3a  67e0              STR      r0,[r4,#0x7c]         ;4075
002c3c  e7a9              B        |L1.11154|
                  |L1.11326|
002c3e  6868              LDR      r0,[r5,#4]            ;4513  ; mess_data
002c40  b120              CBZ      r0,|L1.11340|
002c42  6fa0              LDR      r0,[r4,#0x78]         ;4514
002c44  f0407000          ORR      r0,r0,#0x2000000      ;4514
002c48  67a0              STR      r0,[r4,#0x78]         ;4514
002c4a  e7bb              B        |L1.11204|
                  |L1.11340|
002c4c  6fe0              LDR      r0,[r4,#0x7c]         ;4513
002c4e  f0407000          ORR      r0,r0,#0x2000000      ;4513
002c52  67e0              STR      r0,[r4,#0x7c]         ;4513
002c54  e7b6              B        |L1.11204|
                  |L1.11350|
002c56  e027              B        |L1.11432|
                  |L1.11352|
002c58  6fe0              LDR      r0,[r4,#0x7c]         ;4516
002c5a  f0407000          ORR      r0,r0,#0x2000000      ;4516
002c5e  67e0              STR      r0,[r4,#0x7c]         ;4516
002c60  e7b0              B        |L1.11204|
                  |L1.11362|
002c62  6868              LDR      r0,[r5,#4]            ;4533  ; mess_data
002c64  b130              CBZ      r0,|L1.11380|
002c66  2801              CMP      r0,#1                 ;4534
002c68  d1ba              BNE      |L1.11232|
002c6a  69a0              LDR      r0,[r4,#0x18]         ;4534
002c6c  f0400080          ORR      r0,r0,#0x80           ;4534
002c70  61a0              STR      r0,[r4,#0x18]         ;4534
002c72  e7b5              B        |L1.11232|
                  |L1.11380|
002c74  69e0              LDR      r0,[r4,#0x1c]         ;4533
002c76  f0400080          ORR      r0,r0,#0x80           ;4533
002c7a  61e0              STR      r0,[r4,#0x1c]         ;4533
002c7c  e7b0              B        |L1.11232|
                  |L1.11390|
002c7e  69e0              LDR      r0,[r4,#0x1c]         ;4538
002c80  f0400080          ORR      r0,r0,#0x80           ;4538
002c84  61e0              STR      r0,[r4,#0x1c]         ;4538
002c86  e7ab              B        |L1.11232|
                  |L1.11400|
002c88  e013              B        |L1.11442|
                  |L1.11402|
002c8a  6868              LDR      r0,[r5,#4]            ;4546  ; mess_data
002c8c  b110              CBZ      r0,|L1.11412|
002c8e  2801              CMP      r0,#1                 ;4547
002c90  d005              BEQ      |L1.11422|
002c92  e1a7              B        |L1.12260|
                  |L1.11412|
002c94  69e0              LDR      r0,[r4,#0x1c]         ;4546
002c96  f0400010          ORR      r0,r0,#0x10           ;4546
002c9a  61e0              STR      r0,[r4,#0x1c]         ;4546
002c9c  e1a2              B        |L1.12260|
                  |L1.11422|
002c9e  69a0              LDR      r0,[r4,#0x18]         ;4547
002ca0  f0400010          ORR      r0,r0,#0x10           ;4547
002ca4  61a0              STR      r0,[r4,#0x18]         ;4547
002ca6  e19d              B        |L1.12260|
                  |L1.11432|
002ca8  69e0              LDR      r0,[r4,#0x1c]         ;4551
002caa  f0400010          ORR      r0,r0,#0x10           ;4551
002cae  61e0              STR      r0,[r4,#0x1c]         ;4551
002cb0  e198              B        |L1.12260|
                  |L1.11442|
;;;4553   		}
;;;4554   	#endif
;;;4555   	#ifdef APSENERGIA
;;;4556   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
;;;4557   		{
;;;4558   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4559   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4560        	}
;;;4561   	else 
;;;4562   		{
;;;4563   		if(!apsEnergiaStat)SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4564   		else SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4565   		}
;;;4566   	#endif
;;;4567   	}
;;;4568   
;;;4569   else	if(AUSW_MAIN==22023)
002cb2  f5a041ac          SUB      r1,r0,#0x5600
002cb6  3907              SUBS     r1,#7
002cb8  d162              BNE      |L1.11648|
;;;4570   	{
;;;4571   
;;;4572   	//Реле аварий батарей
;;;4573   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
002cba  20d2              MOVS     r0,#0xd2
002cbc  f7fffffe          BL       mess_find_unvol
002cc0  b110              CBZ      r0,|L1.11464|
002cc2  6828              LDR      r0,[r5,#0]  ; mess_data
002cc4  2867              CMP      r0,#0x67
002cc6  d023              BEQ      |L1.11536|
                  |L1.11464|
;;;4574   		{
;;;4575   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4576   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4577        	}
;;;4578   	else 
;;;4579   		{
;;;4580   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
002cc8  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
002ccc  b370              CBZ      r0,|L1.11564|
;;;4581        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
002cce  69a0              LDR      r0,[r4,#0x18]
002cd0  f0400010          ORR      r0,r0,#0x10
002cd4  61a0              STR      r0,[r4,#0x18]
                  |L1.11478|
;;;4582   		} 
;;;4583   
;;;4584   
;;;4585   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;4586   	#ifndef UKU2071x
;;;4587   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4588   		{
;;;4589   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4590   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4591   		}
;;;4592   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4593   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4594   	#endif
;;;4595   	#ifdef UKU2071x
;;;4596   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
002cd6  20d2              MOVS     r0,#0xd2
002cd8  f7fffffe          BL       mess_find_unvol
002cdc  b110              CBZ      r0,|L1.11492|
002cde  6828              LDR      r0,[r5,#0]  ; mess_data
002ce0  2866              CMP      r0,#0x66
002ce2  d028              BEQ      |L1.11574|
                  |L1.11492|
;;;4597   		{
;;;4598   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4599   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4600   		}
;;;4601   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
002ce4  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002ce6  07c0              LSLS     r0,r0,#31
002ce8  d031              BEQ      |L1.11598|
;;;4602   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
002cea  6fa0              LDR      r0,[r4,#0x78]
002cec  f0407000          ORR      r0,r0,#0x2000000
002cf0  67a0              STR      r0,[r4,#0x78]
                  |L1.11506|
;;;4603   	#endif
;;;4604   
;;;4605   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
002cf2  20d2              MOVS     r0,#0xd2
002cf4  f7fffffe          BL       mess_find_unvol
002cf8  b110              CBZ      r0,|L1.11520|
002cfa  6828              LDR      r0,[r5,#0]  ; mess_data
002cfc  286a              CMP      r0,#0x6a
002cfe  d02b              BEQ      |L1.11608|
                  |L1.11520|
;;;4606   		{
;;;4607   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;4608   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;4609   	     }
;;;4610   	else 
;;;4611   		{
;;;4612   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
002d00  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002d02  4238              TST      r0,r7
002d04  d037              BEQ      |L1.11638|
;;;4613   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
002d06  69a0              LDR      r0,[r4,#0x18]
002d08  f0400080          ORR      r0,r0,#0x80
002d0c  61a0              STR      r0,[r4,#0x18]
002d0e  e169              B        |L1.12260|
                  |L1.11536|
002d10  6868              LDR      r0,[r5,#4]            ;4575  ; mess_data
002d12  b130              CBZ      r0,|L1.11554|
002d14  2801              CMP      r0,#1                 ;4576
002d16  d1de              BNE      |L1.11478|
002d18  69a0              LDR      r0,[r4,#0x18]         ;4576
002d1a  f0400010          ORR      r0,r0,#0x10           ;4576
002d1e  61a0              STR      r0,[r4,#0x18]         ;4576
002d20  e7d9              B        |L1.11478|
                  |L1.11554|
002d22  69e0              LDR      r0,[r4,#0x1c]         ;4575
002d24  f0400010          ORR      r0,r0,#0x10           ;4575
002d28  61e0              STR      r0,[r4,#0x1c]         ;4575
002d2a  e7d4              B        |L1.11478|
                  |L1.11564|
002d2c  69e0              LDR      r0,[r4,#0x1c]         ;4580
002d2e  f0400010          ORR      r0,r0,#0x10           ;4580
002d32  61e0              STR      r0,[r4,#0x1c]         ;4580
002d34  e7cf              B        |L1.11478|
                  |L1.11574|
002d36  6868              LDR      r0,[r5,#4]            ;4598  ; mess_data
002d38  b120              CBZ      r0,|L1.11588|
002d3a  69e0              LDR      r0,[r4,#0x1c]         ;4599
002d3c  f0407000          ORR      r0,r0,#0x2000000      ;4599
002d40  61e0              STR      r0,[r4,#0x1c]         ;4599
002d42  e7d6              B        |L1.11506|
                  |L1.11588|
002d44  69a0              LDR      r0,[r4,#0x18]         ;4598
002d46  f0407000          ORR      r0,r0,#0x2000000      ;4598
002d4a  61a0              STR      r0,[r4,#0x18]         ;4598
002d4c  e7d1              B        |L1.11506|
                  |L1.11598|
002d4e  6ba0              LDR      r0,[r4,#0x38]         ;4601
002d50  f0407000          ORR      r0,r0,#0x2000000      ;4601
002d54  63a0              STR      r0,[r4,#0x38]         ;4601
002d56  e7cc              B        |L1.11506|
                  |L1.11608|
002d58  6868              LDR      r0,[r5,#4]            ;4607  ; mess_data
002d5a  b110              CBZ      r0,|L1.11618|
002d5c  2801              CMP      r0,#1                 ;4608
002d5e  d005              BEQ      |L1.11628|
002d60  e140              B        |L1.12260|
                  |L1.11618|
002d62  69e0              LDR      r0,[r4,#0x1c]         ;4607
002d64  f0400080          ORR      r0,r0,#0x80           ;4607
002d68  61e0              STR      r0,[r4,#0x1c]         ;4607
002d6a  e13b              B        |L1.12260|
                  |L1.11628|
002d6c  69a0              LDR      r0,[r4,#0x18]         ;4608
002d6e  f0400080          ORR      r0,r0,#0x80           ;4608
002d72  61a0              STR      r0,[r4,#0x18]         ;4608
002d74  e136              B        |L1.12260|
                  |L1.11638|
002d76  69e0              LDR      r0,[r4,#0x1c]         ;4612
002d78  f0400080          ORR      r0,r0,#0x80           ;4612
002d7c  61e0              STR      r0,[r4,#0x1c]         ;4612
002d7e  e131              B        |L1.12260|
                  |L1.11648|
;;;4614   		} 
;;;4615   	}
;;;4616   else	if((AUSW_MAIN==22043)||(AUSW_MAIN==22044))
002d80  f5a041ac          SUB      r1,r0,#0x5600
002d84  391b              SUBS     r1,r1,#0x1b
002d86  d001              BEQ      |L1.11660|
002d88  1e49              SUBS     r1,r1,#1
002d8a  d173              BNE      |L1.11892|
                  |L1.11660|
;;;4617   	{
;;;4618   	//Реле аварий батарей
;;;4619   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
002d8c  20d2              MOVS     r0,#0xd2
002d8e  f7fffffe          BL       mess_find_unvol
002d92  b110              CBZ      r0,|L1.11674|
002d94  6828              LDR      r0,[r5,#0]  ; mess_data
002d96  2867              CMP      r0,#0x67
002d98  d052              BEQ      |L1.11840|
                  |L1.11674|
;;;4620   		{
;;;4621   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4622   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4623        	}
;;;4624   	else 
;;;4625   		{
;;;4626   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
002d9a  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
002d9e  b3f0              CBZ      r0,|L1.11806|
;;;4627        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
002da0  69a0              LDR      r0,[r4,#0x18]
002da2  f0400010          ORR      r0,r0,#0x10
002da6  e01d              B        |L1.11748|
                  |L1.11688|
                          DCD      bps
                  |L1.11692|
                          DCD      NUMIST
                  |L1.11696|
                          DCD      ||area_number.25||+0x80
                  |L1.11700|
                          DCD      0x4002c000
                  |L1.11704|
                          DCD      0xfff000ff
                  |L1.11708|
                          DCD      0x2009c000
                  |L1.11712|
                          DCD      bat
                  |L1.11716|
                          DCD      tbatdisable_stat
                  |L1.11720|
                          DCD      tbatdisable_cmnd
                  |L1.11724|
                          DCD      main_1Hz_cnt
                  |L1.11728|
                          DCD      mess_data
                  |L1.11732|
                          DCD      avar_ind_stat
                  |L1.11736|
                          DCD      AUSW_MAIN
                  |L1.11740|
                          DCD      ips_bat_av_stat
                  |L1.11744|
                          DCD      0x100007f8
                  |L1.11748|
002de4  61a0              STR      r0,[r4,#0x18]
                  |L1.11750|
;;;4628   		} 
;;;4629   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;4630   	#ifndef UKU2071x 
;;;4631   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4632   		{
;;;4633   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4634   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4635   		}
;;;4636   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4637   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4638   	#endif
;;;4639   	#ifdef UKU2071x 
;;;4640   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
002de6  20d2              MOVS     r0,#0xd2
002de8  f7fffffe          BL       mess_find_unvol
002dec  b110              CBZ      r0,|L1.11764|
002dee  6828              LDR      r0,[r5,#0]  ; mess_data
002df0  2866              CMP      r0,#0x66
002df2  d038              BEQ      |L1.11878|
                  |L1.11764|
;;;4641   		{
;;;4642   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4643   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4644   		}
;;;4645   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
002df4  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002df6  07c0              LSLS     r0,r0,#31
002df8  d042              BEQ      |L1.11904|
;;;4646   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
002dfa  6fa0              LDR      r0,[r4,#0x78]
002dfc  f0407000          ORR      r0,r0,#0x2000000
002e00  67a0              STR      r0,[r4,#0x78]
                  |L1.11778|
;;;4647   	#endif
;;;4648   
;;;4649   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
002e02  20d2              MOVS     r0,#0xd2
002e04  f7fffffe          BL       mess_find_unvol
002e08  b110              CBZ      r0,|L1.11792|
002e0a  6828              LDR      r0,[r5,#0]  ; mess_data
002e0c  286a              CMP      r0,#0x6a
002e0e  d03c              BEQ      |L1.11914|
                  |L1.11792|
;;;4650   		{
;;;4651   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;4652   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;4653   	     }
;;;4654   	else 
;;;4655   		{
;;;4656   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
002e10  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002e12  4238              TST      r0,r7
002e14  d047              BEQ      |L1.11942|
;;;4657   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
002e16  69a0              LDR      r0,[r4,#0x18]
002e18  f0400080          ORR      r0,r0,#0x80
002e1c  e000              B        |L1.11808|
                  |L1.11806|
002e1e  e01d              B        |L1.11868|
                  |L1.11808|
002e20  61a0              STR      r0,[r4,#0x18]
                  |L1.11810|
;;;4658   		}
;;;4659   	//Реле аварии БПС
;;;4660   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
002e22  20d2              MOVS     r0,#0xd2
002e24  f7fffffe          BL       mess_find_unvol
002e28  b110              CBZ      r0,|L1.11824|
002e2a  6828              LDR      r0,[r5,#0]  ; mess_data
002e2c  286a              CMP      r0,#0x6a
002e2e  d03f              BEQ      |L1.11952|
                  |L1.11824|
;;;4661   		{
;;;4662   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4663   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4664        	}
;;;4665   	else 
;;;4666   		{
;;;4667   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
002e30  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002e32  4238              TST      r0,r7
002e34  d04b              BEQ      |L1.11982|
;;;4668        	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
002e36  69a0              LDR      r0,[r4,#0x18]
002e38  f0400020          ORR      r0,r0,#0x20
002e3c  61a0              STR      r0,[r4,#0x18]
002e3e  e0d1              B        |L1.12260|
                  |L1.11840|
002e40  6868              LDR      r0,[r5,#4]            ;4621  ; mess_data
002e42  b130              CBZ      r0,|L1.11858|
002e44  2801              CMP      r0,#1                 ;4622
002e46  d1ce              BNE      |L1.11750|
002e48  69a0              LDR      r0,[r4,#0x18]         ;4622
002e4a  f0400010          ORR      r0,r0,#0x10           ;4622
002e4e  61a0              STR      r0,[r4,#0x18]         ;4622
002e50  e7c9              B        |L1.11750|
                  |L1.11858|
002e52  69e0              LDR      r0,[r4,#0x1c]         ;4621
002e54  f0400010          ORR      r0,r0,#0x10           ;4621
002e58  61e0              STR      r0,[r4,#0x1c]         ;4621
002e5a  e7c4              B        |L1.11750|
                  |L1.11868|
002e5c  69e0              LDR      r0,[r4,#0x1c]         ;4626
002e5e  f0400010          ORR      r0,r0,#0x10           ;4626
002e62  61e0              STR      r0,[r4,#0x1c]         ;4626
002e64  e7bf              B        |L1.11750|
                  |L1.11878|
002e66  6868              LDR      r0,[r5,#4]            ;4642  ; mess_data
002e68  b128              CBZ      r0,|L1.11894|
002e6a  69e0              LDR      r0,[r4,#0x1c]         ;4643
002e6c  f0407000          ORR      r0,r0,#0x2000000      ;4643
002e70  61e0              STR      r0,[r4,#0x1c]         ;4643
002e72  e7c6              B        |L1.11778|
                  |L1.11892|
002e74  e030              B        |L1.11992|
                  |L1.11894|
002e76  69a0              LDR      r0,[r4,#0x18]         ;4642
002e78  f0407000          ORR      r0,r0,#0x2000000      ;4642
002e7c  61a0              STR      r0,[r4,#0x18]         ;4642
002e7e  e7c0              B        |L1.11778|
                  |L1.11904|
002e80  6ba0              LDR      r0,[r4,#0x38]         ;4645
002e82  f0407000          ORR      r0,r0,#0x2000000      ;4645
002e86  63a0              STR      r0,[r4,#0x38]         ;4645
002e88  e7bb              B        |L1.11778|
                  |L1.11914|
002e8a  6868              LDR      r0,[r5,#4]            ;4651  ; mess_data
002e8c  b130              CBZ      r0,|L1.11932|
002e8e  2801              CMP      r0,#1                 ;4652
002e90  d1c7              BNE      |L1.11810|
002e92  69a0              LDR      r0,[r4,#0x18]         ;4652
002e94  f0400080          ORR      r0,r0,#0x80           ;4652
002e98  61a0              STR      r0,[r4,#0x18]         ;4652
002e9a  e7c2              B        |L1.11810|
                  |L1.11932|
002e9c  69e0              LDR      r0,[r4,#0x1c]         ;4651
002e9e  f0400080          ORR      r0,r0,#0x80           ;4651
002ea2  61e0              STR      r0,[r4,#0x1c]         ;4651
002ea4  e7bd              B        |L1.11810|
                  |L1.11942|
002ea6  69e0              LDR      r0,[r4,#0x1c]         ;4656
002ea8  f0400080          ORR      r0,r0,#0x80           ;4656
002eac  61e0              STR      r0,[r4,#0x1c]         ;4656
002eae  e7b8              B        |L1.11810|
                  |L1.11952|
002eb0  6868              LDR      r0,[r5,#4]            ;4662  ; mess_data
002eb2  b110              CBZ      r0,|L1.11962|
002eb4  2801              CMP      r0,#1                 ;4663
002eb6  d005              BEQ      |L1.11972|
002eb8  e094              B        |L1.12260|
                  |L1.11962|
002eba  69e0              LDR      r0,[r4,#0x1c]         ;4662
002ebc  f0400020          ORR      r0,r0,#0x20           ;4662
002ec0  61e0              STR      r0,[r4,#0x1c]         ;4662
002ec2  e08f              B        |L1.12260|
                  |L1.11972|
002ec4  69a0              LDR      r0,[r4,#0x18]         ;4663
002ec6  f0400020          ORR      r0,r0,#0x20           ;4663
002eca  61a0              STR      r0,[r4,#0x18]         ;4663
002ecc  e08a              B        |L1.12260|
                  |L1.11982|
002ece  69e0              LDR      r0,[r4,#0x1c]         ;4667
002ed0  f0400020          ORR      r0,r0,#0x20           ;4667
002ed4  61e0              STR      r0,[r4,#0x1c]         ;4667
002ed6  e085              B        |L1.12260|
                  |L1.11992|
;;;4669   		} 
;;;4670   	}
;;;4671   else	if((AUSW_MAIN==22033)||(AUSW_MAIN==22018))
002ed8  f5a041ac          SUB      r1,r0,#0x5600
002edc  3911              SUBS     r1,r1,#0x11
002ede  d001              BEQ      |L1.12004|
002ee0  310f              ADDS     r1,r1,#0xf
002ee2  d163              BNE      |L1.12204|
                  |L1.12004|
;;;4672   	{
;;;4673   	#ifndef UKU2071x 
;;;4674   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4675   		{
;;;4676   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4677   		else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4678   		}
;;;4679   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4680   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4681   	#endif
;;;4682   	#ifdef UKU2071x 
;;;4683   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
002ee4  20d2              MOVS     r0,#0xd2
002ee6  f7fffffe          BL       mess_find_unvol
002eea  b110              CBZ      r0,|L1.12018|
002eec  6828              LDR      r0,[r5,#0]  ; mess_data
002eee  2866              CMP      r0,#0x66
002ef0  d023              BEQ      |L1.12090|
                  |L1.12018|
;;;4684   		{
;;;4685   		if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;4686   		else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;4687   		}
;;;4688   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
002ef2  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002ef4  07c0              LSLS     r0,r0,#31
002ef6  d02c              BEQ      |L1.12114|
;;;4689   	else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
002ef8  6fa0              LDR      r0,[r4,#0x78]
002efa  f0407000          ORR      r0,r0,#0x2000000
002efe  67a0              STR      r0,[r4,#0x78]
                  |L1.12032|
;;;4690   	#endif
;;;4691   	
;;;4692   	
;;;4693   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
002f00  20d2              MOVS     r0,#0xd2
002f02  f7fffffe          BL       mess_find_unvol
002f06  b110              CBZ      r0,|L1.12046|
002f08  6828              LDR      r0,[r5,#0]  ; mess_data
002f0a  286a              CMP      r0,#0x6a
002f0c  d026              BEQ      |L1.12124|
                  |L1.12046|
;;;4694   		{
;;;4695   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
;;;4696   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,7,1);
;;;4697   	     }
;;;4698   	else 
;;;4699   		{
;;;4700   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,7,1);
002f0e  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002f10  4238              TST      r0,r7
002f12  d031              BEQ      |L1.12152|
;;;4701   	     else SET_REG(LPC_GPIO0->FIOSET,1,7,1);
002f14  69a0              LDR      r0,[r4,#0x18]
002f16  f0400080          ORR      r0,r0,#0x80
002f1a  61a0              STR      r0,[r4,#0x18]
                  |L1.12060|
;;;4702   		} 
;;;4703   
;;;4704   	//Реле аварий батарей
;;;4705   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BAT))
002f1c  20d2              MOVS     r0,#0xd2
002f1e  f7fffffe          BL       mess_find_unvol
002f22  b110              CBZ      r0,|L1.12074|
002f24  6828              LDR      r0,[r5,#0]  ; mess_data
002f26  2867              CMP      r0,#0x67
002f28  d02b              BEQ      |L1.12162|
                  |L1.12074|
;;;4706   		{
;;;4707   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
;;;4708   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,4,1);
;;;4709        	}
;;;4710   	else 
;;;4711   		{
;;;4712   		if(!(ips_bat_av_stat)) SET_REG(LPC_GPIO0->FIOCLR,1,4,1);
002f2a  f8980000          LDRB     r0,[r8,#0]  ; ips_bat_av_stat
002f2e  b390              CBZ      r0,|L1.12182|
;;;4713        	else SET_REG(LPC_GPIO0->FIOSET,1,4,1);
002f30  69a0              LDR      r0,[r4,#0x18]
002f32  f0400010          ORR      r0,r0,#0x10
002f36  61a0              STR      r0,[r4,#0x18]
002f38  e054              B        |L1.12260|
                  |L1.12090|
002f3a  6868              LDR      r0,[r5,#4]            ;4685  ; mess_data
002f3c  b120              CBZ      r0,|L1.12104|
002f3e  6fa0              LDR      r0,[r4,#0x78]         ;4686
002f40  f0407000          ORR      r0,r0,#0x2000000      ;4686
002f44  67a0              STR      r0,[r4,#0x78]         ;4686
002f46  e7db              B        |L1.12032|
                  |L1.12104|
002f48  6fe0              LDR      r0,[r4,#0x7c]         ;4685
002f4a  f0407000          ORR      r0,r0,#0x2000000      ;4685
002f4e  67e0              STR      r0,[r4,#0x7c]         ;4685
002f50  e7d6              B        |L1.12032|
                  |L1.12114|
002f52  6fe0              LDR      r0,[r4,#0x7c]         ;4688
002f54  f0407000          ORR      r0,r0,#0x2000000      ;4688
002f58  67e0              STR      r0,[r4,#0x7c]         ;4688
002f5a  e7d1              B        |L1.12032|
                  |L1.12124|
002f5c  6868              LDR      r0,[r5,#4]            ;4695  ; mess_data
002f5e  b130              CBZ      r0,|L1.12142|
002f60  2801              CMP      r0,#1                 ;4696
002f62  d1db              BNE      |L1.12060|
002f64  69a0              LDR      r0,[r4,#0x18]         ;4696
002f66  f0400080          ORR      r0,r0,#0x80           ;4696
002f6a  61a0              STR      r0,[r4,#0x18]         ;4696
002f6c  e7d6              B        |L1.12060|
                  |L1.12142|
002f6e  69e0              LDR      r0,[r4,#0x1c]         ;4695
002f70  f0400080          ORR      r0,r0,#0x80           ;4695
002f74  61e0              STR      r0,[r4,#0x1c]         ;4695
002f76  e7d1              B        |L1.12060|
                  |L1.12152|
002f78  69e0              LDR      r0,[r4,#0x1c]         ;4700
002f7a  f0400080          ORR      r0,r0,#0x80           ;4700
002f7e  61e0              STR      r0,[r4,#0x1c]         ;4700
002f80  e7cc              B        |L1.12060|
                  |L1.12162|
002f82  6868              LDR      r0,[r5,#4]            ;4707  ; mess_data
002f84  b110              CBZ      r0,|L1.12172|
002f86  2801              CMP      r0,#1                 ;4708
002f88  d006              BEQ      |L1.12184|
002f8a  e02b              B        |L1.12260|
                  |L1.12172|
002f8c  69e0              LDR      r0,[r4,#0x1c]         ;4707
002f8e  f0400010          ORR      r0,r0,#0x10           ;4707
002f92  61e0              STR      r0,[r4,#0x1c]         ;4707
002f94  e026              B        |L1.12260|
                  |L1.12182|
002f96  e004              B        |L1.12194|
                  |L1.12184|
002f98  69a0              LDR      r0,[r4,#0x18]         ;4708
002f9a  f0400010          ORR      r0,r0,#0x10           ;4708
002f9e  61a0              STR      r0,[r4,#0x18]         ;4708
002fa0  e020              B        |L1.12260|
                  |L1.12194|
002fa2  69e0              LDR      r0,[r4,#0x1c]         ;4712
002fa4  f0400010          ORR      r0,r0,#0x10           ;4712
002fa8  61e0              STR      r0,[r4,#0x1c]         ;4712
002faa  e01b              B        |L1.12260|
                  |L1.12204|
;;;4714   		} 
;;;4715   	} 	 
;;;4716   else	
;;;4717   	{
;;;4718   	//Реле аварии сети ТУТ КАКАЯ то ЛАЖА с аварией сети. Обращение к разным портам
;;;4719   	#ifndef UKU2071x 
;;;4720   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4721   		{
;;;4722   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4723   		else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4724   		}
;;;4725   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4726   	else SET_REG(LPC_GPIO3->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4727   	#endif
;;;4728   	#ifdef UKU2071x 
;;;4729   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
002fac  20d2              MOVS     r0,#0xd2
002fae  f7fffffe          BL       mess_find_unvol
002fb2  b110              CBZ      r0,|L1.12218|
002fb4  6828              LDR      r0,[r5,#0]  ; mess_data
002fb6  2866              CMP      r0,#0x66
002fb8  d026              BEQ      |L1.12296|
                  |L1.12218|
;;;4730   		{
;;;4731   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4732   		else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4733   		}
;;;4734   	else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO1->FIOSET,1,SHIFT_REL_AV_NET,1);
002fba  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002fbc  07c0              LSLS     r0,r0,#31
002fbe  d02f              BEQ      |L1.12320|
;;;4735   	else SET_REG(LPC_GPIO3->FIOSET,1,SHIFT_REL_AV_NET,1);
002fc0  6fa0              LDR      r0,[r4,#0x78]
002fc2  f0407000          ORR      r0,r0,#0x2000000
002fc6  67a0              STR      r0,[r4,#0x78]
                  |L1.12232|
;;;4736   	#endif
;;;4737   
;;;4738   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
002fc8  20d2              MOVS     r0,#0xd2
002fca  f7fffffe          BL       mess_find_unvol
002fce  b110              CBZ      r0,|L1.12246|
002fd0  6828              LDR      r0,[r5,#0]  ; mess_data
002fd2  286a              CMP      r0,#0x6a
002fd4  d029              BEQ      |L1.12330|
                  |L1.12246|
;;;4739   		{
;;;4740   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;4741   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;4742        	}
;;;4743   	else 
;;;4744   		{
;;;4745   		if(!(avar_ind_stat&0x100007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
002fd6  6830              LDR      r0,[r6,#0]  ; avar_ind_stat
002fd8  4238              TST      r0,r7
002fda  d034              BEQ      |L1.12358|
;;;4746        	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
002fdc  69a0              LDR      r0,[r4,#0x18]
002fde  f0400020          ORR      r0,r0,#0x20
002fe2  61a0              STR      r0,[r4,#0x18]
                  |L1.12260|
;;;4747   		}
;;;4748   	}
;;;4749   //Дополнительное реле УКУ 
;;;4750   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_EXT))	 
002fe4  20d2              MOVS     r0,#0xd2
002fe6  f7fffffe          BL       mess_find_unvol
;;;4751   	{
;;;4752   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
;;;4753   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;4754   	}
;;;4755   else if(DOP_RELE_FUNC==0)	//если допреле подключено к ускоренному заряду
;;;4756   	{
;;;4757   	if((!speedChIsOn)&&(spc_stat!=spcVZ)&&(hv_vz_stat==hvsOFF)&&(sp_ch_stat==scsOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(load_U/10<UVENTOFF))   SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
002fea  f8df83fc          LDR      r8,|L1.13288|
002fee  4fff              LDR      r7,|L1.13292|
002ff0  4eff              LDR      r6,|L1.13296|
002ff2  b110              CBZ      r0,|L1.12282|
002ff4  6828              LDR      r0,[r5,#0]            ;4750  ; mess_data
002ff6  2871              CMP      r0,#0x71              ;4750
002ff8  d02a              BEQ      |L1.12368|
                  |L1.12282|
002ffa  48fe              LDR      r0,|L1.13300|
002ffc  f9b00000          LDRSH    r0,[r0,#0]            ;4755  ; DOP_RELE_FUNC
003000  b380              CBZ      r0,|L1.12388|
;;;4758   	else if((speedChIsOn)||(spc_stat==spcVZ)||(hv_vz_stat!=hvsOFF)||(sp_ch_stat!=scsOFF)||(vz1_stat!=vz1sOFF)||(vz2_stat!=vz2sOFF)) SET_REG(LPC_GPIO0->FIOSET,1,9,1);
;;;4759   	}
;;;4760   else if(DOP_RELE_FUNC==1)  //если допреле подключено к индикации разряженной батареи
003002  2801              CMP      r0,#1
003004  d068              BEQ      |L1.12504|
003006  e072              B        |L1.12526|
                  |L1.12296|
003008  6868              LDR      r0,[r5,#4]            ;4731  ; mess_data
00300a  b120              CBZ      r0,|L1.12310|
00300c  69e0              LDR      r0,[r4,#0x1c]         ;4732
00300e  f0407000          ORR      r0,r0,#0x2000000      ;4732
003012  61e0              STR      r0,[r4,#0x1c]         ;4732
003014  e7d8              B        |L1.12232|
                  |L1.12310|
003016  69a0              LDR      r0,[r4,#0x18]         ;4731
003018  f0407000          ORR      r0,r0,#0x2000000      ;4731
00301c  61a0              STR      r0,[r4,#0x18]         ;4731
00301e  e7d3              B        |L1.12232|
                  |L1.12320|
003020  6ba0              LDR      r0,[r4,#0x38]         ;4734
003022  f0407000          ORR      r0,r0,#0x2000000      ;4734
003026  63a0              STR      r0,[r4,#0x38]         ;4734
003028  e7ce              B        |L1.12232|
                  |L1.12330|
00302a  6868              LDR      r0,[r5,#4]            ;4740  ; mess_data
00302c  b130              CBZ      r0,|L1.12348|
00302e  2801              CMP      r0,#1                 ;4741
003030  d1d8              BNE      |L1.12260|
003032  69a0              LDR      r0,[r4,#0x18]         ;4741
003034  f0400020          ORR      r0,r0,#0x20           ;4741
003038  61a0              STR      r0,[r4,#0x18]         ;4741
00303a  e7d3              B        |L1.12260|
                  |L1.12348|
00303c  69e0              LDR      r0,[r4,#0x1c]         ;4740
00303e  f0400020          ORR      r0,r0,#0x20           ;4740
003042  61e0              STR      r0,[r4,#0x1c]         ;4740
003044  e7ce              B        |L1.12260|
                  |L1.12358|
003046  69e0              LDR      r0,[r4,#0x1c]         ;4745
003048  f0400020          ORR      r0,r0,#0x20           ;4745
00304c  61e0              STR      r0,[r4,#0x1c]         ;4745
00304e  e7c9              B        |L1.12260|
                  |L1.12368|
003050  6868              LDR      r0,[r5,#4]            ;4752  ; mess_data
003052  b110              CBZ      r0,|L1.12378|
003054  2801              CMP      r0,#1                 ;4753
003056  d006              BEQ      |L1.12390|
003058  e049              B        |L1.12526|
                  |L1.12378|
00305a  69e0              LDR      r0,[r4,#0x1c]         ;4752
00305c  f4407000          ORR      r0,r0,#0x200          ;4752
003060  61e0              STR      r0,[r4,#0x1c]         ;4752
003062  e044              B        |L1.12526|
                  |L1.12388|
003064  e004              B        |L1.12400|
                  |L1.12390|
003066  69a0              LDR      r0,[r4,#0x18]         ;4753
003068  f4407000          ORR      r0,r0,#0x200          ;4753
00306c  61a0              STR      r0,[r4,#0x18]         ;4753
00306e  e03e              B        |L1.12526|
                  |L1.12400|
003070  48e1              LDR      r0,|L1.13304|
003072  49e2              LDR      r1,|L1.13308|
003074  f9b00000          LDRSH    r0,[r0,#0]            ;4757  ; speedChIsOn
003078  b9d8              CBNZ     r0,|L1.12466|
00307a  7eb2              LDRB     r2,[r6,#0x1a]         ;4757  ; spc_stat
00307c  2a02              CMP      r2,#2                 ;4757
00307e  d018              BEQ      |L1.12466|
003080  780a              LDRB     r2,[r1,#0]            ;4757  ; hv_vz_stat
003082  b9b2              CBNZ     r2,|L1.12466|
003084  783a              LDRB     r2,[r7,#0]            ;4757  ; sp_ch_stat
003086  b9a2              CBNZ     r2,|L1.12466|
003088  f8962026          LDRB     r2,[r6,#0x26]         ;4757  ; vz1_stat
00308c  b98a              CBNZ     r2,|L1.12466|
00308e  f8962029          LDRB     r2,[r6,#0x29]         ;4757  ; vz2_stat
003092  b972              CBNZ     r2,|L1.12466|
003094  f9b82000          LDRSH    r2,[r8,#0]            ;4757  ; load_U
003098  230a              MOVS     r3,#0xa               ;4757
00309a  fb92f2f3          SDIV     r2,r2,r3              ;4757
00309e  4bd8              LDR      r3,|L1.13312|
0030a0  f9b33000          LDRSH    r3,[r3,#0]            ;4757  ; UVENTOFF
0030a4  429a              CMP      r2,r3                 ;4757
0030a6  da04              BGE      |L1.12466|
0030a8  69e0              LDR      r0,[r4,#0x1c]         ;4757
0030aa  f4407000          ORR      r0,r0,#0x200          ;4757
0030ae  61e0              STR      r0,[r4,#0x1c]         ;4757
0030b0  e01d              B        |L1.12526|
                  |L1.12466|
0030b2  b960              CBNZ     r0,|L1.12494|
0030b4  7eb0              LDRB     r0,[r6,#0x1a]         ;4758  ; spc_stat
0030b6  2802              CMP      r0,#2                 ;4758
0030b8  d009              BEQ      |L1.12494|
0030ba  7808              LDRB     r0,[r1,#0]            ;4758  ; hv_vz_stat
0030bc  b938              CBNZ     r0,|L1.12494|
0030be  7838              LDRB     r0,[r7,#0]            ;4758  ; sp_ch_stat
0030c0  b928              CBNZ     r0,|L1.12494|
0030c2  f8960026          LDRB     r0,[r6,#0x26]         ;4758  ; vz1_stat
0030c6  b910              CBNZ     r0,|L1.12494|
0030c8  f8960029          LDRB     r0,[r6,#0x29]         ;4758  ; vz2_stat
0030cc  b178              CBZ      r0,|L1.12526|
                  |L1.12494|
0030ce  69a0              LDR      r0,[r4,#0x18]         ;4758
0030d0  f4407000          ORR      r0,r0,#0x200          ;4758
0030d4  61a0              STR      r0,[r4,#0x18]         ;4758
0030d6  e00a              B        |L1.12526|
                  |L1.12504|
;;;4761   	{
;;;4762   	if((mess_find_unvol(MESS2RELE_HNDL))&& (mess_data[0]==PARAM_RELE_BAT_IS_DISCHARGED)) SET_REG(LPC_GPIO0->FIOCLR,1,9,1);
0030d8  20d2              MOVS     r0,#0xd2
0030da  f7fffffe          BL       mess_find_unvol
0030de  b110              CBZ      r0,|L1.12518|
0030e0  6828              LDR      r0,[r5,#0]  ; mess_data
0030e2  2872              CMP      r0,#0x72
0030e4  d017              BEQ      |L1.12566|
                  |L1.12518|
;;;4763   	else SET_REG(LPC_GPIO0->FIOSET,1,9,1);
0030e6  69a0              LDR      r0,[r4,#0x18]
0030e8  f4407000          ORR      r0,r0,#0x200
0030ec  61a0              STR      r0,[r4,#0x18]
                  |L1.12526|
;;;4764   	}
;;;4765   	
;;;4766   //Блок выносной реле
;;;4767   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR1))
0030ee  20d2              MOVS     r0,#0xd2
0030f0  f7fffffe          BL       mess_find_unvol
;;;4768   	{
;;;4769   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfe;
0030f4  f8df930c          LDR      r9,|L1.13316|
;;;4770   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x01;
;;;4771   	}
;;;4772   else 
;;;4773   	{
;;;4774   	if(bdr_avar_stat&0x01)  	bdr_transmit_stat|=0x01;
0030f8  4cc3              LDR      r4,|L1.13320|
0030fa  b110              CBZ      r0,|L1.12546|
0030fc  6828              LDR      r0,[r5,#0]            ;4767  ; mess_data
0030fe  2875              CMP      r0,#0x75              ;4767
003100  d00e              BEQ      |L1.12576|
                  |L1.12546|
003102  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
003104  07c0              LSLS     r0,r0,#31
003106  d01e              BEQ      |L1.12614|
003108  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00310c  f0400001          ORR      r0,r0,#1
003110  f8890000          STRB     r0,[r9,#0]
003114  e01d              B        |L1.12626|
                  |L1.12566|
003116  69e0              LDR      r0,[r4,#0x1c]         ;4762
003118  f4407000          ORR      r0,r0,#0x200          ;4762
00311c  61e0              STR      r0,[r4,#0x1c]         ;4762
00311e  e7e6              B        |L1.12526|
                  |L1.12576|
003120  6868              LDR      r0,[r5,#4]            ;4769  ; mess_data
003122  b110              CBZ      r0,|L1.12586|
003124  2801              CMP      r0,#1                 ;4770
003126  d007              BEQ      |L1.12600|
003128  e013              B        |L1.12626|
                  |L1.12586|
00312a  f8990000          LDRB     r0,[r9,#0]            ;4769  ; bdr_transmit_stat
00312e  f00000fe          AND      r0,r0,#0xfe           ;4769
003132  f8890000          STRB     r0,[r9,#0]            ;4769
003136  e00c              B        |L1.12626|
                  |L1.12600|
003138  f8990000          LDRB     r0,[r9,#0]            ;4770  ; bdr_transmit_stat
00313c  f0400001          ORR      r0,r0,#1              ;4770
003140  f8890000          STRB     r0,[r9,#0]            ;4770
003144  e005              B        |L1.12626|
                  |L1.12614|
;;;4775   	else 						bdr_transmit_stat&=0xfe;
003146  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00314a  f00000fe          AND      r0,r0,#0xfe
00314e  f8890000          STRB     r0,[r9,#0]
                  |L1.12626|
;;;4776   	}	
;;;4777   
;;;4778   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR2))
003152  20d2              MOVS     r0,#0xd2
003154  f7fffffe          BL       mess_find_unvol
003158  b110              CBZ      r0,|L1.12640|
00315a  6828              LDR      r0,[r5,#0]  ; mess_data
00315c  2876              CMP      r0,#0x76
00315e  d009              BEQ      |L1.12660|
                  |L1.12640|
;;;4779   	{
;;;4780   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfd;
;;;4781   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x02;
;;;4782   	}
;;;4783   else 
;;;4784   	{
;;;4785   	if(bdr_avar_stat&0x01)  	bdr_transmit_stat|=0x02;
003160  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
003162  07c0              LSLS     r0,r0,#31
003164  d019              BEQ      |L1.12698|
003166  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00316a  f0400002          ORR      r0,r0,#2
00316e  f8890000          STRB     r0,[r9,#0]
003172  e018              B        |L1.12710|
                  |L1.12660|
003174  6868              LDR      r0,[r5,#4]            ;4780  ; mess_data
003176  b110              CBZ      r0,|L1.12670|
003178  2801              CMP      r0,#1                 ;4781
00317a  d007              BEQ      |L1.12684|
00317c  e013              B        |L1.12710|
                  |L1.12670|
00317e  f8990000          LDRB     r0,[r9,#0]            ;4780  ; bdr_transmit_stat
003182  f00000fd          AND      r0,r0,#0xfd           ;4780
003186  f8890000          STRB     r0,[r9,#0]            ;4780
00318a  e00c              B        |L1.12710|
                  |L1.12684|
00318c  f8990000          LDRB     r0,[r9,#0]            ;4781  ; bdr_transmit_stat
003190  f0400002          ORR      r0,r0,#2              ;4781
003194  f8890000          STRB     r0,[r9,#0]            ;4781
003198  e005              B        |L1.12710|
                  |L1.12698|
;;;4786   	else 						bdr_transmit_stat&=0xfd;
00319a  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
00319e  f00000fd          AND      r0,r0,#0xfd
0031a2  f8890000          STRB     r0,[r9,#0]
                  |L1.12710|
;;;4787   	}	
;;;4788   	
;;;4789   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR3))
0031a6  20d2              MOVS     r0,#0xd2
0031a8  f7fffffe          BL       mess_find_unvol
0031ac  b110              CBZ      r0,|L1.12724|
0031ae  6828              LDR      r0,[r5,#0]  ; mess_data
0031b0  2877              CMP      r0,#0x77
0031b2  d009              BEQ      |L1.12744|
                  |L1.12724|
;;;4790   	{
;;;4791   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xfb;
;;;4792   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x04;
;;;4793   	}
;;;4794   else 
;;;4795   	{
;;;4796   	if(bdr_avar_stat&0x01)  	bdr_transmit_stat|=0x04;
0031b4  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
0031b6  07c0              LSLS     r0,r0,#31
0031b8  d019              BEQ      |L1.12782|
0031ba  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0031be  f0400004          ORR      r0,r0,#4
0031c2  f8890000          STRB     r0,[r9,#0]
0031c6  e018              B        |L1.12794|
                  |L1.12744|
0031c8  6868              LDR      r0,[r5,#4]            ;4791  ; mess_data
0031ca  b110              CBZ      r0,|L1.12754|
0031cc  2801              CMP      r0,#1                 ;4792
0031ce  d007              BEQ      |L1.12768|
0031d0  e013              B        |L1.12794|
                  |L1.12754|
0031d2  f8990000          LDRB     r0,[r9,#0]            ;4791  ; bdr_transmit_stat
0031d6  f00000fb          AND      r0,r0,#0xfb           ;4791
0031da  f8890000          STRB     r0,[r9,#0]            ;4791
0031de  e00c              B        |L1.12794|
                  |L1.12768|
0031e0  f8990000          LDRB     r0,[r9,#0]            ;4792  ; bdr_transmit_stat
0031e4  f0400004          ORR      r0,r0,#4              ;4792
0031e8  f8890000          STRB     r0,[r9,#0]            ;4792
0031ec  e005              B        |L1.12794|
                  |L1.12782|
;;;4797   	else 						bdr_transmit_stat&=0xfb;
0031ee  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
0031f2  f00000fb          AND      r0,r0,#0xfb
0031f6  f8890000          STRB     r0,[r9,#0]
                  |L1.12794|
;;;4798   	}	
;;;4799   	
;;;4800   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_BDR4))
0031fa  20d2              MOVS     r0,#0xd2
0031fc  f7fffffe          BL       mess_find_unvol
003200  b110              CBZ      r0,|L1.12808|
003202  6828              LDR      r0,[r5,#0]  ; mess_data
003204  2878              CMP      r0,#0x78
003206  d009              BEQ      |L1.12828|
                  |L1.12808|
;;;4801   	{
;;;4802   	if(mess_data[1]==0) 		bdr_transmit_stat&=0xf7;
;;;4803   	else if(mess_data[1]==1) 	bdr_transmit_stat|=0x08;
;;;4804   	}
;;;4805   else 
;;;4806   	{
;;;4807   	if(bdr_avar_stat&0x01)  	bdr_transmit_stat|=0x08;
003208  7820              LDRB     r0,[r4,#0]  ; bdr_avar_stat
00320a  07c0              LSLS     r0,r0,#31
00320c  d019              BEQ      |L1.12866|
00320e  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
003212  f0400008          ORR      r0,r0,#8
003216  f8890000          STRB     r0,[r9,#0]
00321a  e018              B        |L1.12878|
                  |L1.12828|
00321c  6868              LDR      r0,[r5,#4]            ;4802  ; mess_data
00321e  b110              CBZ      r0,|L1.12838|
003220  2801              CMP      r0,#1                 ;4803
003222  d007              BEQ      |L1.12852|
003224  e013              B        |L1.12878|
                  |L1.12838|
003226  f8990000          LDRB     r0,[r9,#0]            ;4802  ; bdr_transmit_stat
00322a  f00000f7          AND      r0,r0,#0xf7           ;4802
00322e  f8890000          STRB     r0,[r9,#0]            ;4802
003232  e00c              B        |L1.12878|
                  |L1.12852|
003234  f8990000          LDRB     r0,[r9,#0]            ;4803  ; bdr_transmit_stat
003238  f0400008          ORR      r0,r0,#8              ;4803
00323c  f8890000          STRB     r0,[r9,#0]            ;4803
003240  e005              B        |L1.12878|
                  |L1.12866|
;;;4808   	else 						bdr_transmit_stat&=0xf7;
003242  f8990000          LDRB     r0,[r9,#0]  ; bdr_transmit_stat
003246  f00000f7          AND      r0,r0,#0xf7
00324a  f8890000          STRB     r0,[r9,#0]
                  |L1.12878|
;;;4809   	}	
;;;4810   					 	
;;;4811   #endif
;;;4812   
;;;4813   #ifdef UKU_KONTUR
;;;4814   
;;;4815   //Реле общей аварии
;;;4816   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_COMM))
;;;4817   	{
;;;4818   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4819   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4820   	}
;;;4821   else 
;;;4822   	{
;;;4823        if(  (!(avar_ind_stat&0x00007fff)) &&
;;;4824             ((!SK_REL_EN[0]) || (sk_av_stat[0]!=sasON))  &&
;;;4825             ((!SK_REL_EN[1]) || (sk_av_stat[1]!=sasON))  &&
;;;4826             ((!SK_REL_EN[2]) || (sk_av_stat[2]!=sasON))  /*&&
;;;4827             ((!SK_REL_EN[3]) || (sk_av_stat[3]!=sasON))*/  )SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_COMM,1);
;;;4828        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_COMM,1);
;;;4829   	}
;;;4830   
;;;4831   	
;;;4832   //rel_warm_plazma=0;
;;;4833   //Реле освещения   
;;;4834   /*
;;;4835   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_WARM))
;;;4836   	{
;;;4837   	if(mess_data[1]==0)
;;;4838   		{
;;;4839   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4840   		rel_warm_plazma=1;
;;;4841   		}
;;;4842   	else if(mess_data[1]==1) 
;;;4843   		{
;;;4844   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4845   		rel_warm_plazma=2;
;;;4846   		}
;;;4847        }
;;;4848   else 
;;;4849   	{
;;;4850   	if(warm_stat_k==wsOFF) 
;;;4851   		{
;;;4852   		SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4853   		rel_warm_plazma=3;
;;;4854   		}
;;;4855        else 
;;;4856   		{
;;;4857   		SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4858   		rel_warm_plazma=4;
;;;4859   		}
;;;4860   	}
;;;4861   */
;;;4862   //Реле освещения
;;;4863   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;4864   	{
;;;4865   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4866   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4867        }
;;;4868   else 
;;;4869   	{
;;;4870   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4871        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4872   	}
;;;4873   
;;;4874   
;;;4875   
;;;4876   //Реле выключения нагрузки
;;;4877   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;4878   	{
;;;4879   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4880   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4881        }
;;;4882   else if(tloaddisable_cmnd==0)
;;;4883   	{
;;;4884   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4885   	}
;;;4886   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;4887   	{
;;;4888   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4889   	}
;;;4890   
;;;4891   else 
;;;4892   	{
;;;4893   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;4894        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;4895   	} 
;;;4896   
;;;4897   //Реле осевого вентилятора или отопителя
;;;4898   if(RELE_LOG)
;;;4899   	{
;;;4900   	if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;4901   		{
;;;4902   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4903   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4904   		}
;;;4905   	else 
;;;4906   		{
;;;4907   		if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4908   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4909   		} 
;;;4910   
;;;4911   	}
;;;4912   else 
;;;4913   	{
;;;4914   	if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT_WARM))
;;;4915   		{
;;;4916   		if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4917   		else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4918   		}
;;;4919   	else 
;;;4920   		{
;;;4921   		if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT_WARM,1);
;;;4922   	     else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT_WARM,1);
;;;4923   		} 
;;;4924   	}
;;;4925   #endif
;;;4926   
;;;4927   
;;;4928   #ifdef UKU_TELECORE2015
;;;4929   //Реле аварии сети
;;;4930   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4931   	{
;;;4932   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4933   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4934   	}
;;;4935   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4936   else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4937   
;;;4938   
;;;4939   //Реле освещения
;;;4940   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;4941   	{
;;;4942   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4943   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4944        }
;;;4945   else 
;;;4946   	{
;;;4947   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;4948        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;4949   	}
;;;4950   
;;;4951   //Реле отопителя
;;;4952   if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_WARM))
;;;4953   	{
;;;4954   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4955   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4956   	}
;;;4957   else 
;;;4958   	{
;;;4959   	if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;4960        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;4961   	} 
;;;4962   //Реле вентилятора
;;;4963   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;4964   	{
;;;4965   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4966   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4967   	}
;;;4968   else 
;;;4969   	{
;;;4970   	if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;4971        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;4972   	} 
;;;4973   
;;;4974   //Реле внутреннего вентилятора
;;;4975   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VVENT))
;;;4976   	{
;;;4977   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;4978   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;4979   	}
;;;4980   else 
;;;4981   	{
;;;4982   	if(vvent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;4983        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;4984   	} 
;;;4985   
;;;4986   #endif
;;;4987   
;;;4988   #ifdef UKU_TELECORE2017
;;;4989   //Реле аварии сети
;;;4990   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;4991   	{
;;;4992   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4993   	else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4994   	}
;;;4995   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_NET,1);
;;;4996   else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_NET,1);
;;;4997   
;;;4998   
;;;4999   //Реле освещения
;;;5000   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LIGHT))
;;;5001   	{
;;;5002   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5003   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5004        }
;;;5005   else 
;;;5006   	{
;;;5007   	if(sk_av_stat[0]!=sasON) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LIGHT,1);
;;;5008        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LIGHT,1);
;;;5009   	}
;;;5010   
;;;5011   //Реле отопителя
;;;5012   if((mess_find_unvol(MESS2RELE_HNDL))&&(mess_data[0]==PARAM_RELE_WARM))
;;;5013   	{
;;;5014   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5015   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5016   	}
;;;5017   else 
;;;5018   	{
;;;5019   	if(warm_stat_k==wsOFF) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_WARM,1);
;;;5020        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_WARM,1);
;;;5021   	} 
;;;5022   //Реле вентилятора
;;;5023   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VENT))
;;;5024   	{
;;;5025   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5026   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5027   	}
;;;5028   else 
;;;5029   	{
;;;5030   	if(vent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VENT,1);
;;;5031        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VENT,1);
;;;5032   	} 
;;;5033   
;;;5034   //Реле внутреннего вентилятора
;;;5035   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_VVENT))
;;;5036   	{
;;;5037   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;5038   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;5039   	}
;;;5040   else 
;;;5041   	{
;;;5042   	if(vvent_stat_k==vsOFF) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_VVENT,1);
;;;5043        else SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_VVENT,1);
;;;5044   	} 
;;;5045   
;;;5046   //Реле выключения нагрузки
;;;5047   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_LOAD_OFF))
;;;5048   	{
;;;5049   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5050   	else if(mess_data[1]==1) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5051        }
;;;5052   else if(tloaddisable_cmnd==0)
;;;5053   	{
;;;5054   	SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5055   	}
;;;5056   else if((tloaddisable_cmnd)&&(tloaddisable_cmnd<=11))
;;;5057   	{
;;;5058   	SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5059   	}
;;;5060   
;;;5061   else 
;;;5062   	{
;;;5063   	if(!(tloaddisable_stat==tldsON)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_LOAD_OFF,1);
;;;5064        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_LOAD_OFF,1);
;;;5065   	} 
;;;5066   
;;;5067   
;;;5068   #endif
;;;5069   
;;;5070   #ifdef IPS_SGEP_GAZPROM
;;;5071   rele_hndl_plazma[0]++;
;;;5072   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_BPS))
;;;5073   	{
;;;5074   	rele_hndl_plazma[1]++;
;;;5075   	if(mess_data[1]==0) SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5076   	else/* if(mess_data[1]==1)*/ SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5077        }
;;;5078   else 
;;;5079   	{
;;;5080   	if(!(avar_ind_stat&0x000007f8)) SET_REG(LPC_GPIO0->FIOCLR,1,SHIFT_REL_AV_BPS,1);
;;;5081        else SET_REG(LPC_GPIO0->FIOSET,1,SHIFT_REL_AV_BPS,1);
;;;5082   	} 
;;;5083   
;;;5084   if((mess_find_unvol(MESS2RELE_HNDL))&&	(mess_data[0]==PARAM_RELE_AV_NET))
;;;5085   	{
;;;5086   	rele_hndl_plazma[2]++;
;;;5087   	if(mess_data[1]==0) SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5088   	else SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5089   	}
;;;5090   else	if(!(avar_ind_stat&0x00000001)) SET_REG(LPC_GPIO3->FIOCLR,1,25,1);
;;;5091   else SET_REG(LPC_GPIO3->FIOSET,1,25,1);
;;;5092   #endif
;;;5093   
;;;5094   if(NUMBDR==1)
00324e  486f              LDR      r0,|L1.13324|
003250  8800              LDRH     r0,[r0,#0]  ; NUMBDR
003252  2801              CMP      r0,#1
003254  d17e              BNE      |L1.13140|
;;;5095   	{
;;;5096   	char ii_;
;;;5097   	char bdr_avar_stat_temp=0;
003256  f04f0000          MOV      r0,#0
;;;5098   	for	(ii_=0;ii_<4;ii_++)
00325a  4601              MOV      r1,r0
;;;5099   		{
;;;5100   		//АБ разряжена
;;;5101   		if((RELE_SET_MASK[ii_]&0x01)&&
;;;5102   			(load_U<(USIGN*10)))			bdr_avar_stat_temp|=(1<<ii_);
;;;5103   		//Ускоренный заряд
;;;5104   		if((RELE_SET_MASK[ii_]&0x02)&&
;;;5105   			(sp_ch_stat==scsWRK))			bdr_avar_stat_temp|=(1<<ii_);
;;;5106   		//Выравнивающий заряд
;;;5107   		if((RELE_SET_MASK[ii_]&0x04)&&
;;;5108   			(spc_stat==spcVZ))			bdr_avar_stat_temp|=(1<<ii_);
;;;5109   		//Общая авария ЗВУ
;;;5110   		if((RELE_SET_MASK[ii_]&0x08)&&
;;;5111   			(avar_stat))					bdr_avar_stat_temp|=(1<<ii_);
;;;5112   		//Uвых завышено
;;;5113   		if((RELE_SET_MASK[ii_]&0x10)&&
;;;5114   			(uout_av==1))					bdr_avar_stat_temp|=(1<<ii_);
00325c  f8dfa1b0          LDR      r10,|L1.13328|
;;;5115   		//Uвых занижено
;;;5116   		if((RELE_SET_MASK[ii_]&0x20)&&
;;;5117   			(uout_av==2))					bdr_avar_stat_temp|=(1<<ii_);
;;;5118   		if((RELE_SET_MASK[ii_]&0x40)&&
;;;5119   			(
;;;5120   			((bps[0]._av&(1<<4))&&(NUMIST>=1))||
003260  f8df91b0          LDR      r9,|L1.13332|
003264  4d6c              LDR      r5,|L1.13336|
003266  f8dfb1b4          LDR      r11,|L1.13340|
00326a  f04f0301          MOV      r3,#1                 ;4052
                  |L1.12910|
00326e  f93b2011          LDRSH    r2,[r11,r1,LSL #1]    ;5101
003272  ea5f7cc2          LSLS     r12,r2,#31            ;5101
003276  d010              BEQ      |L1.12954|
003278  f8dfc1a4          LDR      r12,|L1.13344|
00327c  f9b8e000          LDRSH    lr,[r8,#0]            ;5102  ; load_U
003280  f9bcc000          LDRSH    r12,[r12,#0]          ;5102  ; USIGN
003284  eb0c0c8c          ADD      r12,r12,r12,LSL #2    ;5102
003288  ebbe0f4c          CMP      lr,r12,LSL #1         ;5102
00328c  da05              BGE      |L1.12954|
00328e  fa03fc01          LSL      r12,r3,r1             ;5102
003292  ea4c0c00          ORR      r12,r12,r0            ;5102
003296  f00c00ff          AND      r0,r12,#0xff          ;5102
                  |L1.12954|
00329a  ea5f7c82          LSLS     r12,r2,#30            ;5104
00329e  d50a              BPL      |L1.12982|
0032a0  f897c000          LDRB     r12,[r7,#0]           ;5105  ; sp_ch_stat
0032a4  f1bc0f02          CMP      r12,#2                ;5105
0032a8  d105              BNE      |L1.12982|
0032aa  fa03fc01          LSL      r12,r3,r1             ;5105
0032ae  ea4c0c00          ORR      r12,r12,r0            ;5105
0032b2  f00c00ff          AND      r0,r12,#0xff          ;5105
                  |L1.12982|
0032b6  ea5f7c42          LSLS     r12,r2,#29            ;5107
0032ba  d50a              BPL      |L1.13010|
0032bc  f896c01a          LDRB     r12,[r6,#0x1a]        ;5108  ; spc_stat
0032c0  f1bc0f02          CMP      r12,#2                ;5108
0032c4  d105              BNE      |L1.13010|
0032c6  fa03fc01          LSL      r12,r3,r1             ;5108
0032ca  ea4c0c00          ORR      r12,r12,r0            ;5108
0032ce  f00c00ff          AND      r0,r12,#0xff          ;5108
                  |L1.13010|
0032d2  ea5f7c02          LSLS     r12,r2,#28            ;5110
0032d6  d50c              BPL      |L1.13042|
0032d8  f8dfc148          LDR      r12,|L1.13348|
0032dc  f8dcc000          LDR      r12,[r12,#0]          ;5111  ; avar_stat
0032e0  f1bc0f00          CMP      r12,#0                ;5111
0032e4  d005              BEQ      |L1.13042|
0032e6  fa03fc01          LSL      r12,r3,r1             ;5111
0032ea  ea4c0c00          ORR      r12,r12,r0            ;5111
0032ee  f00c00ff          AND      r0,r12,#0xff          ;5111
                  |L1.13042|
0032f2  ea5f6cc2          LSLS     r12,r2,#27            ;5113
0032f6  d50a              BPL      |L1.13070|
0032f8  f89ac000          LDRB     r12,[r10,#0]          ;5114  ; uout_av
0032fc  f1bc0f01          CMP      r12,#1                ;5114
003300  d105              BNE      |L1.13070|
003302  fa03fc01          LSL      r12,r3,r1             ;5114
003306  ea4c0c00          ORR      r12,r12,r0            ;5114
00330a  f00c00ff          AND      r0,r12,#0xff          ;5114
                  |L1.13070|
00330e  ea5f6c82          LSLS     r12,r2,#26            ;5116
003312  d50a              BPL      |L1.13098|
003314  f89ac000          LDRB     r12,[r10,#0]          ;5117  ; uout_av
003318  f1bc0f02          CMP      r12,#2                ;5117
00331c  d105              BNE      |L1.13098|
00331e  fa03fc01          LSL      r12,r3,r1             ;5117
003322  ea4c0c00          ORR      r12,r12,r0            ;5117
003326  f00c00ff          AND      r0,r12,#0xff          ;5117
                  |L1.13098|
00332a  ea5f6c42          LSLS     r12,r2,#25            ;5118
00332e  d525              BPL      |L1.13180|
003330  f899c001          LDRB     r12,[r9,#1]  ; bps
003334  ea5f6ccc          LSLS     r12,r12,#27
003338  d504              BPL      |L1.13124|
00333a  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
00333e  f1bc0f01          CMP      r12,#1
003342  da15              BGE      |L1.13168|
                  |L1.13124|
;;;5121   			((bps[1]._av&(1<<4))&&(NUMIST>=2))||
003344  f899c05d          LDRB     r12,[r9,#0x5d]  ; bps
003348  ea5f6ccc          LSLS     r12,r12,#27
00334c  d506              BPL      |L1.13148|
00334e  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
003352  e000              B        |L1.13142|
                  |L1.13140|
003354  e047              B        |L1.13286|
                  |L1.13142|
003356  f1bc0f02          CMP      r12,#2
00335a  da09              BGE      |L1.13168|
                  |L1.13148|
;;;5122   			((bps[2]._av&(1<<4))&&(NUMIST>=3))
00335c  f899c0b9          LDRB     r12,[r9,#0xb9]  ; bps
003360  ea5f6ccc          LSLS     r12,r12,#27
003364  d50a              BPL      |L1.13180|
003366  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
00336a  f1bc0f03          CMP      r12,#3
00336e  db05              BLT      |L1.13180|
                  |L1.13168|
;;;5123   			))bdr_avar_stat_temp|=(1<<ii_);
003370  fa03fc01          LSL      r12,r3,r1
003374  ea4c0c00          ORR      r12,r12,r0
003378  f00c00ff          AND      r0,r12,#0xff
                  |L1.13180|
;;;5124   		if((RELE_SET_MASK[ii_]&0x80)&&
00337c  ea5f6c02          LSLS     r12,r2,#24
003380  d523              BPL      |L1.13258|
;;;5125   			(
;;;5126   			((bps[0]._av&(0x0f))&&(NUMIST>=1))||
003382  f899c001          LDRB     r12,[r9,#1]  ; bps
003386  ea5f7c0c          LSLS     r12,r12,#28
00338a  d004              BEQ      |L1.13206|
00338c  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
003390  f1bc0f01          CMP      r12,#1
003394  da13              BGE      |L1.13246|
                  |L1.13206|
;;;5127   			((bps[1]._av&(0x0f))&&(NUMIST>=2))||
003396  f899c05d          LDRB     r12,[r9,#0x5d]  ; bps
00339a  ea5f7c0c          LSLS     r12,r12,#28
00339e  d004              BEQ      |L1.13226|
0033a0  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
0033a4  f1bc0f02          CMP      r12,#2
0033a8  da09              BGE      |L1.13246|
                  |L1.13226|
;;;5128   			((bps[2]._av&(0x0f))&&(NUMIST>=3))
0033aa  f899c0b9          LDRB     r12,[r9,#0xb9]  ; bps
0033ae  ea5f7c0c          LSLS     r12,r12,#28
0033b2  d00a              BEQ      |L1.13258|
0033b4  f9b5c000          LDRSH    r12,[r5,#0]  ; NUMIST
0033b8  f1bc0f03          CMP      r12,#3
0033bc  db05              BLT      |L1.13258|
                  |L1.13246|
;;;5129   			))bdr_avar_stat_temp|=(1<<ii_);
0033be  fa03fc01          LSL      r12,r3,r1
0033c2  ea4c0c00          ORR      r12,r12,r0
0033c6  f00c00ff          AND      r0,r12,#0xff
                  |L1.13258|
;;;5130   
;;;5131   		if(!(RELE_SET_MASK[ii_]&(1<<15))) bdr_avar_stat_temp^=(1<<ii_); 
0033ca  0412              LSLS     r2,r2,#16
0033cc  d404              BMI      |L1.13272|
0033ce  fa03f201          LSL      r2,r3,r1
0033d2  ea820200          EOR      r2,r2,r0
0033d6  b2d0              UXTB     r0,r2
                  |L1.13272|
0033d8  f1010101          ADD      r1,r1,#1              ;5098
0033dc  b2c9              UXTB     r1,r1                 ;5098
0033de  2904              CMP      r1,#4                 ;5098
0033e0  f4ffaf45          BCC      |L1.12910|
;;;5132   		}
;;;5133   	bdr_avar_stat=bdr_avar_stat_temp;
0033e4  7020              STRB     r0,[r4,#0]
                  |L1.13286|
;;;5134   	}
;;;5135   }
0033e6  e01f              B        |L1.13352|
                  |L1.13288|
                          DCD      load_U
                  |L1.13292|
                          DCD      sp_ch_stat
                  |L1.13296|
                          DCD      ||area_number.25||
                  |L1.13300|
                          DCD      DOP_RELE_FUNC
                  |L1.13304|
                          DCD      speedChIsOn
                  |L1.13308|
                          DCD      hv_vz_stat
                  |L1.13312|
                          DCD      UVENTOFF
                  |L1.13316|
                          DCD      bdr_transmit_stat
                  |L1.13320|
                          DCD      bdr_avar_stat
                  |L1.13324|
                          DCD      NUMBDR
                  |L1.13328|
                          DCD      uout_av
                  |L1.13332|
                          DCD      bps
                  |L1.13336|
                          DCD      NUMIST
                  |L1.13340|
                          DCD      RELE_SET_MASK
                  |L1.13344|
                          DCD      USIGN
                  |L1.13348|
                          DCD      avar_stat
                  |L1.13352|
003428  e8bd9ff0          POP      {r4-r12,pc}
;;;5136   
                          ENDP

                  bps_hndl PROC
;;;5138   //-----------------------------------------------
;;;5139   void bps_hndl(void)
00342c  e92d5ff0          PUSH     {r4-r12,lr}
;;;5140   {
;;;5141   char ptr__,i;
;;;5142   unsigned short tempUS;
;;;5143   
;;;5144   if(sh_cnt0<10)
003430  4efd              LDR      r6,|L1.14376|
;;;5145   	{
;;;5146   	sh_cnt0++;
;;;5147   	if(sh_cnt0>=10)
;;;5148   		{
;;;5149   		sh_cnt0=0;
003432  2700              MOVS     r7,#0
;;;5150   		b1Hz_sh=1;
003434  f04f0a01          MOV      r10,#1
003438  7e30              LDRB     r0,[r6,#0x18]         ;5144  ; sh_cnt0
00343a  280a              CMP      r0,#0xa               ;5144
00343c  d208              BCS      |L1.13392|
00343e  f1000001          ADD      r0,r0,#1              ;5146
003442  b2c0              UXTB     r0,r0                 ;5146
003444  7630              STRB     r0,[r6,#0x18]         ;5146
003446  280a              CMP      r0,#0xa               ;5147
003448  d302              BCC      |L1.13392|
00344a  7637              STRB     r7,[r6,#0x18]         ;5149
00344c  f886a019          STRB     r10,[r6,#0x19]
                  |L1.13392|
;;;5151   		}
;;;5152   	}
;;;5153   
;;;5154   /*if(sh_cnt1<5)
;;;5155   	{
;;;5156   	sh_cnt1++;
;;;5157   	if(sh_cnt1==5)
;;;5158   		{
;;;5159   		sh_cnt1=0;
;;;5160   		b2Hz_sh=1;
;;;5161   		}
;;;5162   	} */
;;;5163   
;;;5164   
;;;5165   /*
;;;5166   if(mess_find(MESS_SRC_ON_OFF))
;;;5167   	{
;;;5168   	if(mess_data[0]==_MESS_SRC_MASK_BLOK_2SEC)
;;;5169   		{
;;;5170   		char i;
;;;5171   		for(i=0;i<NUMIST;i++)
;;;5172   			{
;;;5173   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=20;
;;;5174   			}
;;;5175   		
;;;5176   		}
;;;5177   	else if(mess_data[0]==_MESS_SRC_MASK_UNBLOK)
;;;5178   		{
;;;5179   		char i;
;;;5180   		for(i=0;i<NUMIST;i++)
;;;5181   			{
;;;5182   			if(mess_data[1]&(1<<i))src[i]._ist_blok_cnt=0;
;;;5183   			}
;;;5184   		
;;;5185   		}
;;;5186   	}
;;;5187   	
;;;5188   else if(mess_find(_MESS_SRC_MASK_ON))
;;;5189   	{				
;;;5190   	if(mess_data[0]==_MESS_SRC_MASK_ON)
;;;5191   		{
;;;5192   		char i;
;;;5193   		for(i=0;i<NUMIST;i++)
;;;5194   			{
;;;5195   			if(mess_data[1]&(1<<i))
;;;5196   				{
;;;5197   				src[i]._ist_blok_cnt=0;
;;;5198   				src[i]._flags_tu=2;
;;;5199   				}
;;;5200   			}
;;;5201   		
;;;5202   		}				
;;;5203   	}*/
;;;5204   
;;;5205   
;;;5206   
;;;5207   /*else*/ 
;;;5208   bps_on_mask=0;
003450  f8a67058          STRH     r7,[r6,#0x58]
;;;5209   bps_off_mask=0;
003454  f8a6705a          STRH     r7,[r6,#0x5a]
;;;5210   
;;;5211   if(mess_find_unvol(MESS2BPS_HNDL))
003458  20cd              MOVS     r0,#0xcd
00345a  f7fffffe          BL       mess_find_unvol
;;;5212   	{
;;;5213   	if(mess_data[0]==PARAM_BPS_ALL_OFF_AFTER_2SEC)
;;;5214   		{
;;;5215   		bps_off_mask=0xffff;
;;;5216   		}
;;;5217   
;;;5218   	if(mess_data[0]==PARAM_BPS_MASK_OFF_AFTER_2SEC)
;;;5219   		{
;;;5220   		bps_off_mask=mess_data[1];
;;;5221   		}
;;;5222   
;;;5223   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;5224   		{
;;;5225   		bps_on_mask=mess_data[1];
;;;5226   		}
;;;5227   
;;;5228   	if(mess_data[0]==PARAM_BPS_ALL_ON)
;;;5229   		{
;;;5230   		bps_on_mask=0xffff;
;;;5231   		}
;;;5232   
;;;5233   	if(mess_data[0]==PARAM_BPS_MASK_ON_OFF_AFTER_2SEC)
;;;5234   		{
;;;5235   		bps_on_mask=mess_data[1];
;;;5236   		bps_off_mask=~(mess_data[1]);
;;;5237   		}
;;;5238   
;;;5239   
;;;5240   	for(i=0;i<=NUMIST;i++)
;;;5241   		{
;;;5242   		if(bps_off_mask&(1<<i)) bps[i]._blok_cnt++;
00345e  f8df83cc          LDR      r8,|L1.14380|
003462  f8dfb3cc          LDR      r11,|L1.14384|
003466  b3a0              CBZ      r0,|L1.13522|
003468  4af2              LDR      r2,|L1.14388|
00346a  f64f73ff          MOV      r3,#0xffff            ;5215
00346e  6810              LDR      r0,[r2,#0]            ;5213  ; mess_data
003470  28ce              CMP      r0,#0xce              ;5213
003472  d101              BNE      |L1.13432|
003474  f8a6305a          STRH     r3,[r6,#0x5a]         ;5215
                  |L1.13432|
003478  28cf              CMP      r0,#0xcf              ;5218
00347a  d102              BNE      |L1.13442|
00347c  6851              LDR      r1,[r2,#4]            ;5220  ; mess_data
00347e  f8a6105a          STRH     r1,[r6,#0x5a]         ;5220
                  |L1.13442|
003482  28d1              CMP      r0,#0xd1              ;5223
003484  d102              BNE      |L1.13452|
003486  6851              LDR      r1,[r2,#4]            ;5225  ; mess_data
003488  f8a61058          STRH     r1,[r6,#0x58]         ;5225
                  |L1.13452|
00348c  28d2              CMP      r0,#0xd2              ;5228
00348e  d101              BNE      |L1.13460|
003490  f8a63058          STRH     r3,[r6,#0x58]         ;5230
                  |L1.13460|
003494  28d0              CMP      r0,#0xd0              ;5233
003496  d106              BNE      |L1.13478|
003498  6850              LDR      r0,[r2,#4]            ;5235  ; mess_data
00349a  f8a60058          STRH     r0,[r6,#0x58]         ;5235
00349e  ea6f0000          MVN      r0,r0                 ;5236
0034a2  f8a6005a          STRH     r0,[r6,#0x5a]         ;5236
                  |L1.13478|
0034a6  f04f0400          MOV      r4,#0                 ;5240
0034aa  e037              B        |L1.13596|
                  |L1.13484|
0034ac  f8b6005a          LDRH     r0,[r6,#0x5a]  ; bps_off_mask
0034b0  fa0af904          LSL      r9,r10,r4
0034b4  ea190f00          TST      r9,r0
0034b8  d00c              BEQ      |L1.13524|
0034ba  ebc400c4          RSB      r0,r4,r4,LSL #3
0034be  eb001004          ADD      r0,r0,r4,LSL #4
0034c2  eb080080          ADD      r0,r8,r0,LSL #2
0034c6  f8301f40          LDRH     r1,[r0,#0x40]!
0034ca  f1010101          ADD      r1,r1,#1
0034ce  8001              STRH     r1,[r0,#0]
0034d0  e008              B        |L1.13540|
                  |L1.13522|
0034d2  e028              B        |L1.13606|
                  |L1.13524|
;;;5243   		else bps[i]._blok_cnt=0;
0034d4  ebc400c4          RSB      r0,r4,r4,LSL #3
0034d8  eb001004          ADD      r0,r0,r4,LSL #4
0034dc  eb080080          ADD      r0,r8,r0,LSL #2
0034e0  f8a07040          STRH     r7,[r0,#0x40]
                  |L1.13540|
;;;5244   		gran(&bps[i]._blok_cnt,0,50);
0034e4  ebc400c4          RSB      r0,r4,r4,LSL #3
0034e8  eb001004          ADD      r0,r0,r4,LSL #4
0034ec  eb080580          ADD      r5,r8,r0,LSL #2
0034f0  f1050040          ADD      r0,r5,#0x40
0034f4  2232              MOVS     r2,#0x32
0034f6  2100              MOVS     r1,#0
0034f8  f7fffffe          BL       gran
;;;5245   		if(bps[i]._blok_cnt>20) bps[i]._flags_tu=1;
0034fc  f9b50040          LDRSH    r0,[r5,#0x40]
003500  2814              CMP      r0,#0x14
003502  dd01              BLE      |L1.13576|
003504  f885a02c          STRB     r10,[r5,#0x2c]
                  |L1.13576|
;;;5246   		if(bps_on_mask&(1<<i)) bps[i]._flags_tu=0;
003508  f8b60058          LDRH     r0,[r6,#0x58]  ; bps_on_mask
00350c  ea190f00          TST      r9,r0
003510  d001              BEQ      |L1.13590|
003512  f885702c          STRB     r7,[r5,#0x2c]
                  |L1.13590|
003516  f1040401          ADD      r4,r4,#1              ;5240
00351a  b2e4              UXTB     r4,r4                 ;5240
                  |L1.13596|
00351c  f9bb0000          LDRSH    r0,[r11,#0]           ;5240  ; NUMIST
003520  4284              CMP      r4,r0                 ;5240
003522  ddc3              BLE      |L1.13484|
003524  e08b              B        |L1.13886|
                  |L1.13606|
;;;5247   	     }
;;;5248   
;;;5249   	
;;;5250   /*
;;;5251   
;;;5252   	if(bps_all_off_cnt>20)
;;;5253   		{
;;;5254   		for(i=0;i<=NUMIST;i++)
;;;5255   			{
;;;5256   	     	bps[i]._flags_tu=1;
;;;5257   	     	}
;;;5258   		}
;;;5259   	else if(bps_mask_off_cnt>20)
;;;5260   		{
;;;5261   		for(i=0;i<=NUMIST;i++)
;;;5262   			{
;;;5263   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;5264   	     	}
;;;5265   		}	
;;;5266   		
;;;5267   	else if(bps_mask_on_off_cnt>20)
;;;5268   		{
;;;5269   		for(i=0;i<=NUMIST;i++)
;;;5270   			{
;;;5271   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=1;
;;;5272   			else bps[i]._flags_tu=0;
;;;5273   	     	}
;;;5274   		}
;;;5275   		
;;;5276   	if(mess_data[0]==PARAM_BPS_MASK_ON)
;;;5277   		{
;;;5278   		for(i=0;i<=NUMIST;i++)
;;;5279   			{
;;;5280   			if(mess_data[1]&(1<<i)) bps[i]._flags_tu=0;
;;;5281   	     	}
;;;5282   		}
;;;5283   */										
;;;5284   	}
;;;5285   
;;;5286   
;;;5287   else if(b1Hz_sh)
003526  7e70              LDRB     r0,[r6,#0x19]  ; b1Hz_sh
003528  b3f0              CBZ      r0,|L1.13736|
;;;5288   	{
;;;5289   	ptr__=0;
00352a  f04f0400          MOV      r4,#0
;;;5290        for(i=0;i<=NUMIST;i++)
00352e  4621              MOV      r1,r4
003530  f9bb0000          LDRSH    r0,[r11,#0]           ;5240
003534  e00a              B        |L1.13644|
                  |L1.13622|
;;;5291   		{
;;;5292   	     bps[i]._flags_tu=1;
003536  ebc102c1          RSB      r2,r1,r1,LSL #3
00353a  eb021201          ADD      r2,r2,r1,LSL #4
00353e  eb080282          ADD      r2,r8,r2,LSL #2
003542  f882a02c          STRB     r10,[r2,#0x2c]
003546  f1010101          ADD      r1,r1,#1              ;5290
00354a  b2c9              UXTB     r1,r1                 ;5290
                  |L1.13644|
00354c  4281              CMP      r1,r0                 ;5290
00354e  ddf2              BLE      |L1.13622|
;;;5293   	     }	
;;;5294     	     
;;;5295     	for(i=0;(i<NUMIST)&&(ptr__<num_necc);i++)
003550  f04f0100          MOV      r1,#0
003554  e022              B        |L1.13724|
                  |L1.13654|
;;;5296     		{
;;;5297   		char ii,iii;
;;;5298   
;;;5299   		ii=(char)NUMIST;
003556  b2c2              UXTB     r2,r0
;;;5300   		//if(ii<0)ii=0;
;;;5301   		if(ii>32)ii=32;
003558  2a20              CMP      r2,#0x20
00355a  d901              BLS      |L1.13664|
00355c  f04f0220          MOV      r2,#0x20
                  |L1.13664|
;;;5302   		iii=numOfForvardBps;
003560  7ff3              LDRB     r3,[r6,#0x1f]  ; numOfForvardBps
;;;5303   		//if(iii<0)iii=0;
;;;5304   		if(iii>=NUMIST)iii=0;
003562  4283              CMP      r3,r0
003564  db01              BLT      |L1.13674|
003566  f04f0300          MOV      r3,#0
                  |L1.13674|
;;;5305   		iii+=i;
00356a  440b              ADD      r3,r3,r1
00356c  b2db              UXTB     r3,r3
;;;5306   		iii=iii%ii;
00356e  fbb3f5f2          UDIV     r5,r3,r2
003572  fb023215          MLS      r2,r2,r5,r3
;;;5307   		
;;;5308     	     if((bps[iii]._state==bsRDY)||(bps[iii]._state==bsWRK))
003576  ebc203c2          RSB      r3,r2,r2,LSL #3
00357a  eb031202          ADD      r2,r3,r2,LSL #4
00357e  eb080282          ADD      r2,r8,r2,LSL #2
003582  7893              LDRB     r3,[r2,#2]
003584  2b02              CMP      r3,#2
003586  d001              BEQ      |L1.13708|
003588  2b01              CMP      r3,#1
00358a  d104              BNE      |L1.13718|
                  |L1.13708|
;;;5309     	         	{
;;;5310     	         	bps[iii]._flags_tu=0;
00358c  f882702c          STRB     r7,[r2,#0x2c]
;;;5311     	         	ptr__++;
003590  f1040401          ADD      r4,r4,#1
003594  b2e4              UXTB     r4,r4
                  |L1.13718|
003596  f1010101          ADD      r1,r1,#1              ;5295
00359a  b2c9              UXTB     r1,r1                 ;5295
                  |L1.13724|
00359c  4281              CMP      r1,r0                 ;5295
00359e  da06              BGE      |L1.13742|
0035a0  4aa5              LDR      r2,|L1.14392|
0035a2  f9b22000          LDRSH    r2,[r2,#0]            ;5295  ; num_necc
0035a6  e000              B        |L1.13738|
                  |L1.13736|
0035a8  e049              B        |L1.13886|
                  |L1.13738|
0035aa  4294              CMP      r4,r2                 ;5295
0035ac  dbd3              BLT      |L1.13654|
                  |L1.13742|
;;;5312     	         	}
;;;5313   			
;;;5314     	     }
;;;5315   	bps[numOfForvardBps_old]._flags_tu=0;
0035ae  f8961020          LDRB     r1,[r6,#0x20]  ; numOfForvardBps_old
0035b2  ebc102c1          RSB      r2,r1,r1,LSL #3
0035b6  eb021101          ADD      r1,r2,r1,LSL #4
0035ba  eb080181          ADD      r1,r8,r1,LSL #2
0035be  f881702c          STRB     r7,[r1,#0x2c]
;;;5316   
;;;5317   	if(main_1Hz_cnt<60)
0035c2  499e              LDR      r1,|L1.14396|
0035c4  f9b11000          LDRSH    r1,[r1,#0]  ; main_1Hz_cnt
0035c8  293c              CMP      r1,#0x3c
0035ca  da0f              BGE      |L1.13804|
;;;5318   		{
;;;5319        	for(i=0;i<=NUMIST;i++)
0035cc  f04f0100          MOV      r1,#0
0035d0  e00a              B        |L1.13800|
                  |L1.13778|
;;;5320   			{
;;;5321   	     	bps[i]._flags_tu=0;
0035d2  ebc102c1          RSB      r2,r1,r1,LSL #3
0035d6  eb021201          ADD      r2,r2,r1,LSL #4
0035da  eb080282          ADD      r2,r8,r2,LSL #2
0035de  f882702c          STRB     r7,[r2,#0x2c]
0035e2  f1010101          ADD      r1,r1,#1              ;5319
0035e6  b2c9              UXTB     r1,r1                 ;5319
                  |L1.13800|
0035e8  4281              CMP      r1,r0                 ;5319
0035ea  ddf2              BLE      |L1.13778|
                  |L1.13804|
;;;5322   	     	}	
;;;5323   		}
;;;5324   	if(ipsBlckStat)
0035ec  4994              LDR      r1,|L1.14400|
0035ee  8809              LDRH     r1,[r1,#0]  ; ipsBlckStat
0035f0  b179              CBZ      r1,|L1.13842|
;;;5325   		{
;;;5326        	for(i=0;i<=NUMIST;i++)
0035f2  f04f0100          MOV      r1,#0
0035f6  e00a              B        |L1.13838|
                  |L1.13816|
;;;5327   			{
;;;5328   	     	bps[i]._flags_tu=1;
0035f8  ebc102c1          RSB      r2,r1,r1,LSL #3
0035fc  eb021201          ADD      r2,r2,r1,LSL #4
003600  eb080282          ADD      r2,r8,r2,LSL #2
003604  f882a02c          STRB     r10,[r2,#0x2c]
003608  f1010101          ADD      r1,r1,#1              ;5326
00360c  b2c9              UXTB     r1,r1                 ;5326
                  |L1.13838|
00360e  4281              CMP      r1,r0                 ;5326
003610  ddf2              BLE      |L1.13816|
                  |L1.13842|
;;;5329   	     	}
;;;5330   		}
;;;5331   
;;;5332        for(i=0;i<=NUMIST;i++)
003612  f04f0100          MOV      r1,#0
;;;5333   		{
;;;5334   	    if(bps[i]._flags_tu==1) 	bps[i]._x_=-50;
003616  f06f0331          MVN      r3,#0x31
00361a  e00e              B        |L1.13882|
                  |L1.13852|
00361c  ebc102c1          RSB      r2,r1,r1,LSL #3
003620  eb021201          ADD      r2,r2,r1,LSL #4
003624  eb080282          ADD      r2,r8,r2,LSL #2
003628  f892402c          LDRB     r4,[r2,#0x2c]
00362c  2c01              CMP      r4,#1
00362e  d101              BNE      |L1.13876|
003630  f8a23050          STRH     r3,[r2,#0x50]
                  |L1.13876|
003634  f1010101          ADD      r1,r1,#1              ;5332
003638  b2c9              UXTB     r1,r1                 ;5332
                  |L1.13882|
00363a  4281              CMP      r1,r0                 ;5332
00363c  ddee              BLE      |L1.13852|
                  |L1.13886|
;;;5335   	   	}	
;;;5336   		 
;;;5337     	}
;;;5338   
;;;5339   
;;;5340   for(i=0;i<NUMIST;i++)
00363e  f04f0000          MOV      r0,#0
;;;5341        {
;;;5342        if(bps[i]._ist_blok_host_cnt!=0)
;;;5343             {
;;;5344             bps[i]._flags_tu=99;
003642  f04f0463          MOV      r4,#0x63
003646  f9bb1000          LDRSH    r1,[r11,#0]           ;5240
00364a  e00f              B        |L1.13932|
                  |L1.13900|
00364c  ebc002c0          RSB      r2,r0,r0,LSL #3       ;5342
003650  eb021200          ADD      r2,r2,r0,LSL #4       ;5342
003654  eb080282          ADD      r2,r8,r2,LSL #2       ;5342
003658  6bd3              LDR      r3,[r2,#0x3c]         ;5342
00365a  b123              CBZ      r3,|L1.13926|
00365c  f882402c          STRB     r4,[r2,#0x2c]
;;;5345   	     bps[i]._ist_blok_host_cnt--;
003660  f1a30301          SUB      r3,r3,#1
003664  63d3              STR      r3,[r2,#0x3c]
                  |L1.13926|
003666  f1000001          ADD      r0,r0,#1              ;5340
00366a  b2c0              UXTB     r0,r0                 ;5340
                  |L1.13932|
00366c  4288              CMP      r0,r1                 ;5340
00366e  dbed              BLT      |L1.13900|
;;;5346             }
;;;5347        }
;;;5348   
;;;5349   
;;;5350   
;;;5351   
;;;5352   b1Hz_sh=0;
003670  7677              STRB     r7,[r6,#0x19]
;;;5353   
;;;5354   
;;;5355   num_of_wrks_bps=0;
003672  7577              STRB     r7,[r6,#0x15]
;;;5356   tempUS=0;
003674  f04f0200          MOV      r2,#0
;;;5357   for(i=0;i<NUMIST;i++)
003678  4610              MOV      r0,r2
00367a  e013              B        |L1.13988|
                  |L1.13948|
;;;5358   	{
;;;5359   	if(bps[i]._state==bsWRK)
00367c  ebc003c0          RSB      r3,r0,r0,LSL #3
003680  eb031300          ADD      r3,r3,r0,LSL #4
003684  eb080383          ADD      r3,r8,r3,LSL #2
003688  789c              LDRB     r4,[r3,#2]
00368a  2c01              CMP      r4,#1
00368c  d107              BNE      |L1.13982|
;;;5360   		{
;;;5361   		num_of_wrks_bps++;
00368e  7d74              LDRB     r4,[r6,#0x15]  ; num_of_wrks_bps
003690  f1040401          ADD      r4,r4,#1
003694  7574              STRB     r4,[r6,#0x15]
;;;5362   		if(bps[i]._Uii>tempUS)tempUS=bps[i]._Uii;
003696  69db              LDR      r3,[r3,#0x1c]
003698  4293              CMP      r3,r2
00369a  dd00              BLE      |L1.13982|
00369c  b29a              UXTH     r2,r3
                  |L1.13982|
00369e  f1000001          ADD      r0,r0,#1              ;5357
0036a2  b2c0              UXTB     r0,r0                 ;5357
                  |L1.13988|
0036a4  4288              CMP      r0,r1                 ;5357
0036a6  dbe9              BLT      |L1.13948|
;;;5363   		}
;;;5364   	}
;;;5365   Ubpsmax=tempUS;
0036a8  f8a62048          STRH     r2,[r6,#0x48]
;;;5366   
;;;5367   bPARALLEL_ENOUG=0;
0036ac  f8867023          STRB     r7,[r6,#0x23]
;;;5368   bPARALLEL_NOT_ENOUG=1;
0036b0  f886a022          STRB     r10,[r6,#0x22]
;;;5369   
;;;5370   for(i=0;i<NUMIST;i++)
0036b4  f04f0000          MOV      r0,#0
;;;5371   	{
;;;5372   	if(bps[i]._Ti>=TSIGN)
0036b8  4a62              LDR      r2,|L1.14404|
0036ba  f9b23000          LDRSH    r3,[r2,#0]
;;;5373   		{
;;;5374   		bPARALLEL_ENOUG=1;
;;;5375   		}
;;;5376   	if(bps[i]._Ti>=(TSIGN-5))
0036be  f1a30405          SUB      r4,r3,#5
0036c2  e011              B        |L1.14056|
                  |L1.14020|
0036c4  ebc002c0          RSB      r2,r0,r0,LSL #3       ;5372
0036c8  eb021200          ADD      r2,r2,r0,LSL #4       ;5372
0036cc  eb080282          ADD      r2,r8,r2,LSL #2       ;5372
0036d0  6a92              LDR      r2,[r2,#0x28]         ;5372
0036d2  429a              CMP      r2,r3                 ;5372
0036d4  db01              BLT      |L1.14042|
0036d6  f886a023          STRB     r10,[r6,#0x23]        ;5374
                  |L1.14042|
0036da  42a2              CMP      r2,r4
0036dc  db01              BLT      |L1.14050|
;;;5377   		{
;;;5378   		bPARALLEL_NOT_ENOUG=0;
0036de  f8867022          STRB     r7,[r6,#0x22]
                  |L1.14050|
0036e2  f1000001          ADD      r0,r0,#1              ;5370
0036e6  b2c0              UXTB     r0,r0                 ;5370
                  |L1.14056|
0036e8  4288              CMP      r0,r1                 ;5370
0036ea  dbeb              BLT      |L1.14020|
;;;5379   		}
;;;5380   	}
;;;5381   
;;;5382   if(bPARALLEL_ENOUG==1)
0036ec  f8960023          LDRB     r0,[r6,#0x23]  ; bPARALLEL_ENOUG
0036f0  2801              CMP      r0,#1
0036f2  d00a              BEQ      |L1.14090|
;;;5383   	{
;;;5384   	bPARALLEL=1;
;;;5385   	}
;;;5386   else if(bPARALLEL && bPARALLEL_NOT_ENOUG)
0036f4  f8960024          LDRB     r0,[r6,#0x24]  ; bPARALLEL
0036f8  2800              CMP      r0,#0
0036fa  d005              BEQ      |L1.14088|
0036fc  f8960022          LDRB     r0,[r6,#0x22]  ; bPARALLEL_NOT_ENOUG
003700  2800              CMP      r0,#0
003702  d001              BEQ      |L1.14088|
;;;5387   	{
;;;5388   	bPARALLEL=0;
003704  f8867024          STRB     r7,[r6,#0x24]
                  |L1.14088|
;;;5389   	}
;;;5390   }
003708  e66d              B        |L1.13286|
                  |L1.14090|
00370a  f886a024          STRB     r10,[r6,#0x24]        ;5384
00370e  e66a              B        |L1.13286|
;;;5391   
                          ENDP

                  powerAntiAliasingHndl PROC
;;;5398   //-----------------------------------------------
;;;5399   void powerAntiAliasingHndl(void)
003710  b570              PUSH     {r4-r6,lr}
;;;5400   {
;;;5401   if((power_summary_tempo/10UL)==(power_summary_tempo_old/10UL))
003712  230a              MOVS     r3,#0xa
003714  4c4d              LDR      r4,|L1.14412|
003716  484c              LDR      r0,|L1.14408|
;;;5402   	{
;;;5403   	if(powerSummaryCnt<15)powerSummaryCnt++;
;;;5404   	if(powerSummaryCnt>=10)
;;;5405   		{
;;;5406   		power_summary=power_summary_tempo;
;;;5407   		}
;;;5408   	}
;;;5409   else powerSummaryCnt=0;
003718  2500              MOVS     r5,#0
00371a  6822              LDR      r2,[r4,#0]            ;5401  ; power_summary_tempo_old
00371c  6800              LDR      r0,[r0,#0]            ;5401  ; power_summary_tempo
00371e  fbb2f6f3          UDIV     r6,r2,r3              ;5401
003722  fbb0f1f3          UDIV     r1,r0,r3              ;5401
003726  4a4a              LDR      r2,|L1.14416|
003728  42b1              CMP      r1,r6                 ;5401
00372a  d10b              BNE      |L1.14148|
00372c  7811              LDRB     r1,[r2,#0]            ;5403  ; powerSummaryCnt
00372e  290f              CMP      r1,#0xf               ;5403
003730  d202              BCS      |L1.14136|
003732  f1010101          ADD      r1,r1,#1              ;5403
003736  7011              STRB     r1,[r2,#0]            ;5403
                  |L1.14136|
003738  7811              LDRB     r1,[r2,#0]            ;5404  ; powerSummaryCnt
00373a  290a              CMP      r1,#0xa               ;5404
00373c  d303              BCC      |L1.14150|
00373e  4945              LDR      r1,|L1.14420|
003740  6008              STR      r0,[r1,#0]            ;5406  ; power_summary
003742  e000              B        |L1.14150|
                  |L1.14148|
003744  7015              STRB     r5,[r2,#0]
                  |L1.14150|
;;;5410   power_summary_tempo_old=power_summary_tempo;
003746  6020              STR      r0,[r4,#0]  ; power_summary_tempo_old
;;;5411   
;;;5412   if((power_current_tempo/10UL)==(power_current_tempo_old/10UL))
003748  4843              LDR      r0,|L1.14424|
00374a  4c44              LDR      r4,|L1.14428|
00374c  f9b00000          LDRSH    r0,[r0,#0]  ; power_current_tempo
003750  f9b42000          LDRSH    r2,[r4,#0]  ; power_current_tempo_old
003754  fbb0f1f3          UDIV     r1,r0,r3
003758  fbb2f3f3          UDIV     r3,r2,r3
;;;5413   	{
;;;5414   	if(powerCurrentCnt<15)powerCurrentCnt++;
00375c  4a40              LDR      r2,|L1.14432|
00375e  4299              CMP      r1,r3                 ;5412
003760  d10b              BNE      |L1.14202|
003762  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
003764  290f              CMP      r1,#0xf
003766  d202              BCS      |L1.14190|
003768  f1010101          ADD      r1,r1,#1
00376c  7011              STRB     r1,[r2,#0]
                  |L1.14190|
;;;5415   	if(powerCurrentCnt>=10)
00376e  7811              LDRB     r1,[r2,#0]  ; powerCurrentCnt
003770  290a              CMP      r1,#0xa
003772  d303              BCC      |L1.14204|
;;;5416   		{
;;;5417   		power_current=power_current_tempo;
003774  493b              LDR      r1,|L1.14436|
003776  8008              STRH     r0,[r1,#0]
003778  e000              B        |L1.14204|
                  |L1.14202|
;;;5418   		}
;;;5419   	}
;;;5420   else powerCurrentCnt=0;
00377a  7015              STRB     r5,[r2,#0]
                  |L1.14204|
;;;5421   power_current_tempo_old=power_current_tempo;
00377c  8020              STRH     r0,[r4,#0]
;;;5422   }
00377e  bd70              POP      {r4-r6,pc}
;;;5423   
                          ENDP

                  energometr_hndl PROC
;;;5533   //-----------------------------------------------
;;;5534   void energometr_hndl(void)
003780  4770              BX       lr
;;;5535   {
;;;5536   //2F 3F 21 0D 0A 
;;;5537   //05 33 0A 2F 45 4B 54 35 43 45 31 30 32 4D 76 30 31 0D 0A 
;;;5538   //2F 3F 21 0D 0A 
;;;5539   //05 33 0A 2F 45 4B 54 35 43 45 31 30 32 4D 76 30 31 0D 0A 
;;;5540   //06 30 35 31 0D 0A 
;;;5541   //06 33 0A 01 50 30 02 28 31 31 38 36 35 32 39 32 32 29 03 2A 
;;;5542   
;;;5543   #ifdef CE102M_ENABLED
;;;5544   /*if
;;;5545   uart_out1 (5,0xaf,0x3f,0x21,0x8d,0x0a,0);*/
;;;5546   
;;;5547   if(read_power_cnt_main_cnt)
;;;5548   	{
;;;5549   	read_power_cnt_main_cnt--;
;;;5550   	if(read_power_cnt_main_cnt==0)
;;;5551   		{
;;;5552   		rx_read_power_cnt_phase=0;
;;;5553   		if(bENERGOMETR_UIP==0)bENERGOMETR_UIP=1;
;;;5554   		else if(bENERGOMETR_UIP==1)bENERGOMETR_UIP=2;
;;;5555   		else bENERGOMETR_UIP=0;
;;;5556   		//bENERGOMETR_UIP=2;
;;;5557   		}
;;;5558   	}
;;;5559   
;;;5560   if (rx_read_power_cnt_phase==0)
;;;5561   	{
;;;5562   	char command_with_crc[20];
;;;5563   	
;;;5564      	command_with_crc[0]=0xaf;  // /
;;;5565   	command_with_crc[1]=0x3f;  // ?
;;;5566   	command_with_crc[2]=0x21;  // !
;;;5567   	command_with_crc[3]=0x8d;  // CR
;;;5568   	command_with_crc[4]=0x0a;  // LF
;;;5569   
;;;5570   	uart_out__adr1(command_with_crc,5);
;;;5571   
;;;5572   	rx_wr_index1=0;
;;;5573   	rx_read_power_cnt_phase=1;
;;;5574   
;;;5575   	read_power_cnt_main_cnt=50;
;;;5576   	}
;;;5577   if ((rx_read_power_cnt_phase==2)&&(!ce102m_delayCnt))
;;;5578   	{
;;;5579   	char command_with_crc[20];
;;;5580   	
;;;5581   	command_with_crc[0]=0x06;  //  
;;;5582   	command_with_crc[1]=0x30;  // 0
;;;5583   	command_with_crc[2]=0x35;  // 5
;;;5584   	command_with_crc[3]=0xb1;  // 1
;;;5585   	command_with_crc[4]=0x8d;  // CR
;;;5586   	command_with_crc[5]=0x0a;  // LF
;;;5587   	
;;;5588   	uart_out__adr1(command_with_crc,6);
;;;5589   	
;;;5590   	rx_wr_index1=0;
;;;5591   	rx_read_power_cnt_phase=3;
;;;5592   
;;;5593   	read_power_cnt_main_cnt=50;
;;;5594   	}  
;;;5595   
;;;5596   if ((rx_read_power_cnt_phase==4)&&(!ce102m_delayCnt))
;;;5597   	{
;;;5598   	char command_with_crc[20];
;;;5599   	
;;;5600   	command_with_crc[0]=0x81;  //  
;;;5601   	command_with_crc[1]=0xd2;  // 0
;;;5602   	command_with_crc[2]=0xb1;  // 5
;;;5603   	command_with_crc[3]=0x82;  // 1
;;;5604   	command_with_crc[4]=0x56;  // CR
;;;5605   	command_with_crc[5]=0xcf;  // LF
;;;5606   	command_with_crc[6]=0xcc;  // 1
;;;5607   	command_with_crc[7]=0xd4;  // CR
;;;5608   	command_with_crc[8]=0x41;  // LF
;;;5609   	command_with_crc[9]=0x28;  // 1
;;;5610   	command_with_crc[10]=0xa9;  // CR
;;;5611   	command_with_crc[11]=0x03;  // LF
;;;5612   	command_with_crc[12]=0x5f;  // LF
;;;5613   		
;;;5614   	uart_out__adr1(command_with_crc,13);
;;;5615   	
;;;5616   	rx_wr_index1=0;
;;;5617   	rx_read_power_cnt_phase=5;
;;;5618   
;;;5619   	read_power_cnt_main_cnt=50;
;;;5620   	}  
;;;5621   
;;;5622   if ((rx_read_power_cnt_phase==8)&&(!ce102m_delayCnt))
;;;5623   	{
;;;5624   	char command_with_crc[20];
;;;5625   	
;;;5626   	command_with_crc[0]=0x81;  //  
;;;5627   	command_with_crc[1]=0xd2;  // 0
;;;5628   	command_with_crc[2]=0xb1;  // 5
;;;5629   	command_with_crc[3]=0x82;  // 1
;;;5630   	command_with_crc[4]=0xc3;  // CR
;;;5631   	command_with_crc[5]=0x55;  // LF
;;;5632   	command_with_crc[6]=0xd2;  // 1
;;;5633   	command_with_crc[7]=0xd2;  // CR
;;;5634   	command_with_crc[8]=0xc5;  // LF
;;;5635   	command_with_crc[9]=0x28;  // 1
;;;5636   	command_with_crc[10]=0xa9;  // CR
;;;5637   	command_with_crc[11]=0x03;  // LF
;;;5638   	command_with_crc[12]=0x5a;  // LF
;;;5639   		
;;;5640   	uart_out__adr1(command_with_crc,13);
;;;5641   	
;;;5642   	rx_wr_index1=0;
;;;5643   	rx_read_power_cnt_phase=9;
;;;5644   
;;;5645   	read_power_cnt_main_cnt=50;
;;;5646   	}  
;;;5647   
;;;5648   if ((rx_read_power_cnt_phase==20)&&(!ce102m_delayCnt))
;;;5649   	{
;;;5650   	char command_with_crc[20];
;;;5651   	
;;;5652   	command_with_crc[0]=0x81;  //  		01
;;;5653   	command_with_crc[1]=0xd2;  // R		52
;;;5654   	command_with_crc[2]=0xb1;  // 1		31
;;;5655   	command_with_crc[3]=0x82;  // 		02
;;;5656   	command_with_crc[4]=0x50;  // P		50
;;;5657   	command_with_crc[5]=0xcf;  // O	  	4f
;;;5658   	command_with_crc[6]=0xd7;  // W		57
;;;5659   	command_with_crc[7]=0xc5;  // E		45
;;;5660   	command_with_crc[8]=0x50;  // P		50
;;;5661   	command_with_crc[9]=0x28;  // (		28
;;;5662   	command_with_crc[10]=0xa9;  // )	29
;;;5663   	command_with_crc[11]=0x03;  // 		03
;;;5664   	command_with_crc[12]=0xe4;  // d	64
;;;5665   		
;;;5666   	uart_out__adr1(command_with_crc,13);
;;;5667   	
;;;5668   	rx_wr_index1=0;
;;;5669   	rx_read_power_cnt_phase=21;
;;;5670   
;;;5671   	read_power_cnt_main_cnt=50;
;;;5672   	}  
;;;5673   
;;;5674   
;;;5675   #endif
;;;5676   }
;;;5677   
                          ENDP

                  ips_current_average_hndl PROC
;;;5678   //-----------------------------------------------
;;;5679   void ips_current_average_hndl(void)
003782  e92d4ff0          PUSH     {r4-r11,lr}
;;;5680   {
003786  b089              SUB      sp,sp,#0x24
;;;5681   
;;;5682   if(++ica_timer_cnt>=10) 
003788  4e37              LDR      r6,|L1.14440|
;;;5683   	{
;;;5684   	ica_timer_cnt=0;
00378a  2400              MOVS     r4,#0
00378c  7830              LDRB     r0,[r6,#0]            ;5682  ; ica_timer_cnt
00378e  1c40              ADDS     r0,r0,#1              ;5682
003790  b2c0              UXTB     r0,r0                 ;5682
003792  7030              STRB     r0,[r6,#0]            ;5682
003794  280a              CMP      r0,#0xa               ;5682
003796  d300              BCC      |L1.14234|
003798  7034              STRB     r4,[r6,#0]
                  |L1.14234|
;;;5685   	}
;;;5686   
;;;5687   if((ica_timer_cnt==0) && (num_of_wrks_bps)&&((spc_stat==spcOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(sp_ch_stat==scsOFF)))
00379a  7830              LDRB     r0,[r6,#0]  ; ica_timer_cnt
00379c  4f33              LDR      r7,|L1.14444|
;;;5688   	{
;;;5689   	
;;;5690   	ica_plazma[0]++;
;;;5691   
;;;5692   	ica_my_current=bps_I;
;;;5693   
;;;5694   	if((ica_my_current>ica_your_current)&&((ica_my_current-ica_your_current)>=5)&&((ICA_EN==1)||((ICA_EN==2)&&(ica_cntrl_hndl_cnt>5))))
00379e  f8dfb0d0          LDR      r11,|L1.14448|
0037a2  4d21              LDR      r5,|L1.14376|
0037a4  bbf0              CBNZ     r0,|L1.14372|
0037a6  7d68              LDRB     r0,[r5,#0x15]         ;5687  ; num_of_wrks_bps
0037a8  b3e0              CBZ      r0,|L1.14372|
0037aa  7ea8              LDRB     r0,[r5,#0x1a]         ;5687  ; spc_stat
0037ac  f8951026          LDRB     r1,[r5,#0x26]         ;5687  ; vz1_stat
0037b0  4308              ORRS     r0,r0,r1              ;5687
0037b2  f8951029          LDRB     r1,[r5,#0x29]         ;5687  ; vz2_stat
0037b6  4308              ORRS     r0,r0,r1              ;5687
0037b8  7839              LDRB     r1,[r7,#0]            ;5687  ; sp_ch_stat
0037ba  4308              ORRS     r0,r0,r1              ;5687
0037bc  d17f              BNE      |L1.14526|
0037be  f8df90b4          LDR      r9,|L1.14452|
0037c2  f8990000          LDRB     r0,[r9,#0]            ;5690  ; ica_plazma
0037c6  f1000001          ADD      r0,r0,#1              ;5690
0037ca  f8890000          STRB     r0,[r9,#0]            ;5690
0037ce  482a              LDR      r0,|L1.14456|
0037d0  f9b01000          LDRSH    r1,[r0,#0]            ;5692  ; bps_I
0037d4  4829              LDR      r0,|L1.14460|
0037d6  8001              STRH     r1,[r0,#0]            ;5692
0037d8  4829              LDR      r0,|L1.14464|
;;;5695   		{
;;;5696   		ica_plazma[1]++;
;;;5697   		ica_u_necc--;
0037da  f8dfa0a8          LDR      r10,|L1.14468|
0037de  f9b02000          LDRSH    r2,[r0,#0]            ;5694  ; ica_your_current
0037e2  4648              MOV      r0,r9                 ;5690
0037e4  f9bac000          LDRSH    r12,[r10,#0]
0037e8  7843              LDRB     r3,[r0,#1]            ;5696
0037ea  4827              LDR      r0,|L1.14472|
0037ec  4291              CMP      r1,r2                 ;5694
0037ee  f9b08000          LDRSH    r8,[r0,#0]            ;5694
0037f2  4658              MOV      r0,r11                ;5694
0037f4  f9b00000          LDRSH    r0,[r0,#0]            ;5694
0037f8  dd48              BLE      |L1.14476|
0037fa  eba10e02          SUB      lr,r1,r2              ;5694
0037fe  f1be0f05          CMP      lr,#5                 ;5694
003802  db43              BLT      |L1.14476|
003804  2801              CMP      r0,#1                 ;5694
003806  d004              BEQ      |L1.14354|
003808  2802              CMP      r0,#2                 ;5694
00380a  d13f              BNE      |L1.14476|
00380c  f1b80f05          CMP      r8,#5                 ;5694
003810  dd3c              BLE      |L1.14476|
                  |L1.14354|
003812  f1030301          ADD      r3,r3,#1              ;5696
003816  f8893001          STRB     r3,[r9,#1]            ;5696
00381a  f1ac0c01          SUB      r12,r12,#1
00381e  f8aac000          STRH     r12,[r10,#0]
003822  e047              B        |L1.14516|
                  |L1.14372|
003824  e04b              B        |L1.14526|
003826  0000              DCW      0x0000
                  |L1.14376|
                          DCD      ||area_number.25||
                  |L1.14380|
                          DCD      bps
                  |L1.14384|
                          DCD      NUMIST
                  |L1.14388|
                          DCD      mess_data
                  |L1.14392|
                          DCD      num_necc
                  |L1.14396|
                          DCD      main_1Hz_cnt
                  |L1.14400|
                          DCD      ipsBlckStat
                  |L1.14404|
                          DCD      TSIGN
                  |L1.14408|
                          DCD      power_summary_tempo
                  |L1.14412|
                          DCD      power_summary_tempo_old
                  |L1.14416|
                          DCD      powerSummaryCnt
                  |L1.14420|
                          DCD      power_summary
                  |L1.14424|
                          DCD      power_current_tempo
                  |L1.14428|
                          DCD      power_current_tempo_old
                  |L1.14432|
                          DCD      powerCurrentCnt
                  |L1.14436|
                          DCD      power_current
                  |L1.14440|
                          DCD      ica_timer_cnt
                  |L1.14444|
                          DCD      sp_ch_stat
                  |L1.14448|
                          DCD      ICA_EN
                  |L1.14452|
                          DCD      ica_plazma
                  |L1.14456|
                          DCD      bps_I
                  |L1.14460|
                          DCD      ica_my_current
                  |L1.14464|
                          DCD      ica_your_current
                  |L1.14468|
                          DCD      ica_u_necc
                  |L1.14472|
                          DCD      ica_cntrl_hndl_cnt
                  |L1.14476|
;;;5698   		}
;;;5699   	else if((ica_my_current<ica_your_current)&&((ica_your_current-ica_my_current)>=5)&&((ICA_EN==1)||((ICA_EN==2)&&(ica_cntrl_hndl_cnt>5))))
00388c  4291              CMP      r1,r2
00388e  da11              BGE      |L1.14516|
003890  1a51              SUBS     r1,r2,r1
003892  2905              CMP      r1,#5
003894  db0e              BLT      |L1.14516|
003896  2801              CMP      r0,#1
003898  d004              BEQ      |L1.14500|
00389a  2802              CMP      r0,#2
00389c  d10a              BNE      |L1.14516|
00389e  f1b80f05          CMP      r8,#5
0038a2  dd07              BLE      |L1.14516|
                  |L1.14500|
;;;5700   		{
;;;5701   		ica_plazma[1]--;
0038a4  f1a30301          SUB      r3,r3,#1
0038a8  f8893001          STRB     r3,[r9,#1]
;;;5702   		ica_u_necc++;
0038ac  f10c0c01          ADD      r12,r12,#1
0038b0  f8aac000          STRH     r12,[r10,#0]
                  |L1.14516|
;;;5703   		}
;;;5704   	gran(&ica_u_necc,-100,100);
0038b4  2264              MOVS     r2,#0x64
0038b6  4251              RSBS     r1,r2,#0
0038b8  48ff              LDR      r0,|L1.15544|
0038ba  f7fffffe          BL       gran
                  |L1.14526|
;;;5705   	}
;;;5706   
;;;5707   
;;;5708   if((ICA_EN==1)&&((spc_stat==spcOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)&&(sp_ch_stat==scsOFF)) /*&& (num_of_wrks_bps)*/)
0038be  f8bb0000          LDRH     r0,[r11,#0]  ; ICA_EN
0038c2  2801              CMP      r0,#1
0038c4  d167              BNE      |L1.14742|
0038c6  7ea8              LDRB     r0,[r5,#0x1a]  ; spc_stat
0038c8  f8951026          LDRB     r1,[r5,#0x26]  ; vz1_stat
0038cc  4308              ORRS     r0,r0,r1
0038ce  f8951029          LDRB     r1,[r5,#0x29]  ; vz2_stat
0038d2  4308              ORRS     r0,r0,r1
0038d4  7839              LDRB     r1,[r7,#0]  ; sp_ch_stat
0038d6  4308              ORRS     r0,r0,r1
0038d8  d15d              BNE      |L1.14742|
;;;5709   	{
;;;5710   	
;;;5711   	if(ica_timer_cnt==8)
0038da  7830              LDRB     r0,[r6,#0]  ; ica_timer_cnt
;;;5712   		{
;;;5713   		char modbus_buff[20],i;
;;;5714   		short crc_temp;
;;;5715   	
;;;5716   		modbus_buff[0] = ICA_MODBUS_ADDRESS;
0038dc  4bf7              LDR      r3,|L1.15548|
;;;5717   		modbus_buff[1] = 4;
;;;5718   		modbus_buff[2] = 0;
;;;5719   		modbus_buff[3] = 2;
;;;5720   		modbus_buff[4] = 0;	
;;;5721   		modbus_buff[5] = 1;
;;;5722   	
;;;5723   		crc_temp= CRC16_2(modbus_buff,6);
;;;5724   	
;;;5725   		modbus_buff[6]= (char)crc_temp;
;;;5726   		modbus_buff[7]= (char)(crc_temp>>8);
;;;5727   	
;;;5728   		if(ICA_CH==0)
0038de  4ff8              LDR      r7,|L1.15552|
0038e0  2808              CMP      r0,#8                 ;5711
0038e2  d05b              BEQ      |L1.14748|
;;;5729   			{
;;;5730   			for (i=0;i<8;i++)
;;;5731   				{
;;;5732   				putchar_sc16is700(modbus_buff[i]);
;;;5733   				}
;;;5734   			}
;;;5735   		else if(ICA_CH==2)
;;;5736   			{
;;;5737   			uart_out1 (5,4,0,2,0,1,0);
;;;5738   			}
;;;5739   		}
;;;5740   	else
;;;5741   		{
;;;5742   		char modbus_buff[20],i;
;;;5743   		short crc_temp, tempSSSS;
;;;5744   
;;;5745   		tempSSSS=cntrl_stat_old;
0038e4  f9b5602e          LDRSH    r6,[r5,#0x2e]  ; cntrl_stat_old
;;;5746   		if(	(main_kb_cnt==(TBAT*60)-21) || (main_kb_cnt==(TBAT*60)-20) || (main_kb_cnt==(TBAT*60)-19)) tempSSSS=((short)TBAT)|0x4000;
0038e8  48f6              LDR      r0,|L1.15556|
0038ea  f06f0214          MVN      r2,#0x14
0038ee  f9b00000          LDRSH    r0,[r0,#0]  ; TBAT
0038f2  ebc01100          RSB      r1,r0,r0,LSL #4
0038f6  eb020c81          ADD      r12,r2,r1,LSL #2
0038fa  f9b5204c          LDRSH    r2,[r5,#0x4c]  ; main_kb_cnt
0038fe  4594              CMP      r12,r2
003900  d00b              BEQ      |L1.14618|
003902  f06f0c13          MVN      r12,#0x13
003906  eb0c0c81          ADD      r12,r12,r1,LSL #2
00390a  4594              CMP      r12,r2
00390c  d005              BEQ      |L1.14618|
00390e  f06f0c12          MVN      r12,#0x12
003912  eb0c0181          ADD      r1,r12,r1,LSL #2
003916  4291              CMP      r1,r2
003918  d101              BNE      |L1.14622|
                  |L1.14618|
00391a  f4404680          ORR      r6,r0,#0x4000
                  |L1.14622|
;;;5747   
;;;5748   
;;;5749   		modbus_buff[0] = ICA_MODBUS_ADDRESS;
00391e  8818              LDRH     r0,[r3,#0]  ; ICA_MODBUS_ADDRESS
003920  f88d0010          STRB     r0,[sp,#0x10]
;;;5750   		modbus_buff[1] = 6;
003924  f04f0006          MOV      r0,#6
003928  f88d0011          STRB     r0,[sp,#0x11]
;;;5751   		modbus_buff[2] = 0;
00392c  f88d4012          STRB     r4,[sp,#0x12]
;;;5752   		modbus_buff[3] = 100;
003930  f04f0064          MOV      r0,#0x64
003934  f88d0013          STRB     r0,[sp,#0x13]
;;;5753   		modbus_buff[4] = (char)(tempSSSS/256);	
003938  ea4f70e6          ASR      r0,r6,#31
00393c  eb066010          ADD      r0,r6,r0,LSR #24
003940  ea4f2120          ASR      r1,r0,#8
003944  f88d1014          STRB     r1,[sp,#0x14]
;;;5754   		modbus_buff[5] = (char)(tempSSSS%256);
003948  4630              MOV      r0,r6
00394a  f88d0015          STRB     r0,[sp,#0x15]
;;;5755   	
;;;5756   		crc_temp= CRC16_2(modbus_buff,6);
00394e  f04f0106          MOV      r1,#6
003952  a804              ADD      r0,sp,#0x10
003954  f7fffffe          BL       CRC16_2
;;;5757   	
;;;5758   		modbus_buff[6]= (char)crc_temp;
003958  f88d0016          STRB     r0,[sp,#0x16]
;;;5759   		modbus_buff[7]= (char)(crc_temp>>8);
00395c  ea4f2020          ASR      r0,r0,#8
003960  f88d0017          STRB     r0,[sp,#0x17]
;;;5760   	
;;;5761   		crc_temp= CRC16_2(modbus_buff,6);
003964  f04f0106          MOV      r1,#6
003968  a804              ADD      r0,sp,#0x10
00396a  f7fffffe          BL       CRC16_2
;;;5762   	
;;;5763   		plazma_ica1=tempSSSS;
00396e  f8a5607c          STRH     r6,[r5,#0x7c]
;;;5764   		if(ICA_CH==0)
003972  f9b70000          LDRSH    r0,[r7,#0]  ; ICA_CH
003976  b3f0              CBZ      r0,|L1.14838|
;;;5765   			{
;;;5766   			for (i=0;i<8;i++)
;;;5767   				{
;;;5768   				putchar_sc16is700(modbus_buff[i]);
;;;5769   				}
;;;5770   			}
;;;5771   		else if(ICA_CH==2)
003978  2802              CMP      r0,#2
00397a  d10c              BNE      |L1.14742|
;;;5772   			{
;;;5773   			uart_out1 (5,6,0,100,modbus_buff[4],modbus_buff[5],0);
00397c  f89d0015          LDRB     r0,[sp,#0x15]
003980  f89d1014          LDRB     r1,[sp,#0x14]
003984  e9cd0401          STRD     r0,r4,[sp,#4]
003988  9100              STR      r1,[sp,#0]
00398a  2364              MOVS     r3,#0x64
00398c  2200              MOVS     r2,#0
00398e  2106              MOVS     r1,#6
003990  2005              MOVS     r0,#5
003992  f7fffffe          BL       uart_out1
                  |L1.14742|
;;;5774   			}
;;;5775   		}
;;;5776   	}
;;;5777   }
003996  b009              ADD      sp,sp,#0x24
003998  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.14748|
00399c  8818              LDRH     r0,[r3,#0]            ;5716  ; ICA_MODBUS_ADDRESS
00399e  f88d0010          STRB     r0,[sp,#0x10]         ;5716
0039a2  f04f0004          MOV      r0,#4                 ;5717
0039a6  f88d0011          STRB     r0,[sp,#0x11]         ;5717
0039aa  f88d4012          STRB     r4,[sp,#0x12]         ;5718
0039ae  f04f0002          MOV      r0,#2                 ;5719
0039b2  f88d0013          STRB     r0,[sp,#0x13]         ;5719
0039b6  f88d4014          STRB     r4,[sp,#0x14]         ;5720
0039ba  f04f0501          MOV      r5,#1                 ;5721
0039be  f88d5015          STRB     r5,[sp,#0x15]         ;5721
0039c2  f04f0106          MOV      r1,#6                 ;5723
0039c6  a804              ADD      r0,sp,#0x10           ;5723
0039c8  f7fffffe          BL       CRC16_2
0039cc  f88d0016          STRB     r0,[sp,#0x16]         ;5725
0039d0  ea4f2020          ASR      r0,r0,#8              ;5726
0039d4  f88d0017          STRB     r0,[sp,#0x17]         ;5726
0039d8  f9b70000          LDRSH    r0,[r7,#0]            ;5728  ; ICA_CH
0039dc  b160              CBZ      r0,|L1.14840|
0039de  2802              CMP      r0,#2                 ;5735
0039e0  d1d9              BNE      |L1.14742|
0039e2  e9cd4500          STRD     r4,r5,[sp,#0]         ;5737
0039e6  2302              MOVS     r3,#2                 ;5737
0039e8  2200              MOVS     r2,#0                 ;5737
0039ea  2104              MOVS     r1,#4                 ;5737
0039ec  2005              MOVS     r0,#5                 ;5737
0039ee  9402              STR      r4,[sp,#8]            ;5737
0039f0  f7fffffe          BL       uart_out1
0039f4  e7cf              B        |L1.14742|
                  |L1.14838|
0039f6  e00b              B        |L1.14864|
                  |L1.14840|
0039f8  f04f0400          MOV      r4,#0                 ;5730
0039fc  ad04              ADD      r5,sp,#0x10           ;5713
                  |L1.14846|
0039fe  5d28              LDRB     r0,[r5,r4]            ;5732
003a00  f7fffffe          BL       putchar_sc16is700
003a04  f1040401          ADD      r4,r4,#1              ;5730
003a08  b2e4              UXTB     r4,r4                 ;5730
003a0a  2c08              CMP      r4,#8                 ;5730
003a0c  d3f7              BCC      |L1.14846|
003a0e  e7c2              B        |L1.14742|
                  |L1.14864|
003a10  f04f0400          MOV      r4,#0                 ;5766
003a14  ad04              ADD      r5,sp,#0x10           ;5742
                  |L1.14870|
003a16  5d28              LDRB     r0,[r5,r4]            ;5768
003a18  f7fffffe          BL       putchar_sc16is700
003a1c  f1040401          ADD      r4,r4,#1              ;5766
003a20  b2e4              UXTB     r4,r4                 ;5766
003a22  2c08              CMP      r4,#8                 ;5766
003a24  d3f7              BCC      |L1.14870|
003a26  e7b6              B        |L1.14742|
;;;5778   
                          ENDP

                  ipsBlckHndl PROC
;;;5861   //-----------------------------------------------
;;;5862   void ipsBlckHndl(char in)
003a28  b510              PUSH     {r4,lr}
;;;5863   {
;;;5864   
;;;5865   ipsBlckStat=0;
003a2a  4ba7              LDR      r3,|L1.15560|
003a2c  f04f0000          MOV      r0,#0
003a30  8018              STRH     r0,[r3,#0]
;;;5866   if(ipsBlckSrc==1)
003a32  48a6              LDR      r0,|L1.15564|
003a34  f04f0401          MOV      r4,#1
;;;5867   	{
;;;5868   	if(((ipsBlckLog==0)&&(adc_buff_[11]>2000)) || ((ipsBlckLog==1)&&(adc_buff_[11]<2000))) ipsBlckStat=1;
003a38  f44f62fa          MOV      r2,#0x7d0
003a3c  f9b01000          LDRSH    r1,[r0,#0]            ;5866  ; ipsBlckSrc
003a40  48a3              LDR      r0,|L1.15568|
003a42  2901              CMP      r1,#1                 ;5866
003a44  f9b00000          LDRSH    r0,[r0,#0]
003a48  d006              BEQ      |L1.14936|
;;;5869   	}
;;;5870   else if(ipsBlckSrc==2)
003a4a  2902              CMP      r1,#2
003a4c  d10f              BNE      |L1.14958|
003a4e  49a1              LDR      r1,|L1.15572|
;;;5871   	{
;;;5872   	if(((ipsBlckLog==0)&&(adc_buff_[13]>2000)) || ((ipsBlckLog==1)&&(adc_buff_[13]<2000))) ipsBlckStat=1;
003a50  f9b1101a          LDRSH    r1,[r1,#0x1a]
003a54  b160              CBZ      r0,|L1.14960|
003a56  e00d              B        |L1.14964|
                  |L1.14936|
003a58  499e              LDR      r1,|L1.15572|
003a5a  f9b11016          LDRSH    r1,[r1,#0x16]         ;5868
003a5e  b908              CBNZ     r0,|L1.14948|
003a60  4291              CMP      r1,r2                 ;5868
003a62  dc03              BGT      |L1.14956|
                  |L1.14948|
003a64  2801              CMP      r0,#1                 ;5868
003a66  d102              BNE      |L1.14958|
003a68  4291              CMP      r1,r2                 ;5868
003a6a  da00              BGE      |L1.14958|
                  |L1.14956|
003a6c  801c              STRH     r4,[r3,#0]            ;5868
                  |L1.14958|
;;;5873   	}
;;;5874   }
003a6e  bd10              POP      {r4,pc}
                  |L1.14960|
003a70  4291              CMP      r1,r2                 ;5872
003a72  dc03              BGT      |L1.14972|
                  |L1.14964|
003a74  2801              CMP      r0,#1                 ;5872
003a76  d1fa              BNE      |L1.14958|
003a78  4291              CMP      r1,r2                 ;5872
003a7a  daf8              BGE      |L1.14958|
                  |L1.14972|
003a7c  801c              STRH     r4,[r3,#0]            ;5872
003a7e  bd10              POP      {r4,pc}
;;;5875   
                          ENDP

                  bps_drv PROC
;;;5876   //-----------------------------------------------
;;;5877   void bps_drv(char in)
003a80  e92d41f0          PUSH     {r4-r8,lr}
;;;5878   {
003a84  4606              MOV      r6,r0
;;;5879   char temp;
;;;5880   
;;;5881   if (bps[in]._device!=dSRC) return;
003a86  ebc600c6          RSB      r0,r6,r6,LSL #3
003a8a  4993              LDR      r1,|L1.15576|
003a8c  eb001006          ADD      r0,r0,r6,LSL #4
003a90  f8112020          LDRB     r2,[r1,r0,LSL #2]
003a94  2a03              CMP      r2,#3
003a96  d177              BNE      |L1.15240|
;;;5882   temp=bps[in]._flags_tm;
003a98  eb010480          ADD      r4,r1,r0,LSL #2
003a9c  f8945042          LDRB     r5,[r4,#0x42]
;;;5883   if(temp&(1<<AV_T))
003aa0  07a8              LSLS     r0,r5,#30
003aa2  d517              BPL      |L1.15060|
;;;5884   	{
;;;5885   	if(bps[in]._temp_av_cnt<1200) 
003aa4  f9b41046          LDRSH    r1,[r4,#0x46]
003aa8  f44f6096          MOV      r0,#0x4b0
003aac  4281              CMP      r1,r0
003aae  da22              BGE      |L1.15094|
;;;5886   		{
;;;5887   		bps[in]._temp_av_cnt++;
003ab0  f1010101          ADD      r1,r1,#1
003ab4  b209              SXTH     r1,r1
003ab6  f8a41046          STRH     r1,[r4,#0x46]
;;;5888   		if(bps[in]._temp_av_cnt>=1200)
003aba  4281              CMP      r1,r0
003abc  db1b              BLT      |L1.15094|
;;;5889   			{
;;;5890   			bps[in]._temp_av_cnt=1200;
003abe  f8a40046          STRH     r0,[r4,#0x46]
;;;5891   		   	if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
003ac2  7860              LDRB     r0,[r4,#1]
003ac4  07c0              LSLS     r0,r0,#31
003ac6  d116              BNE      |L1.15094|
003ac8  2201              MOVS     r2,#1
003aca  2100              MOVS     r1,#0
003acc  4630              MOV      r0,r6
003ace  f7fffffe          BL       avar_bps_hndl
003ad2  e010              B        |L1.15094|
                  |L1.15060|
;;;5892   			}
;;;5893   		}
;;;5894   	}
;;;5895   
;;;5896   else if(!(temp&(1<<AV_T)))
;;;5897   	{
;;;5898   	if(bps[in]._temp_av_cnt) 
003ad4  f9b41046          LDRSH    r1,[r4,#0x46]
003ad8  b169              CBZ      r1,|L1.15094|
;;;5899   		{
;;;5900   		bps[in]._temp_av_cnt--;
003ada  f1a10101          SUB      r1,r1,#1
003ade  b208              SXTH     r0,r1
003ae0  f8a40046          STRH     r0,[r4,#0x46]
;;;5901   		if(!bps[in]._temp_av_cnt)
003ae4  b938              CBNZ     r0,|L1.15094|
;;;5902   			{
;;;5903   			if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
003ae6  7860              LDRB     r0,[r4,#1]
003ae8  07c0              LSLS     r0,r0,#31
003aea  d004              BEQ      |L1.15094|
003aec  2200              MOVS     r2,#0
003aee  4611              MOV      r1,r2
003af0  4630              MOV      r0,r6
003af2  f7fffffe          BL       avar_bps_hndl
                  |L1.15094|
;;;5904   			}
;;;5905   		} 	
;;;5906   
;;;5907   	}
;;;5908   
;;;5909   if((temp&(1<<AVUMAX)))
003af6  0729              LSLS     r1,r5,#28
;;;5910   	{
;;;5911   	if(bps[in]._umax_av_cnt<10) 
;;;5912   		{
;;;5913   		bps[in]._umax_av_cnt++;
;;;5914   		if(bps[in]._umax_av_cnt>=10)
;;;5915   			{ 
;;;5916   			bps[in]._umax_av_cnt=10;
003af8  f04f070a          MOV      r7,#0xa
003afc  f04f0000          MOV      r0,#0                 ;5891
003b00  d515              BPL      |L1.15150|
003b02  f9b40048          LDRSH    r0,[r4,#0x48]         ;5911
003b06  280a              CMP      r0,#0xa               ;5911
003b08  da26              BGE      |L1.15192|
003b0a  f1000001          ADD      r0,r0,#1              ;5913
003b0e  b200              SXTH     r0,r0                 ;5913
003b10  f8a40048          STRH     r0,[r4,#0x48]         ;5913
003b14  280a              CMP      r0,#0xa               ;5914
003b16  db1f              BLT      |L1.15192|
003b18  f8a47048          STRH     r7,[r4,#0x48]
;;;5917   			if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
003b1c  7860              LDRB     r0,[r4,#1]
003b1e  0780              LSLS     r0,r0,#30
003b20  d41a              BMI      |L1.15192|
003b22  2201              MOVS     r2,#1
003b24  4611              MOV      r1,r2
003b26  4630              MOV      r0,r6
003b28  f7fffffe          BL       avar_bps_hndl
003b2c  e014              B        |L1.15192|
                  |L1.15150|
;;;5918   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;5919   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;5920   				{
;;;5921   				apv_cnt[in,0]=APV_INIT;
;;;5922   				apv_cnt[in,1]=APV_INIT;
;;;5923   				apv_cnt[in,2]=APV_INIT;
;;;5924   				apv_flags[in]=afOFF;
;;;5925   				}				*/
;;;5926   						
;;;5927   			}
;;;5928   		} 
;;;5929   	}		
;;;5930   else if(!(temp&(1<<AVUMAX)))
;;;5931   	{
;;;5932   	if(bps[in]._umax_av_cnt>0) 
003b2e  f9b41048          LDRSH    r1,[r4,#0x48]
003b32  2900              CMP      r1,#0
003b34  dd0d              BLE      |L1.15186|
;;;5933   		{
;;;5934   		bps[in]._umax_av_cnt--;
003b36  f1a10101          SUB      r1,r1,#1
003b3a  b208              SXTH     r0,r1
003b3c  f8a40048          STRH     r0,[r4,#0x48]
;;;5935   		if(bps[in]._umax_av_cnt==0)
003b40  b950              CBNZ     r0,|L1.15192|
;;;5936   			{
;;;5937   			bps[in]._umax_av_cnt=0;
;;;5938   			avar_bps_hndl(in,1,0);
003b42  f04f0200          MOV      r2,#0
003b46  f04f0101          MOV      r1,#1
003b4a  4630              MOV      r0,r6
003b4c  f7fffffe          BL       avar_bps_hndl
003b50  e002              B        |L1.15192|
                  |L1.15186|
;;;5939   	 //		apv_cnt[in,0]=0;
;;;5940   	//		apv_cnt[in,1]=0;
;;;5941   	 //		apv_cnt[in,2]=0;			
;;;5942   			}
;;;5943   		}
;;;5944   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
003b52  da01              BGE      |L1.15192|
003b54  f8a40048          STRH     r0,[r4,#0x48]
                  |L1.15192|
;;;5945   	}
;;;5946   
;;;5947   if(temp&(1<<AVUMIN))
003b58  06e8              LSLS     r0,r5,#27
003b5a  d516              BPL      |L1.15242|
;;;5948   	{
;;;5949   	if(bps[in]._umin_av_cnt<10) 
003b5c  f9b4004a          LDRSH    r0,[r4,#0x4a]
003b60  280a              CMP      r0,#0xa
003b62  da20              BGE      |L1.15270|
;;;5950   		{
;;;5951   		bps[in]._umin_av_cnt++;
003b64  f1000001          ADD      r0,r0,#1
003b68  b200              SXTH     r0,r0
003b6a  f8a4004a          STRH     r0,[r4,#0x4a]
;;;5952   		if(bps[in]._umin_av_cnt>=10)
003b6e  280a              CMP      r0,#0xa
003b70  db19              BLT      |L1.15270|
;;;5953   			{ 
;;;5954   			bps[in]._umin_av_cnt=10;
003b72  f8a4704a          STRH     r7,[r4,#0x4a]
;;;5955   			if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
003b76  7860              LDRB     r0,[r4,#1]
003b78  0740              LSLS     r0,r0,#29
003b7a  d414              BMI      |L1.15270|
003b7c  2201              MOVS     r2,#1
003b7e  2102              MOVS     r1,#2
003b80  4630              MOV      r0,r6
003b82  f7fffffe          BL       avar_bps_hndl
003b86  e00e              B        |L1.15270|
                  |L1.15240|
003b88  e046              B        |L1.15384|
                  |L1.15242|
;;;5956   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;5957   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;5958   				{
;;;5959   				apv_cnt[in,0]=APV_INIT;
;;;5960   				apv_cnt[in,1]=APV_INIT;
;;;5961   				apv_cnt[in,2]=APV_INIT;
;;;5962   				apv_flags[in]=afOFF;
;;;5963   				}*/				
;;;5964   			}
;;;5965   		} 
;;;5966   	}	
;;;5967   	
;;;5968   else if(!(temp&(1<<AVUMIN)))
;;;5969   	{
;;;5970   	if(bps[in]._umin_av_cnt) 
003b8a  f9b4004a          LDRSH    r0,[r4,#0x4a]
003b8e  b150              CBZ      r0,|L1.15270|
;;;5971   		{
;;;5972   		bps[in]._umin_av_cnt--;
003b90  f1a00001          SUB      r0,r0,#1
003b94  b201              SXTH     r1,r0
003b96  f8a4104a          STRH     r1,[r4,#0x4a]
;;;5973   		if(bps[in]._umin_av_cnt==0)
003b9a  b921              CBNZ     r1,|L1.15270|
;;;5974   			{
;;;5975   			bps[in]._umin_av_cnt=0;
;;;5976   			avar_bps_hndl(in,2,0);
003b9c  2200              MOVS     r2,#0
003b9e  2102              MOVS     r1,#2
003ba0  4630              MOV      r0,r6
003ba2  f7fffffe          BL       avar_bps_hndl
                  |L1.15270|
;;;5977   		//	apv_cnt[in,0]=0;
;;;5978   		//	apv_cnt[in,1]=0;
;;;5979   		//	apv_cnt[in,2]=0;
;;;5980   			}
;;;5981   		}
;;;5982   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;5983   	}
;;;5984   
;;;5985   //bps[in]._state=bsOFF;
;;;5986   
;;;5987   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
003ba6  7860              LDRB     r0,[r4,#1]
003ba8  0700              LSLS     r0,r0,#28
003baa  d003              BEQ      |L1.15284|
003bac  f04f0004          MOV      r0,#4
003bb0  70a0              STRB     r0,[r4,#2]
003bb2  e017              B        |L1.15332|
                  |L1.15284|
;;;5988   else if ( (net_av) && (bps[in]._cnt>20)/*&& 
003bb4  4849              LDR      r0,|L1.15580|
003bb6  7800              LDRB     r0,[r0,#0]  ; net_av
003bb8  b130              CBZ      r0,|L1.15304|
003bba  78e0              LDRB     r0,[r4,#3]
003bbc  2814              CMP      r0,#0x14
003bbe  d903              BLS      |L1.15304|
;;;5989   		(bps[in]._Uii<200)*/)				bps[in]._state=bsOFF_AV_NET;
003bc0  f04f0005          MOV      r0,#5
003bc4  70a0              STRB     r0,[r4,#2]
003bc6  e00d              B        |L1.15332|
                  |L1.15304|
;;;5990   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
003bc8  f8940042          LDRB     r0,[r4,#0x42]
003bcc  0680              LSLS     r0,r0,#26
003bce  d503              BPL      |L1.15320|
003bd0  f04f0002          MOV      r0,#2
003bd4  70a0              STRB     r0,[r4,#2]
003bd6  e005              B        |L1.15332|
                  |L1.15320|
;;;5991   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
003bd8  78e0              LDRB     r0,[r4,#3]
003bda  2814              CMP      r0,#0x14
003bdc  d202              BCS      |L1.15332|
003bde  f04f0001          MOV      r0,#1
003be2  70a0              STRB     r0,[r4,#2]
                  |L1.15332|
;;;5992   
;;;5993   
;;;5994   
;;;5995   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;5996   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;5997   //else bps[0]._state=ssNOT;
;;;5998   
;;;5999   //bps[in]._is_ready=0;
;;;6000   //bps[in]._is_wrk=0;
;;;6001   //if(bps[in]._av_net) bps[in]._flags_bp='N';// не подключен
;;;6002   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';// завышено напряжение(u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;6003   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';// занижено напряжение
;;;6004   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// температура
;;;6005   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;6006   //	{
;;;6007   //	bps[in]._flags_bp='B';// заблокирован
;;;6008   //	bps[in]._is_ready=1;
;;;6009   //	}
;;;6010   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;6011   //     {
;;;6012   //     bps[in]._flags_bp='W';// работает
;;;6013   //     bps[in]._is_ready=1;
;;;6014   //     bps[in]._is_wrk=1;
;;;6015        
;;;6016   //     }
;;;6017   //else bps[in]._is_ready=1;     
;;;6018   
;;;6019   
;;;6020   
;;;6021   
;;;6022   
;;;6023   /*
;;;6024   bps[in]._flags_tu&=BIN8(11111110);
;;;6025   if(bps[in]._ist_blok_cnt)
;;;6026   	{
;;;6027   	bps[in]._ist_blok_cnt--;
;;;6028   	bps[in]._flags_tu|=BIN8(1);
;;;6029   	}
;;;6030   
;;;6031   	   */ 
;;;6032   
;;;6033   //Пересброс БПСа при потере связи
;;;6034   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
003be4  78e0              LDRB     r0,[r4,#3]
003be6  280a              CMP      r0,#0xa
003be8  d306              BCC      |L1.15352|
003bea  f894002c          LDRB     r0,[r4,#0x2c]
003bee  f0400080          ORR      r0,r0,#0x80
003bf2  f884002c          STRB     r0,[r4,#0x2c]
003bf6  e005              B        |L1.15364|
                  |L1.15352|
;;;6035   else bps[in]._flags_tu&=BIN8(1111111);
003bf8  f894002c          LDRB     r0,[r4,#0x2c]
003bfc  f000007f          AND      r0,r0,#0x7f
003c00  f884002c          STRB     r0,[r4,#0x2c]
                  |L1.15364|
;;;6036   	
;;;6037   bps[in]._vol_u=cntrl_stat+bps[in]._x_;	
003c04  4936              LDR      r1,|L1.15584|
003c06  f9b40050          LDRSH    r0,[r4,#0x50]
003c0a  f9b1102c          LDRSH    r1,[r1,#0x2c]  ; cntrl_stat
003c0e  4408              ADD      r0,r0,r1
003c10  6320              STR      r0,[r4,#0x30]
;;;6038   bps[in]._vol_i=1000; 
003c12  f44f707a          MOV      r0,#0x3e8
003c16  6360              STR      r0,[r4,#0x34]
                  |L1.15384|
;;;6039   }
003c18  e8bd81f0          POP      {r4-r8,pc}
;;;6040   
                          ENDP

                  avt_hndl PROC
;;;6041   //-----------------------------------------------
;;;6042   void avt_hndl(void)
003c1c  b570              PUSH     {r4-r6,lr}
;;;6043   {
;;;6044   char i;
;;;6045   for(i=0;i<12;i++)
003c1e  f04f0000          MOV      r0,#0
;;;6046   	{
;;;6047   	if(eb2_data_short[6]&(1<<i))
003c22  4930              LDR      r1,|L1.15588|
;;;6048   		{
;;;6049   		avt_stat[i]=avtON;
003c24  4d30              LDR      r5,|L1.15592|
003c26  f04f0401          MOV      r4,#1                 ;6047
003c2a  f9b1200c          LDRSH    r2,[r1,#0xc]          ;6047
003c2e  4603              MOV      r3,r0                 ;6045
                  |L1.15408|
003c30  fa04f100          LSL      r1,r4,r0              ;6047
003c34  420a              TST      r2,r1                 ;6047
003c36  d001              BEQ      |L1.15420|
003c38  542c              STRB     r4,[r5,r0]
003c3a  e000              B        |L1.15422|
                  |L1.15420|
;;;6050   		}
;;;6051   	else avt_stat[i]=avtOFF;
003c3c  542b              STRB     r3,[r5,r0]
                  |L1.15422|
003c3e  f1000001          ADD      r0,r0,#1              ;6045
003c42  b2c0              UXTB     r0,r0                 ;6045
003c44  280c              CMP      r0,#0xc               ;6045
003c46  d3f3              BCC      |L1.15408|
;;;6052   	}
;;;6053   
;;;6054   if((avt_stat_old[0]!=avt_stat[0])&&(NUMAVT>=1))
003c48  4e28              LDR      r6,|L1.15596|
003c4a  7828              LDRB     r0,[r5,#0]  ; avt_stat
003c4c  4c28              LDR      r4,|L1.15600|
003c4e  7831              LDRB     r1,[r6,#0]  ; avt_stat_old
003c50  4281              CMP      r1,r0
003c52  d00b              BEQ      |L1.15468|
003c54  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003c58  2901              CMP      r1,#1
003c5a  db07              BLT      |L1.15468|
;;;6055   	{
;;;6056   	if(avt_stat[0]==avtON) 	snmp_trap_send("Avtomat #1 is ON ",11,1,1);
003c5c  2801              CMP      r0,#1
003c5e  d02a              BEQ      |L1.15542|
;;;6057   	else 				snmp_trap_send("Avtomat #1 is OFF",11,1,0);
003c60  2300              MOVS     r3,#0
003c62  2201              MOVS     r2,#1
003c64  210b              MOVS     r1,#0xb
003c66  a023              ADR      r0,|L1.15604|
003c68  f7fffffe          BL       snmp_trap_send
                  |L1.15468|
;;;6058   	}
;;;6059   if((avt_stat_old[1]!=avt_stat[1])&&(NUMAVT>=2))
003c6c  7871              LDRB     r1,[r6,#1]  ; avt_stat_old
003c6e  7868              LDRB     r0,[r5,#1]  ; avt_stat
003c70  4281              CMP      r1,r0
003c72  d00b              BEQ      |L1.15500|
003c74  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003c78  2902              CMP      r1,#2
003c7a  db07              BLT      |L1.15500|
;;;6060   	{
;;;6061   	if(avt_stat[1]==avtON) 	snmp_trap_send("Avtomat #2 is ON ",11,2,1);
003c7c  2801              CMP      r0,#1
003c7e  d07e              BEQ      |L1.15742|
;;;6062   	else 				snmp_trap_send("Avtomat #2 is OFF",11,2,0);
003c80  2300              MOVS     r3,#0
003c82  2202              MOVS     r2,#2
003c84  210b              MOVS     r1,#0xb
003c86  a020              ADR      r0,|L1.15624|
003c88  f7fffffe          BL       snmp_trap_send
                  |L1.15500|
;;;6063   	}
;;;6064   if((avt_stat_old[2]!=avt_stat[2])&&(NUMAVT>=3))
003c8c  78b1              LDRB     r1,[r6,#2]  ; avt_stat_old
003c8e  78a8              LDRB     r0,[r5,#2]  ; avt_stat
003c90  4281              CMP      r1,r0
003c92  d00b              BEQ      |L1.15532|
003c94  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003c98  2903              CMP      r1,#3
003c9a  db07              BLT      |L1.15532|
;;;6065   	{
;;;6066   	if(avt_stat[2]==avtON) 	snmp_trap_send("Avtomat #3 is ON ",11,3,1);
003c9c  2801              CMP      r0,#1
003c9e  d06f              BEQ      |L1.15744|
;;;6067   	else 				snmp_trap_send("Avtomat #3 is OFF",11,3,0);
003ca0  2300              MOVS     r3,#0
003ca2  2203              MOVS     r2,#3
003ca4  210b              MOVS     r1,#0xb
003ca6  a01d              ADR      r0,|L1.15644|
003ca8  f7fffffe          BL       snmp_trap_send
                  |L1.15532|
;;;6068   	}
;;;6069   if((avt_stat_old[3]!=avt_stat[3])&&(NUMAVT>=4))
003cac  78f1              LDRB     r1,[r6,#3]  ; avt_stat_old
003cae  78e8              LDRB     r0,[r5,#3]  ; avt_stat
003cb0  4281              CMP      r1,r0
003cb2  d049              BEQ      |L1.15688|
003cb4  e03c              B        |L1.15664|
                  |L1.15542|
003cb6  e0a4              B        |L1.15874|
                  |L1.15544|
                          DCD      ica_u_necc
                  |L1.15548|
                          DCD      ICA_MODBUS_ADDRESS
                  |L1.15552|
                          DCD      ICA_CH
                  |L1.15556|
                          DCD      TBAT
                  |L1.15560|
                          DCD      ipsBlckStat
                  |L1.15564|
                          DCD      ipsBlckSrc
                  |L1.15568|
                          DCD      ipsBlckLog
                  |L1.15572|
                          DCD      ||.bss||+0x40c
                  |L1.15576|
                          DCD      bps
                  |L1.15580|
                          DCD      net_av
                  |L1.15584|
                          DCD      ||area_number.25||
                  |L1.15588|
                          DCD      eb2_data_short
                  |L1.15592|
                          DCD      avt_stat
                  |L1.15596|
                          DCD      avt_stat_old
                  |L1.15600|
                          DCD      NUMAVT
                  |L1.15604|
003cf4  4176746f          DCB      "Avtomat #1 is OFF",0
003cf8  6d617420
003cfc  23312069
003d00  73204f46
003d04  4600    
003d06  00                DCB      0
003d07  00                DCB      0
                  |L1.15624|
003d08  4176746f          DCB      "Avtomat #2 is OFF",0
003d0c  6d617420
003d10  23322069
003d14  73204f46
003d18  4600    
003d1a  00                DCB      0
003d1b  00                DCB      0
                  |L1.15644|
003d1c  4176746f          DCB      "Avtomat #3 is OFF",0
003d20  6d617420
003d24  23332069
003d28  73204f46
003d2c  4600    
003d2e  00                DCB      0
003d2f  00                DCB      0
                  |L1.15664|
003d30  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003d34  2904              CMP      r1,#4
003d36  db07              BLT      |L1.15688|
;;;6070   	{
;;;6071   	if(avt_stat[3]==avtON) 	snmp_trap_send("Avtomat #4 is ON ",11,4,1);
003d38  2801              CMP      r0,#1
003d3a  d078              BEQ      |L1.15918|
;;;6072   	else 				snmp_trap_send("Avtomat #4 is OFF",11,4,0);
003d3c  2300              MOVS     r3,#0
003d3e  2204              MOVS     r2,#4
003d40  210b              MOVS     r1,#0xb
003d42  a0ff              ADR      r0,|L1.16704|
003d44  f7fffffe          BL       snmp_trap_send
                  |L1.15688|
;;;6073   	}
;;;6074   if((avt_stat_old[4]!=avt_stat[4])&&(NUMAVT>=5))
003d48  7931              LDRB     r1,[r6,#4]  ; avt_stat_old
003d4a  7928              LDRB     r0,[r5,#4]  ; avt_stat
003d4c  4281              CMP      r1,r0
003d4e  d00b              BEQ      |L1.15720|
003d50  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003d54  2905              CMP      r1,#5
003d56  db07              BLT      |L1.15720|
;;;6075   	{
;;;6076   	if(avt_stat[4]==avtON) 	snmp_trap_send("Avtomat #5 is ON ",11,5,1);
003d58  2801              CMP      r0,#1
003d5a  d070              BEQ      |L1.15934|
;;;6077   	else 				snmp_trap_send("Avtomat #5 is OFF",11,5,0);
003d5c  2300              MOVS     r3,#0
003d5e  2205              MOVS     r2,#5
003d60  210b              MOVS     r1,#0xb
003d62  a0fc              ADR      r0,|L1.16724|
003d64  f7fffffe          BL       snmp_trap_send
                  |L1.15720|
;;;6078   	}
;;;6079   if((avt_stat_old[5]!=avt_stat[5])&&(NUMAVT>=6))
003d68  7971              LDRB     r1,[r6,#5]  ; avt_stat_old
003d6a  7968              LDRB     r0,[r5,#5]  ; avt_stat
003d6c  4281              CMP      r1,r0
003d6e  d00e              BEQ      |L1.15758|
003d70  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003d74  2906              CMP      r1,#6
003d76  db0a              BLT      |L1.15758|
;;;6080   	{
;;;6081   	if(avt_stat[5]==avtON) 	snmp_trap_send("Avtomat #6 is ON ",11,6,1);
003d78  2801              CMP      r0,#1
003d7a  d067              BEQ      |L1.15948|
;;;6082   	else 				snmp_trap_send("Avtomat #6 is OFF",11,6,0);
003d7c  e001              B        |L1.15746|
                  |L1.15742|
003d7e  e047              B        |L1.15888|
                  |L1.15744|
003d80  e04e              B        |L1.15904|
                  |L1.15746|
003d82  2300              MOVS     r3,#0
003d84  2206              MOVS     r2,#6
003d86  210b              MOVS     r1,#0xb
003d88  a0f7              ADR      r0,|L1.16744|
003d8a  f7fffffe          BL       snmp_trap_send
                  |L1.15758|
;;;6083   	}
;;;6084   if((avt_stat_old[6]!=avt_stat[6])&&(NUMAVT>=7))
003d8e  79b1              LDRB     r1,[r6,#6]  ; avt_stat_old
003d90  79a8              LDRB     r0,[r5,#6]  ; avt_stat
003d92  4281              CMP      r1,r0
003d94  d00b              BEQ      |L1.15790|
003d96  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003d9a  2907              CMP      r1,#7
003d9c  db07              BLT      |L1.15790|
;;;6085   	{
;;;6086   	if(avt_stat[6]==avtON) 	snmp_trap_send("Avtomat #7 is ON ",11,7,1);
003d9e  2801              CMP      r0,#1
003da0  d05b              BEQ      |L1.15962|
;;;6087   	else 				snmp_trap_send("Avtomat #7 is OFF",11,7,0);
003da2  2300              MOVS     r3,#0
003da4  2207              MOVS     r2,#7
003da6  210b              MOVS     r1,#0xb
003da8  a0f4              ADR      r0,|L1.16764|
003daa  f7fffffe          BL       snmp_trap_send
                  |L1.15790|
;;;6088   	}
;;;6089   if((avt_stat_old[7]!=avt_stat[7])&&(NUMAVT>=8))
003dae  79f1              LDRB     r1,[r6,#7]  ; avt_stat_old
003db0  79e8              LDRB     r0,[r5,#7]  ; avt_stat
003db2  4281              CMP      r1,r0
003db4  d00b              BEQ      |L1.15822|
003db6  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003dba  2908              CMP      r1,#8
003dbc  db07              BLT      |L1.15822|
;;;6090   	{
;;;6091   	if(avt_stat[7]==avtON) 	snmp_trap_send("Avtomat #8 is ON ",11,8,1);
003dbe  2801              CMP      r0,#1
003dc0  d052              BEQ      |L1.15976|
;;;6092   	else 				snmp_trap_send("Avtomat #8 is OFF",11,8,0);
003dc2  2300              MOVS     r3,#0
003dc4  2208              MOVS     r2,#8
003dc6  210b              MOVS     r1,#0xb
003dc8  a0f1              ADR      r0,|L1.16784|
003dca  f7fffffe          BL       snmp_trap_send
                  |L1.15822|
;;;6093   	}
;;;6094   if((avt_stat_old[8]!=avt_stat[8])&&(NUMAVT>=9))
003dce  7a31              LDRB     r1,[r6,#8]  ; avt_stat_old
003dd0  7a28              LDRB     r0,[r5,#8]  ; avt_stat
003dd2  4281              CMP      r1,r0
003dd4  d00b              BEQ      |L1.15854|
003dd6  f9b41000          LDRSH    r1,[r4,#0]  ; NUMAVT
003dda  2909              CMP      r1,#9
003ddc  db07              BLT      |L1.15854|
;;;6095   	{
;;;6096   	if(avt_stat[8]==avtON) 	snmp_trap_send("Avtomat #9 is ON ",11,9,1);
003dde  2801              CMP      r0,#1
003de0  d049              BEQ      |L1.15990|
;;;6097   	else 				snmp_trap_send("Avtomat #9 is OFF",11,9,0);
003de2  2300              MOVS     r3,#0
003de4  2209              MOVS     r2,#9
003de6  210b              MOVS     r1,#0xb
003de8  a0ee              ADR      r0,|L1.16804|
003dea  f7fffffe          BL       snmp_trap_send
                  |L1.15854|
;;;6098   	}
;;;6099   
;;;6100   for(i=0;i<12;i++)
003dee  f04f0000          MOV      r0,#0
                  |L1.15858|
;;;6101   	{
;;;6102   	avt_stat_old[i]=avt_stat[i];
003df2  5c29              LDRB     r1,[r5,r0]
003df4  5431              STRB     r1,[r6,r0]
003df6  f1000001          ADD      r0,r0,#1              ;6100
003dfa  b2c0              UXTB     r0,r0                 ;6100
003dfc  280c              CMP      r0,#0xc               ;6100
003dfe  d3f8              BCC      |L1.15858|
;;;6103   	}
;;;6104   }
003e00  bd70              POP      {r4-r6,pc}
                  |L1.15874|
003e02  2301              MOVS     r3,#1                 ;6056
003e04  461a              MOV      r2,r3                 ;6056
003e06  210b              MOVS     r1,#0xb               ;6056
003e08  a0eb              ADR      r0,|L1.16824|
003e0a  f7fffffe          BL       snmp_trap_send
003e0e  e72d              B        |L1.15468|
                  |L1.15888|
003e10  2301              MOVS     r3,#1                 ;6061
003e12  2202              MOVS     r2,#2                 ;6061
003e14  210b              MOVS     r1,#0xb               ;6061
003e16  a0ed              ADR      r0,|L1.16844|
003e18  f7fffffe          BL       snmp_trap_send
003e1c  e736              B        |L1.15500|
003e1e  e006              B        |L1.15918|
                  |L1.15904|
003e20  2301              MOVS     r3,#1                 ;6066
003e22  2203              MOVS     r2,#3                 ;6066
003e24  210b              MOVS     r1,#0xb               ;6066
003e26  a0ee              ADR      r0,|L1.16864|
003e28  f7fffffe          BL       snmp_trap_send
003e2c  e73e              B        |L1.15532|
                  |L1.15918|
003e2e  2301              MOVS     r3,#1                 ;6071
003e30  2204              MOVS     r2,#4                 ;6071
003e32  210b              MOVS     r1,#0xb               ;6071
003e34  a0ef              ADR      r0,|L1.16884|
003e36  f7fffffe          BL       snmp_trap_send
003e3a  e785              B        |L1.15688|
003e3c  e7ff              B        |L1.15934|
                  |L1.15934|
003e3e  2301              MOVS     r3,#1                 ;6076
003e40  2205              MOVS     r2,#5                 ;6076
003e42  210b              MOVS     r1,#0xb               ;6076
003e44  a0f0              ADR      r0,|L1.16904|
003e46  f7fffffe          BL       snmp_trap_send
003e4a  e78d              B        |L1.15720|
                  |L1.15948|
003e4c  2301              MOVS     r3,#1                 ;6081
003e4e  2206              MOVS     r2,#6                 ;6081
003e50  210b              MOVS     r1,#0xb               ;6081
003e52  a0f2              ADR      r0,|L1.16924|
003e54  f7fffffe          BL       snmp_trap_send
003e58  e799              B        |L1.15758|
                  |L1.15962|
003e5a  2301              MOVS     r3,#1                 ;6086
003e5c  2207              MOVS     r2,#7                 ;6086
003e5e  210b              MOVS     r1,#0xb               ;6086
003e60  a0f3              ADR      r0,|L1.16944|
003e62  f7fffffe          BL       snmp_trap_send
003e66  e7a2              B        |L1.15790|
                  |L1.15976|
003e68  2301              MOVS     r3,#1                 ;6091
003e6a  2208              MOVS     r2,#8                 ;6091
003e6c  210b              MOVS     r1,#0xb               ;6091
003e6e  a0f5              ADR      r0,|L1.16964|
003e70  f7fffffe          BL       snmp_trap_send
003e74  e7ab              B        |L1.15822|
                  |L1.15990|
003e76  2301              MOVS     r3,#1                 ;6096
003e78  2209              MOVS     r2,#9                 ;6096
003e7a  210b              MOVS     r1,#0xb               ;6096
003e7c  a0f6              ADR      r0,|L1.16984|
003e7e  f7fffffe          BL       snmp_trap_send
003e82  e7b4              B        |L1.15854|
;;;6105   
                          ENDP

                  bat_hndl PROC
;;;6106   //-----------------------------------------------
;;;6107   void bat_hndl(void)
003e84  b570              PUSH     {r4-r6,lr}
;;;6108   {
;;;6109   /*if(mess_find(_MESS_BAT_MASK_ON))
;;;6110   	{
;;;6111   	if(mess_data[0]==_MESS_BAT_MASK_ON)
;;;6112   		{
;;;6113   		char i;
;;;6114   		for(i=0;i<2;i++)
;;;6115   			{
;;;6116   			if(mess_data[1]&(1<<i))
;;;6117   				{
;;;6118   				bat[i]._cnt_to_block=0;
;;;6119        			bat[i]._rel_stat=0;
;;;6120        			}
;;;6121   			}
;;;6122   		}
;;;6123   	}
;;;6124   if(mess_find(_MESS_BAT_MASK_OFF))
;;;6125   	{		
;;;6126   	if(mess_data[0]==_MESS_BAT_MASK_OFF)
;;;6127   		{
;;;6128   		char i;
;;;6129   		for(i=0;i<2;i++)
;;;6130   			{
;;;6131   			if((mess_data[1]&(1<<i)) && (bat[i]._cnt_to_block==0) && (bat[i]._rel_stat==0))
;;;6132   				{
;;;6133   				bat[i]._cnt_to_block=20;
;;;6134   				bat[i]._rel_stat=1;
;;;6135        			}
;;;6136   			}
;;;6137   		
;;;6138   		}		
;;;6139   	}*/
;;;6140   
;;;6141   if(mess_find_unvol(MESS2BAT_HNDL))
003e86  20c8              MOVS     r0,#0xc8
003e88  f7fffffe          BL       mess_find_unvol
;;;6142   	{ 
;;;6143   	char i;
;;;6144   	
;;;6145   	if(mess_data[0]==PARAM_BAT_ALL_OFF_AFTER_2SEC)
;;;6146   		{
;;;6147   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;6148   			{
;;;6149   			if(bat[i]._cnt_to_block<50)bat[i]._cnt_to_block++;
003e8c  49f7              LDR      r1,|L1.17004|
003e8e  2200              MOVS     r2,#0                 ;6147
003e90  b3a8              CBZ      r0,|L1.16126|
003e92  4bf7              LDR      r3,|L1.17008|
;;;6150   			}
;;;6151   		}
;;;6152   
;;;6153   	else if(mess_data[0]==PARAM_BAT_MASK_OFF_AFTER_2SEC)
;;;6154   		{
;;;6155   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;6156   			{
;;;6157   			if(mess_data[1]&(1<<i))
003e94  2401              MOVS     r4,#1
003e96  6818              LDR      r0,[r3,#0]            ;6145  ; mess_data
003e98  28c9              CMP      r0,#0xc9              ;6145
003e9a  d01c              BEQ      |L1.16086|
003e9c  28ca              CMP      r0,#0xca              ;6153
003e9e  d02f              BEQ      |L1.16128|
;;;6158   				{
;;;6159   				if(bat[i]._cnt_to_block<50) bat[i]._cnt_to_block++;
;;;6160   				}
;;;6161   			else bat[i]._cnt_to_block=0;
;;;6162   			}
;;;6163   		}
;;;6164   	else 
;;;6165   	 	{
;;;6166   		for(i=0;i<MAX_NUM_OF_BAT;i++)
003ea0  4610              MOV      r0,r2
                  |L1.16034|
;;;6167   			{
;;;6168   			bat[i]._cnt_to_block=0;
003ea2  eb000340          ADD      r3,r0,r0,LSL #1
003ea6  eb031300          ADD      r3,r3,r0,LSL #4
003eaa  f8012023          STRB     r2,[r1,r3,LSL #2]
003eae  f1000001          ADD      r0,r0,#1              ;6166
003eb2  b2c0              UXTB     r0,r0                 ;6166
003eb4  2802              CMP      r0,#2                 ;6166
003eb6  d3f4              BCC      |L1.16034|
                  |L1.16056|
;;;6169   			}
;;;6170   
;;;6171   		}
;;;6172   	for(i=0;i<MAX_NUM_OF_BAT;i++)
003eb8  f04f0000          MOV      r0,#0
                  |L1.16060|
;;;6173   		{
;;;6174   		if(bat[i]._cnt_to_block>20)bat[i]._rel_stat=1;
003ebc  eb000340          ADD      r3,r0,r0,LSL #1
003ec0  eb031300          ADD      r3,r3,r0,LSL #4
003ec4  f8115023          LDRB     r5,[r1,r3,LSL #2]
003ec8  2d14              CMP      r5,#0x14
003eca  d939              BLS      |L1.16192|
003ecc  eb010383          ADD      r3,r1,r3,LSL #2
003ed0  f883403c          STRB     r4,[r3,#0x3c]
003ed4  e038              B        |L1.16200|
                  |L1.16086|
003ed6  f04f0000          MOV      r0,#0                 ;6147
                  |L1.16090|
003eda  eb000340          ADD      r3,r0,r0,LSL #1       ;6149
003ede  eb031500          ADD      r5,r3,r0,LSL #4       ;6149
003ee2  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;6149
003ee6  2b32              CMP      r3,#0x32              ;6149
003ee8  d203              BCS      |L1.16114|
003eea  f1030301          ADD      r3,r3,#1              ;6149
003eee  f8013025          STRB     r3,[r1,r5,LSL #2]     ;6149
                  |L1.16114|
003ef2  f1000001          ADD      r0,r0,#1              ;6147
003ef6  b2c0              UXTB     r0,r0                 ;6147
003ef8  2802              CMP      r0,#2                 ;6147
003efa  d3ee              BCC      |L1.16090|
003efc  e7dc              B        |L1.16056|
                  |L1.16126|
003efe  e029              B        |L1.16212|
                  |L1.16128|
003f00  f04f0000          MOV      r0,#0                 ;6155
003f04  685e              LDR      r6,[r3,#4]            ;6157
                  |L1.16134|
003f06  fa04f300          LSL      r3,r4,r0              ;6157
003f0a  421e              TST      r6,r3                 ;6157
003f0c  d00c              BEQ      |L1.16168|
003f0e  eb000340          ADD      r3,r0,r0,LSL #1       ;6159
003f12  eb031500          ADD      r5,r3,r0,LSL #4       ;6159
003f16  f8113025          LDRB     r3,[r1,r5,LSL #2]     ;6159
003f1a  2b32              CMP      r3,#0x32              ;6159
003f1c  d20a              BCS      |L1.16180|
003f1e  f1030301          ADD      r3,r3,#1              ;6159
003f22  f8013025          STRB     r3,[r1,r5,LSL #2]     ;6159
003f26  e005              B        |L1.16180|
                  |L1.16168|
003f28  eb000340          ADD      r3,r0,r0,LSL #1       ;6161
003f2c  eb031300          ADD      r3,r3,r0,LSL #4       ;6161
003f30  f8012023          STRB     r2,[r1,r3,LSL #2]     ;6161
                  |L1.16180|
003f34  f1000001          ADD      r0,r0,#1              ;6155
003f38  b2c0              UXTB     r0,r0                 ;6155
003f3a  2802              CMP      r0,#2                 ;6155
003f3c  d3e3              BCC      |L1.16134|
003f3e  e7bb              B        |L1.16056|
                  |L1.16192|
;;;6175   		else bat[i]._rel_stat=0;
003f40  eb010383          ADD      r3,r1,r3,LSL #2
003f44  f883203c          STRB     r2,[r3,#0x3c]
                  |L1.16200|
003f48  f1000001          ADD      r0,r0,#1              ;6172
003f4c  b2c0              UXTB     r0,r0                 ;6172
003f4e  2802              CMP      r0,#2                 ;6172
003f50  d3b4              BCC      |L1.16060|
;;;6176   		}
;;;6177   
;;;6178   	}
;;;6179   
;;;6180   else 
;;;6181   	{
;;;6182   	char i;
;;;6183   	for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;6184   		{
;;;6185   		bat[i]._cnt_to_block=0;
;;;6186   		bat[i]._rel_stat=0;
;;;6187   		}
;;;6188   
;;;6189   	}
;;;6190   
;;;6191   /*if(mess_find_unvol(MESS2BAT_HNDL1))
;;;6192   	{
;;;6193   	if(PARAM_BAT_ON)
;;;6194   		{
;;;6195   		char i;
;;;6196   		for(i=0;i<MAX_NUM_OF_BAT;i++)
;;;6197   			{
;;;6198   			if(mess_data[1]&(1<<i))
;;;6199   				{
;;;6200   				bat[i]._cnt_to_block=0;
;;;6201   				bat[i]._rel_stat=0;
;;;6202   				}
;;;6203   			}
;;;6204   		}
;;;6205   	} */
;;;6206   }
003f52  bd70              POP      {r4-r6,pc}
                  |L1.16212|
003f54  f04f0000          MOV      r0,#0                 ;6183
                  |L1.16216|
003f58  eb000340          ADD      r3,r0,r0,LSL #1       ;6185
003f5c  eb031300          ADD      r3,r3,r0,LSL #4       ;6185
003f60  f8012023          STRB     r2,[r1,r3,LSL #2]     ;6185
003f64  eb010383          ADD      r3,r1,r3,LSL #2       ;6186
003f68  f883203c          STRB     r2,[r3,#0x3c]         ;6186
003f6c  f1000001          ADD      r0,r0,#1              ;6183
003f70  b2c0              UXTB     r0,r0                 ;6183
003f72  2802              CMP      r0,#2                 ;6183
003f74  d3f0              BCC      |L1.16216|
003f76  bd70              POP      {r4-r6,pc}
;;;6207   
                          ENDP

                  bat_drv PROC
;;;6845   //-----------------------------------------------
;;;6846   void bat_drv(char in)
003f78  e92d4ffe          PUSH     {r1-r11,lr}
;;;6847   {
003f7c  4605              MOV      r5,r0
;;;6848   unsigned short /*tempUS,*/tempUS_;
;;;6849   unsigned long tempUL,tempUL_;
;;;6850   unsigned short b_zar;
;;;6851   //static unsigned short time_cnt[2];
;;;6852   
;;;6853   
;;;6854   
;;;6855   if(cntrl_stat_blok_cnt_plus[in])cntrl_stat_blok_cnt_plus[in]--;
003f7e  49bd              LDR      r1,|L1.17012|
003f80  f9310015          LDRSH    r0,[r1,r5,LSL #1]
003f84  b118              CBZ      r0,|L1.16270|
003f86  f1a00001          SUB      r0,r0,#1
003f8a  f8210015          STRH     r0,[r1,r5,LSL #1]
                  |L1.16270|
;;;6856   if(cntrl_stat_blok_cnt_minus[in])cntrl_stat_blok_cnt_minus[in]--;
003f8e  4ab9              LDR      r2,|L1.17012|
003f90  1d12              ADDS     r2,r2,#4
003f92  f9320015          LDRSH    r0,[r2,r5,LSL #1]
003f96  b118              CBZ      r0,|L1.16288|
003f98  f1a00001          SUB      r0,r0,#1
003f9c  f8220015          STRH     r0,[r2,r5,LSL #1]
                  |L1.16288|
;;;6857   
;;;6858   
;;;6859   if(bat[in]._Ib>IZMAX) cntrl_stat_blok_cnt_plus[in]=100;
003fa0  eb050045          ADD      r0,r5,r5,LSL #1
003fa4  4bb1              LDR      r3,|L1.17004|
003fa6  eb001005          ADD      r0,r0,r5,LSL #4
003faa  eb030480          ADD      r4,r3,r0,LSL #2
003fae  4bb2              LDR      r3,|L1.17016|
003fb0  9002              STR      r0,[sp,#8]
003fb2  f9b40008          LDRSH    r0,[r4,#8]
003fb6  f9b33000          LDRSH    r3,[r3,#0]  ; IZMAX
003fba  f04f0b64          MOV      r11,#0x64
003fbe  4298              CMP      r0,r3
003fc0  dd01              BLE      |L1.16326|
003fc2  f821b015          STRH     r11,[r1,r5,LSL #1]
                  |L1.16326|
;;;6860   if(bat[in]._Ib<0)     cntrl_stat_blok_cnt_minus[in]=100;
003fc6  2800              CMP      r0,#0
003fc8  da01              BGE      |L1.16334|
003fca  f822b015          STRH     r11,[r2,r5,LSL #1]
                  |L1.16334|
;;;6861   
;;;6862   if(cntrl_stat_blok_cnt_plus[in] && cntrl_stat_blok_cnt_minus[in])
;;;6863        {
;;;6864        if(!cntrl_stat_blok_cnt_)
003fce  48a9              LDR      r0,|L1.17012|
003fd0  f8313015          LDRH     r3,[r1,r5,LSL #1]     ;6862
003fd4  38ac              SUBS     r0,r0,#0xac
003fd6  2700              MOVS     r7,#0
003fd8  b14b              CBZ      r3,|L1.16366|
003fda  f8323015          LDRH     r3,[r2,r5,LSL #1]     ;6862
003fde  b133              CBZ      r3,|L1.16366|
003fe0  f8b03070          LDRH     r3,[r0,#0x70]  ; cntrl_stat_blok_cnt_
003fe4  b1a3              CBZ      r3,|L1.16400|
;;;6865             {
;;;6866             cntrl_stat_blok_cnt_=600; 
;;;6867             cntrl_stat_blok_cnt_plus[in]=0;
;;;6868             cntrl_stat_blok_cnt_minus[in]=0;
;;;6869             }
;;;6870        else cntrl_stat_blok_cnt=3000;
003fe6  f64031b8          MOV      r1,#0xbb8
003fea  f8a0106e          STRH     r1,[r0,#0x6e]
                  |L1.16366|
;;;6871        }
;;;6872   cntrl_stat_blok_cnt=0;
003fee  f8a0706e          STRH     r7,[r0,#0x6e]
;;;6873   
;;;6874   if(++(bat[in]._time_cnt)>=10)
003ff2  f894003e          LDRB     r0,[r4,#0x3e]
003ff6  1c40              ADDS     r0,r0,#1
003ff8  b2c0              UXTB     r0,r0
003ffa  f884003e          STRB     r0,[r4,#0x3e]
003ffe  280a              CMP      r0,#0xa
004000  d301              BCC      |L1.16390|
;;;6875   	{
;;;6876   	bat[in]._time_cnt=0;
004002  f884703e          STRB     r7,[r4,#0x3e]
                  |L1.16390|
;;;6877   	//bat[in]._zar_cnt++;
;;;6878   	}
;;;6879   
;;;6880   if(main_10Hz_cnt==50)
004006  4e9d              LDR      r6,|L1.17020|
004008  8830              LDRH     r0,[r6,#0]  ; main_10Hz_cnt
00400a  2832              CMP      r0,#0x32
00400c  d009              BEQ      |L1.16418|
00400e  e017              B        |L1.16448|
                  |L1.16400|
004010  f44f7316          MOV      r3,#0x258             ;6866
004014  f8a03070          STRH     r3,[r0,#0x70]         ;6866
004018  f8217015          STRH     r7,[r1,r5,LSL #1]     ;6867
00401c  f8227015          STRH     r7,[r2,r5,LSL #1]     ;6868
004020  e7e5              B        |L1.16366|
                  |L1.16418|
;;;6881   	{
;;;6882   	if(!bat[in]._rel_stat)
004022  f894003c          LDRB     r0,[r4,#0x3c]
004026  b958              CBNZ     r0,|L1.16448|
;;;6883   		{
;;;6884   		
;;;6885   		if(bat[in]._Ub<80) 
004028  f9b40002          LDRSH    r0,[r4,#2]
00402c  2850              CMP      r0,#0x50
00402e  da07              BGE      |L1.16448|
;;;6886   			{
;;;6887   			
;;;6888   			if(!(bat[in]._av&1))
004030  f894003d          LDRB     r0,[r4,#0x3d]
004034  07c0              LSLS     r0,r0,#31
004036  d103              BNE      |L1.16448|
;;;6889   				{
;;;6890   				avar_bat_hndl(in,1);
004038  2101              MOVS     r1,#1
00403a  4628              MOV      r0,r5
00403c  f7fffffe          BL       avar_bat_hndl
                  |L1.16448|
;;;6891   				//if(in==0)plazma_bat++;
;;;6892   				}
;;;6893   			}				
;;;6894   
;;;6895   		}
;;;6896   	}
;;;6897   
;;;6898   if(main_10Hz_cnt>200)
004040  f9b60000          LDRSH    r0,[r6,#0]  ; main_10Hz_cnt
;;;6899   	{
;;;6900   	if(abs(bat[in]._Ib)>IKB) 
004044  4e8e              LDR      r6,|L1.17024|
004046  28c8              CMP      r0,#0xc8              ;6898
004048  dd0f              BLE      |L1.16490|
00404a  f9b40008          LDRSH    r0,[r4,#8]
00404e  f7fffffe          BL       abs
004052  f9b61000          LDRSH    r1,[r6,#0]  ; IKB
004056  4288              CMP      r0,r1
004058  dd07              BLE      |L1.16490|
;;;6901   		{
;;;6902   		if((bat[in]._av&1))avar_bat_hndl(in,0);
00405a  f894003d          LDRB     r0,[r4,#0x3d]
00405e  07c0              LSLS     r0,r0,#31
004060  d003              BEQ      |L1.16490|
004062  2100              MOVS     r1,#0
004064  4628              MOV      r0,r5
004066  f7fffffe          BL       avar_bat_hndl
                  |L1.16490|
;;;6903   		}
;;;6904   	}
;;;6905   
;;;6906   #ifdef APSENERGIA
;;;6907   //if(bat[in]._Ib>(-IKB))
;;;6908   
;;;6909   
;;;6910   #endif
;;;6911   
;;;6912   if(bat[in]._Ib>(-IKB))
00406a  4885              LDR      r0,|L1.17024|
00406c  f9b41008          LDRSH    r1,[r4,#8]
004070  f9b00000          LDRSH    r0,[r0,#0]  ; IKB
004074  4240              RSBS     r0,r0,#0
004076  4281              CMP      r1,r0
004078  dd14              BLE      |L1.16548|
;;;6913   	{
;;;6914   	if(bat[in]._cnt_wrk<10)
00407a  7b60              LDRB     r0,[r4,#0xd]
00407c  280a              CMP      r0,#0xa
00407e  d20d              BCS      |L1.16540|
;;;6915   		{
;;;6916   		bat[in]._cnt_wrk++;
004080  f1000001          ADD      r0,r0,#1
004084  b2c0              UXTB     r0,r0
004086  7360              STRB     r0,[r4,#0xd]
;;;6917   		if((bat[in]._cnt_wrk>=10)&&(bat[in]._wrk)) 
004088  280a              CMP      r0,#0xa
00408a  d306              BCC      |L1.16538|
00408c  7ba0              LDRB     r0,[r4,#0xe]
00408e  2800              CMP      r0,#0
004090  d003              BEQ      |L1.16538|
;;;6918   			{
;;;6919   			bat[in]._wrk=0;
004092  73a7              STRB     r7,[r4,#0xe]
;;;6920   			//beep_init(0x7L,'O');
;;;6921   			//wrk_mem_hndl(0);
;;;6922   			wrk_mem_hndl(in);
004094  4628              MOV      r0,r5
004096  f7fffffe          BL       wrk_mem_hndl
                  |L1.16538|
00409a  e110              B        |L1.17086|
                  |L1.16540|
;;;6923   			//plazma++;
;;;6924   			}
;;;6925   		}
;;;6926   	else bat[in]._cnt_wrk=10;	
00409c  f04f000a          MOV      r0,#0xa
0040a0  7360              STRB     r0,[r4,#0xd]
0040a2  e10c              B        |L1.17086|
                  |L1.16548|
;;;6927   	}	
;;;6928   
;;;6929   else if(bat[in]._Ib<(-IKB))
0040a4  da40              BGE      |L1.16680|
;;;6930   	{
;;;6931   	if(bat[in]._cnt_wrk)
0040a6  7b60              LDRB     r0,[r4,#0xd]
0040a8  b3f0              CBZ      r0,|L1.16680|
;;;6932   		{
;;;6933   		bat[in]._cnt_wrk--;
0040aa  f1a00001          SUB      r0,r0,#1
0040ae  b2c0              UXTB     r0,r0
0040b0  7360              STRB     r0,[r4,#0xd]
;;;6934   		if((bat[in]._cnt_wrk==0)&&(bat[in]._wrk==0)) 
0040b2  bbc8              CBNZ     r0,|L1.16680|
0040b4  7ba0              LDRB     r0,[r4,#0xe]
0040b6  bbb8              CBNZ     r0,|L1.16680|
;;;6935   			{
;;;6936   			bat[in]._wrk=1;
0040b8  f04f0001          MOV      r0,#1
0040bc  73a0              STRB     r0,[r4,#0xe]
;;;6937   
;;;6938   				{
;;;6939   				char temp;
;;;6940   				signed short temp_temp;
;;;6941   				temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)];
0040be  4871              LDR      r0,|L1.17028|
0040c0  8800              LDRH     r0,[r0,#0]  ; bat_u_old_cnt
0040c2  f1000001          ADD      r0,r0,#1
0040c6  f0000007          AND      r0,r0,#7
0040ca  eb040040          ADD      r0,r4,r0,LSL #1
0040ce  8c00              LDRH     r0,[r0,#0x20]
0040d0  9000              STR      r0,[sp,#0]
;;;6942   			 
;;;6943   				temp=LPC_RTC->YEAR;
0040d2  4e6d              LDR      r6,|L1.17032|
0040d4  8bb0              LDRH     r0,[r6,#0x1c]
0040d6  9001              STR      r0,[sp,#4]
;;;6944   				gran_char((signed char*)&temp,1,99);
0040d8  f04f0263          MOV      r2,#0x63
0040dc  f04f0101          MOV      r1,#1
0040e0  a801              ADD      r0,sp,#4
0040e2  f7fffffe          BL       gran_char
;;;6945   				*((char*)(&(bat[in]._wrk_date[0])))=temp;
0040e6  f104041c          ADD      r4,r4,#0x1c
0040ea  f89d0004          LDRB     r0,[sp,#4]
0040ee  7620              STRB     r0,[r4,#0x18]
;;;6946   			
;;;6947   				temp=LPC_RTC->MONTH;
0040f0  7e30              LDRB     r0,[r6,#0x18]
0040f2  9001              STR      r0,[sp,#4]
;;;6948   				gran_char((signed char*)&temp,1,12);
0040f4  f04f020c          MOV      r2,#0xc
0040f8  f04f0101          MOV      r1,#1
0040fc  a801              ADD      r0,sp,#4
0040fe  f7fffffe          BL       gran_char
;;;6949   				*(((char*)(&(bat[in]._wrk_date[0])))+1)=temp;
004102  f89d0004          LDRB     r0,[sp,#4]
004106  7660              STRB     r0,[r4,#0x19]
;;;6950   			
;;;6951   				temp=LPC_RTC->DOM;
004108  7b30              LDRB     r0,[r6,#0xc]
00410a  9001              STR      r0,[sp,#4]
;;;6952   				gran_char((signed char*)&temp,1,31);
00410c  221f              MOVS     r2,#0x1f
00410e  2101              MOVS     r1,#1
004110  a801              ADD      r0,sp,#4
004112  f7fffffe          BL       gran_char
;;;6953   				*(((char*)(&(bat[in]._wrk_date[0])))+2)=temp;			
004116  f89d0004          LDRB     r0,[sp,#4]
00411a  76a0              STRB     r0,[r4,#0x1a]
;;;6954   				
;;;6955   				*(((char*)(&(bat[in]._wrk_date[0])))+3)=*((char*)&temp_temp);
00411c  f89d0000          LDRB     r0,[sp,#0]
004120  76e0              STRB     r0,[r4,#0x1b]
;;;6956   
;;;6957   				temp=LPC_RTC->HOUR;
004122  7a30              LDRB     r0,[r6,#8]
004124  9001              STR      r0,[sp,#4]
;;;6958   				gran_char((signed char*)&temp,0,23);
004126  e000              B        |L1.16682|
                  |L1.16680|
004128  e0c9              B        |L1.17086|
                  |L1.16682|
00412a  2217              MOVS     r2,#0x17
00412c  2100              MOVS     r1,#0
00412e  a801              ADD      r0,sp,#4
004130  f7fffffe          BL       gran_char
;;;6959   				*((char*)(&(bat[in]._wrk_date[1])))=temp;
004134  f89d0004          LDRB     r0,[sp,#4]
004138  7720              STRB     r0,[r4,#0x1c]
;;;6960                  	
;;;6961   				temp=LPC_RTC->MIN;
00413a  7930              LDRB     r0,[r6,#4]
00413c  9001              STR      r0,[sp,#4]
;;;6962   				gran_char((signed char*)&temp,0,59);
00413e  e0a5              B        |L1.17036|
                  |L1.16704|
004140  4176746f          DCB      "Avtomat #4 is OFF",0
004144  6d617420
004148  23342069
00414c  73204f46
004150  4600    
004152  00                DCB      0
004153  00                DCB      0
                  |L1.16724|
004154  4176746f          DCB      "Avtomat #5 is OFF",0
004158  6d617420
00415c  23352069
004160  73204f46
004164  4600    
004166  00                DCB      0
004167  00                DCB      0
                  |L1.16744|
004168  4176746f          DCB      "Avtomat #6 is OFF",0
00416c  6d617420
004170  23362069
004174  73204f46
004178  4600    
00417a  00                DCB      0
00417b  00                DCB      0
                  |L1.16764|
00417c  4176746f          DCB      "Avtomat #7 is OFF",0
004180  6d617420
004184  23372069
004188  73204f46
00418c  4600    
00418e  00                DCB      0
00418f  00                DCB      0
                  |L1.16784|
004190  4176746f          DCB      "Avtomat #8 is OFF",0
004194  6d617420
004198  23382069
00419c  73204f46
0041a0  4600    
0041a2  00                DCB      0
0041a3  00                DCB      0
                  |L1.16804|
0041a4  4176746f          DCB      "Avtomat #9 is OFF",0
0041a8  6d617420
0041ac  23392069
0041b0  73204f46
0041b4  4600    
0041b6  00                DCB      0
0041b7  00                DCB      0
                  |L1.16824|
0041b8  4176746f          DCB      "Avtomat #1 is ON ",0
0041bc  6d617420
0041c0  23312069
0041c4  73204f4e
0041c8  2000    
0041ca  00                DCB      0
0041cb  00                DCB      0
                  |L1.16844|
0041cc  4176746f          DCB      "Avtomat #2 is ON ",0
0041d0  6d617420
0041d4  23322069
0041d8  73204f4e
0041dc  2000    
0041de  00                DCB      0
0041df  00                DCB      0
                  |L1.16864|
0041e0  4176746f          DCB      "Avtomat #3 is ON ",0
0041e4  6d617420
0041e8  23332069
0041ec  73204f4e
0041f0  2000    
0041f2  00                DCB      0
0041f3  00                DCB      0
                  |L1.16884|
0041f4  4176746f          DCB      "Avtomat #4 is ON ",0
0041f8  6d617420
0041fc  23342069
004200  73204f4e
004204  2000    
004206  00                DCB      0
004207  00                DCB      0
                  |L1.16904|
004208  4176746f          DCB      "Avtomat #5 is ON ",0
00420c  6d617420
004210  23352069
004214  73204f4e
004218  2000    
00421a  00                DCB      0
00421b  00                DCB      0
                  |L1.16924|
00421c  4176746f          DCB      "Avtomat #6 is ON ",0
004220  6d617420
004224  23362069
004228  73204f4e
00422c  2000    
00422e  00                DCB      0
00422f  00                DCB      0
                  |L1.16944|
004230  4176746f          DCB      "Avtomat #7 is ON ",0
004234  6d617420
004238  23372069
00423c  73204f4e
004240  2000    
004242  00                DCB      0
004243  00                DCB      0
                  |L1.16964|
004244  4176746f          DCB      "Avtomat #8 is ON ",0
004248  6d617420
00424c  23382069
004250  73204f4e
004254  2000    
004256  00                DCB      0
004257  00                DCB      0
                  |L1.16984|
004258  4176746f          DCB      "Avtomat #9 is ON ",0
00425c  6d617420
004260  23392069
004264  73204f4e
004268  2000    
00426a  00                DCB      0
00426b  00                DCB      0
                  |L1.17004|
                          DCD      bat
                  |L1.17008|
                          DCD      mess_data
                  |L1.17012|
                          DCD      ||area_number.25||+0xac
                  |L1.17016|
                          DCD      IZMAX
                  |L1.17020|
                          DCD      main_10Hz_cnt
                  |L1.17024|
                          DCD      IKB
                  |L1.17028|
                          DCD      bat_u_old_cnt
                  |L1.17032|
                          DCD      0x40024020
                  |L1.17036|
00428c  223b              MOVS     r2,#0x3b
00428e  2100              MOVS     r1,#0
004290  a801              ADD      r0,sp,#4
004292  f7fffffe          BL       gran_char
;;;6963   				*(((char*)(&(bat[in]._wrk_date[1])))+1)=temp;
004296  f89d0004          LDRB     r0,[sp,#4]
00429a  7760              STRB     r0,[r4,#0x1d]
;;;6964   	          
;;;6965   				temp=LPC_RTC->SEC;
00429c  7830              LDRB     r0,[r6,#0]
00429e  9001              STR      r0,[sp,#4]
;;;6966   				gran_char((signed char*)&temp,0,59);
0042a0  223b              MOVS     r2,#0x3b
0042a2  2100              MOVS     r1,#0
0042a4  a801              ADD      r0,sp,#4
0042a6  f7fffffe          BL       gran_char
;;;6967   				*(((char*)(&(bat[in]._wrk_date[1])))+2)=temp;
0042aa  f89d0004          LDRB     r0,[sp,#4]
0042ae  77a0              STRB     r0,[r4,#0x1e]
;;;6968   			
;;;6969   				*(((char*)(&(bat[in]._wrk_date[1])))+3)=*(((char*)&temp_temp)+1);
0042b0  f89d0001          LDRB     r0,[sp,#1]
0042b4  77e0              STRB     r0,[r4,#0x1f]
;;;6970   				bat[in]._Iintegr=0;		//Счетчик десятков милиамперсекунд
0042b6  8027              STRH     r7,[r4,#0]
;;;6971   				bat[in]._Iintegr_=0;	//Счетчик сотен милиамперчасов
0042b8  8067              STRH     r7,[r4,#2]
0042ba  f1a4041c          SUB      r4,r4,#0x1c
                  |L1.17086|
;;;6972   				}
;;;6973   	
;;;6974   			}
;;;6975   
;;;6976   		}
;;;6977   	else bat[in]._cnt_wrk=0;	 
;;;6978   	
;;;6979   	}					
;;;6980   
;;;6981   /*
;;;6982   if(Ibat>=(-IKB))
;;;6983   	{
;;;6984   	if(cnt_wrk<10)
;;;6985   		{
;;;6986   		cnt_wrk++;
;;;6987   		if((cnt_wrk>=10)&&(wrk!=wrkOFF)) 
;;;6988   			{
;;;6989   			wrk=wrkOFF;
;;;6990   			//beep_init(0x7L,'O');
;;;6991   			wrk_mem_hndl(ibat_integr);
;;;6992   			}
;;;6993   		}
;;;6994   	else cnt_wrk=10;	
;;;6995   	}	
;;;6996   
;;;6997   else if((Ibat<(-IKB))&&(spc_stat!=spc_KE))
;;;6998   	{
;;;6999   	if(cnt_wrk)
;;;7000   		{
;;;7001   		cnt_wrk--;
;;;7002   		if((cnt_wrk==0)&&(wrk!=wrkON)) 
;;;7003   			{
;;;7004   			char temp;
;;;7005   			signed short temp_temp;
;;;7006   			temp_temp=ubat_old[((ubat_old_cnt+1)&0x07)];
;;;7007   			 
;;;7008   			wrk=wrkON;
;;;7009   			
;;;7010   			temp=_year;
;;;7011   			gran_char(&temp,1,99);
;;;7012   			*((char*)(&(wrk_date[0])))=temp;
;;;7013   			
;;;7014   			temp=_month;
;;;7015   			gran_char(&temp,1,12);
;;;7016   			*(((char*)(&(wrk_date[0])))+1)=temp;
;;;7017   			
;;;7018   			temp=_date;
;;;7019   			gran_char(&temp,1,31);
;;;7020   			*(((char*)(&(wrk_date[0])))+2)=temp;			
;;;7021   				
;;;7022   			*(((char*)(&(wrk_date[0])))+3)=*((char*)&temp_temp);
;;;7023   
;;;7024   			temp=_hour;
;;;7025   			gran_char(&temp,0,23);
;;;7026   			*((char*)(&(wrk_date[1])))=temp;
;;;7027                  
;;;7028   			temp=_min;
;;;7029   			gran_char(&temp,0,59);
;;;7030   			*(((char*)(&(wrk_date[1])))+1)=temp;
;;;7031   	          
;;;7032   			temp=_sec;
;;;7033   			gran_char(&temp,0,59);
;;;7034   			*(((char*)(&(wrk_date[1])))+2)=temp;
;;;7035   			
;;;7036   			*(((char*)(&(wrk_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;7037   
;;;7038   			
;;;7039   			//beep_init(0xFL,'O'); 
;;;7040   			ibat_integr=0;
;;;7041   			ibat_integr_=0;
;;;7042   			}
;;;7043   		}
;;;7044   	else cnt_wrk=0;	 
;;;7045   	
;;;7046   	}
;;;7047   if(wrk==wrkON)
;;;7048   	{
;;;7049   	ibat_integr_+=-Ibat;
;;;7050   	if(ibat_integr_>=SEC_IN_HOUR*10L)
;;;7051   		{
;;;7052   		ibat_integr_-=SEC_IN_HOUR*10L;
;;;7053   		ibat_integr++;
;;;7054   		}
;;;7055   	}
;;;7056   
;;;7057   */
;;;7058   
;;;7059   
;;;7060   /*if(bat[in]._cnt_to_block)
;;;7061   	{
;;;7062   	bat[in]._cnt_to_block--;
;;;7063   	if(!(bat[in]._cnt_to_block))
;;;7064   		{
;;;7065   		//bat[in]._rel_stat=1;
;;;7066   		}
;;;7067   	}
;;;7068   */
;;;7069   
;;;7070   
;;;7071   
;;;7072   
;;;7073   //unsigned int tempUI,tempUI_;
;;;7074   //unsigned int b_zar; 
;;;7075   //char i;
;;;7076   //Ibat[0]=5000;                     
;;;7077   
;;;7078   
;;;7079                               
;;;7080   if(bat[in]._time_cnt==0)
;;;7081   	{
;;;7082   	bat[in]._zar_cnt+=(signed long)bat[in]._Ib;
;;;7083   	
;;;7084   	if(bat[in]._zar_cnt>=AH_CONSTANT)
0042be  f64848a0          MOV      r8,#0x8ca0
0042c2  f894003e          LDRB     r0,[r4,#0x3e]         ;7080
0042c6  2800              CMP      r0,#0                 ;7080
0042c8  d17e              BNE      |L1.17352|
0042ca  f9b41008          LDRSH    r1,[r4,#8]            ;7082
0042ce  6960              LDR      r0,[r4,#0x14]         ;7082
0042d0  4408              ADD      r0,r0,r1              ;7082
0042d2  6160              STR      r0,[r4,#0x14]         ;7082
;;;7085   		{
;;;7086   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
;;;7087   		else tempUS_=BAT_C_REAL[in];
;;;7088   		
;;;7089   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
0042d4  f8df940c          LDR      r9,|L1.18148|
0042d8  f8dfa40c          LDR      r10,|L1.18152|
0042dc  4540              CMP      r0,r8                 ;7084
0042de  db2a              BLT      |L1.17206|
0042e0  f93a1015          LDRSH    r1,[r10,r5,LSL #1]    ;7086
0042e4  f5a140aa          SUB      r0,r1,#0x5500         ;7086
0042e8  3855              SUBS     r0,r0,#0x55           ;7086
0042ea  d103              BNE      |L1.17140|
0042ec  48ff              LDR      r0,|L1.18156|
0042ee  f8306015          LDRH     r6,[r0,r5,LSL #1]     ;7086
0042f2  e001              B        |L1.17144|
                  |L1.17140|
0042f4  f83a6015          LDRH     r6,[r10,r5,LSL #1]    ;7087
                  |L1.17144|
0042f8  f8390015          LDRH     r0,[r9,r5,LSL #1]
0042fc  f7fffffe          BL       lc640_read_int
004300  b280              UXTH     r0,r0
;;;7090   
;;;7091   		if(b_zar<(tempUS_/**10*/))
004302  42b0              CMP      r0,r6
004304  d20e              BCS      |L1.17188|
;;;7092   			{
;;;7093   			bat[in]._zar_cnt-=AH_CONSTANT;
004306  6961              LDR      r1,[r4,#0x14]
004308  f5a14100          SUB      r1,r1,#0x8000
00430c  f5a1614a          SUB      r1,r1,#0xca0
004310  6161              STR      r1,[r4,#0x14]
;;;7094   
;;;7095   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar+1);
004312  f9392015          LDRSH    r2,[r9,r5,LSL #1]
004316  f1000001          ADD      r0,r0,#1
00431a  b201              SXTH     r1,r0
00431c  4610              MOV      r0,r2
00431e  f7fffffe          BL       lc640_write_int
004322  e033              B        |L1.17292|
                  |L1.17188|
;;;7096   			}
;;;7097   		else if(b_zar>(tempUS_/**10*/))  
004324  d932              BLS      |L1.17292|
;;;7098   			{
;;;7099   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS_);
004326  f9390015          LDRSH    r0,[r9,r5,LSL #1]
00432a  b231              SXTH     r1,r6
00432c  f7fffffe          BL       lc640_write_int
;;;7100   			bat[in]._zar_cnt=AH_CONSTANT;
004330  f8c48014          STR      r8,[r4,#0x14]
004334  e02a              B        |L1.17292|
                  |L1.17206|
;;;7101   
;;;7102   			}
;;;7103   
;;;7104   		}
;;;7105   
;;;7106   	else if(bat[in]._zar_cnt<=-AH_CONSTANT)
004336  49ee              LDR      r1,|L1.18160|
004338  4288              CMP      r0,r1
00433a  dc27              BGT      |L1.17292|
;;;7107   		{
;;;7108   		if(BAT_C_REAL[in]==0x5555) tempUS_=BAT_C_NOM[in];
00433c  f93a1015          LDRSH    r1,[r10,r5,LSL #1]
004340  f5a140aa          SUB      r0,r1,#0x5500
004344  3855              SUBS     r0,r0,#0x55
004346  d103              BNE      |L1.17232|
004348  48e8              LDR      r0,|L1.18156|
00434a  f8306015          LDRH     r6,[r0,r5,LSL #1]
00434e  e001              B        |L1.17236|
                  |L1.17232|
;;;7109   		else tempUS_=BAT_C_REAL[in];
004350  f83a6015          LDRH     r6,[r10,r5,LSL #1]
                  |L1.17236|
;;;7110   		
;;;7111   		b_zar=lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
004354  f8390015          LDRH     r0,[r9,r5,LSL #1]
004358  f7fffffe          BL       lc640_read_int
00435c  b280              UXTH     r0,r0
;;;7112   
;;;7113   		if(b_zar>tempUS_)
00435e  42b0              CMP      r0,r6
004360  d905              BLS      |L1.17262|
;;;7114   			{
;;;7115   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],tempUS_);
004362  f9390015          LDRSH    r0,[r9,r5,LSL #1]
004366  b231              SXTH     r1,r6
004368  f7fffffe          BL       lc640_write_int
;;;7116   			b_zar=tempUS_;
00436c  4630              MOV      r0,r6
                  |L1.17262|
;;;7117   			}
;;;7118   		if(b_zar)
00436e  b158              CBZ      r0,|L1.17288|
;;;7119   			{
;;;7120   			bat[in]._zar_cnt+=AH_CONSTANT;
004370  6961              LDR      r1,[r4,#0x14]
004372  4441              ADD      r1,r1,r8
004374  6161              STR      r1,[r4,#0x14]
;;;7121   
;;;7122   			lc640_write_int(ADR_EE_BAT_ZAR_CNT[in],b_zar-1);
004376  f9392015          LDRSH    r2,[r9,r5,LSL #1]
00437a  f1a00001          SUB      r0,r0,#1
00437e  b201              SXTH     r1,r0
004380  4610              MOV      r0,r2
004382  f7fffffe          BL       lc640_write_int
004386  e001              B        |L1.17292|
                  |L1.17288|
;;;7123   			}
;;;7124   		else 
;;;7125   			{
;;;7126   			bat[in]._zar_cnt=-AH_CONSTANT;
004388  48d9              LDR      r0,|L1.18160|
00438a  6160              STR      r0,[r4,#0x14]
                  |L1.17292|
;;;7127   			}
;;;7128   
;;;7129   		}
;;;7130   
;;;7131   			
;;;7132   	tempUL=(unsigned long)lc640_read_int(ADR_EE_BAT_ZAR_CNT[in]);
00438c  f8390015          LDRH     r0,[r9,r5,LSL #1]
004390  f7fffffe          BL       lc640_read_int
004394  4601              MOV      r1,r0
;;;7133   	
;;;7134   	if(BAT_C_REAL[in]==0x5555) tempUL_=(unsigned long)BAT_C_NOM[in];
004396  f93a0015          LDRSH    r0,[r10,r5,LSL #1]
00439a  f5a042aa          SUB      r2,r0,#0x5500
00439e  3a55              SUBS     r2,r2,#0x55
0043a0  d102              BNE      |L1.17320|
0043a2  48d2              LDR      r0,|L1.18156|
0043a4  f9300015          LDRSH    r0,[r0,r5,LSL #1]
                  |L1.17320|
;;;7135   	else tempUL_=(unsigned long)BAT_C_REAL[in];
;;;7136   		           	
;;;7137   	tempUL*=1000L;
0043a8  f44f727a          MOV      r2,#0x3e8
0043ac  fb01f102          MUL      r1,r1,r2
;;;7138   
;;;7139   
;;;7140   	if(tempUL_==0) tempUL=0;
0043b0  b168              CBZ      r0,|L1.17358|
;;;7141   	else tempUL/=tempUL_;
0043b2  fbb1f0f0          UDIV     r0,r1,r0
                  |L1.17334|
;;;7142   
;;;7143   	tempUL/=10L;
0043b6  f04f010a          MOV      r1,#0xa
0043ba  fbb0f0f1          UDIV     r0,r0,r1
;;;7144   
;;;7145   	bat[in]._zar=(unsigned short)tempUL;
0043be  8220              STRH     r0,[r4,#0x10]
;;;7146   
;;;7147   	if(BAT_TYPE==1)
0043c0  48cc              LDR      r0,|L1.18164|
0043c2  8800              LDRH     r0,[r0,#0]  ; BAT_TYPE
0043c4  2801              CMP      r0,#1
0043c6  e000              B        |L1.17354|
                  |L1.17352|
0043c8  e010              B        |L1.17388|
                  |L1.17354|
0043ca  d003              BEQ      |L1.17364|
0043cc  e008              B        |L1.17376|
                  |L1.17358|
0043ce  f04f0000          MOV      r0,#0                 ;7140
0043d2  e7f0              B        |L1.17334|
                  |L1.17364|
;;;7148   		{
;;;7149   		bat[in]._zar=lakb[in]._s_o_c;
0043d4  49c8              LDR      r1,|L1.18168|
0043d6  9802              LDR      r0,[sp,#8]
0043d8  eb010080          ADD      r0,r1,r0,LSL #2
0043dc  8a40              LDRH     r0,[r0,#0x12]
0043de  8220              STRH     r0,[r4,#0x10]
                  |L1.17376|
;;;7150   		}
;;;7151   	
;;;7152   	gran((signed short*)&bat[in]._zar,0,100);
0043e0  f1040010          ADD      r0,r4,#0x10
0043e4  2264              MOVS     r2,#0x64
0043e6  2100              MOVS     r1,#0
0043e8  f7fffffe          BL       gran
                  |L1.17388|
;;;7153        }
;;;7154   
;;;7155   
;;;7156   //Подсчет тока разряда батареи      
;;;7157   if(bat[in]._wrk==1)
0043ec  7ba0              LDRB     r0,[r4,#0xe]
0043ee  2801              CMP      r0,#1
0043f0  d113              BNE      |L1.17434|
;;;7158   	{
;;;7159   	if(bat[in]._Iintegr<36000)
0043f2  8ba0              LDRH     r0,[r4,#0x1c]
0043f4  4540              CMP      r0,r8
0043f6  d20f              BCS      |L1.17432|
;;;7160   		{          
;;;7161   		bat[in]._Iintegr+=abs(bat[in]._Ib);
0043f8  f9b40008          LDRSH    r0,[r4,#8]
0043fc  f7fffffe          BL       abs
004400  8ba1              LDRH     r1,[r4,#0x1c]
004402  4408              ADD      r0,r0,r1
004404  b280              UXTH     r0,r0
004406  83a0              STRH     r0,[r4,#0x1c]
;;;7162   		if(bat[in]._Iintegr>=36000)
004408  4540              CMP      r0,r8
00440a  d306              BCC      |L1.17434|
;;;7163   			{
;;;7164   			bat[in]._Iintegr=0;		//Счетчик десятков милиамперсекунд
00440c  83a7              STRH     r7,[r4,#0x1c]
;;;7165   			bat[in]._Iintegr_++;	//Счетчик сотен милиамперчасов
00440e  8be0              LDRH     r0,[r4,#0x1e]
004410  f1000001          ADD      r0,r0,#1
004414  83e0              STRH     r0,[r4,#0x1e]
004416  e000              B        |L1.17434|
                  |L1.17432|
;;;7166   			}
;;;7167   		}
;;;7168   	else 
;;;7169   		{
;;;7170   		bat[in]._Iintegr=0;
004418  83a7              STRH     r7,[r4,#0x1c]
                  |L1.17434|
;;;7171   		}	
;;;7172   	} 
;;;7173   	    
;;;7174   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;7175   if((t_ext[0]>TBATSIGN)&&(!ND_EXT[0]))	
00441a  f8df92e0          LDR      r9,|L1.18172|
00441e  49b8              LDR      r1,|L1.18176|
004420  f8dfa2e0          LDR      r10,|L1.18180|
004424  f9b90000          LDRSH    r0,[r9,#0]  ; t_ext
004428  f9b11000          LDRSH    r1,[r1,#0]  ; TBATSIGN
00442c  4288              CMP      r0,r1
00442e  dd02              BLE      |L1.17462|
004430  f89a0000          LDRB     r0,[r10,#0]  ; ND_EXT
004434  b3e8              CBZ      r0,|L1.17586|
                  |L1.17462|
;;;7176   	{
;;;7177   	bat[in]._sign_temper_cnt++;
;;;7178   	}
;;;7179   else 
;;;7180   	{
;;;7181   	bat[in]._sign_temper_cnt--;
004436  f8b40040          LDRH     r0,[r4,#0x40]
00443a  f1a00001          SUB      r0,r0,#1
00443e  f8a40040          STRH     r0,[r4,#0x40]
                  |L1.17474|
;;;7182   	}
;;;7183   #else
;;;7184   if((bat[in]._Tb>TBATSIGN)&&(!bat[in]._nd))	
;;;7185   	{
;;;7186   	bat[in]._sign_temper_cnt++;
;;;7187   	}
;;;7188   else 
;;;7189   	{
;;;7190   	bat[in]._sign_temper_cnt--;
;;;7191   	}
;;;7192   #endif
;;;7193   gran(&bat[in]._sign_temper_cnt,0,600);
004442  f1040040          ADD      r0,r4,#0x40
004446  f44f7216          MOV      r2,#0x258
00444a  2100              MOVS     r1,#0
00444c  f7fffffe          BL       gran
;;;7194   if(bat[in]._sign_temper_cnt>=590)	bat[in]._temper_stat|=(1<<0);
004450  f9b40040          LDRSH    r0,[r4,#0x40]
004454  f240264e          MOV      r6,#0x24e
004458  42b0              CMP      r0,r6
00445a  db05              BLT      |L1.17512|
00445c  f894103f          LDRB     r1,[r4,#0x3f]
004460  f0410101          ORR      r1,r1,#1
004464  f884103f          STRB     r1,[r4,#0x3f]
                  |L1.17512|
;;;7195   if(bat[in]._sign_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<0);
004468  280a              CMP      r0,#0xa
00446a  dc05              BGT      |L1.17528|
00446c  f894003f          LDRB     r0,[r4,#0x3f]
004470  f0200001          BIC      r0,r0,#1
004474  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.17528|
;;;7196   
;;;7197   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;7198   if((t_ext[0]>TBATMAX)&&(!ND_EXT[0]))	
004478  49a3              LDR      r1,|L1.18184|
00447a  f9b90000          LDRSH    r0,[r9,#0]  ; t_ext
00447e  f9b11000          LDRSH    r1,[r1,#0]  ; TBATMAX
004482  4288              CMP      r0,r1
004484  dd02              BLE      |L1.17548|
004486  f89a0000          LDRB     r0,[r10,#0]  ; ND_EXT
00448a  b3b0              CBZ      r0,|L1.17658|
                  |L1.17548|
;;;7199   	{
;;;7200   	bat[in]._max_temper_cnt++;
;;;7201   	}
;;;7202   else 
;;;7203   	{
;;;7204   	bat[in]._max_temper_cnt--;
00448c  f8b40042          LDRH     r0,[r4,#0x42]
004490  f1a00001          SUB      r0,r0,#1
004494  f8a40042          STRH     r0,[r4,#0x42]
                  |L1.17560|
;;;7205   	}
;;;7206   #else
;;;7207   if((bat[in]._Tb>TBATMAX)&&(!bat[in]._nd))	
;;;7208   	{
;;;7209   	bat[in]._max_temper_cnt++;
;;;7210   	}
;;;7211   else 
;;;7212   	{
;;;7213   	bat[in]._max_temper_cnt--;
;;;7214   	}
;;;7215   #endif
;;;7216   
;;;7217   gran(&bat[in]._max_temper_cnt,0,600);
004498  f44f7916          MOV      r9,#0x258
00449c  f1040042          ADD      r0,r4,#0x42
0044a0  464a              MOV      r2,r9
0044a2  2100              MOVS     r1,#0
0044a4  f7fffffe          BL       gran
;;;7218   if(bat[in]._max_temper_cnt>=590)	bat[in]._temper_stat|=(1<<1);
0044a8  f9b40042          LDRSH    r0,[r4,#0x42]
0044ac  42b0              CMP      r0,r6
0044ae  db07              BLT      |L1.17600|
0044b0  e000              B        |L1.17588|
                  |L1.17586|
0044b2  e023              B        |L1.17660|
                  |L1.17588|
0044b4  f894103f          LDRB     r1,[r4,#0x3f]
0044b8  f0410102          ORR      r1,r1,#2
0044bc  f884103f          STRB     r1,[r4,#0x3f]
                  |L1.17600|
;;;7219   if(bat[in]._max_temper_cnt<=10)	bat[in]._temper_stat&=~(1<<1);
0044c0  280a              CMP      r0,#0xa
0044c2  dc05              BGT      |L1.17616|
0044c4  f894003f          LDRB     r0,[r4,#0x3f]
0044c8  f0200002          BIC      r0,r0,#2
0044cc  f884003f          STRB     r0,[r4,#0x3f]
                  |L1.17616|
;;;7220   
;;;7221   
;;;7222   
;;;7223   //Подсчет наработки батареи
;;;7224   if(bat[in]._resurs_cnt<36000)
0044d0  6c60              LDR      r0,[r4,#0x44]
0044d2  4540              CMP      r0,r8
0044d4  da20              BGE      |L1.17688|
;;;7225   	{               
;;;7226   	bat[in]._resurs_cnt++;
0044d6  f1000001          ADD      r0,r0,#1
0044da  6460              STR      r0,[r4,#0x44]
;;;7227   	if(bat[in]._resurs_cnt>=36000)
0044dc  4540              CMP      r0,r8
0044de  db1c              BLT      |L1.17690|
;;;7228   		{
;;;7229   		bat[in]._resurs_cnt=0;
0044e0  6467              STR      r7,[r4,#0x44]
;;;7230   		lc640_write_int(ADR_EE_BAT_RESURS[in],lc640_read_int(ADR_EE_BAT_RESURS[in])+1);
0044e2  4e8a              LDR      r6,|L1.18188|
0044e4  f8360015          LDRH     r0,[r6,r5,LSL #1]
0044e8  f7fffffe          BL       lc640_read_int
0044ec  1c40              ADDS     r0,r0,#1
0044ee  b201              SXTH     r1,r0
0044f0  f9360015          LDRSH    r0,[r6,r5,LSL #1]
0044f4  f7fffffe          BL       lc640_write_int
0044f8  e00f              B        |L1.17690|
                  |L1.17658|
0044fa  e006              B        |L1.17674|
                  |L1.17660|
0044fc  f8b40040          LDRH     r0,[r4,#0x40]         ;7177
004500  f1000001          ADD      r0,r0,#1              ;7177
004504  f8a40040          STRH     r0,[r4,#0x40]         ;7177
004508  e79b              B        |L1.17474|
                  |L1.17674|
00450a  f8b40042          LDRH     r0,[r4,#0x42]         ;7200
00450e  f1000001          ADD      r0,r0,#1              ;7200
004512  f8a40042          STRH     r0,[r4,#0x42]         ;7200
004516  e7bf              B        |L1.17560|
                  |L1.17688|
;;;7231   		}
;;;7232   	}
;;;7233   else bat[in]._resurs_cnt=0;
004518  6467              STR      r7,[r4,#0x44]
                  |L1.17690|
;;;7234   
;;;7235   
;;;7236   #ifndef UKU_220_V2
;;;7237   #ifndef UKU_GLONASS
;;;7238   //#ifndef UKU_6U
;;;7239   //#ifndef UKU_220
;;;7240   if(UBM_AV)
00451a  4e7d              LDR      r6,|L1.18192|
00451c  8830              LDRH     r0,[r6,#0]  ; UBM_AV
00451e  2800              CMP      r0,#0
004520  d05e              BEQ      |L1.17888|
;;;7241        {
;;;7242        signed short temp_SS;
;;;7243   #ifdef UKU_220
;;;7244   temp_SS=bat[in]._Ub/2;
;;;7245   #else
;;;7246        if(U0B<600)
004522  487c              LDR      r0,|L1.18196|
004524  f9b00000          LDRSH    r0,[r0,#0]  ; U0B
004528  4548              CMP      r0,r9
00452a  da08              BGE      |L1.17726|
;;;7247             {
;;;7248             temp_SS=bat[in]._Ub/4;
00452c  f9b40002          LDRSH    r0,[r4,#2]
004530  ea4f71e0          ASR      r1,r0,#31
004534  eb007091          ADD      r0,r0,r1,LSR #30
004538  ea4f00a0          ASR      r0,r0,#2
00453c  e006              B        |L1.17740|
                  |L1.17726|
;;;7249             }
;;;7250        else temp_SS=bat[in]._Ub/5;
00453e  f9b40002          LDRSH    r0,[r4,#2]
004542  f04f0105          MOV      r1,#5
004546  fb90f0f1          SDIV     r0,r0,r1
00454a  b200              SXTH     r0,r0
                  |L1.17740|
;;;7251   	
;;;7252   	temp_SS+=temp_SS;     
00454c  ea4f0040          LSL      r0,r0,#1
;;;7253   #endif
;;;7254        temp_SS-=(bat[in]._Ubm);
004550  88a1              LDRH     r1,[r4,#4]
004552  eba00001          SUB      r0,r0,r1
004556  b200              SXTH     r0,r0
;;;7255   
;;;7256        temp_SS=abs(temp_SS);
004558  f7fffffe          BL       abs
;;;7257   
;;;7258        temp_SS*=10;
00455c  eb000080          ADD      r0,r0,r0,LSL #2
004560  ea4f0040          LSL      r0,r0,#1
004564  b200              SXTH     r0,r0
;;;7259   
;;;7260        temp_SS/=12;
004566  f04f010c          MOV      r1,#0xc
00456a  fb90f0f1          SDIV     r0,r0,r1
00456e  b200              SXTH     r0,r0
;;;7261   
;;;7262        bat[in]._dUbm=temp_SS;
004570  80e0              STRH     r0,[r4,#6]
;;;7263   
;;;7264   
;;;7265        if(	(bat[in]._dUbm>UBM_AV) &&
004572  f9b61000          LDRSH    r1,[r6,#0]  ; UBM_AV
004576  4288              CMP      r0,r1
004578  dd34              BLE      |L1.17892|
;;;7266   		(abs(bat[in]._Ib)<(5*IKB)) &&
00457a  f9b40008          LDRSH    r0,[r4,#8]
00457e  f7fffffe          BL       abs
004582  4601              MOV      r1,r0
004584  4864              LDR      r0,|L1.18200|
004586  f9b00000          LDRSH    r0,[r0,#0]  ; IKB
00458a  eb000080          ADD      r0,r0,r0,LSL #2
00458e  4281              CMP      r1,r0
004590  da28              BGE      |L1.17892|
;;;7267   		(bat[in]._Ub>((short)(((long)USIGN*115)/100))) &&
004592  4862              LDR      r0,|L1.18204|
004594  2173              MOVS     r1,#0x73
004596  f9b00000          LDRSH    r0,[r0,#0]  ; USIGN
00459a  4348              MULS     r0,r1,r0
00459c  fb90f0fb          SDIV     r0,r0,r11
0045a0  f9b41002          LDRSH    r1,[r4,#2]
0045a4  b200              SXTH     r0,r0
0045a6  4288              CMP      r0,r1
0045a8  da1c              BGE      |L1.17892|
;;;7268   		(!(bat[in]._av & 2))  )
0045aa  f894003d          LDRB     r0,[r4,#0x3d]
0045ae  0780              LSLS     r0,r0,#30
0045b0  d418              BMI      |L1.17892|
;;;7269   		{
;;;7270   		bat[in]._cnt_as++;
0045b2  f8b40048          LDRH     r0,[r4,#0x48]
0045b6  f1000001          ADD      r0,r0,#1
0045ba  b200              SXTH     r0,r0
0045bc  f8a40048          STRH     r0,[r4,#0x48]
;;;7271   		if(bat[in]._cnt_as==3000)
0045c0  f5a06130          SUB      r1,r0,#0xb00
0045c4  39b8              SUBS     r1,r1,#0xb8
0045c6  d103              BNE      |L1.17872|
;;;7272   			{
;;;7273   			avar_bat_as_hndl(in,1);
0045c8  2101              MOVS     r1,#1
0045ca  4628              MOV      r0,r5
0045cc  f7fffffe          BL       avar_bat_as_hndl
                  |L1.17872|
;;;7274   			}
;;;7275   		if(bat[in]._cnt_as>=3005) bat[in]._cnt_as=3005;
0045d0  f9b41048          LDRSH    r1,[r4,#0x48]
0045d4  f64030bd          MOV      r0,#0xbbd
0045d8  4281              CMP      r1,r0
0045da  db01              BLT      |L1.17888|
0045dc  f8a40048          STRH     r0,[r4,#0x48]
                  |L1.17888|
;;;7276   		}
;;;7277   	else 
;;;7278   		{
;;;7279   		bat[in]._cnt_as=0;
;;;7280   		}
;;;7281        
;;;7282        }
;;;7283   //#endif 
;;;7284   #endif 
;;;7285   #endif
;;;7286   
;;;7287   }
0045e0  e8bd8ffe          POP      {r1-r11,pc}
                  |L1.17892|
0045e4  f8a47048          STRH     r7,[r4,#0x48]         ;7279
0045e8  e7fa              B        |L1.17888|
;;;7288   
                          ENDP

                  bat_hndl_zvu PROC
;;;7290   //-----------------------------------------------
;;;7291   void bat_hndl_zvu(void)
0045ea  e92d4ff0          PUSH     {r4-r11,lr}
;;;7292   {
0045ee  b089              SUB      sp,sp,#0x24
;;;7293   char i;
;;;7294   short bat_hndl_i_temp;
;;;7295   const long bat_hndl_t_razr_const[7]={600L,1800L,3600L,10800L,18000L,36000L,72000L};
0045f0  f04f021c          MOV      r2,#0x1c
0045f4  494a              LDR      r1,|L1.18208|
0045f6  4668              MOV      r0,sp
0045f8  f7fffffe          BL       __aeabi_memcpy4
;;;7296   
;;;7297   //Ib_ips_termokompensat=-17000;
;;;7298    
;;;7299   if(bat_hndl_zvu_init==0)
0045fc  4c49              LDR      r4,|L1.18212|
;;;7300   	{
;;;7301   	//Инициализация при включении системы
;;;7302   	bat_hndl_zvu_Q=(long)lc640_read_int(EE_BAT1_ZAR_CNT);
;;;7303   	if((bat_hndl_zvu_Q>100L)||(bat_hndl_zvu_Q<0L)) bat_hndl_zvu_Q=100L;
0045fe  2564              MOVS     r5,#0x64
;;;7304   	bat_hndl_zvu_Q*=10000L;
;;;7305   
;;;7306   	bat_hndl_zvu_init=1;
;;;7307   	}
;;;7308   else 
;;;7309   	{
;;;7310   	if(Ib_ips_termokompensat<-IKB)
;;;7311   		{
;;;7312   		bat_hndl_i_vector=0;
;;;7313   		bat_hndl_i_zar_price=0L;
;;;7314   			
;;;7315   		bat_hndl_i=-Ib_ips_termokompensat;
;;;7316   		I_from_t_table[0]=BAT_C_POINT_1_6*6; //Ток при котором батарея разрядится за 1/6 часа (0.1А)
;;;7317   		I_from_t_table[1]=BAT_C_POINT_1_2*2; //Ток при котором батарея разрядится за 1/2 часа (0.1А)
;;;7318   		I_from_t_table[2]=BAT_C_POINT_1; //Ток при котором батарея разрядится за 1 час (0.1А)
;;;7319   		I_from_t_table[3]=BAT_C_POINT_3/3; //Ток при котором батарея разрядится за 3 часа (0.1А)
;;;7320   		I_from_t_table[4]=BAT_C_POINT_5/5; //Ток при котором батарея разрядится за 5 часов (0.1А)
;;;7321   		I_from_t_table[5]=BAT_C_POINT_10/10; //Ток при котором батарея разрядится за 10 часов (0.1А)
;;;7322   		I_from_t_table[6]=BAT_C_POINT_20/20; //Ток при котором батарея разрядится за 20 часов (0.1А)
;;;7323   		
;;;7324   		I_from_t_table[0]=(short)((((long)I_from_t_table[0])*((long)BAT_K_OLD))/100L);
;;;7325   		I_from_t_table[1]=(short)((((long)I_from_t_table[1])*((long)BAT_K_OLD))/100L);
;;;7326   		I_from_t_table[2]=(short)((((long)I_from_t_table[2])*((long)BAT_K_OLD))/100L);
;;;7327   		I_from_t_table[3]=(short)((((long)I_from_t_table[3])*((long)BAT_K_OLD))/100L);
;;;7328   		I_from_t_table[4]=(short)((((long)I_from_t_table[4])*((long)BAT_K_OLD))/100L);
;;;7329   		I_from_t_table[5]=(short)((((long)I_from_t_table[5])*((long)BAT_K_OLD))/100L);
;;;7330   		I_from_t_table[6]=(short)((((long)I_from_t_table[6])*((long)BAT_K_OLD))/100L);
;;;7331   
;;;7332   		bat_hndl_i_temp=bat_hndl_i/10;
;;;7333   		for(i=0;i<7;i++)
;;;7334   			{
;;;7335   			if(bat_hndl_i_temp>=I_from_t_table[i])
;;;7336   				{
;;;7337   				break;
;;;7338   				}
;;;7339   			}
;;;7340   		 if(i==0) bat_hndl_t_razr=bat_hndl_t_razr_const[0];
;;;7341   		 else if((i>=1)&&(i<7))
;;;7342   		 	{
;;;7343   			short i1,i2;
;;;7344   			i1=I_from_t_table[i-1]-bat_hndl_i_temp;
;;;7345   			i2=I_from_t_table[i-1]-I_from_t_table[i];
;;;7346   			bat_hndl_t_razr=bat_hndl_t_razr_const[i]-bat_hndl_t_razr_const[i-1];
;;;7347   			bat_hndl_t_razr*=(long)i1;
;;;7348   			bat_hndl_t_razr/=(long)i2;
;;;7349   			bat_hndl_t_razr+=bat_hndl_t_razr_const[i-1];
;;;7350   			}
;;;7351   		else if(i>=7)
;;;7352   			{
;;;7353   			bat_hndl_t_razr=bat_hndl_t_razr_const[6];
;;;7354   			}
;;;7355   		bat_hndl_proc_razr=1000000L/bat_hndl_t_razr;
004600  f8df8124          LDR      r8,|L1.18216|
004604  7860              LDRB     r0,[r4,#1]            ;7299  ; bat_hndl_zvu_init
004606  2700              MOVS     r7,#0                 ;7299
004608  f04f0901          MOV      r9,#1                 ;7306
00460c  f1040680          ADD      r6,r4,#0x80           ;7302
004610  2800              CMP      r0,#0                 ;7299
004612  d065              BEQ      |L1.18144|
004614  4940              LDR      r1,|L1.18200|
004616  4845              LDR      r0,|L1.18220|
004618  f9b12000          LDRSH    r2,[r1,#0]            ;7310  ; IKB
00461c  4631              MOV      r1,r6                 ;7302
00461e  f9b00000          LDRSH    r0,[r0,#0]            ;7310  ; Ib_ips_termokompensat
004622  4253              RSBS     r3,r2,#0              ;7310
004624  6d09              LDR      r1,[r1,#0x50]         ;7302
004626  4298              CMP      r0,r3                 ;7310
004628  da5b              BGE      |L1.18146|
00462a  70e7              STRB     r7,[r4,#3]            ;7312
00462c  60f7              STR      r7,[r6,#0xc]          ;7313  ; bat_hndl_i_zar_price
00462e  f1c00000          RSB      r0,r0,#0              ;7315
004632  b200              SXTH     r0,r0                 ;7315
004634  f8a4007e          STRH     r0,[r4,#0x7e]         ;7315
004638  9008              STR      r0,[sp,#0x20]         ;7315
00463a  483d              LDR      r0,|L1.18224|
00463c  4a3d              LDR      r2,|L1.18228|
00463e  8800              LDRH     r0,[r0,#0]            ;7316  ; BAT_C_POINT_1_6
004640  eb000040          ADD      r0,r0,r0,LSL #1       ;7316
004644  ea4f0040          LSL      r0,r0,#1              ;7316
004648  fa0ffb80          SXTH     r11,r0                ;7316
00464c  483a              LDR      r0,|L1.18232|
00464e  8800              LDRH     r0,[r0,#0]            ;7317  ; BAT_C_POINT_1_2
004650  ea4f0040          LSL      r0,r0,#1              ;7317
004654  b203              SXTH     r3,r0                 ;7317
004656  4839              LDR      r0,|L1.18236|
004658  f9b0c000          LDRSH    r12,[r0,#0]           ;7318  ; BAT_C_POINT_1
00465c  4838              LDR      r0,|L1.18240|
00465e  f04f0903          MOV      r9,#3                 ;7319
004662  f9b00000          LDRSH    r0,[r0,#0]            ;7319  ; BAT_C_POINT_3
004666  fb90f0f9          SDIV     r0,r0,r9              ;7319
00466a  b200              SXTH     r0,r0                 ;7319
00466c  9007              STR      r0,[sp,#0x1c]         ;7319
00466e  4835              LDR      r0,|L1.18244|
004670  f04f0905          MOV      r9,#5                 ;7320
004674  f9b00000          LDRSH    r0,[r0,#0]            ;7320  ; BAT_C_POINT_5
004678  fb90f0f9          SDIV     r0,r0,r9              ;7320
00467c  fa0ff980          SXTH     r9,r0                 ;7320
004680  4831              LDR      r0,|L1.18248|
004682  f9b0a000          LDRSH    r10,[r0,#0]           ;7321  ; BAT_C_POINT_10
004686  f04f000a          MOV      r0,#0xa               ;7321
00468a  fb9af0f0          SDIV     r0,r10,r0             ;7321
00468e  fa0ffe80          SXTH     lr,r0                 ;7321
004692  482e              LDR      r0,|L1.18252|
004694  f04f0a14          MOV      r10,#0x14             ;7322
004698  f9b00000          LDRSH    r0,[r0,#0]            ;7322  ; BAT_C_POINT_20
00469c  fb90f0fa          SDIV     r0,r0,r10             ;7322
0046a0  fa0ffa80          SXTH     r10,r0                ;7322
0046a4  482a              LDR      r0,|L1.18256|
0046a6  f9b00000          LDRSH    r0,[r0,#0]            ;7324  ; BAT_K_OLD
0046aa  fb0bfb00          MUL      r11,r11,r0            ;7324
0046ae  fb9bfbf5          SDIV     r11,r11,r5            ;7324
0046b2  f8a2b000          STRH     r11,[r2,#0]           ;7324
0046b6  fb03f300          MUL      r3,r3,r0              ;7325
0046ba  fb93f3f5          SDIV     r3,r3,r5              ;7325
0046be  8053              STRH     r3,[r2,#2]            ;7325
0046c0  fb0cfc00          MUL      r12,r12,r0            ;7326
0046c4  fb9cf3f5          SDIV     r3,r12,r5             ;7326
0046c8  8093              STRH     r3,[r2,#4]            ;7326
0046ca  9b07              LDR      r3,[sp,#0x1c]         ;7327
0046cc  fb03f300          MUL      r3,r3,r0              ;7327
0046d0  fb93f3f5          SDIV     r3,r3,r5              ;7327
0046d4  80d3              STRH     r3,[r2,#6]            ;7327
0046d6  fb09f900          MUL      r9,r9,r0              ;7328
0046da  fb99f3f5          SDIV     r3,r9,r5              ;7328
0046de  e039              B        |L1.18260|
                  |L1.18144|
0046e0  e070              B        |L1.18372|
                  |L1.18146|
0046e2  e0a4              B        |L1.18478|
                  |L1.18148|
                          DCD      ADR_EE_BAT_ZAR_CNT
                  |L1.18152|
                          DCD      BAT_C_REAL
                  |L1.18156|
                          DCD      BAT_C_NOM
                  |L1.18160|
                          DCD      0xffff7360
                  |L1.18164|
                          DCD      BAT_TYPE
                  |L1.18168|
                          DCD      lakb
                  |L1.18172|
                          DCD      t_ext
                  |L1.18176|
                          DCD      TBATSIGN
                  |L1.18180|
                          DCD      ND_EXT
                  |L1.18184|
                          DCD      TBATMAX
                  |L1.18188|
                          DCD      ADR_EE_BAT_RESURS
                  |L1.18192|
                          DCD      UBM_AV
                  |L1.18196|
                          DCD      U0B
                  |L1.18200|
                          DCD      IKB
                  |L1.18204|
                          DCD      USIGN
                  |L1.18208|
                          DCD      ||area_number.19||+0x20
                  |L1.18212|
                          DCD      ||area_number.25||
                  |L1.18216|
                          DCD      0x000f4240
                  |L1.18220|
                          DCD      Ib_ips_termokompensat
                  |L1.18224|
                          DCD      BAT_C_POINT_1_6
                  |L1.18228|
                          DCD      ||.bss||+0x44c
                  |L1.18232|
                          DCD      BAT_C_POINT_1_2
                  |L1.18236|
                          DCD      BAT_C_POINT_1
                  |L1.18240|
                          DCD      BAT_C_POINT_3
                  |L1.18244|
                          DCD      BAT_C_POINT_5
                  |L1.18248|
                          DCD      BAT_C_POINT_10
                  |L1.18252|
                          DCD      BAT_C_POINT_20
                  |L1.18256|
                          DCD      BAT_K_OLD
                  |L1.18260|
004754  8113              STRH     r3,[r2,#8]            ;7328
004756  fb0efe00          MUL      lr,lr,r0              ;7329
00475a  fb9ef3f5          SDIV     r3,lr,r5              ;7329
00475e  8153              STRH     r3,[r2,#0xa]          ;7329
004760  fb0afa00          MUL      r10,r10,r0            ;7330
004764  fb9af0f5          SDIV     r0,r10,r5             ;7330
004768  8190              STRH     r0,[r2,#0xc]          ;7330
00476a  9808              LDR      r0,[sp,#0x20]         ;7332
00476c  f04f030a          MOV      r3,#0xa               ;7332
004770  fb90f0f3          SDIV     r0,r0,r3              ;7332
004774  b203              SXTH     r3,r0                 ;7332
004776  f04f0000          MOV      r0,#0                 ;7333
                  |L1.18298|
00477a  f9325010          LDRSH    r5,[r2,r0,LSL #1]     ;7335
00477e  429d              CMP      r5,r3                 ;7335
004780  dd04              BLE      |L1.18316|
004782  f1000001          ADD      r0,r0,#1              ;7333
004786  b2c0              UXTB     r0,r0                 ;7333
004788  2807              CMP      r0,#7                 ;7333
00478a  d3f6              BCC      |L1.18298|
                  |L1.18316|
00478c  b358              CBZ      r0,|L1.18406|
00478e  1e45              SUBS     r5,r0,#1              ;7341
004790  2d06              CMP      r5,#6                 ;7341
004792  d22b              BCS      |L1.18412|
004794  f832c015          LDRH     r12,[r2,r5,LSL #1]    ;7344
004798  ebac0303          SUB      r3,r12,r3             ;7344
00479c  b21b              SXTH     r3,r3                 ;7344
00479e  f8322010          LDRH     r2,[r2,r0,LSL #1]     ;7345
0047a2  ebac0202          SUB      r2,r12,r2             ;7345
0047a6  fa0ffc82          SXTH     r12,r2                ;7345
0047aa  f85d9020          LDR      r9,[sp,r0,LSL #2]     ;7346
0047ae  f85d0025          LDR      r0,[sp,r5,LSL #2]     ;7346
0047b2  eba90200          SUB      r2,r9,r0              ;7346
0047b6  fb02f203          MUL      r2,r2,r3              ;7347
0047ba  fb92f2fc          SDIV     r2,r2,r12             ;7348
0047be  4410              ADD      r0,r0,r2              ;7349
0047c0  64b0              STR      r0,[r6,#0x48]         ;7349  ; bat_hndl_t_razr
0047c2  e017              B        |L1.18420|
                  |L1.18372|
0047c4  f44f70ef          MOV      r0,#0x1de             ;7302
0047c8  f7fffffe          BL       lc640_read_int
0047cc  6530              STR      r0,[r6,#0x50]         ;7302  ; bat_hndl_zvu_Q
0047ce  2865              CMP      r0,#0x65              ;7303
0047d0  d300              BCC      |L1.18388|
0047d2  6535              STR      r5,[r6,#0x50]         ;7303  ; bat_hndl_zvu_Q
                  |L1.18388|
0047d4  6d30              LDR      r0,[r6,#0x50]         ;7304  ; bat_hndl_zvu_Q
0047d6  f2427110          MOV      r1,#0x2710            ;7304
0047da  fb00f001          MUL      r0,r0,r1              ;7304
0047de  6530              STR      r0,[r6,#0x50]         ;7304  ; bat_hndl_zvu_Q
0047e0  f8849001          STRB     r9,[r4,#1]            ;7306
0047e4  e067              B        |L1.18614|
                  |L1.18406|
0047e6  9800              LDR      r0,[sp,#0]            ;7340
0047e8  64b0              STR      r0,[r6,#0x48]         ;7340  ; bat_hndl_t_razr
0047ea  e003              B        |L1.18420|
                  |L1.18412|
0047ec  2807              CMP      r0,#7                 ;7351
0047ee  d301              BCC      |L1.18420|
0047f0  9806              LDR      r0,[sp,#0x18]         ;7353
0047f2  64b0              STR      r0,[r6,#0x48]         ;7353  ; bat_hndl_t_razr
                  |L1.18420|
0047f4  6cb0              LDR      r0,[r6,#0x48]  ; bat_hndl_t_razr
0047f6  fb98f0f0          SDIV     r0,r8,r0
0047fa  6570              STR      r0,[r6,#0x54]  ; bat_hndl_proc_razr
;;;7356   
;;;7357   		if(bat_hndl_zvu_Q>bat_hndl_proc_razr)bat_hndl_zvu_Q-=bat_hndl_proc_razr;
0047fc  4281              CMP      r1,r0
0047fe  dd03              BLE      |L1.18440|
004800  eba10000          SUB      r0,r1,r0
004804  6530              STR      r0,[r6,#0x50]  ; bat_hndl_zvu_Q
004806  e000              B        |L1.18442|
                  |L1.18440|
;;;7358   		else bat_hndl_zvu_Q=0L;
004808  6537              STR      r7,[r6,#0x50]  ; bat_hndl_zvu_Q
                  |L1.18442|
;;;7359   
;;;7360   		bat_hndl_t_razr_hour=(short)(bat_hndl_remain_time/3600L);
00480a  6db1              LDR      r1,[r6,#0x58]  ; bat_hndl_remain_time
00480c  f44f6061          MOV      r0,#0xe10
004810  fb91f0f0          SDIV     r0,r1,r0
004814  8030              STRH     r0,[r6,#0]
;;;7361   		bat_hndl_t_razr_min=(short)(bat_hndl_remain_time/60L);
004816  f04f003c          MOV      r0,#0x3c
00481a  fb91f1f0          SDIV     r1,r1,r0
00481e  b209              SXTH     r1,r1
004820  8071              STRH     r1,[r6,#2]
;;;7362   		bat_hndl_t_razr_mininhour=bat_hndl_t_razr_min%60L;
004822  fb91f2f0          SDIV     r2,r1,r0
004826  fb001012          MLS      r0,r0,r2,r1
00482a  80b0              STRH     r0,[r6,#4]
00482c  e017              B        |L1.18526|
                  |L1.18478|
;;;7363   
;;;7364   		}
;;;7365   	else if(Ib_ips_termokompensat>IKB)
00482e  4290              CMP      r0,r2
004830  dd15              BLE      |L1.18526|
;;;7366   		{
;;;7367   		bat_hndl_i_vector=1;
004832  f8849003          STRB     r9,[r4,#3]
;;;7368   
;;;7369   		bat_hndl_i=Ib_ips_termokompensat;
004836  f8a4007e          STRH     r0,[r4,#0x7e]
;;;7370   		bat_hndl_i_summ+=(long)bat_hndl_i;
00483a  6e32              LDR      r2,[r6,#0x60]  ; bat_hndl_i_summ
00483c  4410              ADD      r0,r0,r2
00483e  6630              STR      r0,[r6,#0x60]  ; bat_hndl_i_summ
;;;7371   		if(bat_hndl_i_summ>=36000L)
004840  f64842a0          MOV      r2,#0x8ca0
004844  4290              CMP      r0,r2
004846  db0a              BLT      |L1.18526|
;;;7372   
;;;7373   		//bat_hndl_t_razr=BAT_C_POINT_20*36000L/bat_hndl_i;
;;;7374   		//bat_hndl_proc_razr=1000000L/bat_hndl_t_razr;
;;;7375   			{
;;;7376   			bat_hndl_i_summ-=36000L;
004848  eba00002          SUB      r0,r0,r2
00484c  6630              STR      r0,[r6,#0x60]  ; bat_hndl_i_summ
;;;7377   			if(bat_hndl_zvu_Q<1000000L)bat_hndl_zvu_Q+=bat_hndl_i_zar_price;
00484e  4541              CMP      r1,r8
004850  da03              BGE      |L1.18522|
004852  68f0              LDR      r0,[r6,#0xc]  ; bat_hndl_i_zar_price
004854  4408              ADD      r0,r0,r1
004856  6530              STR      r0,[r6,#0x50]  ; bat_hndl_zvu_Q
004858  e001              B        |L1.18526|
                  |L1.18522|
;;;7378   			else bat_hndl_zvu_Q=1000000L; 
00485a  f8c68050          STR      r8,[r6,#0x50]  ; bat_hndl_zvu_Q
                  |L1.18526|
;;;7379   			}
;;;7380   		}
;;;7381   
;;;7382   
;;;7383   	if(bat_hndl_i_vector!=bat_hndl_i_vector_old)
00485e  78e0              LDRB     r0,[r4,#3]  ; bat_hndl_i_vector
004860  7921              LDRB     r1,[r4,#4]  ; bat_hndl_i_vector_old
004862  4288              CMP      r0,r1
004864  d00d              BEQ      |L1.18562|
;;;7384   		{
;;;7385   		if(bat_hndl_i_vector==1)
004866  2801              CMP      r0,#1
004868  d10b              BNE      |L1.18562|
;;;7386   			{
;;;7387   			signed short tempSS;
;;;7388   			tempSS=lc640_read_int(EE_AMPER_CHAS_CNT);
00486a  f44f70e4          MOV      r0,#0x1c8
00486e  f7fffffe          BL       lc640_read_int
004872  b200              SXTH     r0,r0
;;;7389   			bat_hndl_i_zar_price=(bat_hndl_zvu_Q-1000000L)/((long)tempSS);
004874  4aff              LDR      r2,|L1.19572|
004876  6d31              LDR      r1,[r6,#0x50]  ; bat_hndl_zvu_Q
004878  4411              ADD      r1,r1,r2
00487a  fb91f0f0          SDIV     r0,r1,r0
00487e  60f0              STR      r0,[r6,#0xc]  ; bat_hndl_i_zar_price
;;;7390   			bat_hndl_i_summ=0;
004880  6637              STR      r7,[r6,#0x60]  ; bat_hndl_i_summ
                  |L1.18562|
;;;7391   			}
;;;7392   		}
;;;7393   	bat_hndl_i_vector_old=bat_hndl_i_vector;
004882  78e0              LDRB     r0,[r4,#3]  ; bat_hndl_i_vector
004884  7120              STRB     r0,[r4,#4]
;;;7394   
;;;7395   	if((bat_hndl_zvu_Q/10000L)!=lc640_read_int(EE_BAT1_ZAR_CNT)) lc640_write_int(EE_BAT1_ZAR_CNT,bat_hndl_zvu_Q/10000L);
004886  6d30              LDR      r0,[r6,#0x50]  ; bat_hndl_zvu_Q
004888  f2427a10          MOV      r10,#0x2710
00488c  fb90f5fa          SDIV     r5,r0,r10
004890  f44f79ef          MOV      r9,#0x1de
004894  4648              MOV      r0,r9
004896  f7fffffe          BL       lc640_read_int
00489a  4285              CMP      r5,r0
00489c  d006              BEQ      |L1.18604|
00489e  6d30              LDR      r0,[r6,#0x50]  ; bat_hndl_zvu_Q
0048a0  fb90f0fa          SDIV     r0,r0,r10
0048a4  b201              SXTH     r1,r0
0048a6  4648              MOV      r0,r9
0048a8  f7fffffe          BL       lc640_write_int
                  |L1.18604|
;;;7396   	bat_hndl_remain_time=bat_hndl_zvu_Q/bat_hndl_proc_razr;
0048ac  e9d60114          LDRD     r0,r1,[r6,#0x50]
0048b0  fb90f0f1          SDIV     r0,r0,r1
0048b4  65b0              STR      r0,[r6,#0x58]  ; bat_hndl_remain_time
                  |L1.18614|
;;;7397   	}
;;;7398   
;;;7399   if(bat_hndl_zvu_Q>1000000L)	bat_hndl_zvu_Q=1000000L;
0048b6  6d30              LDR      r0,[r6,#0x50]  ; bat_hndl_zvu_Q
0048b8  4540              CMP      r0,r8
0048ba  dd02              BLE      |L1.18626|
0048bc  f8c68050          STR      r8,[r6,#0x50]  ; bat_hndl_zvu_Q
0048c0  e002              B        |L1.18632|
                  |L1.18626|
;;;7400   else if(bat_hndl_zvu_Q<0L)	bat_hndl_zvu_Q=0L;
0048c2  2800              CMP      r0,#0
0048c4  da00              BGE      |L1.18632|
0048c6  6537              STR      r7,[r6,#0x50]  ; bat_hndl_zvu_Q
                  |L1.18632|
;;;7401   
;;;7402   if((Ib_ips_termokompensat/10<(2*IKB))&&(Ib_ips_termokompensat/10>(-2*IKB))&&(!(bat[0]._av&0x01))&& (out_U<=u_necc_up) && (out_U>u_necc_dn) && (main_kb_cnt>=10) && (main_kb_cnt<=200) /*(main_kb_cnt==((TBAT*60)-10))*//*&& ((TVENTMAX!=0))*/ )
0048c8  48eb              LDR      r0,|L1.19576|
0048ca  f9b01000          LDRSH    r1,[r0,#0]  ; Ib_ips_termokompensat
0048ce  200a              MOVS     r0,#0xa
0048d0  fb91f0f0          SDIV     r0,r1,r0
0048d4  49e9              LDR      r1,|L1.19580|
0048d6  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
0048da  ebb00f41          CMP      r0,r1,LSL #1
0048de  da30              BGE      |L1.18754|
0048e0  4249              RSBS     r1,r1,#0
0048e2  ebb00f41          CMP      r0,r1,LSL #1
0048e6  dd2c              BLE      |L1.18754|
0048e8  48e5              LDR      r0,|L1.19584|
0048ea  f890003d          LDRB     r0,[r0,#0x3d]  ; bat
0048ee  07c0              LSLS     r0,r0,#31
0048f0  d127              BNE      |L1.18754|
0048f2  48e4              LDR      r0,|L1.19588|
0048f4  49e4              LDR      r1,|L1.19592|
0048f6  f9b00000          LDRSH    r0,[r0,#0]  ; out_U
0048fa  f9b11000          LDRSH    r1,[r1,#0]  ; u_necc_up
0048fe  4288              CMP      r0,r1
004900  dc1f              BGT      |L1.18754|
004902  49e2              LDR      r1,|L1.19596|
004904  f9b11000          LDRSH    r1,[r1,#0]  ; u_necc_dn
004908  4288              CMP      r0,r1
00490a  dd1a              BLE      |L1.18754|
00490c  f9b4004c          LDRSH    r0,[r4,#0x4c]  ; main_kb_cnt
004910  280a              CMP      r0,#0xa
004912  db16              BLT      |L1.18754|
004914  28c8              CMP      r0,#0xc8
004916  dc14              BGT      |L1.18754|
;;;7403   	{
;;;7404   	if(bat_hndl_zvu_Q_cnt<60)
004918  f894002b          LDRB     r0,[r4,#0x2b]  ; bat_hndl_zvu_Q_cnt
00491c  283c              CMP      r0,#0x3c
00491e  d20d              BCS      |L1.18748|
;;;7405   		{
;;;7406   		bat_hndl_zvu_Q_cnt++;
004920  f1000001          ADD      r0,r0,#1
004924  b2c0              UXTB     r0,r0
004926  f884002b          STRB     r0,[r4,#0x2b]
;;;7407   		if(bat_hndl_zvu_Q_cnt>=60)
00492a  283c              CMP      r0,#0x3c
00492c  d306              BCC      |L1.18748|
;;;7408   			{
;;;7409   			lc640_write_int(EE_BAT1_ZAR_CNT,100);
00492e  2164              MOVS     r1,#0x64
004930  f44f70ef          MOV      r0,#0x1de
004934  f7fffffe          BL       lc640_write_int
;;;7410   			bat_hndl_zvu_Q=1000000L;
004938  f8c68050          STR      r8,[r6,#0x50]  ; bat_hndl_zvu_Q
                  |L1.18748|
;;;7411   
;;;7412   
;;;7413   			}
;;;7414   		}
;;;7415   	}
;;;7416   else 
;;;7417   	{
;;;7418   	bat_hndl_zvu_Q_cnt=0;
;;;7419   	}
;;;7420   
;;;7421   
;;;7422   
;;;7423   };
00493c  b009              ADD      sp,sp,#0x24
00493e  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.18754|
004942  f884702b          STRB     r7,[r4,#0x2b]         ;7418
004946  e7f9              B        |L1.18748|
;;;7424   #endif
                          ENDP

                  u_avt_set_hndl PROC
;;;7428   //Установка напряжения автономной работы в полуавтоматическом режиме
;;;7429   void u_avt_set_hndl(void)
004948  e92d5fff          PUSH     {r0-r12,lr}
;;;7430   {
;;;7431   if(uavt_set_stat==uassSTEP1)
00494c  4dd0              LDR      r5,|L1.19600|
;;;7432   	{
;;;7433   	char i,find_succes;
;;;7434   
;;;7435   	//u_max_temp=U_AVT+10;//(short)((((long)U_AVT)*101U)/100U);
;;;7436   	//u_min_temp=U_AVT-10;//(short)((((long)U_AVT)*99U)/100U);
;;;7437   	if(uavt_set_stat_old!=uavt_set_stat)
;;;7438   		{
;;;7439   		uavt_set_error_cnt=60;
00494e  4ed1              LDR      r6,|L1.19604|
004950  f8df8344          LDR      r8,|L1.19608|
004954  7828              LDRB     r0,[r5,#0]            ;7431  ; uavt_set_stat
;;;7440   		}
;;;7441   	//mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
;;;7442   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
;;;7443   	find_succes=0;
;;;7444   /*	for(i=0;i<NUMIST;i++)
;;;7445   		{
;;;7446   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
;;;7447   		else
;;;7448   			{
;;;7449   			find_succes=0;
;;;7450   			break;
;;;7451   			}
;;;7452   		}*/
;;;7453   	if((bps_U>=U_AVT-1)&&(bps_U<=U_AVT+1))find_succes=1;
004956  f8dfa344          LDR      r10,|L1.19612|
00495a  2400              MOVS     r4,#0                 ;7442
;;;7454   
;;;7455   	if(find_succes==1)
;;;7456   		{
;;;7457   		uavt_set_stat=uassSTEP2;
00495c  f04f0902          MOV      r9,#2
;;;7458   		}
;;;7459   	if(uavt_set_error_cnt)
;;;7460   		{
;;;7461   		uavt_set_error_cnt--;
;;;7462   		if(!uavt_set_error_cnt)
;;;7463   			{
;;;7464   			uavt_set_stat=uassOFF;
;;;7465   			uavt_set_result_stat=uasrsERR;
;;;7466   			avt_error_bps=100;
004960  f04f0b64          MOV      r11,#0x64
004964  2801              CMP      r0,#1                 ;7431
004966  d12e              BNE      |L1.18886|
004968  f8980000          LDRB     r0,[r8,#0]            ;7437  ; uavt_set_stat_old
00496c  2801              CMP      r0,#1                 ;7437
00496e  d002              BEQ      |L1.18806|
004970  f04f003c          MOV      r0,#0x3c              ;7439
004974  7030              STRB     r0,[r6,#0]            ;7439
                  |L1.18806|
004976  230a              MOVS     r3,#0xa               ;7442
004978  2200              MOVS     r2,#0                 ;7442
00497a  21e6              MOVS     r1,#0xe6              ;7442
00497c  20e1              MOVS     r0,#0xe1              ;7442
00497e  f7fffffe          BL       mess_send
004982  f04f0000          MOV      r0,#0                 ;7443
004986  49c6              LDR      r1,|L1.19616|
004988  f9b12000          LDRSH    r2,[r1,#0]            ;7453  ; bps_U
00498c  f9ba1000          LDRSH    r1,[r10,#0]           ;7453  ; U_AVT
004990  f1a10301          SUB      r3,r1,#1              ;7453
004994  429a              CMP      r2,r3                 ;7453
004996  db04              BLT      |L1.18850|
004998  1c49              ADDS     r1,r1,#1              ;7453
00499a  428a              CMP      r2,r1                 ;7453
00499c  dc01              BGT      |L1.18850|
00499e  f04f0001          MOV      r0,#1                 ;7453
                  |L1.18850|
0049a2  2801              CMP      r0,#1                 ;7455
0049a4  d101              BNE      |L1.18858|
0049a6  f8859000          STRB     r9,[r5,#0]            ;7457
                  |L1.18858|
0049aa  7830              LDRB     r0,[r6,#0]            ;7459  ; uavt_set_error_cnt
0049ac  b158              CBZ      r0,|L1.18886|
0049ae  f1a00001          SUB      r0,r0,#1              ;7461
0049b2  b2c0              UXTB     r0,r0                 ;7461
0049b4  7030              STRB     r0,[r6,#0]            ;7461
0049b6  b930              CBNZ     r0,|L1.18886|
0049b8  702c              STRB     r4,[r5,#0]            ;7464
0049ba  48ba              LDR      r0,|L1.19620|
0049bc  f8809000          STRB     r9,[r0,#0]            ;7465
0049c0  48b9              LDR      r0,|L1.19624|
0049c2  f880b000          STRB     r11,[r0,#0]
                  |L1.18886|
;;;7467   			}
;;;7468   		}
;;;7469   	}
;;;7470   if(uavt_set_stat==uassSTEP2)
0049c6  782a              LDRB     r2,[r5,#0]  ; uavt_set_stat
;;;7471   	{
;;;7472   	char i,find_succes;
;;;7473   
;;;7474   	u_max_temp=(short)((((long)U_AVT)*101U)/100U);
0049c8  49b8              LDR      r1,|L1.19628|
;;;7475   	u_min_temp=(short)((((long)U_AVT)*99U)/100U);
0049ca  48b9              LDR      r0,|L1.19632|
;;;7476   
;;;7477   	if(uavt_set_stat_old!=uavt_set_stat)
;;;7478   		{
;;;7479   		uavt_set_error_cnt=60;
;;;7480   		}
;;;7481   
;;;7482   	mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
;;;7483   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
;;;7484   	find_succes=1;
;;;7485   
;;;7486   	for(i=0;i<NUMIST;i++)
;;;7487   		{
;;;7488   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
;;;7489   		else
;;;7490   			{
;;;7491   			find_succes=0;
;;;7492   			avt_error_bps=i+1;
;;;7493   			break;
;;;7494   			}
;;;7495   		}
;;;7496   
;;;7497   	if(find_succes==1)
;;;7498   		{
;;;7499   		uavt_set_stat=uassSTEP3;
;;;7500   		uavt_bps_pntr=0;
0049cc  4fb9              LDR      r7,|L1.19636|
0049ce  2a02              CMP      r2,#2                 ;7470
0049d0  d002              BEQ      |L1.18904|
;;;7501   		avt_plazma=0;
;;;7502   		}
;;;7503   
;;;7504   	if(uavt_set_error_cnt)
;;;7505   		{
;;;7506   		uavt_set_error_cnt--;
;;;7507   		if(!uavt_set_error_cnt)
;;;7508   			{
;;;7509   			uavt_set_stat=uassOFF;
;;;7510   			uavt_set_result_stat=uasrsERR;
;;;7511   			}
;;;7512   		}
;;;7513   	}
;;;7514   else if(uavt_set_stat==uassSTEP3)
0049d2  2a03              CMP      r2,#3
0049d4  d05e              BEQ      |L1.19092|
0049d6  e0ca              B        |L1.19310|
                  |L1.18904|
0049d8  f9ba2000          LDRSH    r2,[r10,#0]           ;7474  ; U_AVT
0049dc  f04f0365          MOV      r3,#0x65              ;7474
0049e0  fb02f303          MUL      r3,r2,r3              ;7474
0049e4  fbb3f3fb          UDIV     r3,r3,r11             ;7474
0049e8  468a              MOV      r10,r1                ;7474
0049ea  800b              STRH     r3,[r1,#0]            ;7474
0049ec  eb021142          ADD      r1,r2,r2,LSL #5       ;7475
0049f0  eb010141          ADD      r1,r1,r1,LSL #1       ;7475
0049f4  fbb1f1fb          UDIV     r1,r1,r11             ;7475
0049f8  4683              MOV      r11,r0                ;7475
0049fa  8001              STRH     r1,[r0,#0]            ;7475
0049fc  f8980000          LDRB     r0,[r8,#0]            ;7477  ; uavt_set_stat_old
004a00  2802              CMP      r0,#2                 ;7477
004a02  d002              BEQ      |L1.18954|
004a04  f04f003c          MOV      r0,#0x3c              ;7479
004a08  7030              STRB     r0,[r6,#0]            ;7479
                  |L1.18954|
004a0a  230a              MOVS     r3,#0xa               ;7482
004a0c  21bf              MOVS     r1,#0xbf              ;7482
004a0e  20be              MOVS     r0,#0xbe              ;7482
004a10  f7fffffe          BL       mess_send
004a14  230a              MOVS     r3,#0xa               ;7483
004a16  2200              MOVS     r2,#0                 ;7483
004a18  21e6              MOVS     r1,#0xe6              ;7483
004a1a  20e1              MOVS     r0,#0xe1              ;7483
004a1c  f7fffffe          BL       mess_send
004a20  f04f0201          MOV      r2,#1                 ;7484
004a24  f04f0000          MOV      r0,#0                 ;7486
004a28  49a4              LDR      r1,|L1.19644|
004a2a  f9ba3000          LDRSH    r3,[r10,#0]           ;7486
004a2e  f8dfe288          LDR      lr,|L1.19640|
004a32  f9bbc000          LDRSH    r12,[r11,#0]          ;7488
004a36  f9b1a000          LDRSH    r10,[r1,#0]           ;7486
004a3a  e00d              B        |L1.19032|
                  |L1.19004|
004a3c  ebc001c0          RSB      r1,r0,r0,LSL #3       ;7488
004a40  eb011100          ADD      r1,r1,r0,LSL #4       ;7488
004a44  eb0e0181          ADD      r1,lr,r1,LSL #2       ;7488
004a48  69c9              LDR      r1,[r1,#0x1c]         ;7488
004a4a  4299              CMP      r1,r3                 ;7488
004a4c  da09              BGE      |L1.19042|
004a4e  4561              CMP      r1,r12                ;7488
004a50  dd07              BLE      |L1.19042|
004a52  f1000001          ADD      r0,r0,#1              ;7486
004a56  b2c0              UXTB     r0,r0                 ;7486
                  |L1.19032|
004a58  4550              CMP      r0,r10                ;7486
004a5a  dbef              BLT      |L1.19004|
                  |L1.19036|
004a5c  2a01              CMP      r2,#1                 ;7497
004a5e  d007              BEQ      |L1.19056|
004a60  e00c              B        |L1.19068|
                  |L1.19042|
004a62  f04f0200          MOV      r2,#0                 ;7491
004a66  4990              LDR      r1,|L1.19624|
004a68  f1000001          ADD      r0,r0,#1              ;7492
004a6c  7008              STRB     r0,[r1,#0]            ;7492
004a6e  e7f5              B        |L1.19036|
                  |L1.19056|
004a70  f04f0003          MOV      r0,#3                 ;7499
004a74  7028              STRB     r0,[r5,#0]            ;7499
004a76  703c              STRB     r4,[r7,#0]            ;7500
004a78  4891              LDR      r0,|L1.19648|
004a7a  7004              STRB     r4,[r0,#0]            ;7501
                  |L1.19068|
004a7c  7830              LDRB     r0,[r6,#0]            ;7504  ; uavt_set_error_cnt
004a7e  b3d0              CBZ      r0,|L1.19190|
004a80  f1a00001          SUB      r0,r0,#1              ;7506
004a84  b2c0              UXTB     r0,r0                 ;7506
004a86  7030              STRB     r0,[r6,#0]            ;7506
004a88  bba8              CBNZ     r0,|L1.19190|
004a8a  702c              STRB     r4,[r5,#0]            ;7509
004a8c  4885              LDR      r0,|L1.19620|
004a8e  f8809000          STRB     r9,[r0,#0]            ;7510
004a92  e06c              B        |L1.19310|
                  |L1.19092|
;;;7515   	{
;;;7516   	char i,find_succes;
;;;7517   
;;;7518   	u_max_temp=(short)((((long)U_AVT)*101U)/100U);
004a94  f9ba2000          LDRSH    r2,[r10,#0]  ; U_AVT
004a98  f04f0365          MOV      r3,#0x65
004a9c  fb02f303          MUL      r3,r2,r3
004aa0  fbb3f3fb          UDIV     r3,r3,r11
004aa4  468a              MOV      r10,r1
004aa6  800b              STRH     r3,[r1,#0]
;;;7519   	u_min_temp=(short)((((long)U_AVT)*99U)/100U);
004aa8  eb021142          ADD      r1,r2,r2,LSL #5
004aac  eb010141          ADD      r1,r1,r1,LSL #1
004ab0  fbb1f1fb          UDIV     r1,r1,r11
004ab4  4683              MOV      r11,r0
004ab6  8001              STRH     r1,[r0,#0]
;;;7520   	
;;;7521   	if(uavt_set_stat_old!=uavt_set_stat)
004ab8  f8980000          LDRB     r0,[r8,#0]  ; uavt_set_stat_old
004abc  2803              CMP      r0,#3
004abe  d000              BEQ      |L1.19138|
;;;7522   		{
;;;7523   		uavt_bps_pntr=0;
004ac0  703c              STRB     r4,[r7,#0]
                  |L1.19138|
;;;7524   		}
;;;7525   
;;;7526   	mess_send(MESS2UNECC_HNDL,PARAM_UNECC_SET,U_AVT,10);
004ac2  230a              MOVS     r3,#0xa
004ac4  21bf              MOVS     r1,#0xbf
004ac6  20be              MOVS     r0,#0xbe
004ac8  f7fffffe          BL       mess_send
;;;7527   	mess_send(MESS2CNTRL_HNDL,PARAM_CNTRL_STAT_FAST_REG,0,10);
004acc  230a              MOVS     r3,#0xa
004ace  2200              MOVS     r2,#0
004ad0  21e6              MOVS     r1,#0xe6
004ad2  20e1              MOVS     r0,#0xe1
004ad4  f7fffffe          BL       mess_send
;;;7528   
;;;7529   	find_succes=1;
004ad8  f04f0601          MOV      r6,#1
;;;7530   	for(i=0;i<NUMIST;i++)
004adc  f04f0000          MOV      r0,#0
004ae0  f8df91d8          LDR      r9,|L1.19644|
004ae4  f9ba2000          LDRSH    r2,[r10,#0]
004ae8  f8dfc1cc          LDR      r12,|L1.19640|
004aec  f9bb3000          LDRSH    r3,[r11,#0]           ;7488
004af0  f9b9a000          LDRSH    r10,[r9,#0]           ;7486
004af4  e00e              B        |L1.19220|
                  |L1.19190|
004af6  e03a              B        |L1.19310|
                  |L1.19192|
;;;7531   		{
;;;7532   		if((bps[i]._Uii<u_max_temp)&&(bps[i]._Uii>u_min_temp))continue;
004af8  ebc001c0          RSB      r1,r0,r0,LSL #3
004afc  eb011100          ADD      r1,r1,r0,LSL #4
004b00  eb0c0181          ADD      r1,r12,r1,LSL #2
004b04  69c9              LDR      r1,[r1,#0x1c]
004b06  4291              CMP      r1,r2
004b08  da0f              BGE      |L1.19242|
004b0a  4299              CMP      r1,r3
004b0c  dd0d              BLE      |L1.19242|
004b0e  f1000001          ADD      r0,r0,#1              ;7530
004b12  b2c0              UXTB     r0,r0                 ;7530
                  |L1.19220|
004b14  4550              CMP      r0,r10                ;7530
004b16  dbef              BLT      |L1.19192|
                  |L1.19224|
;;;7533   		else
;;;7534   			{
;;;7535   			find_succes=0;
;;;7536   			break;
;;;7537   			}
;;;7538   		}
;;;7539   
;;;7540   	if(mess_find( (MESS2IND_HNDL)) && (mess_data[0]==PARAM_U_AVT_GOOD) )
004b18  20d7              MOVS     r0,#0xd7
004b1a  f7fffffe          BL       mess_find
004b1e  b1a0              CBZ      r0,|L1.19274|
004b20  4868              LDR      r0,|L1.19652|
004b22  6800              LDR      r0,[r0,#0]  ; mess_data
004b24  28d9              CMP      r0,#0xd9
004b26  d003              BEQ      |L1.19248|
004b28  e00f              B        |L1.19274|
                  |L1.19242|
004b2a  f04f0600          MOV      r6,#0                 ;7535
004b2e  e7f3              B        |L1.19224|
                  |L1.19248|
;;;7541   		{
;;;7542   		if(++uavt_bps_pntr>=NUMIST)
004b30  7838              LDRB     r0,[r7,#0]  ; uavt_bps_pntr
004b32  1c40              ADDS     r0,r0,#1
004b34  b2c0              UXTB     r0,r0
004b36  7038              STRB     r0,[r7,#0]
004b38  f9b91000          LDRSH    r1,[r9,#0]  ; NUMIST
004b3c  4288              CMP      r0,r1
004b3e  db04              BLT      |L1.19274|
;;;7543   			{
;;;7544   			uavt_set_stat=uassOFF;
004b40  702c              STRB     r4,[r5,#0]
;;;7545   			uavt_set_result_stat=uasrsSUCCESS;
004b42  4958              LDR      r1,|L1.19620|
004b44  f04f0003          MOV      r0,#3
004b48  7008              STRB     r0,[r1,#0]
                  |L1.19274|
;;;7546   			}
;;;7547   		//uavt_bps_pntr++;
;;;7548   		//if()
;;;7549   		}
;;;7550   	if(find_succes==1)
004b4a  2e01              CMP      r6,#1
004b4c  d10f              BNE      |L1.19310|
;;;7551   		{
;;;7552   		mcp2515_transmit(uavt_bps_pntr,uavt_bps_pntr,CMND,0xee,0xee,0,0,0);
004b4e  20ee              MOVS     r0,#0xee
004b50  e9cd0400          STRD     r0,r4,[sp,#0]
004b54  9402              STR      r4,[sp,#8]
004b56  9403              STR      r4,[sp,#0xc]
004b58  7839              LDRB     r1,[r7,#0]  ; uavt_bps_pntr
004b5a  4603              MOV      r3,r0
004b5c  2216              MOVS     r2,#0x16
004b5e  4608              MOV      r0,r1
004b60  f7fffffe          BL       mcp2515_transmit
;;;7553   		avt_plazma++;
004b64  4856              LDR      r0,|L1.19648|
004b66  7801              LDRB     r1,[r0,#0]  ; avt_plazma
004b68  f1010101          ADD      r1,r1,#1
004b6c  7001              STRB     r1,[r0,#0]
                  |L1.19310|
;;;7554   		}
;;;7555   	}
;;;7556   
;;;7557   
;;;7558   
;;;7559   uavt_set_stat_old=uavt_set_stat;
004b6e  7828              LDRB     r0,[r5,#0]  ; uavt_set_stat
004b70  f8880000          STRB     r0,[r8,#0]
;;;7560   
;;;7561   }
004b74  e8bd9fff          POP      {r0-r12,pc}
;;;7562   
                          ENDP

                  u_necc_hndl PROC
;;;7637   //-----------------------------------------------
;;;7638   void u_necc_hndl(void)
004b78  b5f8              PUSH     {r3-r7,lr}
;;;7639   {
;;;7640   signed long temp_L;
;;;7641   signed long temp_SL;
;;;7642   //signed short temp_SS;
;;;7643   
;;;7644   //char i;
;;;7645   
;;;7646   //temp_SS=0;
;;;7647   signed short t[2];
;;;7648   
;;;7649   
;;;7650   
;;;7651   
;;;7652   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;7653   
;;;7654   if(!TERMOKOMPENS)
004b7a  4853              LDR      r0,|L1.19656|
;;;7655   	{
;;;7656   	//u_necc=U0B;
;;;7657   	u_necc=UB20;
;;;7658   	}
;;;7659   else
;;;7660   	{
;;;7661   	if(ND_EXT[0])t[0]=20;
;;;7662   	else t[0]=t_ext[0];
;;;7663   
;;;7664   	mat_temper=t[0];
;;;7665   			
;;;7666   	if(mat_temper<0)temp_SL=UB0; 
;;;7667   	else 
;;;7668   		{
;;;7669   		if(mat_temper>40)mat_temper=40; 
;;;7670   		temp_SL=(UB20-UB0)*10;
;;;7671   		temp_SL*=mat_temper;
;;;7672   		temp_SL/=200;
;;;7673   		temp_SL+=UB0;
;;;7674   		}
;;;7675   	if((spc_stat==spcVZ)&&((sk_stat[0]==1)||(VZ_CH_VENT_BLOK==0)))
004b7c  4d55              LDR      r5,|L1.19668|
004b7e  4c56              LDR      r4,|L1.19672|
004b80  8801              LDRH     r1,[r0,#0]            ;7654  ; TERMOKOMPENS
004b82  4852              LDR      r0,|L1.19660|
004b84  f9b03000          LDRSH    r3,[r0,#0]            ;7657
;;;7676   		{
;;;7677   		temp_SL=UVZ;
004b88  4851              LDR      r0,|L1.19664|
004b8a  f9b02000          LDRSH    r2,[r0,#0]
004b8e  b139              CBZ      r1,|L1.19360|
004b90  4852              LDR      r0,|L1.19676|
004b92  7800              LDRB     r0,[r0,#0]            ;7661  ; ND_EXT
004b94  b130              CBZ      r0,|L1.19364|
004b96  f04f0014          MOV      r0,#0x14              ;7661
004b9a  f8ad0000          STRH     r0,[sp,#0]            ;7661
004b9e  e005              B        |L1.19372|
                  |L1.19360|
004ba0  8023              STRH     r3,[r4,#0]            ;7657
004ba2  e02b              B        |L1.19452|
                  |L1.19364|
004ba4  484e              LDR      r0,|L1.19680|
004ba6  8800              LDRH     r0,[r0,#0]            ;7662  ; t_ext
004ba8  f8ad0000          STRH     r0,[sp,#0]            ;7662
                  |L1.19372|
004bac  4e4d              LDR      r6,|L1.19684|
004bae  f9bd1000          LDRSH    r1,[sp,#0]            ;7664
004bb2  6031              STR      r1,[r6,#0]            ;7664  ; mat_temper
004bb4  484c              LDR      r0,|L1.19688|
004bb6  2900              CMP      r1,#0                 ;7666
004bb8  f9b00000          LDRSH    r0,[r0,#0]            ;7666
004bbc  db12              BLT      |L1.19428|
004bbe  2928              CMP      r1,#0x28              ;7669
004bc0  dd02              BLE      |L1.19400|
004bc2  f04f0128          MOV      r1,#0x28              ;7669
004bc6  6031              STR      r1,[r6,#0]            ;7669  ; mat_temper
                  |L1.19400|
004bc8  eba30100          SUB      r1,r3,r0              ;7670
004bcc  eb010181          ADD      r1,r1,r1,LSL #2       ;7670
004bd0  ea4f0141          LSL      r1,r1,#1              ;7670
004bd4  6833              LDR      r3,[r6,#0]            ;7671  ; mat_temper
004bd6  fb01f103          MUL      r1,r1,r3              ;7671
004bda  f04f03c8          MOV      r3,#0xc8              ;7672
004bde  fb91f1f3          SDIV     r1,r1,r3              ;7672
004be2  4408              ADD      r0,r0,r1              ;7673
                  |L1.19428|
004be4  7ea9              LDRB     r1,[r5,#0x1a]         ;7675  ; spc_stat
004be6  2902              CMP      r1,#2                 ;7675
004be8  d107              BNE      |L1.19450|
004bea  4940              LDR      r1,|L1.19692|
004bec  7809              LDRB     r1,[r1,#0]            ;7675  ; sk_stat
004bee  2901              CMP      r1,#1                 ;7675
004bf0  d002              BEQ      |L1.19448|
004bf2  493f              LDR      r1,|L1.19696|
004bf4  8809              LDRH     r1,[r1,#0]            ;7675  ; VZ_CH_VENT_BLOK
004bf6  b901              CBNZ     r1,|L1.19450|
                  |L1.19448|
004bf8  4610              MOV      r0,r2
                  |L1.19450|
;;;7678   		}
;;;7679   	u_necc=(unsigned int)temp_SL;
004bfa  8020              STRH     r0,[r4,#0]
                  |L1.19452|
;;;7680   	///u_necc=3456;
;;;7681   	}  
;;;7682   
;;;7683   //u_necc=2355;
;;;7684   
;;;7685   if((speedChIsOn)||(sp_ch_stat==scsWRK))
004bfc  483d              LDR      r0,|L1.19700|
004bfe  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
004c00  b918              CBNZ     r0,|L1.19466|
004c02  483d              LDR      r0,|L1.19704|
004c04  7800              LDRB     r0,[r0,#0]  ; sp_ch_stat
004c06  2802              CMP      r0,#2
004c08  d102              BNE      |L1.19472|
                  |L1.19466|
;;;7686   	{
;;;7687   	u_necc=speedChrgVolt;
004c0a  483c              LDR      r0,|L1.19708|
004c0c  8800              LDRH     r0,[r0,#0]  ; speedChrgVolt
004c0e  8020              STRH     r0,[r4,#0]
                  |L1.19472|
;;;7688   	}
;;;7689   if(hv_vz_stat==hvsWRK)
004c10  483b              LDR      r0,|L1.19712|
004c12  7800              LDRB     r0,[r0,#0]  ; hv_vz_stat
004c14  2805              CMP      r0,#5
004c16  d100              BNE      |L1.19482|
;;;7690   	{
;;;7691   	u_necc=UVZ;
004c18  8022              STRH     r2,[r4,#0]
                  |L1.19482|
;;;7692   	}
;;;7693   if(vz1_stat==vz1sWRK)
004c1a  f8950026          LDRB     r0,[r5,#0x26]  ; vz1_stat
004c1e  280a              CMP      r0,#0xa
004c20  d102              BNE      |L1.19496|
;;;7694   	{
;;;7695   	u_necc=UZ_U;
004c22  4838              LDR      r0,|L1.19716|
004c24  8800              LDRH     r0,[r0,#0]  ; UZ_U
004c26  8020              STRH     r0,[r4,#0]
                  |L1.19496|
;;;7696   	}
;;;7697   if(vz2_stat==vz2sWRK1)
004c28  f8950029          LDRB     r0,[r5,#0x29]  ; vz2_stat
004c2c  280a              CMP      r0,#0xa
004c2e  d102              BNE      |L1.19510|
;;;7698   	{
;;;7699   	u_necc=FZ_U1;
004c30  4935              LDR      r1,|L1.19720|
004c32  8809              LDRH     r1,[r1,#0]  ; FZ_U1
004c34  8021              STRH     r1,[r4,#0]
                  |L1.19510|
;;;7700   	}
;;;7701   if(vz2_stat==vz2sWRK2)
004c36  280b              CMP      r0,#0xb
004c38  d102              BNE      |L1.19520|
;;;7702   	{
;;;7703   	u_necc=FZ_U2;
004c3a  4834              LDR      r0,|L1.19724|
004c3c  8800              LDRH     r0,[r0,#0]  ; FZ_U2
004c3e  8020              STRH     r0,[r4,#0]
                  |L1.19520|
;;;7704   	}
;;;7705   
;;;7706   if((uavt_set_stat==uassSTEP1)||(uavt_set_stat==uassSTEP2))
004c40  4813              LDR      r0,|L1.19600|
004c42  7800              LDRB     r0,[r0,#0]  ; uavt_set_stat
004c44  2801              CMP      r0,#1
004c46  d001              BEQ      |L1.19532|
004c48  2802              CMP      r0,#2
004c4a  d102              BNE      |L1.19538|
                  |L1.19532|
;;;7707   	{
;;;7708   	u_necc=U_AVT;
004c4c  4813              LDR      r0,|L1.19612|
004c4e  8800              LDRH     r0,[r0,#0]  ; U_AVT
004c50  8020              STRH     r0,[r4,#0]
                  |L1.19538|
;;;7709   	}
;;;7710   
;;;7711   if(mess_find_unvol(MESS2UNECC_HNDL))
004c52  20be              MOVS     r0,#0xbe
004c54  f7fffffe          BL       mess_find_unvol
004c58  b128              CBZ      r0,|L1.19558|
;;;7712   	{		
;;;7713   	if(mess_data[0]==PARAM_UNECC_SET)
004c5a  481a              LDR      r0,|L1.19652|
004c5c  6801              LDR      r1,[r0,#0]  ; mess_data
004c5e  29bf              CMP      r1,#0xbf
004c60  d101              BNE      |L1.19558|
;;;7714   		{
;;;7715   		u_necc=mess_data[1];
004c62  6840              LDR      r0,[r0,#4]  ; mess_data
004c64  8020              STRH     r0,[r4,#0]
                  |L1.19558|
;;;7716   		}		
;;;7717   	} 
;;;7718   
;;;7719   //if(ICA_EN)u_necc+=ica_u_necc;
;;;7720   #endif
;;;7721   
;;;7722   
;;;7723   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;7724   
;;;7725   #ifndef UKU_TELECORE2015
;;;7726   #ifndef UKU_TELECORE2017
;;;7727   if(unh_cnt0<10)
;;;7728   	{
;;;7729   	unh_cnt0++;
;;;7730   	if(unh_cnt0>=10)
;;;7731   		{
;;;7732   		unh_cnt0=0;
;;;7733   		b1Hz_unh=1;
;;;7734   		}
;;;7735   	}
;;;7736   
;;;7737   if(unh_cnt1<5)
;;;7738   	{
;;;7739   	unh_cnt1++;
;;;7740   	if(unh_cnt1==5)
;;;7741   		{
;;;7742   		unh_cnt1=0;
;;;7743   //		b2Hz_unh=1;
;;;7744   		}
;;;7745   	} 
;;;7746   
;;;7747   
;;;7748   
;;;7749   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;7750   	{		
;;;7751   	if(mess_data[0]==PARAM_UNECC_SET)
;;;7752   		{
;;;7753   		u_necc=mess_data[1];
;;;7754   		}		
;;;7755   	}
;;;7756   
;;;7757   
;;;7758   else if(b1Hz_unh)
;;;7759   	{
;;;7760   	
;;;7761   	if((BAT_IS_ON[0]!=bisON) && (BAT_IS_ON[1]!=bisON))
;;;7762   		{
;;;7763   		
;;;7764   		u_necc=U0B;
;;;7765   		#ifdef IPS_SGEP_GAZPROM
;;;7766   		u_necc=UB0;
;;;7767   		#endif
;;;7768   		}
;;;7769   	else 
;;;7770   		{
;;;7771   		if(BAT_TYPE==0) //если батарея обычная
;;;7772   			{
;;;7773   			for(i=0;i<2;i++)
;;;7774   				{
;;;7775   				if(BAT_IS_ON[i]==bisON)
;;;7776   					{
;;;7777   					if(bat[i]._nd)t[i]=20;
;;;7778   					else t[i]=bat[i]._Tb;
;;;7779   					}
;;;7780   				else
;;;7781   					{
;;;7782   					t[i]=-20;
;;;7783   					}
;;;7784   				}
;;;7785   			if(t[0]>t[1])mat_temper=t[0];
;;;7786   			else mat_temper=t[1];
;;;7787   			
;;;7788   		
;;;7789   			if(mat_temper<0)temp_SL=UB0; 
;;;7790   			else 
;;;7791   				{
;;;7792   				if(mat_temper>40)mat_temper=40; 
;;;7793   				temp_SL=(UB20-UB0)*10;
;;;7794   				temp_SL*=mat_temper;
;;;7795   				temp_SL/=200;
;;;7796   				temp_SL+=UB0;
;;;7797   				}
;;;7798   			if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7799   				{
;;;7800   				temp_SL=UVZ;
;;;7801   				}
;;;7802   			u_necc=(unsigned int)temp_SL;
;;;7803   			}
;;;7804   		else if(BAT_TYPE==1) //если батарея китайская
;;;7805   			{
;;;7806   			u_necc=U0B;
;;;7807   					
;;;7808   			u_necc=bat[0]._Ub+10;
;;;7809   
;;;7810   			
;;;7811   			if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7812   				{
;;;7813   				u_necc=UVZ;
;;;7814   				}
;;;7815   			if(u_necc>=UB0) u_necc=UB0;
;;;7816   			if(u_necc>=UB20) u_necc=UB20;
;;;7817   			}
;;;7818   		}  
;;;7819   	}
;;;7820   #endif
;;;7821   #endif
;;;7822   
;;;7823   #ifdef UKU_TELECORE2015
;;;7824   
;;;7825   if(unh_cnt0<10)
;;;7826   	{
;;;7827   	unh_cnt0++;
;;;7828   	if(unh_cnt0>=10)
;;;7829   		{
;;;7830   		unh_cnt0=0;
;;;7831   		b1Hz_unh=1;
;;;7832   		}
;;;7833   	}
;;;7834   
;;;7835   if(unh_cnt1<5)
;;;7836   	{
;;;7837   	unh_cnt1++;
;;;7838   	if(unh_cnt1==5)
;;;7839   		{
;;;7840   		unh_cnt1=0;
;;;7841   //		b2Hz_unh=1;
;;;7842   		}
;;;7843   	} 
;;;7844   
;;;7845   
;;;7846   
;;;7847   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;7848   	{		
;;;7849   	if(mess_data[0]==PARAM_UNECC_SET)
;;;7850   		{
;;;7851   		u_necc=mess_data[1];
;;;7852   		}		
;;;7853   	}
;;;7854   
;;;7855   
;;;7856   else if(b1Hz_unh)
;;;7857   	{
;;;7858   	b1Hz_unh=0;
;;;7859   
;;;7860   	if(BAT_TYPE==0)
;;;7861   		{
;;;7862   		if(bat[0]._nd)mat_temper=20;
;;;7863   		else mat_temper=bat[0]._Tb;
;;;7864   
;;;7865   			
;;;7866   		if(mat_temper<0)temp_SL=UB0; 
;;;7867   		else 
;;;7868   			{
;;;7869   			if(mat_temper>40)mat_temper=40; 
;;;7870   			temp_SL=(UB20-UB0)*10;
;;;7871   			temp_SL*=mat_temper;
;;;7872   			temp_SL/=200;
;;;7873   			temp_SL+=UB0;
;;;7874   			}
;;;7875   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7876   			{
;;;7877   			temp_SL=UVZ;
;;;7878   			}
;;;7879   		u_necc=(unsigned int)temp_SL;
;;;7880   	///u_necc=3456;
;;;7881   		}
;;;7882   	else if(BAT_TYPE==1)
;;;7883   		{
;;;7884   		
;;;7885   		gran(&DU_LI_BAT,1,30);
;;;7886   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;7887   		gran(&u_necc,0,UB0);
;;;7888   		gran(&u_necc,0,UB20);
;;;7889   		gran(&u_necc,0,540);		
;;;7890   
;;;7891   
;;;7892   		if(li_bat._batStat!=bsOK)
;;;7893   			{
;;;7894   			u_necc=U0B;
;;;7895   			}
;;;7896   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7897   			{
;;;7898   			u_necc=UVZ;
;;;7899   			}
;;;7900   		/* 
;;;7901   		u_necc=U0B;
;;;7902   		
;;;7903   
;;;7904   	
;;;7905   		u_necc=UB0;
;;;7906   		u_necc=li_bat._Ub+10;
;;;7907   		if((li_bat._Ub<450)||(li_bat._Ub>550))
;;;7908   			{
;;;7909   			lakb_error_cnt++;
;;;7910   			if(lakb_error_cnt>=30)
;;;7911   				{
;;;7912   				lakb_error_cnt=30;
;;;7913   				u_necc=U0B;
;;;7914   				}
;;;7915   			}
;;;7916   		else lakb_error_cnt=0;*/
;;;7917   		}
;;;7918   	else if(BAT_TYPE==2)
;;;7919   		{
;;;7920   		u_necc=U0B;
;;;7921   		
;;;7922   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7923   			{
;;;7924   			u_necc=UVZ;
;;;7925   			}
;;;7926   	
;;;7927   		u_necc=UB0;
;;;7928   		}
;;;7929   
;;;7930   	else if(BAT_TYPE==3)
;;;7931   		{
;;;7932   		u_necc=U0B;
;;;7933   		
;;;7934   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;7935   			{
;;;7936   			u_necc=UVZ;
;;;7937   			}
;;;7938   
;;;7939   		gran(&DU_LI_BAT,1,30);
;;;7940   
;;;7941   
;;;7942   		if(lakbNotErrorNum==0)
;;;7943   			{
;;;7944   			u_necc=U0B;
;;;7945   			}
;;;7946   		else 
;;;7947   			{
;;;7948   			signed short i;
;;;7949   			//signed short u_necc_max;
;;;7950   			//u_necc_max=0;
;;;7951   			char soc_flag=0;
;;;7952   
;;;7953   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;7954   				{
;;;7955   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;7956   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;7957   				}
;;;7958   
;;;7959   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;7960   			}
;;;7961   		gran(&u_necc,0,UB0);
;;;7962   		//gran(&u_necc,0,UB20);
;;;7963   		gran(&u_necc,0,540);
;;;7964   		}
;;;7965   	}
;;;7966   
;;;7967   #endif 
;;;7968   
;;;7969   #ifdef UKU_TELECORE2017
;;;7970   
;;;7971   if(unh_cnt0<10)
;;;7972   	{
;;;7973   	unh_cnt0++;
;;;7974   	if(unh_cnt0>=10)
;;;7975   		{
;;;7976   		unh_cnt0=0;
;;;7977   		b1Hz_unh=1;
;;;7978   		}
;;;7979   	}
;;;7980   
;;;7981   if(unh_cnt1<5)
;;;7982   	{
;;;7983   	unh_cnt1++;
;;;7984   	if(unh_cnt1==5)
;;;7985   		{
;;;7986   		unh_cnt1=0;
;;;7987   //		b2Hz_unh=1;
;;;7988   		}
;;;7989   	} 
;;;7990   
;;;7991   
;;;7992   
;;;7993   if(mess_find_unvol(MESS2UNECC_HNDL))
;;;7994   	{		
;;;7995   	if(mess_data[0]==PARAM_UNECC_SET)
;;;7996   		{
;;;7997   		u_necc=mess_data[1];
;;;7998   		}		
;;;7999   	}
;;;8000   
;;;8001   
;;;8002   else if(b1Hz_unh)
;;;8003   	{
;;;8004   	b1Hz_unh=0;
;;;8005   
;;;8006   	if(BAT_TYPE==0)
;;;8007   		{
;;;8008   		if(bat[0]._nd)mat_temper=20;
;;;8009   		else mat_temper=bat[0]._Tb;
;;;8010   
;;;8011   			
;;;8012   		if(mat_temper<0)temp_SL=UB0; 
;;;8013   		else 
;;;8014   			{
;;;8015   			if(mat_temper>40)mat_temper=40; 
;;;8016   			temp_SL=(UB20-UB0)*10;
;;;8017   			temp_SL*=mat_temper;
;;;8018   			temp_SL/=200;
;;;8019   			temp_SL+=UB0;
;;;8020   			}
;;;8021   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;8022   			{
;;;8023   			temp_SL=UVZ;
;;;8024   			}
;;;8025   		u_necc=(unsigned int)temp_SL;
;;;8026   	///u_necc=3456;
;;;8027   		}
;;;8028   	else if(BAT_TYPE==1)
;;;8029   		{
;;;8030   		
;;;8031   		gran(&DU_LI_BAT,1,30);
;;;8032   		u_necc=li_bat._Ub+DU_LI_BAT;
;;;8033   		gran(&u_necc,0,UB0);
;;;8034   		gran(&u_necc,0,UB20);
;;;8035   		gran(&u_necc,0,540);		
;;;8036   
;;;8037   
;;;8038   		if(li_bat._batStat!=bsOK)
;;;8039   			{
;;;8040   			u_necc=U0B;
;;;8041   			}
;;;8042   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;8043   			{
;;;8044   			u_necc=UVZ;
;;;8045   			}
;;;8046   		}
;;;8047   	else if(BAT_TYPE==2)
;;;8048   		{
;;;8049   		u_necc=U0B;
;;;8050   		
;;;8051   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;8052   			{
;;;8053   			u_necc=UVZ;
;;;8054   			}
;;;8055   	
;;;8056   		u_necc=UB0;
;;;8057   		}
;;;8058   
;;;8059   	else if(BAT_TYPE==3)
;;;8060   		{
;;;8061   		u_necc=U0B;
;;;8062   		
;;;8063   		if((spc_stat==spcVZ)&&(sk_stat[0]==1))
;;;8064   			{
;;;8065   			u_necc=UVZ;
;;;8066   			}
;;;8067   
;;;8068   		gran(&DU_LI_BAT,1,30);
;;;8069   
;;;8070   
;;;8071   		if(lakbNotErrorNum==0)
;;;8072   			{
;;;8073   			u_necc=U0B;
;;;8074   			}
;;;8075   		else 
;;;8076   			{
;;;8077   			signed short i;
;;;8078   			//signed short u_necc_max;
;;;8079   			//u_necc_max=0;
;;;8080   			char soc_flag=0;
;;;8081   
;;;8082   			for(i=(NUMBAT_TELECORE-1);i>=0;i--)
;;;8083   				{
;;;8084   				if(lakb[i]._communicationFullErrorStat==0)u_necc=lakb[i]._tot_bat_volt+DU_LI_BAT;
;;;8085   				if(lakb[i]._s_o_c_percent<QSODERG_LI_BAT)soc_flag=1;
;;;8086   				}
;;;8087   
;;;8088   			if(soc_flag==0)u_necc=USODERG_LI_BAT;
;;;8089   			}
;;;8090   		gran(&u_necc,0,UB0);
;;;8091   		//gran(&u_necc,0,UB20);
;;;8092   		gran(&u_necc,0,540);
;;;8093   		}
;;;8094   	}
;;;8095   
;;;8096   #endif 
;;;8097   //u_necc=2356;
;;;8098   
;;;8099   if((speedChIsOn)||(sp_ch_stat==scsWRK))
;;;8100   	{
;;;8101   	u_necc=speedChrgVolt;
;;;8102   	}
;;;8103   #endif//gran(&u_necc,400,UMAX);
;;;8104   
;;;8105   
;;;8106   
;;;8107   temp_L=(signed long) u_necc;
004c66  f9b40000          LDRSH    r0,[r4,#0]  ; u_necc
;;;8108   temp_L*=98L;
004c6a  f04f0162          MOV      r1,#0x62
004c6e  fb00f101          MUL      r1,r0,r1
;;;8109   temp_L/=100L;
004c72  e04d              B        |L1.19728|
                  |L1.19572|
                          DCD      0xfff0bdc0
                  |L1.19576|
                          DCD      Ib_ips_termokompensat
                  |L1.19580|
                          DCD      IKB
                  |L1.19584|
                          DCD      bat
                  |L1.19588|
                          DCD      out_U
                  |L1.19592|
                          DCD      u_necc_up
                  |L1.19596|
                          DCD      u_necc_dn
                  |L1.19600|
                          DCD      uavt_set_stat
                  |L1.19604|
                          DCD      uavt_set_error_cnt
                  |L1.19608|
                          DCD      uavt_set_stat_old
                  |L1.19612|
                          DCD      U_AVT
                  |L1.19616|
                          DCD      bps_U
                  |L1.19620|
                          DCD      uavt_set_result_stat
                  |L1.19624|
                          DCD      avt_error_bps
                  |L1.19628|
                          DCD      u_max_temp
                  |L1.19632|
                          DCD      u_min_temp
                  |L1.19636|
                          DCD      uavt_bps_pntr
                  |L1.19640|
                          DCD      bps
                  |L1.19644|
                          DCD      NUMIST
                  |L1.19648|
                          DCD      avt_plazma
                  |L1.19652|
                          DCD      mess_data
                  |L1.19656|
                          DCD      TERMOKOMPENS
                  |L1.19660|
                          DCD      UB20
                  |L1.19664|
                          DCD      UVZ
                  |L1.19668|
                          DCD      ||area_number.25||
                  |L1.19672|
                          DCD      u_necc
                  |L1.19676|
                          DCD      ND_EXT
                  |L1.19680|
                          DCD      t_ext
                  |L1.19684|
                          DCD      mat_temper
                  |L1.19688|
                          DCD      UB0
                  |L1.19692|
                          DCD      sk_stat
                  |L1.19696|
                          DCD      VZ_CH_VENT_BLOK
                  |L1.19700|
                          DCD      speedChIsOn
                  |L1.19704|
                          DCD      sp_ch_stat
                  |L1.19708|
                          DCD      speedChrgVolt
                  |L1.19712|
                          DCD      hv_vz_stat
                  |L1.19716|
                          DCD      UZ_U
                  |L1.19720|
                          DCD      FZ_U1
                  |L1.19724|
                          DCD      FZ_U2
                  |L1.19728|
004d10  f04f0264          MOV      r2,#0x64
004d14  fb91f1f2          SDIV     r1,r1,r2
;;;8110   u_necc_dn=(signed short)temp_L;
004d18  4bfd              LDR      r3,|L1.20752|
004d1a  8019              STRH     r1,[r3,#0]
;;;8111   
;;;8112   temp_L=(signed long) u_necc;
;;;8113   temp_L*=102L;
004d1c  f04f0166          MOV      r1,#0x66
004d20  fb00f001          MUL      r0,r0,r1
;;;8114   temp_L/=100L;
004d24  fb90f0f2          SDIV     r0,r0,r2
;;;8115   u_necc_up=(signed short)temp_L;
004d28  49fa              LDR      r1,|L1.20756|
004d2a  8008              STRH     r0,[r1,#0]
;;;8116   /*
;;;8117   #ifdef IPS_SGEP_GAZPROM
;;;8118   u_necc=248;
;;;8119   #endif */
;;;8120   }
004d2c  bdf8              POP      {r3-r7,pc}
;;;8121   
                          ENDP

                  num_necc_hndl PROC
;;;8123   //-----------------------------------------------
;;;8124   void num_necc_hndl(void)
004d2e  e92d41f0          PUSH     {r4-r8,lr}
;;;8125   {
;;;8126   
;;;8127   static short num_necc_block_cnt;
;;;8128   if(num_necc_block_cnt) num_necc_block_cnt--;
004d32  4cf9              LDR      r4,|L1.20760|
004d34  f9b40032          LDRSH    r0,[r4,#0x32]  ; num_necc_block_cnt
004d38  b110              CBZ      r0,|L1.19776|
004d3a  f1a00001          SUB      r0,r0,#1
004d3e  8660              STRH     r0,[r4,#0x32]
                  |L1.19776|
;;;8129   
;;;8130   Isumm_=Isumm;
004d40  48f6              LDR      r0,|L1.20764|
004d42  4df7              LDR      r5,|L1.20768|
004d44  8800              LDRH     r0,[r0,#0]  ; Isumm
004d46  8028              STRH     r0,[r5,#0]
;;;8131   
;;;8132   if(bat[0]._Ib<0) Isumm_+=(abs(bat[0]._Ib))/10;
004d48  4ef6              LDR      r6,|L1.20772|
004d4a  270a              MOVS     r7,#0xa
004d4c  f9b60008          LDRSH    r0,[r6,#8]  ; bat
004d50  2800              CMP      r0,#0
004d52  da06              BGE      |L1.19810|
004d54  f7fffffe          BL       abs
004d58  fb90f0f7          SDIV     r0,r0,r7
004d5c  8829              LDRH     r1,[r5,#0]  ; Isumm_
004d5e  4408              ADD      r0,r0,r1
004d60  8028              STRH     r0,[r5,#0]
                  |L1.19810|
;;;8133   if(bat[1]._Ib<0) Isumm_+=(abs(bat[1]._Ib))/10;
004d62  f9b60054          LDRSH    r0,[r6,#0x54]  ; bat
004d66  2800              CMP      r0,#0
004d68  da06              BGE      |L1.19832|
004d6a  f7fffffe          BL       abs
004d6e  fb90f0f7          SDIV     r0,r0,r7
004d72  8829              LDRH     r1,[r5,#0]  ; Isumm_
004d74  4408              ADD      r0,r0,r1
004d76  8028              STRH     r0,[r5,#0]
                  |L1.19832|
;;;8134   
;;;8135   num_necc_up=(Isumm_/((signed short)IMAX))+1;
004d78  49eb              LDR      r1,|L1.20776|
004d7a  f9b50000          LDRSH    r0,[r5,#0]  ; Isumm_
004d7e  f9b11000          LDRSH    r1,[r1,#0]  ; IMAX
004d82  fb90f1f1          SDIV     r1,r0,r1
004d86  f1010101          ADD      r1,r1,#1
004d8a  b2c9              UXTB     r1,r1
004d8c  75a1              STRB     r1,[r4,#0x16]
;;;8136   ////Isumm_+=(signed short)((IMAX*(10-KIMAX))/10);
;;;8137   ////Isumm_+=(signed short)(IMAX-IMIN);
;;;8138   
;;;8139   num_necc_down=(Isumm_/((signed short)IMIN))+1;
004d8e  4ae7              LDR      r2,|L1.20780|
004d90  f9b22000          LDRSH    r2,[r2,#0]  ; IMIN
004d94  fb90f0f2          SDIV     r0,r0,r2
004d98  f1000001          ADD      r0,r0,#1
004d9c  b2c2              UXTB     r2,r0
004d9e  75e2              STRB     r2,[r4,#0x17]
;;;8140   
;;;8141   if(num_necc_up>num_necc)
004da0  48e3              LDR      r0,|L1.20784|
;;;8142   	{
;;;8143   	num_necc=num_necc_up;
;;;8144   	num_necc_block_cnt=60;
004da2  f04f053c          MOV      r5,#0x3c
004da6  f9b03000          LDRSH    r3,[r0,#0]            ;8141  ; num_necc
004daa  4299              CMP      r1,r3                 ;8141
004dac  dd02              BLE      |L1.19892|
004dae  8001              STRH     r1,[r0,#0]            ;8143
004db0  8665              STRH     r5,[r4,#0x32]
004db2  e005              B        |L1.19904|
                  |L1.19892|
;;;8145   	}
;;;8146   else if(num_necc_down<num_necc)
004db4  429a              CMP      r2,r3
004db6  da03              BGE      |L1.19904|
;;;8147   	{
;;;8148   	if(!num_necc_block_cnt)
004db8  8e61              LDRH     r1,[r4,#0x32]  ; num_necc_block_cnt
004dba  b909              CBNZ     r1,|L1.19904|
;;;8149   		{
;;;8150   		num_necc=num_necc_down;
004dbc  8002              STRH     r2,[r0,#0]
;;;8151   		num_necc_block_cnt=60;
004dbe  8665              STRH     r5,[r4,#0x32]
                  |L1.19904|
;;;8152   		}
;;;8153   	}
;;;8154   
;;;8155   if(PAR) num_necc=NUMIST;
004dc0  49dc              LDR      r1,|L1.20788|
004dc2  880a              LDRH     r2,[r1,#0]  ; PAR
004dc4  49dc              LDR      r1,|L1.20792|
004dc6  b10a              CBZ      r2,|L1.19916|
004dc8  880a              LDRH     r2,[r1,#0]  ; NUMIST
004dca  8002              STRH     r2,[r0,#0]
                  |L1.19916|
;;;8156   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8157   if(bPARALLEL) num_necc=NUMIST;
004dcc  f8942024          LDRB     r2,[r4,#0x24]  ; bPARALLEL
004dd0  b10a              CBZ      r2,|L1.19926|
004dd2  880a              LDRH     r2,[r1,#0]  ; NUMIST
004dd4  8002              STRH     r2,[r0,#0]
                  |L1.19926|
;;;8158   if(vz1_stat==vz1sWRK)num_necc=NUMIST; //Включаем все источники если уравнительный заряд
004dd6  f8942026          LDRB     r2,[r4,#0x26]  ; vz1_stat
004dda  2a0a              CMP      r2,#0xa
004ddc  d101              BNE      |L1.19938|
004dde  880a              LDRH     r2,[r1,#0]  ; NUMIST
004de0  8002              STRH     r2,[r0,#0]
                  |L1.19938|
;;;8159   if((vz2_stat==vz2sWRK1)||(vz2_stat==vz2sWRK2))num_necc=NUMIST; //Включаем все источники если уравнительный заряд
004de2  f8942029          LDRB     r2,[r4,#0x29]  ; vz2_stat
004de6  2a0a              CMP      r2,#0xa
004de8  d001              BEQ      |L1.19950|
004dea  2a0b              CMP      r2,#0xb
004dec  d101              BNE      |L1.19954|
                  |L1.19950|
004dee  880a              LDRH     r2,[r1,#0]  ; NUMIST
004df0  8002              STRH     r2,[r0,#0]
                  |L1.19954|
;;;8160   #endif
;;;8161   
;;;8162   gran(&num_necc,1,NUMIST);
004df2  f9b12000          LDRSH    r2,[r1,#0]  ; NUMIST
004df6  e8bd41f0          POP      {r4-r8,lr}
004dfa  2101              MOVS     r1,#1
004dfc  48cc              LDR      r0,|L1.20784|
004dfe  f7ffbffe          B.W      gran
;;;8163   
;;;8164   }
;;;8165   
                          ENDP

                  cntrl_hndl PROC
;;;8168   //-----------------------------------------------
;;;8169   void cntrl_hndl(void)
004e02  e92d5ff0          PUSH     {r4-r12,lr}
;;;8170   {
;;;8171   
;;;8172   
;;;8173   
;;;8174   IZMAX_=IZMAX;
004e06  48cd              LDR      r0,|L1.20796|
004e08  4cc3              LDR      r4,|L1.20760|
004e0a  8800              LDRH     r0,[r0,#0]  ; IZMAX
004e0c  f8a40046          STRH     r0,[r4,#0x46]
;;;8175   
;;;8176   //cntrl_hndl_plazma=10;
;;;8177   
;;;8178   if((speedChIsOn)||(sp_ch_stat==scsWRK))IZMAX_=speedChrgCurr;
004e10  48cb              LDR      r0,|L1.20800|
004e12  8800              LDRH     r0,[r0,#0]  ; speedChIsOn
004e14  b918              CBNZ     r0,|L1.19998|
004e16  48cb              LDR      r0,|L1.20804|
004e18  7800              LDRB     r0,[r0,#0]  ; sp_ch_stat
004e1a  2802              CMP      r0,#2
004e1c  d103              BNE      |L1.20006|
                  |L1.19998|
004e1e  48ca              LDR      r0,|L1.20808|
004e20  8800              LDRH     r0,[r0,#0]  ; speedChrgCurr
004e22  f8a40046          STRH     r0,[r4,#0x46]
                  |L1.20006|
;;;8179   if(vz1_stat==vz1sWRK) IZMAX_=UZ_IMAX;
004e26  f8940026          LDRB     r0,[r4,#0x26]  ; vz1_stat
004e2a  280a              CMP      r0,#0xa
004e2c  d103              BNE      |L1.20022|
004e2e  48c7              LDR      r0,|L1.20812|
004e30  8800              LDRH     r0,[r0,#0]  ; UZ_IMAX
004e32  f8a40046          STRH     r0,[r4,#0x46]
                  |L1.20022|
;;;8180   if(vz2_stat==vz2sWRK1) IZMAX_=FZ_IMAX1;
004e36  f8940029          LDRB     r0,[r4,#0x29]  ; vz2_stat
004e3a  280a              CMP      r0,#0xa
004e3c  d103              BNE      |L1.20038|
004e3e  49c4              LDR      r1,|L1.20816|
004e40  8809              LDRH     r1,[r1,#0]  ; FZ_IMAX1
004e42  f8a41046          STRH     r1,[r4,#0x46]
                  |L1.20038|
;;;8181   if(vz2_stat==vz2sWRK2) IZMAX_=FZ_IMAX2;
004e46  280b              CMP      r0,#0xb
004e48  d103              BNE      |L1.20050|
004e4a  48c2              LDR      r0,|L1.20820|
004e4c  8800              LDRH     r0,[r0,#0]  ; FZ_IMAX2
004e4e  f8a40046          STRH     r0,[r4,#0x46]
                  |L1.20050|
;;;8182   //if(spc_stat==spcVZ) IZMAX_=IMAX_VZ;
;;;8183   
;;;8184   if(cntrl_stat_blok_cnt)cntrl_stat_blok_cnt--;
004e52  f9b4006e          LDRSH    r0,[r4,#0x6e]  ; cntrl_stat_blok_cnt
004e56  b118              CBZ      r0,|L1.20064|
004e58  f1a00001          SUB      r0,r0,#1
004e5c  f8a4006e          STRH     r0,[r4,#0x6e]
                  |L1.20064|
;;;8185   if(cntrl_stat_blok_cnt_)cntrl_stat_blok_cnt_--;
004e60  f9b40070          LDRSH    r0,[r4,#0x70]  ; cntrl_stat_blok_cnt_
004e64  b118              CBZ      r0,|L1.20078|
004e66  f1a00001          SUB      r0,r0,#1
004e6a  f8a40070          STRH     r0,[r4,#0x70]
                  |L1.20078|
;;;8186   
;;;8187   if((bat[0]._temper_stat&0x03)||(bat[1]._temper_stat&0x03))IZMAX_=IZMAX_/10;
004e6e  48ad              LDR      r0,|L1.20772|
004e70  f04f080a          MOV      r8,#0xa               ;8179
004e74  f890103f          LDRB     r1,[r0,#0x3f]  ; bat
004e78  0789              LSLS     r1,r1,#30
004e7a  d103              BNE      |L1.20100|
004e7c  f890008b          LDRB     r0,[r0,#0x8b]  ; bat
004e80  0780              LSLS     r0,r0,#30
004e82  d005              BEQ      |L1.20112|
                  |L1.20100|
004e84  f8b40046          LDRH     r0,[r4,#0x46]  ; IZMAX_
004e88  fbb0f0f8          UDIV     r0,r0,r8
004e8c  f8a40046          STRH     r0,[r4,#0x46]
                  |L1.20112|
;;;8188   
;;;8189   
;;;8190   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8191   if((REG_SPEED<1)||(REG_SPEED>5)) REG_SPEED=1;
004e90  48b1              LDR      r0,|L1.20824|
004e92  2601              MOVS     r6,#1
004e94  f9b01000          LDRSH    r1,[r0,#0]  ; REG_SPEED
004e98  1e49              SUBS     r1,r1,#1
004e9a  2905              CMP      r1,#5
004e9c  d300              BCC      |L1.20128|
004e9e  8006              STRH     r6,[r0,#0]
                  |L1.20128|
;;;8192   if(ch_cnt0<(10*REG_SPEED))
004ea0  f9b00000          LDRSH    r0,[r0,#0]  ; REG_SPEED
004ea4  2500              MOVS     r5,#0                 ;8178
004ea6  eb000180          ADD      r1,r0,r0,LSL #2
004eaa  7b60              LDRB     r0,[r4,#0xd]  ; ch_cnt0
004eac  ebb00f41          CMP      r0,r1,LSL #1
004eb0  da08              BGE      |L1.20164|
;;;8193   	{
;;;8194   	ch_cnt0++;
004eb2  f1000001          ADD      r0,r0,#1
004eb6  b2c0              UXTB     r0,r0
004eb8  7360              STRB     r0,[r4,#0xd]
;;;8195   	if(ch_cnt0>=10*REG_SPEED)
004eba  ebb00f41          CMP      r0,r1,LSL #1
004ebe  db01              BLT      |L1.20164|
;;;8196   		{
;;;8197   		ch_cnt0=0;
004ec0  7365              STRB     r5,[r4,#0xd]
;;;8198   		b1Hz_ch=1;
004ec2  73a6              STRB     r6,[r4,#0xe]
                  |L1.20164|
;;;8199   		}
;;;8200   	}
;;;8201   #endif
;;;8202   #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;8203   if(ch_cnt0<10)
;;;8204   	{
;;;8205   	ch_cnt0++;
;;;8206   	if(ch_cnt0>=10)
;;;8207   		{
;;;8208   		ch_cnt0=0;
;;;8209   		b1Hz_ch=1;
;;;8210   		}
;;;8211   	}
;;;8212   #endif
;;;8213   
;;;8214   
;;;8215   if(mess_find_unvol(MESS2CNTRL_HNDL))
004ec4  20e1              MOVS     r0,#0xe1
004ec6  f7fffffe          BL       mess_find_unvol
;;;8216   	{
;;;8217   	if(mess_data[0]==PARAM_CNTRL_STAT_PLUS)
;;;8218   		{
;;;8219   		cntrl_stat_new=cntrl_stat_old+mess_data[1];
;;;8220   		}
;;;8221   	else if(mess_data[0]==PARAM_CNTRL_STAT_MINUS)
;;;8222   		{
;;;8223   		cntrl_stat_new=cntrl_stat_old-mess_data[1];
;;;8224   		}
;;;8225   	else if(mess_data[0]==PARAM_CNTRL_STAT_STEP_DOWN)
;;;8226   		{
;;;8227   		static char cntrlStatIsDownCnt;
;;;8228   		cntrl_stat--;
;;;8229   
;;;8230   		if((cntrl_stat<=30)||(load_U<USIGN))
;;;8231   			{
;;;8232   			if(++cntrlStatIsDownCnt==250)mess_send(MESS2KB_HNDL,PARAM_CNTRL_IS_DOWN,0,10);
;;;8233   			}
;;;8234   		else 
;;;8235   			{
;;;8236   			cntrlStatIsDownCnt=0;
;;;8237   			}
;;;8238   
;;;8239   		}
;;;8240   	else if(mess_data[0]==PARAM_CNTRL_STAT_SET)
;;;8241   		{
;;;8242   		cntrl_stat_new=mess_data[1];
;;;8243   		}
;;;8244   
;;;8245   	else if(mess_data[0]==PARAM_CNTRL_STAT_FAST_REG)
;;;8246   		{
;;;8247   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8248   		if(bps_U>u_necc)
004eca  f8dfc290          LDR      r12,|L1.20828|
004ece  4aa4              LDR      r2,|L1.20832|
;;;8249   			{
;;;8250   			cntrl_hndl_plazma=11;
;;;8251   			if(((bps_U-u_necc)>40)&&(cntrl_stat_new>0))cntrl_stat_new-=5;
;;;8252   			else if((cntrl_stat_new)&&b1Hz_ch)cntrl_stat_new--;
;;;8253   			}
;;;8254   		else if(bps_U<u_necc)
;;;8255   			{
;;;8256   			cntrl_hndl_plazma=12;	
;;;8257   			if(((u_necc-bps_U)>40)&&(cntrl_stat_new<1015))cntrl_stat_new+=5;
;;;8258   			else	if((cntrl_stat_new<1020)&&b1Hz_ch)cntrl_stat_new++;
;;;8259   			}
;;;8260   		#elif defined(UKU_220)
;;;8261   		if(load_U>u_necc)
;;;8262   			{
;;;8263   			cntrl_hndl_plazma=13;
;;;8264   			if(((load_U-u_necc)>40)&&(cntrl_stat_new>0))cntrl_stat_new-=5;
;;;8265   			else if((cntrl_stat_new)&&b1Hz_ch)cntrl_stat_new--;
;;;8266   			}
;;;8267   		else if(load_U<u_necc)
;;;8268   			{
;;;8269   			cntrl_hndl_plazma=14;	
;;;8270   			if(((u_necc-load_U)>40)&&(cntrl_stat_new<1015))cntrl_stat_new+=5;
;;;8271   			else	if((cntrl_stat_new<1020)&&b1Hz_ch)cntrl_stat_new++;
;;;8272   			}
;;;8273   		#elif defined(UKU_220_V2)
;;;8274   		if(load_U>u_necc)
;;;8275   			{
;;;8276   			cntrl_hndl_plazma=15;
;;;8277   			if(((load_U-u_necc)>40)&&(cntrl_stat_new>0))cntrl_stat_new-=5;
;;;8278   			else if((cntrl_stat_new)&&b1Hz_ch)cntrl_stat_new--;
;;;8279   			}
;;;8280   		else if(load_U<u_necc)
;;;8281   			{
;;;8282   			cntrl_hndl_plazma=16;	
;;;8283   			if(((u_necc-load_U)>40)&&(cntrl_stat_new<1015))cntrl_stat_new+=5;
;;;8284   			else	if((cntrl_stat_new<1020)&&b1Hz_ch)cntrl_stat_new++;
;;;8285   			}
;;;8286   		#else
;;;8287   
;;;8288   		if(load_U>u_necc)
;;;8289   			{
;;;8290   			cntrl_hndl_plazma=17;
;;;8291   			if(((load_U-u_necc)>10)&&(cntrl_stat_new>0))cntrl_stat_new-=5;
;;;8292   			else if((cntrl_stat_new)&&b1Hz_ch)cntrl_stat_new--;
;;;8293   			}
;;;8294   		else if(load_U<u_necc)
;;;8295   			{
;;;8296   			cntrl_hndl_plazma=18;	
;;;8297   			if(((u_necc-load_U)>10)&&(cntrl_stat_new<1015))cntrl_stat_new+=5;
;;;8298   			else	if((cntrl_stat_new<1020)&&b1Hz_ch)cntrl_stat_new++;
;;;8299   			}
;;;8300   		#endif	
;;;8301   	 	}
;;;8302   
;;;8303   	gran(&cntrl_stat_new,10,1010);			
;;;8304   	cntrl_stat_old=cntrl_stat_new;
;;;8305   	cntrl_stat=cntrl_stat_new;
;;;8306   	}
;;;8307   
;;;8308   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8309   else if((b1Hz_ch)&&((!bIBAT_SMKLBR)||(bps[8]._cnt>40)))
004ed0  f8df9290          LDR      r9,|L1.20836|
;;;8310   	{
;;;8311   	cntrl_stat_new=cntrl_stat_old;
;;;8312   	cntrl_hndl_plazma=19;
;;;8313   	if((Ibmax/10)>(2*IZMAX_))
;;;8314   		{
;;;8315   		cntrl_hndl_plazma=20;
;;;8316             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8317   		else	cntrl_stat_new-=10;
;;;8318   		}		
;;;8319   	else if(((Ibmax/10)<(IZMAX_*2))&&(Ibmax>(IZMAX_*15)))
;;;8320   		{
;;;8321   		cntrl_hndl_plazma=21;
;;;8322             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8323             else	cntrl_stat_new-=3;
;;;8324   		}   
;;;8325   	else if((Ibmax<(IZMAX_*15))&&((Ibmax/10)>IZMAX_))
;;;8326   		{
;;;8327   		cntrl_hndl_plazma=22;
;;;8328   		cntrl_stat_new--;
;;;8329   		}
;;;8330   		
;;;8331   	else if(bps_U<u_necc)
;;;8332   		{
;;;8333   		cntrl_hndl_plazma=23;
;;;8334   		if(bps_U<(u_necc-(UB0-UB20)))
;;;8335   			{
;;;8336   			cntrl_hndl_plazma=24;
;;;8337   			if(Ibmax<0)
;;;8338   				{
;;;8339   				cntrl_hndl_plazma=25;
;;;8340                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8341   				else cntrl_stat_new+=10;
;;;8342   				}
;;;8343   			else if(Ibmax<(IZMAX_*5))
;;;8344   				{
;;;8345   				cntrl_hndl_plazma=26;
;;;8346                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8347   				else	cntrl_stat_new+=2;
;;;8348   				}
;;;8349   			else if(Ibmax<((IZMAX_*10)/*-10*/))//(Ibmax<((IZMAX_*95)/10))
;;;8350   				{
;;;8351   				cntrl_hndl_plazma=27;
;;;8352   				cntrl_stat_new++;
;;;8353   				}					
;;;8354   			}
;;;8355   		else if(bps_U<(u_necc-((UB0-UB20)/4)))
;;;8356   			{
;;;8357   			cntrl_hndl_plazma=28;
;;;8358   			if(Ibmax<(IZMAX_*5))
;;;8359   				{
;;;8360   				cntrl_hndl_plazma=29;
;;;8361                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8362   				else	cntrl_stat_new+=2;
;;;8363   				}
;;;8364   			else if(Ibmax<((IZMAX_*10)/*-10*/))//(Ibmax<((IZMAX_*95)/10))
;;;8365   				{
;;;8366   				cntrl_hndl_plazma=30;
;;;8367   				cntrl_stat_new++;
;;;8368   				}					
;;;8369   			}	
;;;8370   		else if(bps_U<(u_necc-1))
;;;8371   			{
;;;8372   			cntrl_hndl_plazma=31;
;;;8373   			if(Ibmax<((IZMAX_*10)/*-10*/))//(Ibmax<((IZMAX_*95)/10))
;;;8374   				{
;;;8375   				cntrl_hndl_plazma=32;
;;;8376   				cntrl_stat_new++;
;;;8377   				}					
;;;8378   			}					
;;;8379   		}	
;;;8380   	else if((bps_U>u_necc)/*&&(!cntrl_blok)*/)
;;;8381   		{ 	
;;;8382   		cntrl_hndl_plazma=33;
;;;8383   		if(bps_U>(u_necc+(UB0-UB20)))
;;;8384   			{
;;;8385   			cntrl_hndl_plazma=34;
;;;8386                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8387   			else	cntrl_stat_new-=10;
;;;8388   			}
;;;8389   		else if(bps_U>(u_necc+((UB0-UB20)/4)))
;;;8390   			{
;;;8391   			cntrl_hndl_plazma=35;
;;;8392                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8393   			else cntrl_stat_new-=2;
;;;8394   			}	
;;;8395   		else if(bps_U>(u_necc+1))
;;;8396   			{
;;;8397   			cntrl_hndl_plazma=36;
;;;8398   			cntrl_stat_new--;
;;;8399   			}					
;;;8400   		}
;;;8401   
;;;8402   	if((hv_vz_stat==hvsOFF)&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF))
;;;8403   		{
;;;8404   		if(((sk_stat[1]==1)&&(sk_stat_old[1]==0))&&(VZ_KIND==1))cntrl_stat_new=50;
;;;8405   		}
;;;8406   
;;;8407   	gran(&cntrl_stat_new,10,1010);			
;;;8408   	cntrl_stat_old=cntrl_stat_new;
;;;8409   	cntrl_stat=cntrl_stat_new;
;;;8410   	
;;;8411   	if(ICA_EN==0)
;;;8412   		{
;;;8413   		if(ica_cntrl_hndl_cnt)
004ed4  4fa4              LDR      r7,|L1.20840|
004ed6  2800              CMP      r0,#0                 ;8215
004ed8  d070              BEQ      |L1.20412|
004eda  49a4              LDR      r1,|L1.20844|
004edc  6808              LDR      r0,[r1,#0]            ;8217  ; mess_data
004ede  2864              CMP      r0,#0x64              ;8217
004ee0  d008              BEQ      |L1.20212|
004ee2  2869              CMP      r0,#0x69              ;8221
004ee4  d00c              BEQ      |L1.20224|
004ee6  286e              CMP      r0,#0x6e              ;8225
004ee8  d011              BEQ      |L1.20238|
004eea  28e5              CMP      r0,#0xe5              ;8240
004eec  d02d              BEQ      |L1.20298|
004eee  28e6              CMP      r0,#0xe6              ;8245
004ef0  d02f              BEQ      |L1.20306|
004ef2  e06f              B        |L1.20436|
                  |L1.20212|
004ef4  6848              LDR      r0,[r1,#4]            ;8219  ; mess_data
004ef6  8de1              LDRH     r1,[r4,#0x2e]         ;8219  ; cntrl_stat_old
004ef8  4408              ADD      r0,r0,r1              ;8219
004efa  f8a40042          STRH     r0,[r4,#0x42]         ;8219
004efe  e069              B        |L1.20436|
                  |L1.20224|
004f00  6848              LDR      r0,[r1,#4]            ;8223  ; mess_data
004f02  8de1              LDRH     r1,[r4,#0x2e]         ;8223  ; cntrl_stat_old
004f04  eba10000          SUB      r0,r1,r0              ;8223
004f08  f8a40042          STRH     r0,[r4,#0x42]         ;8223
004f0c  e062              B        |L1.20436|
                  |L1.20238|
004f0e  8da0              LDRH     r0,[r4,#0x2c]         ;8228  ; cntrl_stat
004f10  f1a00001          SUB      r0,r0,#1              ;8228
004f14  b200              SXTH     r0,r0                 ;8228
004f16  85a0              STRH     r0,[r4,#0x2c]         ;8228
004f18  281e              CMP      r0,#0x1e              ;8230
004f1a  dd07              BLE      |L1.20268|
004f1c  4894              LDR      r0,|L1.20848|
004f1e  4995              LDR      r1,|L1.20852|
004f20  f9b00000          LDRSH    r0,[r0,#0]            ;8230  ; load_U
004f24  f9b11000          LDRSH    r1,[r1,#0]            ;8230  ; USIGN
004f28  4288              CMP      r0,r1                 ;8230
004f2a  da0c              BGE      |L1.20294|
                  |L1.20268|
004f2c  79e0              LDRB     r0,[r4,#7]            ;8232  ; cntrlStatIsDownCnt
004f2e  1c40              ADDS     r0,r0,#1              ;8232
004f30  b2c0              UXTB     r0,r0                 ;8232
004f32  71e0              STRB     r0,[r4,#7]            ;8232
004f34  28fa              CMP      r0,#0xfa              ;8232
004f36  d14d              BNE      |L1.20436|
004f38  230a              MOVS     r3,#0xa               ;8232
004f3a  2200              MOVS     r2,#0                 ;8232
004f3c  21e7              MOVS     r1,#0xe7              ;8232
004f3e  20e6              MOVS     r0,#0xe6              ;8232
004f40  f7fffffe          BL       mess_send
004f44  e046              B        |L1.20436|
                  |L1.20294|
004f46  71e5              STRB     r5,[r4,#7]            ;8236
004f48  e044              B        |L1.20436|
                  |L1.20298|
004f4a  6848              LDR      r0,[r1,#4]            ;8242  ; mess_data
004f4c  f8a40042          STRH     r0,[r4,#0x42]         ;8242
004f50  e040              B        |L1.20436|
                  |L1.20306|
004f52  f9bc0000          LDRSH    r0,[r12,#0]           ;8248  ; bps_U
004f56  f9b21000          LDRSH    r1,[r2,#0]            ;8248  ; u_necc
004f5a  4288              CMP      r0,r1                 ;8248
004f5c  dd1a              BLE      |L1.20372|
004f5e  f04f020b          MOV      r2,#0xb               ;8250
004f62  f8842025          STRB     r2,[r4,#0x25]         ;8250
004f66  eba00001          SUB      r0,r0,r1              ;8251
004f6a  2828              CMP      r0,#0x28              ;8251
004f6c  dd08              BLE      |L1.20352|
004f6e  f9b40042          LDRSH    r0,[r4,#0x42]         ;8251  ; cntrl_stat_new
004f72  2800              CMP      r0,#0                 ;8251
004f74  dd04              BLE      |L1.20352|
004f76  f1a00005          SUB      r0,r0,#5              ;8251
004f7a  f8a40042          STRH     r0,[r4,#0x42]         ;8251
004f7e  e029              B        |L1.20436|
                  |L1.20352|
004f80  f9b40042          LDRSH    r0,[r4,#0x42]         ;8252  ; cntrl_stat_new
004f84  b330              CBZ      r0,|L1.20436|
004f86  7ba1              LDRB     r1,[r4,#0xe]          ;8252  ; b1Hz_ch
004f88  b321              CBZ      r1,|L1.20436|
004f8a  f1a00001          SUB      r0,r0,#1              ;8252
004f8e  f8a40042          STRH     r0,[r4,#0x42]         ;8252
004f92  e01f              B        |L1.20436|
                  |L1.20372|
004f94  da1e              BGE      |L1.20436|
004f96  f04f020c          MOV      r2,#0xc               ;8256
004f9a  f8842025          STRB     r2,[r4,#0x25]         ;8256
004f9e  eba10000          SUB      r0,r1,r0              ;8257
004fa2  2828              CMP      r0,#0x28              ;8257
004fa4  dd0b              BLE      |L1.20414|
004fa6  f9b40042          LDRSH    r0,[r4,#0x42]         ;8257  ; cntrl_stat_new
004faa  f24031f7          MOV      r1,#0x3f7             ;8257
004fae  4288              CMP      r0,r1                 ;8257
004fb0  da05              BGE      |L1.20414|
004fb2  f1000005          ADD      r0,r0,#5              ;8257
004fb6  f8a40042          STRH     r0,[r4,#0x42]         ;8257
004fba  e00b              B        |L1.20436|
                  |L1.20412|
004fbc  e016              B        |L1.20460|
                  |L1.20414|
004fbe  f9b40042          LDRSH    r0,[r4,#0x42]         ;8258  ; cntrl_stat_new
004fc2  f5b07f7f          CMP      r0,#0x3fc             ;8258
004fc6  da05              BGE      |L1.20436|
004fc8  7ba1              LDRB     r1,[r4,#0xe]          ;8258  ; b1Hz_ch
004fca  b119              CBZ      r1,|L1.20436|
004fcc  f1000001          ADD      r0,r0,#1              ;8258
004fd0  f8a40042          STRH     r0,[r4,#0x42]         ;8258
                  |L1.20436|
004fd4  4850              LDR      r0,|L1.20760|
004fd6  f24032f2          MOV      r2,#0x3f2             ;8303
004fda  210a              MOVS     r1,#0xa               ;8303
004fdc  3042              ADDS     r0,r0,#0x42           ;8303
004fde  f7fffffe          BL       gran
004fe2  f8b40042          LDRH     r0,[r4,#0x42]         ;8304  ; cntrl_stat_new
004fe6  85e0              STRH     r0,[r4,#0x2e]         ;8304
004fe8  85a0              STRH     r0,[r4,#0x2c]         ;8305
                  |L1.20458|
004fea  e19b              B        |L1.21284|
                  |L1.20460|
004fec  7ba0              LDRB     r0,[r4,#0xe]          ;8309  ; b1Hz_ch
004fee  2800              CMP      r0,#0                 ;8309
004ff0  d0fb              BEQ      |L1.20458|
004ff2  4861              LDR      r0,|L1.20856|
004ff4  8800              LDRH     r0,[r0,#0]            ;8309  ; bIBAT_SMKLBR
004ff6  b118              CBZ      r0,|L1.20480|
004ff8  f89902e3          LDRB     r0,[r9,#0x2e3]        ;8309  ; bps
004ffc  2828              CMP      r0,#0x28              ;8309
004ffe  d9f4              BLS      |L1.20458|
                  |L1.20480|
005000  f1040424          ADD      r4,r4,#0x24           ;8311
005004  f9b4000a          LDRSH    r0,[r4,#0xa]          ;8311  ; cntrl_stat_old
005008  83e0              STRH     r0,[r4,#0x1e]         ;8311
00500a  f04f0113          MOV      r1,#0x13              ;8312
00500e  7061              STRB     r1,[r4,#1]            ;8312
005010  f9b41020          LDRSH    r1,[r4,#0x20]         ;8313  ; Ibmax
005014  8c63              LDRH     r3,[r4,#0x22]         ;8313  ; IZMAX_
005016  fb91f8f8          SDIV     r8,r1,r8              ;8313
00501a  f1a40424          SUB      r4,r4,#0x24           ;8313
00501e  ebb80f43          CMP      r8,r3,LSL #1          ;8313
005022  dd10              BLE      |L1.20550|
005024  f04f0114          MOV      r1,#0x14              ;8315
005028  f8841025          STRB     r1,[r4,#0x25]         ;8315
00502c  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8316  ; cntrl_stat_blok_cnt
005030  b121              CBZ      r1,|L1.20540|
005032  f1a00001          SUB      r0,r0,#1              ;8316
005036  f8a40042          STRH     r0,[r4,#0x42]         ;8316
00503a  e13b              B        |L1.21172|
                  |L1.20540|
00503c  f1a0000a          SUB      r0,r0,#0xa            ;8317
005040  f8a40042          STRH     r0,[r4,#0x42]         ;8317
005044  e136              B        |L1.21172|
                  |L1.20550|
005046  da14              BGE      |L1.20594|
005048  ebc31a03          RSB      r10,r3,r3,LSL #4      ;8319
00504c  458a              CMP      r10,r1                ;8319
00504e  da10              BGE      |L1.20594|
005050  f04f0115          MOV      r1,#0x15              ;8321
005054  f8841025          STRB     r1,[r4,#0x25]         ;8321
005058  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8322  ; cntrl_stat_blok_cnt
00505c  b121              CBZ      r1,|L1.20584|
00505e  f1a00001          SUB      r0,r0,#1              ;8322
005062  f8a40042          STRH     r0,[r4,#0x42]         ;8322
005066  e125              B        |L1.21172|
                  |L1.20584|
005068  f1a00003          SUB      r0,r0,#3              ;8323
00506c  f8a40042          STRH     r0,[r4,#0x42]         ;8323
005070  e120              B        |L1.21172|
                  |L1.20594|
005072  ebc31a03          RSB      r10,r3,r3,LSL #4      ;8325
005076  458a              CMP      r10,r1                ;8325
005078  dd0a              BLE      |L1.20624|
00507a  4598              CMP      r8,r3                 ;8325
00507c  dd08              BLE      |L1.20624|
00507e  f04f0116          MOV      r1,#0x16              ;8327
005082  f8841025          STRB     r1,[r4,#0x25]         ;8327
005086  f1a00001          SUB      r0,r0,#1              ;8328
00508a  f8a40042          STRH     r0,[r4,#0x42]         ;8328
00508e  e111              B        |L1.21172|
                  |L1.20624|
005090  f9bcc000          LDRSH    r12,[r12,#0]          ;8331  ; bps_U
005094  f9b22000          LDRSH    r2,[r2,#0]            ;8331  ; u_necc
005098  f8df80e0          LDR      r8,|L1.20860|
00509c  f8dfb0e0          LDR      r11,|L1.20864|
0050a0  4594              CMP      r12,r2                ;8331
0050a2  da6f              BGE      |L1.20868|
0050a4  f04f0a17          MOV      r10,#0x17             ;8333
0050a8  f884a025          STRB     r10,[r4,#0x25]        ;8333
0050ac  f9b88000          LDRSH    r8,[r8,#0]            ;8334  ; UB0
0050b0  f9bba000          LDRSH    r10,[r11,#0]          ;8334  ; UB20
0050b4  eba8080a          SUB      r8,r8,r10             ;8334
0050b8  eba20a08          SUB      r10,r2,r8             ;8334
0050bc  45e2              CMP      r10,r12               ;8334
0050be  dd74              BLE      |L1.20906|
0050c0  f04f0218          MOV      r2,#0x18              ;8336
0050c4  f8842025          STRB     r2,[r4,#0x25]         ;8336
0050c8  2900              CMP      r1,#0                 ;8337
0050ca  da10              BGE      |L1.20718|
0050cc  f04f0119          MOV      r1,#0x19              ;8339
0050d0  f8841025          STRB     r1,[r4,#0x25]         ;8339
0050d4  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8340  ; cntrl_stat_blok_cnt
0050d8  b121              CBZ      r1,|L1.20708|
0050da  f1000001          ADD      r0,r0,#1              ;8340
0050de  f8a40042          STRH     r0,[r4,#0x42]         ;8340
0050e2  e0e7              B        |L1.21172|
                  |L1.20708|
0050e4  f100000a          ADD      r0,r0,#0xa            ;8341
0050e8  f8a40042          STRH     r0,[r4,#0x42]         ;8341
0050ec  e0e2              B        |L1.21172|
                  |L1.20718|
0050ee  eb030283          ADD      r2,r3,r3,LSL #2       ;8343
0050f2  428a              CMP      r2,r1                 ;8343
0050f4  dd4c              BLE      |L1.20880|
0050f6  f04f011a          MOV      r1,#0x1a              ;8345
0050fa  f8841025          STRB     r1,[r4,#0x25]         ;8345
0050fe  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8346  ; cntrl_stat_blok_cnt
005102  b121              CBZ      r1,|L1.20750|
005104  f1000001          ADD      r0,r0,#1              ;8346
005108  f8a40042          STRH     r0,[r4,#0x42]         ;8346
00510c  e0d2              B        |L1.21172|
                  |L1.20750|
00510e  e03a              B        |L1.20870|
                  |L1.20752|
                          DCD      u_necc_dn
                  |L1.20756|
                          DCD      u_necc_up
                  |L1.20760|
                          DCD      ||area_number.25||
                  |L1.20764|
                          DCD      Isumm
                  |L1.20768|
                          DCD      Isumm_
                  |L1.20772|
                          DCD      bat
                  |L1.20776|
                          DCD      IMAX
                  |L1.20780|
                          DCD      IMIN
                  |L1.20784|
                          DCD      num_necc
                  |L1.20788|
                          DCD      PAR
                  |L1.20792|
                          DCD      NUMIST
                  |L1.20796|
                          DCD      IZMAX
                  |L1.20800|
                          DCD      speedChIsOn
                  |L1.20804|
                          DCD      sp_ch_stat
                  |L1.20808|
                          DCD      speedChrgCurr
                  |L1.20812|
                          DCD      UZ_IMAX
                  |L1.20816|
                          DCD      FZ_IMAX1
                  |L1.20820|
                          DCD      FZ_IMAX2
                  |L1.20824|
                          DCD      REG_SPEED
                  |L1.20828|
                          DCD      bps_U
                  |L1.20832|
                          DCD      u_necc
                  |L1.20836|
                          DCD      bps
                  |L1.20840|
                          DCD      ica_cntrl_hndl_cnt
                  |L1.20844|
                          DCD      mess_data
                  |L1.20848|
                          DCD      load_U
                  |L1.20852|
                          DCD      USIGN
                  |L1.20856|
                          DCD      bIBAT_SMKLBR
                  |L1.20860|
                          DCD      UB0
                  |L1.20864|
                          DCD      UB20
                  |L1.20868|
005184  e053              B        |L1.21038|
                  |L1.20870|
005186  f1000002          ADD      r0,r0,#2              ;8347
00518a  f8a40042          STRH     r0,[r4,#0x42]         ;8347
00518e  e091              B        |L1.21172|
                  |L1.20880|
005190  ebb10f42          CMP      r1,r2,LSL #1          ;8349
005194  da07              BGE      |L1.20902|
005196  f04f011b          MOV      r1,#0x1b              ;8351
00519a  f8841025          STRB     r1,[r4,#0x25]         ;8351
00519e  f1000001          ADD      r0,r0,#1              ;8352
0051a2  f8a40042          STRH     r0,[r4,#0x42]         ;8352
                  |L1.20902|
0051a6  e085              B        |L1.21172|
0051a8  e7ff              B        |L1.20906|
                  |L1.20906|
0051aa  ea4f7ae8          ASR      r10,r8,#31            ;8355
0051ae  eb08789a          ADD      r8,r8,r10,LSR #30     ;8355
0051b2  eba208a8          SUB      r8,r2,r8,ASR #2       ;8355
0051b6  45e0              CMP      r8,r12                ;8355
0051b8  dd24              BLE      |L1.20996|
0051ba  f04f021c          MOV      r2,#0x1c              ;8357
0051be  f8842025          STRB     r2,[r4,#0x25]         ;8357
0051c2  eb030283          ADD      r2,r3,r3,LSL #2       ;8358
0051c6  428a              CMP      r2,r1                 ;8358
0051c8  dd10              BLE      |L1.20972|
0051ca  f04f011d          MOV      r1,#0x1d              ;8360
0051ce  f8841025          STRB     r1,[r4,#0x25]         ;8360
0051d2  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8361  ; cntrl_stat_blok_cnt
0051d6  b121              CBZ      r1,|L1.20962|
0051d8  f1000001          ADD      r0,r0,#1              ;8361
0051dc  f8a40042          STRH     r0,[r4,#0x42]         ;8361
0051e0  e068              B        |L1.21172|
                  |L1.20962|
0051e2  f1000002          ADD      r0,r0,#2              ;8362
0051e6  f8a40042          STRH     r0,[r4,#0x42]         ;8362
0051ea  e063              B        |L1.21172|
                  |L1.20972|
0051ec  ebb10f42          CMP      r1,r2,LSL #1          ;8364
0051f0  da60              BGE      |L1.21172|
0051f2  f04f011e          MOV      r1,#0x1e              ;8366
0051f6  f8841025          STRB     r1,[r4,#0x25]         ;8366
0051fa  f1000001          ADD      r0,r0,#1              ;8367
0051fe  f8a40042          STRH     r0,[r4,#0x42]         ;8367
005202  e057              B        |L1.21172|
                  |L1.20996|
005204  1e52              SUBS     r2,r2,#1              ;8370
005206  4594              CMP      r12,r2                ;8370
005208  da54              BGE      |L1.21172|
00520a  f04f021f          MOV      r2,#0x1f              ;8372
00520e  f8842025          STRB     r2,[r4,#0x25]         ;8372
005212  eb030283          ADD      r2,r3,r3,LSL #2       ;8373
005216  ebb10f42          CMP      r1,r2,LSL #1          ;8373
00521a  da4b              BGE      |L1.21172|
00521c  f04f0120          MOV      r1,#0x20              ;8375
005220  f8841025          STRB     r1,[r4,#0x25]         ;8375
005224  f1000001          ADD      r0,r0,#1              ;8376
005228  f8a40042          STRH     r0,[r4,#0x42]         ;8376
00522c  e042              B        |L1.21172|
                  |L1.21038|
00522e  dd41              BLE      |L1.21172|
005230  f04f0121          MOV      r1,#0x21              ;8382
005234  f8841025          STRB     r1,[r4,#0x25]         ;8382
005238  f9b81000          LDRSH    r1,[r8,#0]            ;8383  ; UB0
00523c  f9bb3000          LDRSH    r3,[r11,#0]           ;8383  ; UB20
005240  eba10103          SUB      r1,r1,r3              ;8383
005244  eb010302          ADD      r3,r1,r2              ;8383
005248  4563              CMP      r3,r12                ;8383
00524a  da10              BGE      |L1.21102|
00524c  f04f0122          MOV      r1,#0x22              ;8385
005250  f8841025          STRB     r1,[r4,#0x25]         ;8385
005254  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8386  ; cntrl_stat_blok_cnt
005258  b121              CBZ      r1,|L1.21092|
00525a  f1a00001          SUB      r0,r0,#1              ;8386
00525e  f8a40042          STRH     r0,[r4,#0x42]         ;8386
005262  e027              B        |L1.21172|
                  |L1.21092|
005264  f1a0000a          SUB      r0,r0,#0xa            ;8387
005268  f8a40042          STRH     r0,[r4,#0x42]         ;8387
00526c  e022              B        |L1.21172|
                  |L1.21102|
00526e  17cb              ASRS     r3,r1,#31             ;8389
005270  eb017193          ADD      r1,r1,r3,LSR #30      ;8389
005274  eb0201a1          ADD      r1,r2,r1,ASR #2       ;8389
005278  4561              CMP      r1,r12                ;8389
00527a  da10              BGE      |L1.21150|
00527c  f04f0123          MOV      r1,#0x23              ;8391
005280  f8841025          STRB     r1,[r4,#0x25]         ;8391
005284  f8b4106e          LDRH     r1,[r4,#0x6e]         ;8392  ; cntrl_stat_blok_cnt
005288  b121              CBZ      r1,|L1.21140|
00528a  f1a00001          SUB      r0,r0,#1              ;8392
00528e  f8a40042          STRH     r0,[r4,#0x42]         ;8392
005292  e00f              B        |L1.21172|
                  |L1.21140|
005294  f1a00002          SUB      r0,r0,#2              ;8393
005298  f8a40042          STRH     r0,[r4,#0x42]         ;8393
00529c  e00a              B        |L1.21172|
                  |L1.21150|
00529e  1c52              ADDS     r2,r2,#1              ;8395
0052a0  4594              CMP      r12,r2                ;8395
0052a2  dd07              BLE      |L1.21172|
0052a4  f04f0124          MOV      r1,#0x24              ;8397
0052a8  f8841025          STRB     r1,[r4,#0x25]         ;8397
0052ac  f1a00001          SUB      r0,r0,#1              ;8398
0052b0  f8a40042          STRH     r0,[r4,#0x42]         ;8398
                  |L1.21172|
0052b4  48ff              LDR      r0,|L1.22196|
0052b6  f8941026          LDRB     r1,[r4,#0x26]         ;8402  ; vz1_stat
0052ba  7800              LDRB     r0,[r0,#0]            ;8402  ; hv_vz_stat
0052bc  4308              ORRS     r0,r0,r1              ;8402
0052be  f8941029          LDRB     r1,[r4,#0x29]         ;8402  ; vz2_stat
0052c2  4308              ORRS     r0,r0,r1              ;8402
0052c4  d10e              BNE      |L1.21220|
0052c6  48fc              LDR      r0,|L1.22200|
0052c8  7840              LDRB     r0,[r0,#1]            ;8404  ; sk_stat
0052ca  2801              CMP      r0,#1                 ;8404
0052cc  d10a              BNE      |L1.21220|
0052ce  48fb              LDR      r0,|L1.22204|
0052d0  7840              LDRB     r0,[r0,#1]            ;8404  ; sk_stat_old
0052d2  b938              CBNZ     r0,|L1.21220|
0052d4  48fa              LDR      r0,|L1.22208|
0052d6  8800              LDRH     r0,[r0,#0]            ;8404  ; VZ_KIND
0052d8  2801              CMP      r0,#1                 ;8404
0052da  d103              BNE      |L1.21220|
0052dc  f04f0032          MOV      r0,#0x32              ;8404
0052e0  f8a40042          STRH     r0,[r4,#0x42]         ;8404
                  |L1.21220|
0052e4  f24032f2          MOV      r2,#0x3f2             ;8407
0052e8  210a              MOVS     r1,#0xa               ;8407
0052ea  48f6              LDR      r0,|L1.22212|
0052ec  f7fffffe          BL       gran
0052f0  f8b40042          LDRH     r0,[r4,#0x42]         ;8408  ; cntrl_stat_new
0052f4  85e0              STRH     r0,[r4,#0x2e]         ;8408
0052f6  85a0              STRH     r0,[r4,#0x2c]         ;8409
0052f8  48f3              LDR      r0,|L1.22216|
0052fa  f9b00000          LDRSH    r0,[r0,#0]            ;8411  ; ICA_EN
0052fe  b938              CBNZ     r0,|L1.21264|
005300  8839              LDRH     r1,[r7,#0]  ; ica_cntrl_hndl_cnt
005302  b129              CBZ      r1,|L1.21264|
;;;8414   			{
;;;8415   			cntrl_stat = ica_cntrl_hndl;
005304  49f1              LDR      r1,|L1.22220|
005306  8809              LDRH     r1,[r1,#0]  ; ica_cntrl_hndl
005308  85a1              STRH     r1,[r4,#0x2c]
;;;8416   			cntrl_stat_new = ica_cntrl_hndl;//=10*PWM_START;
00530a  f8a41042          STRH     r1,[r4,#0x42]
;;;8417   			cntrl_stat_old = ica_cntrl_hndl;//=10*PWM_START;
00530e  85e1              STRH     r1,[r4,#0x2e]
                  |L1.21264|
;;;8418   			}
;;;8419   		}
;;;8420   	
;;;8421   	if((ICA_EN==1)||(ICA_EN==2))
005310  2801              CMP      r0,#1
005312  d001              BEQ      |L1.21272|
005314  2802              CMP      r0,#2
005316  d105              BNE      |L1.21284|
                  |L1.21272|
;;;8422   		{
;;;8423   		cntrl_stat=cntrl_stat_new+ica_u_necc;
005318  49ed              LDR      r1,|L1.22224|
00531a  f8b40042          LDRH     r0,[r4,#0x42]  ; cntrl_stat_new
00531e  8809              LDRH     r1,[r1,#0]  ; ica_u_necc
005320  4408              ADD      r0,r0,r1
005322  85a0              STRH     r0,[r4,#0x2c]
                  |L1.21284|
;;;8424   		}			
;;;8425   	}
;;;8426   #else
;;;8427   else if((b1Hz_ch)&&((!bIBAT_SMKLBR)||(bps[8]._cnt>40)))
;;;8428   	{
;;;8429   	cntrl_hndl_plazma=37;
;;;8430   	cntrl_stat_new=cntrl_stat_old;
;;;8431   	
;;;8432   	if((Ibmax/10)>(2*IZMAX_))
;;;8433   		{
;;;8434   		cntrl_hndl_plazma=38;
;;;8435             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8436   		else	cntrl_stat_new-=10;
;;;8437   		}		
;;;8438   	else if(((Ibmax/10)<(IZMAX_*2))&&(Ibmax>(IZMAX_*15)))
;;;8439   		{
;;;8440   		cntrl_hndl_plazma=39;
;;;8441             if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8442             else	cntrl_stat_new-=3;
;;;8443   		}   
;;;8444   	else if((Ibmax<(IZMAX_*15))&&((Ibmax/10)>IZMAX_))
;;;8445   		{
;;;8446   		cntrl_hndl_plazma=40;
;;;8447   		cntrl_stat_new--;
;;;8448   		}
;;;8449   		
;;;8450   	else if(load_U<u_necc)
;;;8451   		{
;;;8452   		cntrl_hndl_plazma=41;
;;;8453   		if(load_U<(u_necc-(UB0-UB20)))
;;;8454   			{
;;;8455   			cntrl_hndl_plazma=42;
;;;8456   			if(Ibmax<0)
;;;8457   				{
;;;8458   				cntrl_hndl_plazma=43;
;;;8459                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8460   				else cntrl_stat_new+=10;
;;;8461   				}
;;;8462   			else if(Ibmax<(IZMAX_*5))
;;;8463   				{
;;;8464   				cntrl_hndl_plazma=44;
;;;8465                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8466   				else	cntrl_stat_new+=2;
;;;8467   				}
;;;8468   			else if(Ibmax<((IZMAX_*95)/10))
;;;8469   				{
;;;8470   				cntrl_hndl_plazma=45;
;;;8471   				cntrl_stat_new++;
;;;8472   				}					
;;;8473   			}
;;;8474   		else if(load_U<(u_necc-((UB0-UB20)/4)))
;;;8475   			{
;;;8476   			cntrl_hndl_plazma=46;
;;;8477   			if(Ibmax<(IZMAX_*5))
;;;8478   				{
;;;8479   				cntrl_hndl_plazma=47;
;;;8480                       if(cntrl_stat_blok_cnt)cntrl_stat_new++;
;;;8481   				else	cntrl_stat_new+=2;
;;;8482   				}
;;;8483   			else if(Ibmax<((IZMAX_*95)/10))
;;;8484   				{
;;;8485   				cntrl_hndl_plazma=48;
;;;8486   				cntrl_stat_new++;
;;;8487   				}					
;;;8488   			}	
;;;8489   		else if(load_U<(u_necc-1))
;;;8490   			{
;;;8491   			cntrl_hndl_plazma=49;
;;;8492   			if(Ibmax<((IZMAX_*95)/10))
;;;8493   				{
;;;8494   				cntrl_hndl_plazma=50;
;;;8495   				cntrl_stat_new++;
;;;8496   				}					
;;;8497   			}					
;;;8498   		}	
;;;8499   	else if((load_U>u_necc)/*&&(!cntrl_blok)*/)
;;;8500   		{
;;;8501   		cntrl_hndl_plazma=51;
;;;8502   		if(load_U>(u_necc+(UB0-UB20)))
;;;8503   			{
;;;8504   			cntrl_hndl_plazma=52;
;;;8505                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8506   			else	cntrl_stat_new-=10;
;;;8507   			}
;;;8508   		else if(load_U>(u_necc+((UB0-UB20)/4)))
;;;8509   			{
;;;8510   			cntrl_hndl_plazma=53;
;;;8511                  if(cntrl_stat_blok_cnt)cntrl_stat_new--;
;;;8512   			else cntrl_stat_new-=2;
;;;8513   			}	
;;;8514   		else if(load_U>(u_necc+1))
;;;8515   			{
;;;8516   			cntrl_hndl_plazma=54;
;;;8517   			cntrl_stat_new--;
;;;8518   			}					
;;;8519   		}
;;;8520   
;;;8521   	gran(&cntrl_stat_new,10,1010);			
;;;8522   	cntrl_stat_old=cntrl_stat_new;
;;;8523   	cntrl_stat=cntrl_stat_new;	
;;;8524   	}
;;;8525   #endif
;;;8526   
;;;8527   iiii=0;
005324  7425              STRB     r5,[r4,#0x10]
;;;8528   for(i=0;i<NUMIST;i++)
005326  73e5              STRB     r5,[r4,#0xf]
005328  48ea              LDR      r0,|L1.22228|
00532a  f9b01000          LDRSH    r1,[r0,#0]
00532e  e00c              B        |L1.21322|
                  |L1.21296|
;;;8529        {
;;;8530        if(bps[i]._cnt<30)iiii=1;
005330  ebc002c0          RSB      r2,r0,r0,LSL #3
005334  eb021200          ADD      r2,r2,r0,LSL #4
005338  eb090282          ADD      r2,r9,r2,LSL #2
00533c  78d2              LDRB     r2,[r2,#3]
00533e  2a1e              CMP      r2,#0x1e
005340  d200              BCS      |L1.21316|
005342  7426              STRB     r6,[r4,#0x10]
                  |L1.21316|
005344  f1000001          ADD      r0,r0,#1              ;8528
005348  73e0              STRB     r0,[r4,#0xf]          ;8528
                  |L1.21322|
00534a  7be0              LDRB     r0,[r4,#0xf]          ;8528  ; i
00534c  4288              CMP      r0,r1                 ;8528
00534e  dbef              BLT      |L1.21296|
;;;8531        }
;;;8532   
;;;8533   if(iiii==0)
005350  7c20              LDRB     r0,[r4,#0x10]  ; iiii
005352  b948              CBNZ     r0,|L1.21352|
;;;8534   	{
;;;8535   	cntrl_stat=600;	
;;;8536   	cntrl_stat_old=600;
;;;8537   	cntrl_stat_new=600;
;;;8538   	cntrl_stat=10*PWM_START;
005354  48e0              LDR      r0,|L1.22232|
005356  8800              LDRH     r0,[r0,#0]  ; PWM_START
005358  eb000080          ADD      r0,r0,r0,LSL #2
00535c  ea4f0040          LSL      r0,r0,#1
005360  85a0              STRH     r0,[r4,#0x2c]
;;;8539   	cntrl_stat_old=10*PWM_START;
005362  85e0              STRH     r0,[r4,#0x2e]
;;;8540   	cntrl_stat_new=10*PWM_START;
005364  f8a40042          STRH     r0,[r4,#0x42]
                  |L1.21352|
;;;8541   	}
;;;8542   
;;;8543   #ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;8544   if(ica_cntrl_hndl_cnt)	ica_cntrl_hndl_cnt--;
005368  f9b70000          LDRSH    r0,[r7,#0]  ; ica_cntrl_hndl_cnt
00536c  b110              CBZ      r0,|L1.21364|
00536e  f1a00001          SUB      r0,r0,#1
005372  8038              STRH     r0,[r7,#0]
                  |L1.21364|
;;;8545   
;;;8546   
;;;8547   
;;;8548   #endif
;;;8549   
;;;8550   
;;;8551   gran(&cntrl_stat,10,1010); 
005374  48d3              LDR      r0,|L1.22212|
005376  f24032f2          MOV      r2,#0x3f2
00537a  210a              MOVS     r1,#0xa
00537c  3816              SUBS     r0,r0,#0x16
00537e  f7fffffe          BL       gran
;;;8552   b1Hz_ch=0;
005382  73a5              STRB     r5,[r4,#0xe]
                  |L1.21380|
;;;8553   }
005384  e8bd9ff0          POP      {r4-r12,pc}
;;;8554   #endif
                          ENDP

                  ext_drv PROC
;;;9043   //-----------------------------------------------
;;;9044   void ext_drv(void)
005388  e92d5ff0          PUSH     {r4-r12,lr}
;;;9045   {
;;;9046   char i;
;;;9047   
;;;9048   
;;;9049   for(i=0;i<NUMSK;i++)
00538c  f04f0000          MOV      r0,#0
005390  4ad3              LDR      r2,|L1.22240|
;;;9050   	{
;;;9051   	#ifdef UKU_MGTS
;;;9052   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;9053   	#endif
;;;9054   	#ifdef UKU_RSTKM
;;;9055   	if(adc_buff_[sk_buff_RSTKM[i]]<2000)
;;;9056   	#endif
;;;9057   	#ifdef UKU_3U
;;;9058   	if(adc_buff_[sk_buff_3U[i]]<2000)
;;;9059   	#endif
;;;9060   	#ifdef UKU_GLONASS
;;;9061   	if(adc_buff_[sk_buff_GLONASS[i]]<2000)
;;;9062   	#endif
;;;9063   	#ifdef UKU_KONTUR
;;;9064   	if(adc_buff_[sk_buff_KONTUR[i]]<2000)
;;;9065   	#endif
;;;9066   	#ifdef UKU_6U
;;;9067   	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;9068   	#endif
;;;9069   	#ifdef UKU_220
;;;9070   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;9071   	#endif
;;;9072   	#ifdef UKU_220_V2
;;;9073   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;9074   	#endif
;;;9075   	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9076   	if(adc_buff_[sk_buff_220[i]]<2000)
;;;9077   	#endif
;;;9078   	#ifdef UKU_TELECORE2015	
;;;9079   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;9080   	#endif
;;;9081   	#ifdef UKU_TELECORE2017
;;;9082   	if(adc_buff_[sk_buff_TELECORE2015[i]]<2000)	 //TODO
;;;9083   	#endif
;;;9084   	#ifdef IPS_SGEP_GAZPROM
;;;9085   	if(adc_buff_[sk_buff_6U[i]]<2000)
;;;9086   	#endif		
;;;9087   		{
;;;9088   		if(sk_cnt[i]<10)
005392  4bd2              LDR      r3,|L1.22236|
;;;9089   			{
;;;9090   			sk_cnt[i]++;
;;;9091   			if(sk_cnt[i]>=10)
;;;9092   				{
;;;9093   				sk_stat[i]=ssON;
005394  4dc8              LDR      r5,|L1.22200|
005396  f04f0a01          MOV      r10,#1
;;;9094   				}
;;;9095   			}
;;;9096   		else 
;;;9097   			{
;;;9098   			sk_cnt[i]=10;
00539a  f04f0b0a          MOV      r11,#0xa
00539e  4606              MOV      r6,r0                 ;9049
0053a0  f9b24000          LDRSH    r4,[r2,#0]            ;9049
0053a4  e025              B        |L1.21490|
                  |L1.21414|
0053a6  49cf              LDR      r1,|L1.22244|
0053a8  4fcf              LDR      r7,|L1.22248|
0053aa  5c09              LDRB     r1,[r1,r0]            ;9076
0053ac  f9371011          LDRSH    r1,[r7,r1,LSL #1]     ;9076
0053b0  f5b16ffa          CMP      r1,#0x7d0             ;9076
0053b4  da0e              BGE      |L1.21460|
0053b6  5619              LDRSB    r1,[r3,r0]            ;9088
0053b8  290a              CMP      r1,#0xa               ;9088
0053ba  da08              BGE      |L1.21454|
0053bc  f1010101          ADD      r1,r1,#1              ;9090
0053c0  b249              SXTB     r1,r1                 ;9090
0053c2  5419              STRB     r1,[r3,r0]            ;9090
0053c4  290a              CMP      r1,#0xa               ;9091
0053c6  db11              BLT      |L1.21484|
0053c8  f805a000          STRB     r10,[r5,r0]           ;9093
0053cc  e00e              B        |L1.21484|
                  |L1.21454|
0053ce  f803b000          STRB     r11,[r3,r0]
0053d2  e00b              B        |L1.21484|
                  |L1.21460|
;;;9099   			}
;;;9100                  
;;;9101   		}
;;;9102   	else
;;;9103   		{
;;;9104   		if(sk_cnt[i]>0)
0053d4  5619              LDRSB    r1,[r3,r0]
0053d6  2900              CMP      r1,#0
0053d8  dd07              BLE      |L1.21482|
;;;9105   			{
;;;9106   			sk_cnt[i]--;
0053da  f1a10101          SUB      r1,r1,#1
0053de  b249              SXTB     r1,r1
0053e0  5419              STRB     r1,[r3,r0]
;;;9107   			if(sk_cnt[i]<=0)
0053e2  2900              CMP      r1,#0
0053e4  dc02              BGT      |L1.21484|
;;;9108   				{
;;;9109   				sk_stat[i]=ssOFF;
0053e6  542e              STRB     r6,[r5,r0]
0053e8  e000              B        |L1.21484|
                  |L1.21482|
;;;9110   				}
;;;9111   			}
;;;9112   		else 
;;;9113   			{
;;;9114   			sk_cnt[i]=0;
0053ea  541e              STRB     r6,[r3,r0]
                  |L1.21484|
0053ec  f1000001          ADD      r0,r0,#1              ;9049
0053f0  b2c0              UXTB     r0,r0                 ;9049
                  |L1.21490|
0053f2  42a0              CMP      r0,r4                 ;9049
0053f4  dbd7              BLT      |L1.21414|
;;;9115   			}
;;;9116   		}
;;;9117   	}
;;;9118   
;;;9119   for(i=0;i<NUMSK;i++)
0053f6  f04f0400          MOV      r4,#0
;;;9120   	{
;;;9121   	if(((SK_SIGN[i]==0)&&(sk_stat[i]==ssON))||((SK_SIGN[i])&&(sk_stat[i]==ssOFF)) )
;;;9122   		{
;;;9123   		if(sk_av_cnt[i]<10)
0053fa  f8df92f0          LDR      r9,|L1.22252|
;;;9124   			{
;;;9125   			sk_av_cnt[i]++;
;;;9126   			if(sk_av_cnt[i]>=10)
;;;9127   				{
;;;9128   				sk_av_stat[i]=sasON;
0053fe  4fbc              LDR      r7,|L1.22256|
;;;9129   				}
;;;9130   			}
;;;9131   		else 
;;;9132   			{
;;;9133   			sk_av_cnt[i]=10;
;;;9134   			}
;;;9135   		}
;;;9136   	else
;;;9137   		{
;;;9138   		if(sk_av_cnt[i]>=0)
;;;9139   			{
;;;9140   			sk_av_cnt[i]--;
;;;9141   			if(sk_av_cnt[i]<=0)
;;;9142   				{
;;;9143   				sk_av_stat[i]=sasOFF;
;;;9144   				}
;;;9145   			}
;;;9146   		else 
;;;9147   			{
;;;9148   			sk_av_cnt[i]=0;
;;;9149   			}
;;;9150   		}
;;;9151   
;;;9152   #ifndef UKU_KONTUR
;;;9153   	if(sk_av_stat_old[i]!=sk_av_stat[i])
005400  f8df82f0          LDR      r8,|L1.22260|
005404  e083              B        |L1.21774|
                  |L1.21510|
005406  48bc              LDR      r0,|L1.22264|
005408  f9300014          LDRSH    r0,[r0,r4,LSL #1]     ;9121
00540c  b910              CBNZ     r0,|L1.21524|
00540e  5d29              LDRB     r1,[r5,r4]            ;9121
005410  2901              CMP      r1,#1                 ;9121
005412  d00f              BEQ      |L1.21556|
                  |L1.21524|
005414  b108              CBZ      r0,|L1.21530|
005416  5d28              LDRB     r0,[r5,r4]            ;9121
005418  b160              CBZ      r0,|L1.21556|
                  |L1.21530|
00541a  f9190004          LDRSB    r0,[r9,r4]            ;9138
00541e  2800              CMP      r0,#0                 ;9138
005420  db19              BLT      |L1.21590|
005422  f1a00001          SUB      r0,r0,#1              ;9140
005426  b240              SXTB     r0,r0                 ;9140
005428  f8090004          STRB     r0,[r9,r4]            ;9140
00542c  2800              CMP      r0,#0                 ;9141
00542e  dc14              BGT      |L1.21594|
005430  553e              STRB     r6,[r7,r4]            ;9143
005432  e012              B        |L1.21594|
                  |L1.21556|
005434  f9190004          LDRSB    r0,[r9,r4]            ;9123
005438  280a              CMP      r0,#0xa               ;9123
00543a  da09              BGE      |L1.21584|
00543c  f1000001          ADD      r0,r0,#1              ;9125
005440  b240              SXTB     r0,r0                 ;9125
005442  f8090004          STRB     r0,[r9,r4]            ;9125
005446  280a              CMP      r0,#0xa               ;9126
005448  db07              BLT      |L1.21594|
00544a  f807a004          STRB     r10,[r7,r4]           ;9128
00544e  e004              B        |L1.21594|
                  |L1.21584|
005450  f809b004          STRB     r11,[r9,r4]           ;9133
005454  e001              B        |L1.21594|
                  |L1.21590|
005456  f8096004          STRB     r6,[r9,r4]            ;9148
                  |L1.21594|
00545a  f8181004          LDRB     r1,[r8,r4]
00545e  5d38              LDRB     r0,[r7,r4]
005460  4281              CMP      r1,r0
005462  d04e              BEQ      |L1.21762|
;;;9154   		{
;;;9155   		plazma_sk++;
005464  4a97              LDR      r2,|L1.22212|
005466  1e92              SUBS     r2,r2,#2
005468  8811              LDRH     r1,[r2,#0]  ; plazma_sk
00546a  f1010101          ADD      r1,r1,#1
00546e  8011              STRH     r1,[r2,#0]
;;;9156   		if(sk_av_stat[i]==sasON)
005470  2801              CMP      r0,#1
005472  d007              BEQ      |L1.21636|
;;;9157   			{
;;;9158   			if(i==0)snmp_trap_send("SK #1 Alarm",15,1,1);
;;;9159   			else if(i==1)
;;;9160   				{
;;;9161   				#ifndef UKU_TELEKORE2017
;;;9162   				snmp_trap_send("SK #2 Alarm",15,2,1);
;;;9163   				#endif
;;;9164   				#ifdef UKU_TELEKORE2017
;;;9165   				snmp_trap_send("Door open",15,2,1);
;;;9166   				#endif
;;;9167   				}
;;;9168   			else if(i==2)snmp_trap_send("SK #3 Alarm",15,3,1);
;;;9169   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;9170   			}
;;;9171   		else 
;;;9172   			{
;;;9173   			if(i==0)snmp_trap_send("SK #1 Alarm is off",15,1,0);
005474  b354              CBZ      r4,|L1.21708|
;;;9174   			else if(i==1)
005476  2c01              CMP      r4,#1
005478  d02f              BEQ      |L1.21722|
;;;9175   				{
;;;9176   				#ifndef UKU_TELEKORE2017
;;;9177   				snmp_trap_send("SK #2 Alarm is off",15,2,0);
;;;9178   				#endif
;;;9179   				#ifdef UKU_TELEKORE2017
;;;9180   				snmp_trap_send("Door open clear",15,2,0);
;;;9181   				#endif
;;;9182   				}
;;;9183   			else if(i==2)snmp_trap_send("SK #3 Alarm is off",15,3,0);
00547a  2c02              CMP      r4,#2
00547c  d034              BEQ      |L1.21736|
;;;9184   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
00547e  2c03              CMP      r4,#3
005480  d039              BEQ      |L1.21750|
005482  e03e              B        |L1.21762|
                  |L1.21636|
005484  b134              CBZ      r4,|L1.21652|
005486  2c01              CMP      r4,#1                 ;9159
005488  d00b              BEQ      |L1.21666|
00548a  2c02              CMP      r4,#2                 ;9168
00548c  d010              BEQ      |L1.21680|
00548e  2c03              CMP      r4,#3                 ;9169
005490  d015              BEQ      |L1.21694|
005492  e036              B        |L1.21762|
                  |L1.21652|
005494  2301              MOVS     r3,#1                 ;9158
005496  461a              MOV      r2,r3                 ;9158
005498  210f              MOVS     r1,#0xf               ;9158
00549a  a098              ADR      r0,|L1.22268|
00549c  f7fffffe          BL       snmp_trap_send
0054a0  e02f              B        |L1.21762|
                  |L1.21666|
0054a2  2301              MOVS     r3,#1                 ;9162
0054a4  2202              MOVS     r2,#2                 ;9162
0054a6  210f              MOVS     r1,#0xf               ;9162
0054a8  a097              ADR      r0,|L1.22280|
0054aa  f7fffffe          BL       snmp_trap_send
0054ae  e028              B        |L1.21762|
                  |L1.21680|
0054b0  2301              MOVS     r3,#1                 ;9168
0054b2  2203              MOVS     r2,#3                 ;9168
0054b4  210f              MOVS     r1,#0xf               ;9168
0054b6  a097              ADR      r0,|L1.22292|
0054b8  f7fffffe          BL       snmp_trap_send
0054bc  e021              B        |L1.21762|
                  |L1.21694|
0054be  2301              MOVS     r3,#1                 ;9169
0054c0  2204              MOVS     r2,#4                 ;9169
0054c2  210f              MOVS     r1,#0xf               ;9169
0054c4  a096              ADR      r0,|L1.22304|
0054c6  f7fffffe          BL       snmp_trap_send
0054ca  e01a              B        |L1.21762|
                  |L1.21708|
0054cc  2300              MOVS     r3,#0                 ;9173
0054ce  2201              MOVS     r2,#1                 ;9173
0054d0  210f              MOVS     r1,#0xf               ;9173
0054d2  a096              ADR      r0,|L1.22316|
0054d4  f7fffffe          BL       snmp_trap_send
0054d8  e013              B        |L1.21762|
                  |L1.21722|
0054da  2300              MOVS     r3,#0                 ;9177
0054dc  2202              MOVS     r2,#2                 ;9177
0054de  210f              MOVS     r1,#0xf               ;9177
0054e0  a097              ADR      r0,|L1.22336|
0054e2  f7fffffe          BL       snmp_trap_send
0054e6  e00c              B        |L1.21762|
                  |L1.21736|
0054e8  2300              MOVS     r3,#0                 ;9183
0054ea  2203              MOVS     r2,#3                 ;9183
0054ec  210f              MOVS     r1,#0xf               ;9183
0054ee  a099              ADR      r0,|L1.22356|
0054f0  f7fffffe          BL       snmp_trap_send
0054f4  e005              B        |L1.21762|
                  |L1.21750|
0054f6  2300              MOVS     r3,#0
0054f8  2204              MOVS     r2,#4
0054fa  210f              MOVS     r1,#0xf
0054fc  a09a              ADR      r0,|L1.22376|
0054fe  f7fffffe          BL       snmp_trap_send
                  |L1.21762|
;;;9185   			}
;;;9186   	 	}
;;;9187   #endif
;;;9188   
;;;9189   #ifdef UKU_KONTUR
;;;9190   	if(sk_av_stat_old[i]!=sk_av_stat[i])
;;;9191   		{
;;;9192   		plazma_sk++;
;;;9193   		if(sk_av_stat[i]==sasON)
;;;9194   			{
;;;9195   			if(i==0)snmp_trap_send("Door is opened",15,1,1);
;;;9196   			else if(i==1)snmp_trap_send("Smoke Alarm",15,2,1);
;;;9197   			else if(i==2)snmp_trap_send("Shock Sensor Alarm",15,3,1);
;;;9198   			else if(i==3)snmp_trap_send("SK #4 Alarm",15,4,1);
;;;9199   			}
;;;9200   		else 
;;;9201   			{
;;;9202   			if(i==0)snmp_trap_send("Door is closed",15,1,0);
;;;9203   			else if(i==1)snmp_trap_send("Smoke Alarm is off",15,2,0);
;;;9204   			else if(i==2)snmp_trap_send("Shock Sensor Alarm is off",15,3,0);
;;;9205   			else if(i==3)snmp_trap_send("SK #4 Alarm is off",15,4,0);
;;;9206   			}
;;;9207   	 	}
;;;9208   #endif
;;;9209   	sk_av_stat_old[i]=sk_av_stat[i];
005502  5d38              LDRB     r0,[r7,r4]
005504  f8080004          STRB     r0,[r8,r4]
005508  f1040401          ADD      r4,r4,#1              ;9119
00550c  b2e4              UXTB     r4,r4                 ;9119
                  |L1.21774|
00550e  4874              LDR      r0,|L1.22240|
005510  f9b00000          LDRSH    r0,[r0,#0]            ;9119  ; NUMSK
005514  4284              CMP      r4,r0                 ;9119
005516  f6ffaf76          BLT      |L1.21510|
;;;9210   	}
;;;9211   }
00551a  e733              B        |L1.21380|
;;;9212   
                          ENDP

                  zar_superviser_start PROC
;;;9249   //-----------------------------------------------
;;;9250   void zar_superviser_start(void)
00551c  4a97              LDR      r2,|L1.22396|
;;;9251   {
;;;9252   sign_U[0]=1;
00551e  f04f0001          MOV      r0,#1
005522  7010              STRB     r0,[r2,#0]
;;;9253   sign_I[0]=1;
005524  4996              LDR      r1,|L1.22400|
005526  7008              STRB     r0,[r1,#0]
;;;9254   sign_U[1]=1;
005528  7050              STRB     r0,[r2,#1]
;;;9255   sign_I[1]=1;
00552a  7048              STRB     r0,[r1,#1]
;;;9256   
;;;9257   }
00552c  4770              BX       lr
;;;9258   
                          ENDP

                  zar_superviser_drv PROC
;;;9214   //-----------------------------------------------
;;;9215   void zar_superviser_drv(void)
00552e  e92d5ff0          PUSH     {r4-r12,lr}
;;;9216   {
;;;9217   
;;;9218   if(((bat[0]._Ub>u_necc_up) || (bat[0]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[0]=0;
005532  4895              LDR      r0,|L1.22408|
005534  f8df9254          LDR      r9,|L1.22412|
005538  f8df8248          LDR      r8,|L1.22404|
00553c  f9b0c000          LDRSH    r12,[r0,#0]  ; u_necc_up
005540  f9b90000          LDRSH    r0,[r9,#0]
005544  4c5f              LDR      r4,|L1.22212|
005546  ebc01100          RSB      r1,r0,r0,LSL #4
00554a  3c42              SUBS     r4,r4,#0x42
00554c  f9b87002          LDRSH    r7,[r8,#2]  ; bat
005550  f06f0a1d          MVN      r10,#0x1d
005554  f06f0b95          MVN      r11,#0x95
005558  2500              MOVS     r5,#0
00555a  4e88              LDR      r6,|L1.22396|
00555c  f9b4004c          LDRSH    r0,[r4,#0x4c]
005560  eb0a0281          ADD      r2,r10,r1,LSL #2
005564  eb0b0381          ADD      r3,r11,r1,LSL #2
005568  4567              CMP      r7,r12
00556a  dc05              BGT      |L1.21880|
00556c  f8dfc220          LDR      r12,|L1.22416|
005570  f9bcc000          LDRSH    r12,[r12,#0]  ; u_necc_dn
005574  4567              CMP      r7,r12
005576  da04              BGE      |L1.21890|
                  |L1.21880|
005578  4282              CMP      r2,r0
00557a  dd02              BLE      |L1.21890|
00557c  4283              CMP      r3,r0
00557e  da00              BGE      |L1.21890|
005580  7035              STRB     r5,[r6,#0]
                  |L1.21890|
;;;9219   
;;;9220   if(((bat[0]._Ib>(2*IKB)) || (bat[0]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[0]=0;
005582  4f84              LDR      r7,|L1.22420|
005584  f9b8c008          LDRSH    r12,[r8,#8]  ; bat
005588  f9b7e000          LDRSH    lr,[r7,#0]  ; IKB
00558c  4f7c              LDR      r7,|L1.22400|
00558e  ebbc0f4e          CMP      r12,lr,LSL #1
005592  dc04              BGT      |L1.21918|
005594  f1ce0e00          RSB      lr,lr,#0
005598  ebbc0f4e          CMP      r12,lr,LSL #1
00559c  da04              BGE      |L1.21928|
                  |L1.21918|
00559e  4282              CMP      r2,r0
0055a0  dd02              BLE      |L1.21928|
0055a2  4283              CMP      r3,r0
0055a4  da00              BGE      |L1.21928|
0055a6  703d              STRB     r5,[r7,#0]
                  |L1.21928|
;;;9221   																 
;;;9222   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
0055a8  f06f0209          MVN      r2,#9
0055ac  eb020181          ADD      r1,r2,r1,LSL #2
0055b0  4281              CMP      r1,r0
0055b2  d120              BNE      |L1.22006|
0055b4  7ea0              LDRB     r0,[r4,#0x1a]  ; spc_stat
0055b6  b9f0              CBNZ     r0,|L1.22006|
;;;9223   	{
;;;9224   	if((sign_U[0]==1) && (sign_I[0]==1) && (lc640_read_int(EE_BAT1_ZAR_CNT)!=BAT_C_REAL[0]) && (NUMBAT) && (!(bat[0]._av&1)))
0055b8  7830              LDRB     r0,[r6,#0]  ; sign_U
0055ba  2801              CMP      r0,#1
0055bc  d11b              BNE      |L1.22006|
0055be  7838              LDRB     r0,[r7,#0]  ; sign_I
0055c0  2801              CMP      r0,#1
0055c2  d118              BNE      |L1.22006|
0055c4  f44f70ef          MOV      r0,#0x1de
0055c8  f7fffffe          BL       lc640_read_int
0055cc  4972              LDR      r1,|L1.22424|
0055ce  f9b11000          LDRSH    r1,[r1,#0]  ; BAT_C_REAL
0055d2  4288              CMP      r0,r1
0055d4  d00f              BEQ      |L1.22006|
0055d6  4871              LDR      r0,|L1.22428|
0055d8  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0055da  b160              CBZ      r0,|L1.22006|
0055dc  f898003d          LDRB     r0,[r8,#0x3d]  ; bat
0055e0  07c0              LSLS     r0,r0,#31
0055e2  d108              BNE      |L1.22006|
;;;9225   		{
;;;9226   		lc640_write_int(EE_BAT1_ZAR_CNT,BAT_C_REAL[0]);
0055e4  f44f70ef          MOV      r0,#0x1de
0055e8  f7fffffe          BL       lc640_write_int
;;;9227   		superviser_cnt++;
0055ec  486c              LDR      r0,|L1.22432|
0055ee  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
0055f0  f1010101          ADD      r1,r1,#1
0055f4  7001              STRB     r1,[r0,#0]
                  |L1.22006|
;;;9228   		}
;;;9229   	
;;;9230   	}
;;;9231   
;;;9232   if(((bat[0]._Ub>u_necc_up) || (bat[1]._Ub<u_necc_dn))&&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_U[1]=0;
0055f6  4864              LDR      r0,|L1.22408|
0055f8  f9b81002          LDRSH    r1,[r8,#2]  ; bat
0055fc  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_up
005600  4281              CMP      r1,r0
005602  dc06              BGT      |L1.22034|
005604  4862              LDR      r0,|L1.22416|
005606  f9b8104e          LDRSH    r1,[r8,#0x4e]  ; bat
00560a  f9b00000          LDRSH    r0,[r0,#0]  ; u_necc_dn
00560e  4281              CMP      r1,r0
005610  da0e              BGE      |L1.22064|
                  |L1.22034|
005612  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
005616  f9b4104c          LDRSH    r1,[r4,#0x4c]  ; main_kb_cnt
00561a  ebc01000          RSB      r0,r0,r0,LSL #4
00561e  eb0a0280          ADD      r2,r10,r0,LSL #2
005622  428a              CMP      r2,r1
005624  dd04              BLE      |L1.22064|
005626  eb0b0080          ADD      r0,r11,r0,LSL #2
00562a  4288              CMP      r0,r1
00562c  da00              BGE      |L1.22064|
00562e  7075              STRB     r5,[r6,#1]
                  |L1.22064|
;;;9233   
;;;9234   if(((bat[1]._Ib>(2*IKB)) || (bat[1]._Ib<(-IKB*2))) &&(main_kb_cnt<((TBAT*60)-30))&&(main_kb_cnt>((TBAT*60)-150))) sign_I[1]=0;
005630  4958              LDR      r1,|L1.22420|
005632  f9b80054          LDRSH    r0,[r8,#0x54]  ; bat
005636  f9b11000          LDRSH    r1,[r1,#0]  ; IKB
00563a  ebb00f41          CMP      r0,r1,LSL #1
00563e  dc03              BGT      |L1.22088|
005640  4249              RSBS     r1,r1,#0
005642  ebb00f41          CMP      r0,r1,LSL #1
005646  da0e              BGE      |L1.22118|
                  |L1.22088|
005648  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
00564c  f9b4104c          LDRSH    r1,[r4,#0x4c]  ; main_kb_cnt
005650  ebc01000          RSB      r0,r0,r0,LSL #4
005654  eb0a0280          ADD      r2,r10,r0,LSL #2
005658  428a              CMP      r2,r1
00565a  dd04              BLE      |L1.22118|
00565c  eb0b0080          ADD      r0,r11,r0,LSL #2
005660  4288              CMP      r0,r1
005662  da00              BGE      |L1.22118|
005664  707d              STRB     r5,[r7,#1]
                  |L1.22118|
;;;9235   																 
;;;9236   if((main_kb_cnt==((TBAT*60)-10)) &&(spc_stat==spcOFF))
005666  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
00566a  ebc01100          RSB      r1,r0,r0,LSL #4
00566e  f06f0009          MVN      r0,#9
005672  eb000081          ADD      r0,r0,r1,LSL #2
005676  f9b4104c          LDRSH    r1,[r4,#0x4c]  ; main_kb_cnt
00567a  4288              CMP      r0,r1
00567c  d119              BNE      |L1.22194|
00567e  7ea0              LDRB     r0,[r4,#0x1a]  ; spc_stat
005680  b9b8              CBNZ     r0,|L1.22194|
;;;9237   	{
;;;9238   	if((sign_U[1]==1) && (sign_I[1]==1) && (lc640_read_int(EE_BAT2_ZAR_CNT)!=BAT_C_REAL[1]) && (NUMBAT==2) && (!(bat[1]._av&1)))
005682  7870              LDRB     r0,[r6,#1]  ; sign_U
005684  2801              CMP      r0,#1
005686  d114              BNE      |L1.22194|
005688  7878              LDRB     r0,[r7,#1]  ; sign_I
00568a  2801              CMP      r0,#1
00568c  d111              BNE      |L1.22194|
00568e  f44f75fe          MOV      r5,#0x1fc
005692  4628              MOV      r0,r5
005694  f7fffffe          BL       lc640_read_int
005698  493f              LDR      r1,|L1.22424|
00569a  f9b11002          LDRSH    r1,[r1,#2]  ; BAT_C_REAL
00569e  4288              CMP      r0,r1
0056a0  d007              BEQ      |L1.22194|
0056a2  483e              LDR      r0,|L1.22428|
0056a4  8800              LDRH     r0,[r0,#0]  ; NUMBAT
0056a6  2802              CMP      r0,#2
0056a8  d103              BNE      |L1.22194|
0056aa  f8980089          LDRB     r0,[r8,#0x89]  ; bat
0056ae  07c0              LSLS     r0,r0,#31
0056b0  e078              B        |L1.22436|
                  |L1.22194|
0056b2  e080              B        |L1.22454|
                  |L1.22196|
                          DCD      hv_vz_stat
                  |L1.22200|
                          DCD      sk_stat
                  |L1.22204|
                          DCD      sk_stat_old
                  |L1.22208|
                          DCD      VZ_KIND
                  |L1.22212|
                          DCD      ||area_number.25||+0x42
                  |L1.22216|
                          DCD      ICA_EN
                  |L1.22220|
                          DCD      ica_cntrl_hndl
                  |L1.22224|
                          DCD      ica_u_necc
                  |L1.22228|
                          DCD      NUMIST
                  |L1.22232|
                          DCD      PWM_START
                  |L1.22236|
                          DCD      sk_cnt
                  |L1.22240|
                          DCD      NUMSK
                  |L1.22244|
                          DCD      ||area_number.19||
                  |L1.22248|
                          DCD      ||.bss||+0x40c
                  |L1.22252|
                          DCD      sk_av_cnt
                  |L1.22256|
                          DCD      sk_av_stat
                  |L1.22260|
                          DCD      sk_av_stat_old
                  |L1.22264|
                          DCD      SK_SIGN
                  |L1.22268|
0056fc  534b2023          DCB      "SK #1 Alarm",0
005700  3120416c
005704  61726d00
                  |L1.22280|
005708  534b2023          DCB      "SK #2 Alarm",0
00570c  3220416c
005710  61726d00
                  |L1.22292|
005714  534b2023          DCB      "SK #3 Alarm",0
005718  3320416c
00571c  61726d00
                  |L1.22304|
005720  534b2023          DCB      "SK #4 Alarm",0
005724  3420416c
005728  61726d00
                  |L1.22316|
00572c  534b2023          DCB      "SK #1 Alarm is off",0
005730  3120416c
005734  61726d20
005738  6973206f
00573c  666600  
00573f  00                DCB      0
                  |L1.22336|
005740  534b2023          DCB      "SK #2 Alarm is off",0
005744  3220416c
005748  61726d20
00574c  6973206f
005750  666600  
005753  00                DCB      0
                  |L1.22356|
005754  534b2023          DCB      "SK #3 Alarm is off",0
005758  3320416c
00575c  61726d20
005760  6973206f
005764  666600  
005767  00                DCB      0
                  |L1.22376|
005768  534b2023          DCB      "SK #4 Alarm is off",0
00576c  3420416c
005770  61726d20
005774  6973206f
005778  666600  
00577b  00                DCB      0
                  |L1.22396|
                          DCD      sign_U
                  |L1.22400|
                          DCD      sign_I
                  |L1.22404|
                          DCD      bat
                  |L1.22408|
                          DCD      u_necc_up
                  |L1.22412|
                          DCD      TBAT
                  |L1.22416|
                          DCD      u_necc_dn
                  |L1.22420|
                          DCD      IKB
                  |L1.22424|
                          DCD      BAT_C_REAL
                  |L1.22428|
                          DCD      NUMBAT
                  |L1.22432|
                          DCD      superviser_cnt
                  |L1.22436|
0057a4  d107              BNE      |L1.22454|
;;;9239   		{
;;;9240   		lc640_write_int(EE_BAT2_ZAR_CNT,BAT_C_REAL[1]);
0057a6  4628              MOV      r0,r5
0057a8  f7fffffe          BL       lc640_write_int
;;;9241   		superviser_cnt++;
0057ac  48ff              LDR      r0,|L1.23468|
0057ae  7801              LDRB     r1,[r0,#0]  ; superviser_cnt
0057b0  f1010101          ADD      r1,r1,#1
0057b4  7001              STRB     r1,[r0,#0]
                  |L1.22454|
;;;9242   		}
;;;9243   	
;;;9244   	}
;;;9245   
;;;9246   if(main_kb_cnt==((TBAT*60)-2)) zar_superviser_start();
0057b6  f9b90000          LDRSH    r0,[r9,#0]  ; TBAT
0057ba  f06f0101          MVN      r1,#1
0057be  ebc01000          RSB      r0,r0,r0,LSL #4
0057c2  eb010080          ADD      r0,r1,r0,LSL #2
0057c6  f9b4104c          LDRSH    r1,[r4,#0x4c]  ; main_kb_cnt
0057ca  4288              CMP      r0,r1
0057cc  d102              BNE      |L1.22484|
0057ce  e8bd5ff0          POP      {r4-r12,lr}
0057d2  e7fe              B        zar_superviser_start
                  |L1.22484|
;;;9247   }
0057d4  e5d6              B        |L1.21380|
;;;9248   
                          ENDP

                  npn_hndl PROC
;;;9259   //-----------------------------------------------
;;;9260   void npn_hndl(void)
0057d6  e92d03f0          PUSH     {r4-r9}
;;;9261   {
;;;9262   if(NPN_OUT!=npnoOFF)
0057da  48f5              LDR      r0,|L1.23472|
;;;9263   	{
;;;9264   /*	if(NPN_SIGN==npnsAVNET)
;;;9265   		{
;;;9266   		if(net_av==1)
;;;9267   			{
;;;9268   			if(npn_tz_cnt<TZNPN)
;;;9269   				{
;;;9270   				npn_tz_cnt++;
;;;9271   				if(npn_tz_cnt==TZNPN)
;;;9272   					{
;;;9273   					npn_stat=npnsOFF;
;;;9274   					}
;;;9275   				}
;;;9276   			}
;;;9277   		else
;;;9278   			{
;;;9279   			if(npn_tz_cnt)
;;;9280   				{
;;;9281   				npn_tz_cnt--;
;;;9282   				if(npn_tz_cnt==0)
;;;9283   					{
;;;9284   					npn_stat=npnsON;
;;;9285   					}
;;;9286   				}
;;;9287   			}
;;;9288   		}*/
;;;9289   /*	if(NPN_SIGN==npnsULOAD)
;;;9290   		{
;;;9291   		if(load_U<UONPN)
;;;9292   			{
;;;9293   			if(npn_tz_cnt<TZNPN)
;;;9294   				{
;;;9295   				npn_tz_cnt++;
;;;9296   				if(npn_tz_cnt==TZNPN)
;;;9297   					{
;;;9298   					npn_stat=npnsOFF;
;;;9299   					}
;;;9300   				}
;;;9301   			}
;;;9302   		else if(load_U>UVNPN)
;;;9303   			{
;;;9304   			if(npn_tz_cnt)
;;;9305   				{
;;;9306   				npn_tz_cnt--;
;;;9307   				if(npn_tz_cnt==0)
;;;9308   					{
;;;9309   					npn_stat=npnsON;
;;;9310   					}
;;;9311   				}
;;;9312   			}
;;;9313   		}*/
;;;9314   
;;;9315   	if((load_U<UONPN)&&((net_Ua<UMN)||(net_Ub<UMN)||(net_Uc<UMN)))
;;;9316   		{
;;;9317   		if(npn_tz_cnt<TZNPN)
0057dc  4ff5              LDR      r7,|L1.23476|
;;;9318   			{
;;;9319   			npn_tz_cnt++;
;;;9320   			if(npn_tz_cnt==TZNPN)
;;;9321   				{
;;;9322   				npn_stat=npnsOFF;
0057de  4ef6              LDR      r6,|L1.23480|
0057e0  7800              LDRB     r0,[r0,#0]            ;9262  ; NPN_OUT
0057e2  f04f0c00          MOV      r12,#0                ;9262
;;;9323   				}
;;;9324   			}
;;;9325   		}
;;;9326   	else if((load_U>UVNPN)&&(net_Ua>UMN)&&(net_Ub>UMN)&&(net_Uc>UMN))
;;;9327   		{
;;;9328   		if(npn_tz_cnt)
;;;9329   			{
;;;9330   			npn_tz_cnt--;
;;;9331   			if(npn_tz_cnt==0)
;;;9332   				{
;;;9333   				npn_stat=npnsON;
0057e6  f04f0801          MOV      r8,#1
0057ea  b3e8              CBZ      r0,|L1.22632|
0057ec  48f3              LDR      r0,|L1.23484|
0057ee  4639              MOV      r1,r7                 ;9317
0057f0  f9b05000          LDRSH    r5,[r0,#0]            ;9315  ; load_U
0057f4  48f2              LDR      r0,|L1.23488|
0057f6  f9b11000          LDRSH    r1,[r1,#0]            ;9317
0057fa  f9b09000          LDRSH    r9,[r0,#0]            ;9315  ; UONPN
0057fe  48f1              LDR      r0,|L1.23492|
005800  454d              CMP      r5,r9                 ;9315
005802  f9b02000          LDRSH    r2,[r0,#0]            ;9315
005806  48f0              LDR      r0,|L1.23496|
005808  f9b03000          LDRSH    r3,[r0,#0]            ;9315
00580c  48ef              LDR      r0,|L1.23500|
00580e  f9b04000          LDRSH    r4,[r0,#0]            ;9315
005812  48ef              LDR      r0,|L1.23504|
005814  f9b00000          LDRSH    r0,[r0,#0]            ;9315
005818  da13              BGE      |L1.22594|
00581a  4282              CMP      r2,r0                 ;9315
00581c  db03              BLT      |L1.22566|
00581e  4283              CMP      r3,r0                 ;9315
005820  db01              BLT      |L1.22566|
005822  4284              CMP      r4,r0                 ;9315
005824  da0d              BGE      |L1.22594|
                  |L1.22566|
005826  48eb              LDR      r0,|L1.23508|
005828  f9b02000          LDRSH    r2,[r0,#0]            ;9317  ; TZNPN
00582c  4291              CMP      r1,r2                 ;9317
00582e  da23              BGE      |L1.22648|
005830  f1010101          ADD      r1,r1,#1              ;9319
005834  b208              SXTH     r0,r1                 ;9319
005836  8038              STRH     r0,[r7,#0]            ;9319
005838  4290              CMP      r0,r2                 ;9320
00583a  d11d              BNE      |L1.22648|
00583c  f886c000          STRB     r12,[r6,#0]           ;9322
005840  e01a              B        |L1.22648|
                  |L1.22594|
005842  f8dfc394          LDR      r12,|L1.23512|
005846  f9bcc000          LDRSH    r12,[r12,#0]          ;9326  ; UVNPN
00584a  4565              CMP      r5,r12                ;9326
00584c  dd14              BLE      |L1.22648|
00584e  4282              CMP      r2,r0                 ;9326
005850  dd12              BLE      |L1.22648|
005852  4283              CMP      r3,r0                 ;9326
005854  dd10              BLE      |L1.22648|
005856  4284              CMP      r4,r0                 ;9326
005858  dd0e              BLE      |L1.22648|
00585a  b169              CBZ      r1,|L1.22648|
00585c  f1a10101          SUB      r1,r1,#1              ;9330
005860  b208              SXTH     r0,r1                 ;9330
005862  8038              STRH     r0,[r7,#0]            ;9330
005864  b940              CBNZ     r0,|L1.22648|
005866  e000              B        |L1.22634|
                  |L1.22632|
005868  e002              B        |L1.22640|
                  |L1.22634|
00586a  f8868000          STRB     r8,[r6,#0]
00586e  e003              B        |L1.22648|
                  |L1.22640|
;;;9334   				}
;;;9335   			}
;;;9336   		}
;;;9337   	}
;;;9338   else
;;;9339   	{
;;;9340   	npn_tz_cnt=0;
005870  f8a7c000          STRH     r12,[r7,#0]
;;;9341   	npn_stat=npnsON;
005874  f8868000          STRB     r8,[r6,#0]
                  |L1.22648|
;;;9342   	}
;;;9343   
;;;9344   if(npn_stat==npnsOFF) mess_send(MESS2RELE_HNDL,PARAM_RELE_NPN,1,15);
005878  7830              LDRB     r0,[r6,#0]  ; npn_stat
00587a  2800              CMP      r0,#0
00587c  d107              BNE      |L1.22670|
00587e  e8bd03f0          POP      {r4-r9}
005882  230f              MOVS     r3,#0xf
005884  2201              MOVS     r2,#1
005886  216e              MOVS     r1,#0x6e
005888  20d2              MOVS     r0,#0xd2
00588a  f7ffbffe          B.W      mess_send
                  |L1.22670|
;;;9345   
;;;9346   
;;;9347   }
00588e  e8bd03f0          POP      {r4-r9}
005892  4770              BX       lr
;;;9348   
                          ENDP

                  loadoff_hndl PROC
;;;9350   //-----------------------------------------------
;;;9351   void loadoff_hndl(void)
005894  b5f0              PUSH     {r4-r7,lr}
;;;9352   {
;;;9353   if((load_U>UONPN)||(load_U<UVNPN))
005896  48c9              LDR      r0,|L1.23484|
;;;9354   	{
;;;9355   	if(load_off_cnt<TZNPN)
005898  4dd0              LDR      r5,|L1.23516|
;;;9356   		{
;;;9357   		load_off_cnt++;
;;;9358   		if(load_off_cnt>=TZNPN)
;;;9359   			{
;;;9360   			load_off_stat=npnsOFF;
00589a  2700              MOVS     r7,#0
00589c  f9b01000          LDRSH    r1,[r0,#0]            ;9353  ; load_U
0058a0  48c7              LDR      r0,|L1.23488|
0058a2  4ecf              LDR      r6,|L1.23520|
0058a4  f9b02000          LDRSH    r2,[r0,#0]            ;9353  ; UONPN
0058a8  f9b50000          LDRSH    r0,[r5,#0]            ;9355
0058ac  4291              CMP      r1,r2                 ;9353
0058ae  dc04              BGT      |L1.22714|
0058b0  4bc9              LDR      r3,|L1.23512|
0058b2  f9b33000          LDRSH    r3,[r3,#0]            ;9353  ; UVNPN
0058b6  4299              CMP      r1,r3                 ;9353
0058b8  da0d              BGE      |L1.22742|
                  |L1.22714|
0058ba  49c6              LDR      r1,|L1.23508|
0058bc  f9b11000          LDRSH    r1,[r1,#0]            ;9355  ; TZNPN
0058c0  4288              CMP      r0,r1                 ;9355
0058c2  da1c              BGE      |L1.22782|
0058c4  f1000001          ADD      r0,r0,#1              ;9357
0058c8  b200              SXTH     r0,r0                 ;9357
0058ca  8028              STRH     r0,[r5,#0]            ;9357
0058cc  4288              CMP      r0,r1                 ;9358
0058ce  db16              BLT      |L1.22782|
0058d0  7037              STRB     r7,[r6,#0]
;;;9361   			load_off_cnt=TZNPN;
0058d2  8029              STRH     r1,[r5,#0]
0058d4  e013              B        |L1.22782|
                  |L1.22742|
;;;9362   			}
;;;9363   		}
;;;9364   	}
;;;9365   else if((load_U>(UVNPN+dUNPN))&&(load_U<(UONPN-dUNPN)))
0058d6  4cc3              LDR      r4,|L1.23524|
0058d8  f9b44000          LDRSH    r4,[r4,#0]  ; dUNPN
0058dc  4423              ADD      r3,r3,r4
0058de  428b              CMP      r3,r1
0058e0  da0d              BGE      |L1.22782|
0058e2  1b12              SUBS     r2,r2,r4
0058e4  428a              CMP      r2,r1
0058e6  dd0a              BLE      |L1.22782|
;;;9366   	{
;;;9367   	if(load_off_cnt)
0058e8  b148              CBZ      r0,|L1.22782|
;;;9368   		{
;;;9369   		load_off_cnt--;
0058ea  f1a00001          SUB      r0,r0,#1
0058ee  b200              SXTH     r0,r0
0058f0  8028              STRH     r0,[r5,#0]
;;;9370   		if(load_off_cnt<=0)
0058f2  2800              CMP      r0,#0
0058f4  dc03              BGT      |L1.22782|
;;;9371   			{
;;;9372   			load_off_stat=npnsON;
0058f6  f04f0001          MOV      r0,#1
0058fa  7030              STRB     r0,[r6,#0]
;;;9373   			load_off_cnt=0;
0058fc  802f              STRH     r7,[r5,#0]
                  |L1.22782|
;;;9374   			}
;;;9375   		}
;;;9376   	}
;;;9377   
;;;9378   
;;;9379   if(load_off_stat==npnsOFF) tloaddisable_cmnd=10;
0058fe  7830              LDRB     r0,[r6,#0]  ; load_off_stat
005900  2800              CMP      r0,#0
005902  d103              BNE      |L1.22796|
005904  49b8              LDR      r1,|L1.23528|
005906  f04f000a          MOV      r0,#0xa
00590a  7008              STRB     r0,[r1,#0]
                  |L1.22796|
;;;9380   
;;;9381   
;;;9382   }
00590c  bdf0              POP      {r4-r7,pc}
;;;9383   
                          ENDP

                  speedChargeStartStop PROC
;;;9571   //-----------------------------------------------
;;;9572   void speedChargeStartStop(void)
00590e  b508              PUSH     {r3,lr}
;;;9573   {
;;;9574   /*if(speedChIsOn)
;;;9575   	{
;;;9576   	speedChIsOn=0;
;;;9577   	}
;;;9578   
;;;9579   else
;;;9580   	{
;;;9581   	if(speedChrgBlckStat==0)
;;;9582   		{
;;;9583   		speedChIsOn=1;
;;;9584   		speedChTimeCnt=0;
;;;9585   		}
;;;9586   	else
;;;9587   		{
;;;9588   		show_mess(	"     Ускоренный     ",
;;;9589   	          		"       заряд        ",
;;;9590   	          		"    заблокирован!   ",
;;;9591   	          		"                    ",2000);	 
;;;9592   		}
;;;9593   	}*/
;;;9594   
;;;9595   if(sp_ch_stat!=scsOFF)
005910  48b6              LDR      r0,|L1.23532|
005912  7801              LDRB     r1,[r0,#0]  ; sp_ch_stat
005914  b141              CBZ      r1,|L1.22824|
;;;9596   	{
;;;9597   	sp_ch_stat=scsOFF;
005916  f04f0100          MOV      r1,#0
00591a  7001              STRB     r1,[r0,#0]
;;;9598   	speedz_mem_hndl(10);
00591c  e8bd4008          POP      {r3,lr}
005920  f04f000a          MOV      r0,#0xa
005924  f7ffbffe          B.W      speedz_mem_hndl
                  |L1.22824|
;;;9599   	}
;;;9600   
;;;9601   else
;;;9602   	{
;;;9603   	if((speedChrgBlckStat==0)&&(spc_stat==spcOFF)
005928  49b1              LDR      r1,|L1.23536|
00592a  f9b12000          LDRSH    r2,[r1,#0]  ; speedChrgBlckStat
00592e  49b1              LDR      r1,|L1.23540|
005930  780b              LDRB     r3,[r1,#0]  ; spc_stat
005932  431a              ORRS     r2,r2,r3
005934  7b0b              LDRB     r3,[r1,#0xc]  ; vz1_stat
005936  7bc9              LDRB     r1,[r1,#0xf]  ; vz2_stat
005938  431a              ORRS     r2,r2,r3
00593a  430a              ORRS     r2,r2,r1
00593c  d009              BEQ      |L1.22866|
;;;9604   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9605   		&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)
;;;9606   		#endif
;;;9607   		)
;;;9608   		{
;;;9609   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9610   		sp_ch_stat=scsSTEP1;
;;;9611   		#else
;;;9612   		sp_ch_stat=scsWRK;
;;;9613   		#endif
;;;9614   		speedz_mem_hndl(1);
;;;9615   		}
;;;9616   	else 
;;;9617   		{
;;;9618   		show_mess(	"     Ускоренный     ",
00593e  f44f60fa          MOV      r0,#0x7d0
005942  9000              STR      r0,[sp,#0]
005944  4bac              LDR      r3,|L1.23544|
005946  a2ad              ADR      r2,|L1.23548|
005948  a1b2              ADR      r1,|L1.23572|
00594a  a0b8              ADR      r0,|L1.23596|
00594c  f7fffffe          BL       show_mess
;;;9619   	          		"       заряд        ",
;;;9620   	          		"    заблокирован!   ",
;;;9621   	          		"                    ",2000);
;;;9622   		}
;;;9623   	}
;;;9624   }
005950  bd08              POP      {r3,pc}
                  |L1.22866|
005952  f04f0101          MOV      r1,#1                 ;9610
005956  7001              STRB     r1,[r0,#0]            ;9610
005958  e8bd4008          POP      {r3,lr}               ;9614
00595c  4608              MOV      r0,r1                 ;9614
00595e  f7ffbffe          B.W      speedz_mem_hndl
;;;9625   
                          ENDP

                  speedChargeHndl PROC
;;;9384   //-----------------------------------------------
;;;9385   void speedChargeHndl(void)
005962  e92d4ff8          PUSH     {r3-r11,lr}
;;;9386   {
;;;9387   /*
;;;9388   if(sp_ch_stat==scsOFF)
;;;9389   	{
;;;9390   	if((sk_stat[1]==1)&&(sk_stat_old[1]=0))
;;;9391   	}*/
;;;9392   	 
;;;9393   if(sp_ch_stat==scsSTEP1)
005966  4fa1              LDR      r7,|L1.23532|
;;;9394   	{
;;;9395   	if(sp_ch_stat_old!=sp_ch_stat)
005968  4eb8              LDR      r6,|L1.23628|
;;;9396   		{
;;;9397   		sp_ch_stat_cnt=5;
;;;9398   		if(SP_CH_VENT_BLOK==0)
00596a  f8dfa2d8          LDR      r10,|L1.23620|
00596e  7839              LDRB     r1,[r7,#0]            ;9393  ; sp_ch_stat
;;;9399   			{
;;;9400   			sp_ch_stat_cnt=0;
;;;9401   			sp_ch_stat=scsWRK;
;;;9402   			}
;;;9403   		}
;;;9404   	if(sp_ch_stat_cnt)
;;;9405   		{
;;;9406   		sp_ch_stat_cnt--;
;;;9407   		if(sp_ch_stat_cnt==0)
;;;9408   			{
;;;9409   			sp_ch_stat=scsERR1; 	//Не включилась вентиляция;
;;;9410   
;;;9411   			}
;;;9412   		}
;;;9413   	if(sk_stat[0]==1)sp_ch_stat=scsWRK;
005970  f8df92d4          LDR      r9,|L1.23624|
005974  7830              LDRB     r0,[r6,#0]            ;9395
005976  4cb6              LDR      r4,|L1.23632|
005978  2500              MOVS     r5,#0                 ;9398
00597a  f04f0802          MOV      r8,#2                 ;9401
00597e  2901              CMP      r1,#1                 ;9393
005980  d11b              BNE      |L1.22970|
005982  2801              CMP      r0,#1                 ;9395
005984  d008              BEQ      |L1.22936|
005986  f04f0105          MOV      r1,#5                 ;9397
00598a  8021              STRH     r1,[r4,#0]            ;9397
00598c  f8ba1000          LDRH     r1,[r10,#0]           ;9398  ; SP_CH_VENT_BLOK
005990  b911              CBNZ     r1,|L1.22936|
005992  8025              STRH     r5,[r4,#0]            ;9400
005994  f8878000          STRB     r8,[r7,#0]            ;9401
                  |L1.22936|
005998  f9b41000          LDRSH    r1,[r4,#0]            ;9404  ; sp_ch_stat_cnt
00599c  b139              CBZ      r1,|L1.22958|
00599e  f1a10101          SUB      r1,r1,#1              ;9406
0059a2  b209              SXTH     r1,r1                 ;9406
0059a4  8021              STRH     r1,[r4,#0]            ;9406
0059a6  b911              CBNZ     r1,|L1.22958|
0059a8  f04f0103          MOV      r1,#3                 ;9409
0059ac  7039              STRB     r1,[r7,#0]            ;9409
                  |L1.22958|
0059ae  f8991000          LDRB     r1,[r9,#0]  ; sk_stat
0059b2  2901              CMP      r1,#1
0059b4  d101              BNE      |L1.22970|
0059b6  f8878000          STRB     r8,[r7,#0]
                  |L1.22970|
;;;9414   	}
;;;9415   
;;;9416   if(sp_ch_stat==scsWRK)
0059ba  7839              LDRB     r1,[r7,#0]  ; sp_ch_stat
0059bc  2902              CMP      r1,#2
0059be  d123              BNE      |L1.23048|
;;;9417   	{
;;;9418   	if(sp_ch_stat_old!=sp_ch_stat)
;;;9419   		{
;;;9420   		sp_ch_wrk_cnt=(signed long)speedChrgTimeInHour*3600L;
0059c0  4aa4              LDR      r2,|L1.23636|
;;;9421   		hv_vz_up_cnt=0;
0059c2  49a5              LDR      r1,|L1.23640|
0059c4  2802              CMP      r0,#2                 ;9418
0059c6  d008              BEQ      |L1.23002|
0059c8  48a4              LDR      r0,|L1.23644|
0059ca  f44f6361          MOV      r3,#0xe10             ;9420
0059ce  f9b00000          LDRSH    r0,[r0,#0]            ;9420  ; speedChrgTimeInHour
0059d2  fb00f003          MUL      r0,r0,r3              ;9420
0059d6  6010              STR      r0,[r2,#0]            ;9420  ; sp_ch_wrk_cnt
0059d8  600d              STR      r5,[r1,#0]  ; hv_vz_up_cnt
                  |L1.23002|
;;;9422   		}
;;;9423   	sp_ch_wrk_cnt--;
0059da  6810              LDR      r0,[r2,#0]  ; sp_ch_wrk_cnt
0059dc  f1a00001          SUB      r0,r0,#1
0059e0  6010              STR      r0,[r2,#0]  ; sp_ch_wrk_cnt
;;;9424   	hv_vz_up_cnt++;
0059e2  680a              LDR      r2,[r1,#0]  ; hv_vz_up_cnt
0059e4  f1020201          ADD      r2,r2,#1
0059e8  600a              STR      r2,[r1,#0]  ; hv_vz_up_cnt
;;;9425   	if(sp_ch_wrk_cnt==0)
0059ea  b918              CBNZ     r0,|L1.23028|
;;;9426   		{
;;;9427   		sp_ch_stat=scsOFF;
0059ec  703d              STRB     r5,[r7,#0]
;;;9428   		speedz_mem_hndl(0);
0059ee  2000              MOVS     r0,#0
0059f0  f7fffffe          BL       speedz_mem_hndl
                  |L1.23028|
;;;9429   		}
;;;9430   	#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9431   	if((sk_stat[0]==0)&&(SP_CH_VENT_BLOK==1))sp_ch_stat=scsERR2;
0059f4  f8990000          LDRB     r0,[r9,#0]  ; sk_stat
0059f8  b930              CBNZ     r0,|L1.23048|
0059fa  f8ba0000          LDRH     r0,[r10,#0]  ; SP_CH_VENT_BLOK
0059fe  2801              CMP      r0,#1
005a00  d102              BNE      |L1.23048|
005a02  f04f0004          MOV      r0,#4
005a06  7038              STRB     r0,[r7,#0]
                  |L1.23048|
;;;9432   	#endif
;;;9433   	}
;;;9434   
;;;9435   if(sp_ch_stat==scsERR1)		//Отсутствует вентиляция при включении
005a08  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
;;;9436   	{
;;;9437   	if((sp_ch_stat_old!=sp_ch_stat)||(sp_ch_stat_cnt==0))
;;;9438   		{
;;;9439   		sp_ch_stat_cnt=10;
;;;9440   		}
;;;9441   	sp_ch_stat_cnt--;
;;;9442   	if((sp_ch_stat_cnt==10)||(sp_ch_stat_cnt==9))
;;;9443   		{
;;;9444   		show_mess(	"  УСКОРЕННЫЙ ЗАРЯД  ",
005a0a  f2413b88          MOV      r11,#0x1388
005a0e  f04f0a0a          MOV      r10,#0xa              ;9439
005a12  2803              CMP      r0,#3                 ;9435
005a14  d119              BNE      |L1.23114|
005a16  7830              LDRB     r0,[r6,#0]            ;9437  ; sp_ch_stat_old
005a18  2803              CMP      r0,#3                 ;9437
005a1a  d101              BNE      |L1.23072|
005a1c  8820              LDRH     r0,[r4,#0]            ;9437  ; sp_ch_stat_cnt
005a1e  b908              CBNZ     r0,|L1.23076|
                  |L1.23072|
005a20  f8a4a000          STRH     r10,[r4,#0]           ;9439
                  |L1.23076|
005a24  8820              LDRH     r0,[r4,#0]            ;9441  ; sp_ch_stat_cnt
005a26  f1a00001          SUB      r0,r0,#1              ;9441
005a2a  b200              SXTH     r0,r0                 ;9441
005a2c  8020              STRH     r0,[r4,#0]            ;9441
005a2e  280a              CMP      r0,#0xa               ;9442
005a30  d001              BEQ      |L1.23094|
005a32  2809              CMP      r0,#9                 ;9442
005a34  d109              BNE      |L1.23114|
                  |L1.23094|
005a36  4b8a              LDR      r3,|L1.23648|
005a38  a08a              ADR      r0,|L1.23652|
005a3a  f1030218          ADD      r2,r3,#0x18
005a3e  f1020118          ADD      r1,r2,#0x18
005a42  f8cdb000          STR      r11,[sp,#0]
005a46  f7fffffe          BL       show_mess
                  |L1.23114|
;;;9445   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;9446   					"      ВКЛЮЧЕН       ",
;;;9447   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;9448   					5000);
;;;9449   		}
;;;9450   	}
;;;9451   if(sp_ch_stat==scsERR2)		//Пропала вентиляция при работе
005a4a  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
005a4c  2804              CMP      r0,#4
005a4e  d11f              BNE      |L1.23184|
;;;9452   	{
;;;9453   	if((sp_ch_stat_old!=sp_ch_stat)||(sp_ch_stat_cnt==0))
005a50  7830              LDRB     r0,[r6,#0]  ; sp_ch_stat_old
005a52  2804              CMP      r0,#4
005a54  d101              BNE      |L1.23130|
005a56  8820              LDRH     r0,[r4,#0]  ; sp_ch_stat_cnt
005a58  b908              CBNZ     r0,|L1.23134|
                  |L1.23130|
;;;9454   		{
;;;9455   		sp_ch_stat_cnt=10;
005a5a  f8a4a000          STRH     r10,[r4,#0]
                  |L1.23134|
;;;9456   		}
;;;9457   	sp_ch_stat_cnt--;
005a5e  8820              LDRH     r0,[r4,#0]  ; sp_ch_stat_cnt
005a60  f1a00001          SUB      r0,r0,#1
005a64  b200              SXTH     r0,r0
005a66  8020              STRH     r0,[r4,#0]
;;;9458   	if((sp_ch_stat_cnt==10)||(sp_ch_stat_cnt==9))
005a68  280a              CMP      r0,#0xa
005a6a  d001              BEQ      |L1.23152|
005a6c  2809              CMP      r0,#9
005a6e  d109              BNE      |L1.23172|
                  |L1.23152|
;;;9459   		{
;;;9460   		show_mess(	"  УСКОРЕННЫЙ ЗАРЯД  ",
005a70  4b82              LDR      r3,|L1.23676|
005a72  a07c              ADR      r0,|L1.23652|
005a74  f1030218          ADD      r2,r3,#0x18
005a78  f1020118          ADD      r1,r2,#0x18
005a7c  f8cdb000          STR      r11,[sp,#0]
005a80  f7fffffe          BL       show_mess
                  |L1.23172|
;;;9461   					"    ЗАБЛОКИРОВАН    ",
;;;9462   					"     НЕИСПРАВНА     ",
;;;9463   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;9464   					5000);
;;;9465   		}
;;;9466   	if(sk_stat[0]==1)sp_ch_stat=scsWRK;
005a84  f8990000          LDRB     r0,[r9,#0]  ; sk_stat
005a88  2801              CMP      r0,#1
005a8a  d101              BNE      |L1.23184|
005a8c  f8878000          STRB     r8,[r7,#0]
                  |L1.23184|
;;;9467   	}
;;;9468   
;;;9469   
;;;9470   sp_ch_stat_old=sp_ch_stat;
005a90  7838              LDRB     r0,[r7,#0]  ; sp_ch_stat
005a92  7030              STRB     r0,[r6,#0]
;;;9471   
;;;9472   
;;;9473   
;;;9474   if(speedChrgAvtEn==1)
005a94  497a              LDR      r1,|L1.23680|
;;;9475   	{
;;;9476   	if((sp_ch_stat==scsOFF)&&(spc_stat==spcOFF)
;;;9477   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9478   		&&(vz1_stat==vz1sOFF)&&(vz2_stat==vz2sOFF)
;;;9479   		#endif
;;;9480   		)
;;;9481   		{
;;;9482   		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)
;;;9483   		#ifdef UKU_220_IPS_TERMOKOMPENSAT
;;;9484   		&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)
;;;9485   		#endif
;;;9486   		#ifdef UKU_220_V2
;;;9487   		&&(abs(bat[0]._Ib/10-IZMAX)<10)
;;;9488   		#endif
;;;9489   		&&(!speedChrgBlckStat))
005a96  4c56              LDR      r4,|L1.23536|
005a98  8809              LDRH     r1,[r1,#0]            ;9474  ; speedChrgAvtEn
005a9a  2901              CMP      r1,#1                 ;9474
005a9c  d109              BNE      |L1.23218|
005a9e  4955              LDR      r1,|L1.23540|
;;;9490   			{
;;;9491   			speedChargeStartCnt++;
005aa0  4e78              LDR      r6,|L1.23684|
005aa2  780a              LDRB     r2,[r1,#0]            ;9476  ; spc_stat
005aa4  4310              ORRS     r0,r0,r2              ;9476
005aa6  7b0a              LDRB     r2,[r1,#0xc]          ;9476  ; vz1_stat
005aa8  7bc9              LDRB     r1,[r1,#0xf]          ;9476  ; vz2_stat
005aaa  4310              ORRS     r0,r0,r2              ;9476
005aac  4308              ORRS     r0,r0,r1              ;9476
005aae  d007              BEQ      |L1.23232|
;;;9492   			if(speedChargeStartCnt>=60)
;;;9493   				{
;;;9494   				speedChargeStartStop();
;;;9495   				speedz_mem_hndl(5);
;;;9496   				}
;;;9497   			}
;;;9498   		else speedChargeStartCnt=0;
;;;9499   		}
;;;9500   	else speedChargeStartCnt=0;
005ab0  7035              STRB     r5,[r6,#0]
                  |L1.23218|
;;;9501   	}
;;;9502   
;;;9503   
;;;9504   
;;;9505   /*
;;;9506   if(speedChIsOn)
;;;9507   	{
;;;9508   	speedChTimeCnt++;
;;;9509   	if(speedChTimeCnt>=((signed long)speedChrgTimeInHour*3600L))
;;;9510   		{
;;;9511   		speedChIsOn=0;
;;;9512   		}
;;;9513   	if(speedChrgBlckStat)
;;;9514   		{
;;;9515   		speedChIsOn=0;
;;;9516   		speedChTimeCnt=0;
;;;9517   		}
;;;9518   	}
;;;9519   
;;;9520   
;;;9521   
;;;9522   if(speedChrgAvtEn)
;;;9523   	{
;;;9524   	if(!speedChIsOn)
;;;9525   		{
;;;9526   		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)&&(!speedChrgBlckStat))
;;;9527   			{
;;;9528   			speedChIsOn=1;
;;;9529   			}
;;;9530   		}
;;;9531   	}
;;;9532   
;;;9533   
;;;9534   */
;;;9535   if(/*(speedChrgBlckSrc!=1)&&*/(speedChrgBlckSrc!=2)) speedChrgBlckStat=0;
005ab2  4875              LDR      r0,|L1.23688|
005ab4  8800              LDRH     r0,[r0,#0]  ; speedChrgBlckSrc
005ab6  2802              CMP      r0,#2
005ab8  d02e              BEQ      |L1.23320|
005aba  8025              STRH     r5,[r4,#0]
                  |L1.23228|
;;;9536   else
;;;9537   	{
;;;9538   	speedChrgBlckStat=0;
;;;9539   	if(speedChrgBlckSrc==1)
;;;9540   		{
;;;9541   		if(((speedChrgBlckLog==0)&&(adc_buff_[11]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[11]<2000))) speedChrgBlckStat=1;
;;;9542   		}
;;;9543   	else if(speedChrgBlckSrc==2)
;;;9544   		{
;;;9545   		if(((speedChrgBlckLog==0)&&(adc_buff_[13]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[13]<2000))) speedChrgBlckStat=1;
;;;9546   		}
;;;9547   	}
;;;9548   
;;;9549   /*
;;;9550   if(speedChrgBlckStat==1)
;;;9551   	{
;;;9552   
;;;9553   	//speedChargeStartStop();
;;;9554   
;;;9555   	speedChrgShowCnt++;
;;;9556   	if(speedChrgShowCnt>=30)	
;;;9557   		{
;;;9558   		speedChrgShowCnt=0;
;;;9559   		show_mess(	"     УСКОРЕННЫЙ     ",
;;;9560   					"       ЗАРЯД        ",
;;;9561   					"     ЗАПРЕЩЕН!!!    ",
;;;9562   					"                    ",
;;;9563   					5000);
;;;9564   		}
;;;9565   	} 
;;;9566   else speedChrgShowCnt=0;  */
;;;9567   
;;;9568   
;;;9569   }
005abc  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.23232|
005ac0  483e              LDR      r0,|L1.23484|
005ac2  4972              LDR      r1,|L1.23692|
005ac4  f9b00000          LDRSH    r0,[r0,#0]            ;9482  ; load_U
005ac8  f9b11000          LDRSH    r1,[r1,#0]            ;9482  ; u_necc
005acc  4288              CMP      r0,r1                 ;9482
005ace  da14              BGE      |L1.23290|
005ad0  1a08              SUBS     r0,r1,r0              ;9482
005ad2  496f              LDR      r1,|L1.23696|
005ad4  f9b11000          LDRSH    r1,[r1,#0]            ;9482  ; speedChrgDU
005ad8  4288              CMP      r0,r1                 ;9482
005ada  dd0e              BLE      |L1.23290|
005adc  486d              LDR      r0,|L1.23700|
005ade  496e              LDR      r1,|L1.23704|
005ae0  f9b00000          LDRSH    r0,[r0,#0]            ;9484  ; Ib_ips_termokompensat
005ae4  8809              LDRH     r1,[r1,#0]            ;9484  ; IZMAX
005ae6  fb90f0fa          SDIV     r0,r0,r10             ;9484
005aea  1a40              SUBS     r0,r0,r1              ;9484
005aec  b200              SXTH     r0,r0                 ;9484
005aee  f7fffffe          BL       abs
005af2  2805              CMP      r0,#5                 ;9484
005af4  da01              BGE      |L1.23290|
005af6  8820              LDRH     r0,[r4,#0]            ;9489  ; speedChrgBlckStat
005af8  b108              CBZ      r0,|L1.23294|
                  |L1.23290|
005afa  7035              STRB     r5,[r6,#0]            ;9498
005afc  e7d9              B        |L1.23218|
                  |L1.23294|
005afe  7830              LDRB     r0,[r6,#0]            ;9491  ; speedChargeStartCnt
005b00  f1000001          ADD      r0,r0,#1              ;9491
005b04  b2c0              UXTB     r0,r0                 ;9491
005b06  7030              STRB     r0,[r6,#0]            ;9491
005b08  283c              CMP      r0,#0x3c              ;9492
005b0a  d3d2              BCC      |L1.23218|
005b0c  f7fffffe          BL       speedChargeStartStop
005b10  2005              MOVS     r0,#5                 ;9495
005b12  f7fffffe          BL       speedz_mem_hndl
005b16  e7cc              B        |L1.23218|
                  |L1.23320|
005b18  8025              STRH     r5,[r4,#0]            ;9538
005b1a  4860              LDR      r0,|L1.23708|
005b1c  4960              LDR      r1,|L1.23712|
005b1e  f44f63fa          MOV      r3,#0x7d0             ;9541
005b22  f9b00000          LDRSH    r0,[r0,#0]            ;9545  ; speedChrgBlckLog
005b26  b918              CBNZ     r0,|L1.23344|
005b28  f9b1201a          LDRSH    r2,[r1,#0x1a]         ;9545  ; adc_buff_
005b2c  429a              CMP      r2,r3                 ;9545
005b2e  dc05              BGT      |L1.23356|
                  |L1.23344|
005b30  2801              CMP      r0,#1                 ;9545
005b32  d1c3              BNE      |L1.23228|
005b34  f9b1001a          LDRSH    r0,[r1,#0x1a]         ;9545  ; adc_buff_
005b38  4298              CMP      r0,r3                 ;9545
005b3a  dabf              BGE      |L1.23228|
                  |L1.23356|
005b3c  f04f0001          MOV      r0,#1                 ;9545
005b40  8020              STRH     r0,[r4,#0]            ;9545
005b42  e7bb              B        |L1.23228|
;;;9570   
                          ENDP

                  averageChargeHndl PROC
;;;9626   //-----------------------------------------------
;;;9627   void averageChargeHndl(void)
005b44  e92d4ff8          PUSH     {r3-r11,lr}
;;;9628   {
;;;9629   /*
;;;9630   if(hv_vz_stat==hvsOFF)
;;;9631   	{
;;;9632   	if((sk_stat[1]==1)&&(sk_stat_old[1]=0))
;;;9633   	} */
;;;9634   if(hv_vz_stat!=hvsOFF)
005b48  f8dfa158          LDR      r10,|L1.23716|
005b4c  f04f0b00          MOV      r11,#0
005b50  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005b54  b130              CBZ      r0,|L1.23396|
;;;9635   	{
;;;9636   	hv_vz_stat=hvsOFF; 	
005b56  f88ab000          STRB     r11,[r10,#0]
;;;9637   	lc640_write(EE_HV_VZ_STAT,hvsOFF);
005b5a  2100              MOVS     r1,#0
005b5c  f44f70b4          MOV      r0,#0x168
005b60  f7fffffe          BL       lc640_write
                  |L1.23396|
;;;9638   	}
;;;9639   
;;;9640   if(hv_vz_stat==hvsSTEP1)
005b64  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
;;;9641   	{
;;;9642   	if(hv_vz_stat_old!=hv_vz_stat)
;;;9643   		{
;;;9644   		hv_vz_stat_cnt=5;
;;;9645   		}
;;;9646   	if(hv_vz_stat_cnt)
;;;9647   		{
;;;9648   		hv_vz_stat_cnt--;
;;;9649   		if(hv_vz_stat_cnt==0)
;;;9650   			{
;;;9651   			hv_vz_stat=hvsERR1; 	//Не включилась вентиляция;
;;;9652   			lc640_write(EE_HV_VZ_STAT,hvsERR1);
;;;9653   			}
;;;9654   		}
;;;9655   	if(sk_stat[0]==1)
005b68  4e37              LDR      r6,|L1.23624|
005b6a  4d4f              LDR      r5,|L1.23720|
005b6c  4c4f              LDR      r4,|L1.23724|
005b6e  f04f0905          MOV      r9,#5                 ;9644
005b72  2801              CMP      r0,#1                 ;9640
005b74  d118              BNE      |L1.23464|
005b76  7828              LDRB     r0,[r5,#0]            ;9642  ; hv_vz_stat_old
005b78  2801              CMP      r0,#1                 ;9642
005b7a  d001              BEQ      |L1.23424|
005b7c  f8a49000          STRH     r9,[r4,#0]            ;9644
                  |L1.23424|
005b80  f9b40000          LDRSH    r0,[r4,#0]            ;9646  ; hv_vz_stat_cnt
005b84  b168              CBZ      r0,|L1.23458|
005b86  f1a00001          SUB      r0,r0,#1              ;9648
005b8a  b200              SXTH     r0,r0                 ;9648
005b8c  8020              STRH     r0,[r4,#0]            ;9648
005b8e  b940              CBNZ     r0,|L1.23458|
005b90  f04f0006          MOV      r0,#6                 ;9651
005b94  f88a0000          STRB     r0,[r10,#0]           ;9651
005b98  4601              MOV      r1,r0                 ;9652
005b9a  f44f70b4          MOV      r0,#0x168             ;9652
005b9e  f7fffffe          BL       lc640_write
                  |L1.23458|
005ba2  7830              LDRB     r0,[r6,#0]  ; sk_stat
005ba4  2801              CMP      r0,#1
005ba6  e083              B        |L1.23728|
                  |L1.23464|
005ba8  e09c              B        |L1.23780|
005baa  0000              DCW      0x0000
                  |L1.23468|
                          DCD      superviser_cnt
                  |L1.23472|
                          DCD      NPN_OUT
                  |L1.23476|
                          DCD      npn_tz_cnt
                  |L1.23480|
                          DCD      npn_stat
                  |L1.23484|
                          DCD      load_U
                  |L1.23488|
                          DCD      UONPN
                  |L1.23492|
                          DCD      net_Ua
                  |L1.23496|
                          DCD      net_Ub
                  |L1.23500|
                          DCD      net_Uc
                  |L1.23504|
                          DCD      UMN
                  |L1.23508|
                          DCD      TZNPN
                  |L1.23512|
                          DCD      UVNPN
                  |L1.23516|
                          DCD      load_off_cnt
                  |L1.23520|
                          DCD      load_off_stat
                  |L1.23524|
                          DCD      dUNPN
                  |L1.23528|
                          DCD      tloaddisable_cmnd
                  |L1.23532|
                          DCD      sp_ch_stat
                  |L1.23536|
                          DCD      speedChrgBlckStat
                  |L1.23540|
                          DCD      ||area_number.25||+0x1a
                  |L1.23544|
                          DCD      ||.text||+0xeb4
                  |L1.23548|
005bfc  20202020          DCB      "    ",231,224,225,235,238,234,232,240,238,226,224,237,"!"
005c00  e7e0e1eb
005c04  eeeae8f0
005c08  eee2e0ed
005c0c  21      
005c0d  20202000          DCB      "   ",0
005c11  00                DCB      0
005c12  00                DCB      0
005c13  00                DCB      0
                  |L1.23572|
005c14  20202020          DCB      "       ",231,224,240,255,228,"        ",0
005c18  202020e7
005c1c  e0f0ffe4
005c20  20202020
005c24  20202020
005c28  00      
005c29  00                DCB      0
005c2a  00                DCB      0
005c2b  00                DCB      0
                  |L1.23596|
005c2c  20202020          DCB      "     ",211,241,234,238,240,229,237,237,251,233,"     ",0
005c30  20d3f1ea
005c34  eef0e5ed
005c38  edfbe920
005c3c  20202020
005c40  00      
005c41  00                DCB      0
005c42  00                DCB      0
005c43  00                DCB      0
                  |L1.23620|
                          DCD      SP_CH_VENT_BLOK
                  |L1.23624|
                          DCD      sk_stat
                  |L1.23628|
                          DCD      sp_ch_stat_old
                  |L1.23632|
                          DCD      sp_ch_stat_cnt
                  |L1.23636|
                          DCD      sp_ch_wrk_cnt
                  |L1.23640|
                          DCD      hv_vz_up_cnt
                  |L1.23644|
                          DCD      speedChrgTimeInHour
                  |L1.23648|
                          DCD      ||.text||+0xd7c
                  |L1.23652|
005c64  2020d3d1          DCB      "  ",211,209,202,206,208,197,205,205,219,201," ",199,192
005c68  caced0c5
005c6c  cdcddbc9
005c70  20c7c0  
005c73  d0dfc420          DCB      208,223,196,"  ",0
005c77  2000    
005c79  00                DCB      0
005c7a  00                DCB      0
005c7b  00                DCB      0
                  |L1.23676|
                          DCD      ||.text||+0x8e0
                  |L1.23680|
                          DCD      speedChrgAvtEn
                  |L1.23684|
                          DCD      speedChargeStartCnt
                  |L1.23688|
                          DCD      speedChrgBlckSrc
                  |L1.23692|
                          DCD      u_necc
                  |L1.23696|
                          DCD      speedChrgDU
                  |L1.23700|
                          DCD      Ib_ips_termokompensat
                  |L1.23704|
                          DCD      IZMAX
                  |L1.23708|
                          DCD      speedChrgBlckLog
                  |L1.23712|
                          DCD      ||.bss||+0x40c
                  |L1.23716|
                          DCD      hv_vz_stat
                  |L1.23720|
                          DCD      hv_vz_stat_old
                  |L1.23724|
                          DCD      hv_vz_stat_cnt
                  |L1.23728|
005cb0  d118              BNE      |L1.23780|
;;;9656   		{
;;;9657   		hv_vz_stat=hvsSTEP2;
005cb2  f04f0002          MOV      r0,#2
005cb6  f88a0000          STRB     r0,[r10,#0]
;;;9658   		lc640_write(EE_HV_VZ_STAT,hvsSTEP2);
005cba  4601              MOV      r1,r0
005cbc  f44f70b4          MOV      r0,#0x168
005cc0  f7fffffe          BL       lc640_write
;;;9659   		tree_up(iHV_STEP2_2,1,0,0);
005cc4  2300              MOVS     r3,#0
005cc6  461a              MOV      r2,r3
005cc8  2101              MOVS     r1,#1
005cca  20dc              MOVS     r0,#0xdc
005ccc  f7fffffe          BL       tree_up
;;;9660   		tree_up(iHV_STEP2_1,0,0,0);
005cd0  2300              MOVS     r3,#0
005cd2  461a              MOV      r2,r3
005cd4  4619              MOV      r1,r3
005cd6  20db              MOVS     r0,#0xdb
005cd8  f7fffffe          BL       tree_up
;;;9661   		ret(1200);
005cdc  f44f6096          MOV      r0,#0x4b0
005ce0  f7fffffe          BL       ||ret||
                  |L1.23780|
;;;9662   		}
;;;9663   	}
;;;9664   
;;;9665   if(hv_vz_stat==hvsSTEP2)
005ce4  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005ce8  2802              CMP      r0,#2
005cea  d10b              BNE      |L1.23812|
;;;9666   	{
;;;9667   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
005cec  7829              LDRB     r1,[r5,#0]  ; hv_vz_stat_old
005cee  2902              CMP      r1,#2
005cf0  d101              BNE      |L1.23798|
005cf2  8821              LDRH     r1,[r4,#0]  ; hv_vz_stat_cnt
005cf4  b911              CBNZ     r1,|L1.23804|
                  |L1.23798|
;;;9668   		{
;;;9669   		hv_vz_stat_cnt=15;
005cf6  f04f010f          MOV      r1,#0xf
005cfa  8021              STRH     r1,[r4,#0]
                  |L1.23804|
;;;9670   		}
;;;9671   	hv_vz_stat_cnt--;
005cfc  8821              LDRH     r1,[r4,#0]  ; hv_vz_stat_cnt
005cfe  f1a10101          SUB      r1,r1,#1
005d02  8021              STRH     r1,[r4,#0]
                  |L1.23812|
;;;9672   	//if((hv_vz_stat_cnt==14)/*||(hv_vz_stat_cnt==13)||(hv_vz_stat_cnt==12)*/)
;;;9673   	//	{
;;;9674   //		show_mess_number(	"     ВНИМАНИЕ!!!    ",
;;;9675   	//				"  Напряжение будет  ",
;;;9676   	//				" увеличено до     @В",
;;;9677   	//				"ОТКЛЮЧИТЕ НАГРУЗКУ!!",
;;;9678   	//				4800,UVZ,1);
;;;9679   	//	}
;;;9680   	//if((hv_vz_stat_cnt==8)/*||(hv_vz_stat_cnt==7)||(hv_vz_stat_cnt==6)*/)
;;;9681   	//	{
;;;9682   	//	show_mess(	"    ПОДТВЕРДИТЕ     ",
;;;9683   	//				"     НАЖАТИЕМ       ",
;;;9684   	//				"    ЦЕНТРАЛЬНОЙ     ",
;;;9685   	//				"      КНОПКИ        ",
;;;9686   	//				4800);
;;;9687   	//	} 
;;;9688   /*	if(sk_stat[1]==1)
;;;9689   		{
;;;9690   		hv_vz_stat=hvsWRK;
;;;9691   		lc640_write(EE_HV_VZ_STAT,hvsWRK);
;;;9692   		}*/
;;;9693   	}
;;;9694   
;;;9695   if(hv_vz_stat==hvsSTEP3)
;;;9696   	{
;;;9697   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
;;;9698   		{
;;;9699   		hv_vz_stat_cnt=10;
005d04  270a              MOVS     r7,#0xa
;;;9700   		}
;;;9701   	hv_vz_stat_cnt--;
;;;9702   	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
;;;9703   		{
;;;9704   		show_mess(	"     ВКЛЮЧИТЕ       ",
005d06  f2413888          MOV      r8,#0x1388
005d0a  2803              CMP      r0,#3                 ;9695
005d0c  d122              BNE      |L1.23892|
005d0e  7828              LDRB     r0,[r5,#0]            ;9697  ; hv_vz_stat_old
005d10  2803              CMP      r0,#3                 ;9697
005d12  d101              BNE      |L1.23832|
005d14  8820              LDRH     r0,[r4,#0]            ;9697  ; hv_vz_stat_cnt
005d16  b900              CBNZ     r0,|L1.23834|
                  |L1.23832|
005d18  8027              STRH     r7,[r4,#0]            ;9699
                  |L1.23834|
005d1a  8820              LDRH     r0,[r4,#0]            ;9701  ; hv_vz_stat_cnt
005d1c  f1a00001          SUB      r0,r0,#1              ;9701
005d20  b200              SXTH     r0,r0                 ;9701
005d22  8020              STRH     r0,[r4,#0]            ;9701
005d24  280a              CMP      r0,#0xa               ;9702
005d26  d001              BEQ      |L1.23852|
005d28  2809              CMP      r0,#9                 ;9702
005d2a  d109              BNE      |L1.23872|
                  |L1.23852|
005d2c  4bfd              LDR      r3,|L1.24868|
005d2e  a2fe              ADR      r2,|L1.24872|
005d30  f5a37194          SUB      r1,r3,#0x128
005d34  f1010018          ADD      r0,r1,#0x18
005d38  f8cd8000          STR      r8,[sp,#0]
005d3c  f7fffffe          BL       show_mess
                  |L1.23872|
;;;9705   					"      ТУМБЛЕР       ",
;;;9706   					"   ВЫРАВНИВАЮЩИЙ    ",
;;;9707   					"       ЗАРЯД        ",
;;;9708   					5000);
;;;9709   		}
;;;9710   	if(sk_stat[1]==1)
005d40  7870              LDRB     r0,[r6,#1]  ; sk_stat
005d42  2801              CMP      r0,#1
005d44  d106              BNE      |L1.23892|
;;;9711   		{
;;;9712   		hv_vz_stat=hvsWRK;
005d46  f88a9000          STRB     r9,[r10,#0]
;;;9713   		lc640_write(EE_HV_VZ_STAT,hvsWRK);
005d4a  2105              MOVS     r1,#5
005d4c  f44f70b4          MOV      r0,#0x168
005d50  f7fffffe          BL       lc640_write
                  |L1.23892|
;;;9714   		}
;;;9715   	}
;;;9716   
;;;9717   if(hv_vz_stat==hvsWRK)
005d54  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005d58  2805              CMP      r0,#5
005d5a  d13a              BNE      |L1.24018|
;;;9718   	{
;;;9719   	if(hv_vz_stat_old!=hv_vz_stat)
005d5c  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
;;;9720   		{
;;;9721   		hv_vz_wrk_cnt=3600L/*100L*/*((long)VZ_HR);
005d5e  4af8              LDR      r2,|L1.24896|
;;;9722   		if(VZ_HR==0)  	hv_vz_wrk_cnt=1800L;
;;;9723   		hv_vz_up_cnt=0L;
005d60  49f8              LDR      r1,|L1.24900|
005d62  2805              CMP      r0,#5                 ;9719
005d64  d00d              BEQ      |L1.23938|
005d66  48f8              LDR      r0,|L1.24904|
005d68  f44f6361          MOV      r3,#0xe10             ;9721
005d6c  f9b00000          LDRSH    r0,[r0,#0]            ;9721  ; VZ_HR
005d70  fb00f303          MUL      r3,r0,r3              ;9721
005d74  6013              STR      r3,[r2,#0]            ;9721  ; hv_vz_wrk_cnt
005d76  b910              CBNZ     r0,|L1.23934|
005d78  f44f60e1          MOV      r0,#0x708             ;9722
005d7c  6010              STR      r0,[r2,#0]            ;9722  ; hv_vz_wrk_cnt
                  |L1.23934|
005d7e  f8c1b000          STR      r11,[r1,#0]  ; hv_vz_up_cnt
                  |L1.23938|
;;;9724   		}
;;;9725   	hv_vz_wrk_cnt--;
005d82  6810              LDR      r0,[r2,#0]  ; hv_vz_wrk_cnt
005d84  f1a00001          SUB      r0,r0,#1
005d88  6010              STR      r0,[r2,#0]  ; hv_vz_wrk_cnt
;;;9726   	hv_vz_up_cnt++;
005d8a  680a              LDR      r2,[r1,#0]  ; hv_vz_up_cnt
005d8c  f1020201          ADD      r2,r2,#1
005d90  600a              STR      r2,[r1,#0]  ; hv_vz_up_cnt
;;;9727   
;;;9728   	if(hv_vz_wrk_cnt==0)
005d92  b940              CBNZ     r0,|L1.23974|
;;;9729   		{
;;;9730   		hv_vz_stat=hvsERR4;
005d94  f04f0009          MOV      r0,#9
005d98  f88a0000          STRB     r0,[r10,#0]
;;;9731   		lc640_write(EE_HV_VZ_STAT,hvsERR4);
005d9c  4601              MOV      r1,r0
005d9e  f44f70b4          MOV      r0,#0x168
005da2  f7fffffe          BL       lc640_write
                  |L1.23974|
;;;9732   		}
;;;9733   	if(sk_stat[0]==0)
005da6  7830              LDRB     r0,[r6,#0]  ; sk_stat
005da8  b940              CBNZ     r0,|L1.23996|
;;;9734   		{
;;;9735   		hv_vz_stat=hvsERR2;
005daa  f04f0007          MOV      r0,#7
005dae  f88a0000          STRB     r0,[r10,#0]
;;;9736   		lc640_write(EE_HV_VZ_STAT,hvsERR2);
005db2  4601              MOV      r1,r0
005db4  f44f70b4          MOV      r0,#0x168
005db8  f7fffffe          BL       lc640_write
                  |L1.23996|
;;;9737   		}
;;;9738   	if(sk_stat[1]==0)
005dbc  7870              LDRB     r0,[r6,#1]  ; sk_stat
005dbe  b940              CBNZ     r0,|L1.24018|
;;;9739   		{
;;;9740   		hv_vz_stat=hvsERR3;
005dc0  f04f0008          MOV      r0,#8
005dc4  f88a0000          STRB     r0,[r10,#0]
;;;9741   		lc640_write(EE_HV_VZ_STAT,hvsERR3);
005dc8  4601              MOV      r1,r0
005dca  f44f70b4          MOV      r0,#0x168
005dce  f7fffffe          BL       lc640_write
                  |L1.24018|
;;;9742   		}
;;;9743   	}
;;;9744   
;;;9745   if(hv_vz_stat==hvsERR1)		//Отсутствует вентиляция при включении
005dd2  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005dd6  2806              CMP      r0,#6
005dd8  d11a              BNE      |L1.24080|
;;;9746   	{
;;;9747   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
005dda  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
005ddc  2806              CMP      r0,#6
005dde  d101              BNE      |L1.24036|
005de0  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005de2  b900              CBNZ     r0,|L1.24038|
                  |L1.24036|
;;;9748   		{
;;;9749   		hv_vz_stat_cnt=10;
005de4  8027              STRH     r7,[r4,#0]
                  |L1.24038|
;;;9750   		}
;;;9751   	hv_vz_stat_cnt--;
005de6  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005de8  f1a00001          SUB      r0,r0,#1
005dec  b200              SXTH     r0,r0
005dee  8020              STRH     r0,[r4,#0]
;;;9752   	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
005df0  280a              CMP      r0,#0xa
005df2  d001              BEQ      |L1.24056|
005df4  2809              CMP      r0,#9
005df6  d10b              BNE      |L1.24080|
                  |L1.24056|
;;;9753   		{
;;;9754   		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
005df8  4bca              LDR      r3,|L1.24868|
005dfa  f8cd8000          STR      r8,[sp,#0]
005dfe  3bf0              SUBS     r3,r3,#0xf0
005e00  f1030218          ADD      r2,r3,#0x18
005e04  f1020118          ADD      r1,r2,#0x18
005e08  f2a14084          SUB      r0,r1,#0x484
005e0c  f7fffffe          BL       show_mess
                  |L1.24080|
;;;9755   					"   НЕ МОЖЕТ БЫТЬ    ",
;;;9756   					"      ВКЛЮЧЕН       ",
;;;9757   					"  БЕЗ ВЕНТИЛЯЦИИ!!  ",
;;;9758   					5000);
;;;9759   		}
;;;9760   	}
;;;9761   if(hv_vz_stat==hvsERR2)		//Пропала вентиляция при работе
005e10  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005e14  2807              CMP      r0,#7
005e16  d123              BNE      |L1.24160|
;;;9762   	{
;;;9763   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
005e18  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
005e1a  2807              CMP      r0,#7
005e1c  d101              BNE      |L1.24098|
005e1e  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005e20  b900              CBNZ     r0,|L1.24100|
                  |L1.24098|
;;;9764   		{
;;;9765   		hv_vz_stat_cnt=10;
005e22  8027              STRH     r7,[r4,#0]
                  |L1.24100|
;;;9766   		}
;;;9767   	hv_vz_stat_cnt--;
005e24  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005e26  f1a00001          SUB      r0,r0,#1
005e2a  b200              SXTH     r0,r0
005e2c  8020              STRH     r0,[r4,#0]
;;;9768   	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
005e2e  280a              CMP      r0,#0xa
005e30  d001              BEQ      |L1.24118|
005e32  2809              CMP      r0,#9
005e34  d10a              BNE      |L1.24140|
                  |L1.24118|
;;;9769   		{
;;;9770   		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
005e36  4bc5              LDR      r3,|L1.24908|
005e38  f8cd8000          STR      r8,[sp,#0]
005e3c  f1030218          ADD      r2,r3,#0x18
005e40  f1020118          ADD      r1,r2,#0x18
005e44  f1010018          ADD      r0,r1,#0x18
005e48  f7fffffe          BL       show_mess
                  |L1.24140|
;;;9771   					"    ЗАБЛОКИРОВАН    ",
;;;9772   					"     НЕИСПРАВНА     ",
;;;9773   					"    ВЕНТИЛЯЦИЯ!!!   ",
;;;9774   					5000);
;;;9775   		}
;;;9776   	if(sk_stat[0]==1)
005e4c  7830              LDRB     r0,[r6,#0]  ; sk_stat
005e4e  2801              CMP      r0,#1
005e50  d106              BNE      |L1.24160|
;;;9777   		{
;;;9778   		hv_vz_stat=hvsWRK;
005e52  f88a9000          STRB     r9,[r10,#0]
;;;9779   		lc640_write(EE_HV_VZ_STAT,hvsWRK);
005e56  2105              MOVS     r1,#5
005e58  f44f70b4          MOV      r0,#0x168
005e5c  f7fffffe          BL       lc640_write
                  |L1.24160|
;;;9780   		}
;;;9781   	}
;;;9782   
;;;9783   if(hv_vz_stat==hvsERR3)		//Отключен тумблер "Выравнивающий заряд"
005e60  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005e64  2808              CMP      r0,#8
005e66  d123              BNE      |L1.24240|
;;;9784   	{
;;;9785   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
005e68  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
005e6a  2808              CMP      r0,#8
005e6c  d101              BNE      |L1.24178|
005e6e  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005e70  b900              CBNZ     r0,|L1.24180|
                  |L1.24178|
;;;9786   		{
;;;9787   		hv_vz_stat_cnt=10;
005e72  8027              STRH     r7,[r4,#0]
                  |L1.24180|
;;;9788   		}
;;;9789   	hv_vz_stat_cnt--;
005e74  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005e76  f1a00001          SUB      r0,r0,#1
005e7a  b200              SXTH     r0,r0
005e7c  8020              STRH     r0,[r4,#0]
;;;9790   	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
005e7e  280a              CMP      r0,#0xa
005e80  d001              BEQ      |L1.24198|
005e82  2809              CMP      r0,#9
005e84  d10a              BNE      |L1.24220|
                  |L1.24198|
;;;9791   		{
;;;9792   		show_mess(	"ВЫРАВНИВАЮЩИЙ ЗАРЯД ",
005e86  4bb2              LDR      r3,|L1.24912|
005e88  f8cd8000          STR      r8,[sp,#0]
005e8c  f5a36217          SUB      r2,r3,#0x970
005e90  f1020118          ADD      r1,r2,#0x18
005e94  f2a140e4          SUB      r0,r1,#0x4e4
005e98  f7fffffe          BL       show_mess
                  |L1.24220|
;;;9793   					"  БУДЕТ ПРОДОЛЖЕН   ",
;;;9794   					"  ПОСЛЕ ВКЛЮЧЕНИЯ   ",
;;;9795   					"    ТУМБЛЕРА!!!     ",
;;;9796   					5000);
;;;9797   		}
;;;9798   	if(sk_stat[1]==1)
005e9c  7870              LDRB     r0,[r6,#1]  ; sk_stat
005e9e  2801              CMP      r0,#1
005ea0  d106              BNE      |L1.24240|
;;;9799   		{
;;;9800   		hv_vz_stat=hvsWRK;
005ea2  f88a9000          STRB     r9,[r10,#0]
;;;9801   		lc640_write(EE_HV_VZ_STAT,hvsWRK);
005ea6  2105              MOVS     r1,#5
005ea8  f44f70b4          MOV      r0,#0x168
005eac  f7fffffe          BL       lc640_write
                  |L1.24240|
;;;9802   		}
;;;9803   	}
;;;9804   if(hv_vz_stat==hvsERR4)		//ВЗ закончился а тумблер включен
005eb0  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005eb4  2809              CMP      r0,#9
005eb6  d123              BNE      |L1.24320|
;;;9805   	{
;;;9806   	if((hv_vz_stat_old!=hv_vz_stat)||(hv_vz_stat_cnt==0))
005eb8  7828              LDRB     r0,[r5,#0]  ; hv_vz_stat_old
005eba  2809              CMP      r0,#9
005ebc  d101              BNE      |L1.24258|
005ebe  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005ec0  b900              CBNZ     r0,|L1.24260|
                  |L1.24258|
;;;9807   		{
;;;9808   		hv_vz_stat_cnt=10;
005ec2  8027              STRH     r7,[r4,#0]
                  |L1.24260|
;;;9809   		}
;;;9810   	hv_vz_stat_cnt--;
005ec4  8820              LDRH     r0,[r4,#0]  ; hv_vz_stat_cnt
005ec6  f1a00001          SUB      r0,r0,#1
005eca  b200              SXTH     r0,r0
005ecc  8020              STRH     r0,[r4,#0]
;;;9811   	if((hv_vz_stat_cnt==10)||(hv_vz_stat_cnt==9))
005ece  280a              CMP      r0,#0xa
005ed0  d001              BEQ      |L1.24278|
005ed2  2809              CMP      r0,#9
005ed4  d109              BNE      |L1.24298|
                  |L1.24278|
;;;9812   		{
;;;9813   		show_mess(	"     ВЫКЛЮЧИТЕ      ",
005ed6  4b93              LDR      r3,|L1.24868|
005ed8  a293              ADR      r2,|L1.24872|
005eda  f5a37194          SUB      r1,r3,#0x128
005ede  f50170ac          ADD      r0,r1,#0x158
005ee2  f8cd8000          STR      r8,[sp,#0]
005ee6  f7fffffe          BL       show_mess
                  |L1.24298|
;;;9814   					"      ТУМБЛЕР       ",
;;;9815   					"   ВЫРАВНИВАЮЩИЙ    ",
;;;9816   					"       ЗАРЯД        ",
;;;9817   					5000);
;;;9818   		}
;;;9819   	if(sk_stat[1]==0)
005eea  7870              LDRB     r0,[r6,#1]  ; sk_stat
005eec  b940              CBNZ     r0,|L1.24320|
;;;9820   		{
;;;9821   		hv_vz_stat=hvsOFF;
005eee  f88ab000          STRB     r11,[r10,#0]
;;;9822   		lc640_write(EE_HV_VZ_STAT,hvsOFF);
005ef2  2100              MOVS     r1,#0
005ef4  f44f70b4          MOV      r0,#0x168
005ef8  f7fffffe          BL       lc640_write
;;;9823   		vz_stop();
005efc  f7fffffe          BL       vz_stop
                  |L1.24320|
;;;9824   
;;;9825   		}
;;;9826   	}
;;;9827   hv_vz_stat_old=hv_vz_stat;
005f00  f89a0000          LDRB     r0,[r10,#0]  ; hv_vz_stat
005f04  7028              STRB     r0,[r5,#0]
;;;9828   /*
;;;9829   if(speedChIsOn)
;;;9830   	{
;;;9831   	speedChTimeCnt++;
;;;9832   	if(speedChTimeCnt>=((signed long)speedChrgTimeInHour*3600L))
;;;9833   		{
;;;9834   		speedChIsOn=0;
;;;9835   		}
;;;9836   	if(speedChrgBlckStat)
;;;9837   		{
;;;9838   		speedChIsOn=0;
;;;9839   		speedChTimeCnt=0;
;;;9840   		}
;;;9841   	}
;;;9842   
;;;9843   
;;;9844   
;;;9845   if(speedChrgAvtEn)
;;;9846   	{
;;;9847   	if(!speedChIsOn)
;;;9848   		{
;;;9849   		if((load_U<u_necc)&&((u_necc-load_U)>speedChrgDU)&&(abs(Ib_ips_termokompensat/10-IZMAX)<5)&&(!speedChrgBlckStat))
;;;9850   			{
;;;9851   			speedChIsOn=1;
;;;9852   			}
;;;9853   		}
;;;9854   	}
;;;9855   
;;;9856   
;;;9857   
;;;9858   if((speedChrgBlckSrc!=1)&&(speedChrgBlckSrc!=2)) speedChrgBlckStat=0;
;;;9859   else
;;;9860   	{
;;;9861   	speedChrgBlckStat=0;
;;;9862   	if(speedChrgBlckSrc==1)
;;;9863   		{
;;;9864   		if(((speedChrgBlckLog==0)&&(adc_buff_[11]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[11]<2000))) speedChrgBlckStat=1;
;;;9865   		}
;;;9866   	else if(speedChrgBlckSrc==2)
;;;9867   		{
;;;9868   		if(((speedChrgBlckLog==0)&&(adc_buff_[13]>2000)) || ((speedChrgBlckLog==1)&&(adc_buff_[13]<2000))) speedChrgBlckStat=1;
;;;9869   		}
;;;9870   	}
;;;9871   
;;;9872   
;;;9873   if(speedChrgBlckStat==1)
;;;9874   	{
;;;9875   
;;;9876   	//speedChargeStartStop();
;;;9877   
;;;9878   	speedChrgShowCnt++;
;;;9879   	if(speedChrgShowCnt>=30)	
;;;9880   		{
;;;9881   		speedChrgShowCnt=0;
;;;9882   		show_mess(	"     УСКОРЕННЫЙ     ",
;;;9883   					"       ЗАРЯД        ",
;;;9884   					"     ЗАПРЕЩЕН!!!    ",
;;;9885   					"                    ",
;;;9886   					5000);
;;;9887   		}
;;;9888   	}
;;;9889   else speedChrgShowCnt=0;
;;;9890   
;;;9891   */
;;;9892   }
005f06  e5d9              B        |L1.23228|
;;;9893   
                          ENDP

                  numOfForvardBps_hndl PROC
;;;9910   //-----------------------------------------------
;;;9911   void	numOfForvardBps_hndl(void)			//Программа смены первого источника для равномерного износа БПСов
005f08  e92d41f0          PUSH     {r4-r8,lr}
;;;9912   {
;;;9913   
;;;9914   numOfForvardBps_old=numOfForvardBps;
005f0c  4c91              LDR      r4,|L1.24916|
005f0e  7fe0              LDRB     r0,[r4,#0x1f]  ; numOfForvardBps
005f10  f8840020          STRB     r0,[r4,#0x20]
;;;9915   
;;;9916   numOfForvardBps=0;
005f14  f04f0500          MOV      r5,#0
005f18  77e5              STRB     r5,[r4,#0x1f]
;;;9917   
;;;9918   //FORVARDBPSCHHOUR=10;
;;;9919   
;;;9920   if((FORVARDBPSCHHOUR<=0)||(FORVARDBPSCHHOUR>500))
005f1a  4e8f              LDR      r6,|L1.24920|
005f1c  f9b60000          LDRSH    r0,[r6,#0]  ; FORVARDBPSCHHOUR
005f20  2800              CMP      r0,#0
005f22  dd02              BLE      |L1.24362|
005f24  f5b07ffa          CMP      r0,#0x1f4
005f28  dd02              BLE      |L1.24368|
                  |L1.24362|
;;;9921   	{
;;;9922   	FORVARDBPSCHHOUR=0;
005f2a  8035              STRH     r5,[r6,#0]
                  |L1.24364|
;;;9923   	return;
;;;9924   	}
;;;9925   
;;;9926   numOfForvardBps_minCnt++;
;;;9927   
;;;9928   
;;;9929   if(numOfForvardBps_minCnt>=60)
;;;9930   	{
;;;9931   	numOfForvardBps_minCnt=0;
;;;9932   	numOfForvardBps_hourCnt=lc640_read_int(EE_FORVBPSHOURCNT);
;;;9933   	numOfForvardBps_hourCnt++;
;;;9934   	if(numOfForvardBps_hourCnt>=(FORVARDBPSCHHOUR*NUMIST))
;;;9935   		{
;;;9936   		numOfForvardBps_hourCnt=0;
;;;9937   		}
;;;9938   	lc640_write_int(EE_FORVBPSHOURCNT,numOfForvardBps_hourCnt);
;;;9939   	}
;;;9940   
;;;9941   numOfForvardBps=numOfForvardBps_hourCnt/FORVARDBPSCHHOUR;
;;;9942   
;;;9943   //if(numOfForvardBps)
;;;9944   //numOfForvardBps_old=numOfForvardBps; 
;;;9945   }
005f2c  e8bd81f0          POP      {r4-r8,pc}
                  |L1.24368|
005f30  f8940021          LDRB     r0,[r4,#0x21]         ;9926  ; numOfForvardBps_minCnt
005f34  f1000001          ADD      r0,r0,#1              ;9926
005f38  b2c0              UXTB     r0,r0                 ;9926
005f3a  f8840021          STRB     r0,[r4,#0x21]         ;9926
005f3e  283c              CMP      r0,#0x3c              ;9929
005f40  d31b              BCC      |L1.24442|
005f42  f8845021          STRB     r5,[r4,#0x21]         ;9931
005f46  f44f7794          MOV      r7,#0x128             ;9932
005f4a  4638              MOV      r0,r7                 ;9932
005f4c  f7fffffe          BL       lc640_read_int
005f50  f1000001          ADD      r0,r0,#1              ;9933
005f54  b200              SXTH     r0,r0                 ;9933
005f56  f8a40072          STRH     r0,[r4,#0x72]         ;9933
005f5a  4a80              LDR      r2,|L1.24924|
005f5c  f9b61000          LDRSH    r1,[r6,#0]            ;9934  ; FORVARDBPSCHHOUR
005f60  f9b22000          LDRSH    r2,[r2,#0]            ;9934  ; NUMIST
005f64  fb01f102          MUL      r1,r1,r2              ;9934
005f68  4281              CMP      r1,r0                 ;9934
005f6a  dc01              BGT      |L1.24432|
005f6c  f8a45072          STRH     r5,[r4,#0x72]         ;9936
                  |L1.24432|
005f70  f9b41072          LDRSH    r1,[r4,#0x72]         ;9938  ; numOfForvardBps_hourCnt
005f74  4638              MOV      r0,r7                 ;9938
005f76  f7fffffe          BL       lc640_write_int
                  |L1.24442|
005f7a  f9b40072          LDRSH    r0,[r4,#0x72]         ;9941  ; numOfForvardBps_hourCnt
005f7e  f9b61000          LDRSH    r1,[r6,#0]            ;9941  ; FORVARDBPSCHHOUR
005f82  fb90f0f1          SDIV     r0,r0,r1              ;9941
005f86  77e0              STRB     r0,[r4,#0x1f]         ;9941
005f88  e7d0              B        |L1.24364|
;;;9946   
                          ENDP

                  numOfForvardBps_init PROC
;;;9947   //-----------------------------------------------
;;;9948   void	numOfForvardBps_init(void)			//Программа сброса системы смены первого источника для равномерного износа БПСов
005f8a  b510              PUSH     {r4,lr}
;;;9949   {									//Должна вызываться при изменении кол-ва источников в структуре
;;;9950   lc640_write_int(EE_FORVBPSHOURCNT,0);
005f8c  2100              MOVS     r1,#0
005f8e  f44f7094          MOV      r0,#0x128
005f92  f7fffffe          BL       lc640_write_int
;;;9951   numOfForvardBps_minCnt=58;
005f96  496f              LDR      r1,|L1.24916|
005f98  f04f003a          MOV      r0,#0x3a
005f9c  f8810021          STRB     r0,[r1,#0x21]
;;;9952   }
005fa0  bd10              POP      {r4,pc}
;;;9953   
                          ENDP

                  outVoltContrHndl PROC
;;;9954   //-----------------------------------------------
;;;9955   void outVoltContrHndl(void)
005fa2  b570              PUSH     {r4-r6,lr}
;;;9956   { 
;;;9957   if((load_U>U_OUT_KONTR_MAX)||(load_U<U_OUT_KONTR_MIN))
005fa4  4c6e              LDR      r4,|L1.24928|
005fa6  486f              LDR      r0,|L1.24932|
;;;9958   	{
;;;9959   	outVoltContrHndlCnt_=0;
;;;9960   	if(outVoltContrHndlCnt<U_OUT_KONTR_DELAY)
005fa8  4a6f              LDR      r2,|L1.24936|
005faa  f9b41000          LDRSH    r1,[r4,#0]            ;9957  ; load_U
005fae  f9b06000          LDRSH    r6,[r0,#0]            ;9957  ; U_OUT_KONTR_MAX
005fb2  2500              MOVS     r5,#0                 ;9959
005fb4  f9b20000          LDRSH    r0,[r2,#0]
005fb8  4b6c              LDR      r3,|L1.24940|
005fba  42b1              CMP      r1,r6                 ;9957
005fbc  dc04              BGT      |L1.24520|
005fbe  4e6c              LDR      r6,|L1.24944|
005fc0  f9b66000          LDRSH    r6,[r6,#0]            ;9957  ; U_OUT_KONTR_MIN
005fc4  42b1              CMP      r1,r6                 ;9957
005fc6  da0f              BGE      |L1.24552|
                  |L1.24520|
005fc8  801d              STRH     r5,[r3,#0]            ;9959
005fca  496a              LDR      r1,|L1.24948|
005fcc  f9b11000          LDRSH    r1,[r1,#0]  ; U_OUT_KONTR_DELAY
005fd0  4288              CMP      r0,r1
005fd2  da1b              BGE      |L1.24588|
;;;9961   		{
;;;9962   		outVoltContrHndlCnt++;
005fd4  f1000001          ADD      r0,r0,#1
005fd8  b200              SXTH     r0,r0
005fda  8010              STRH     r0,[r2,#0]
;;;9963   		if(outVoltContrHndlCnt==U_OUT_KONTR_DELAY)
005fdc  4288              CMP      r0,r1
005fde  d115              BNE      |L1.24588|
;;;9964   			{
;;;9965   			avar_uout_hndl(1);
005fe0  2001              MOVS     r0,#1
005fe2  f7fffffe          BL       avar_uout_hndl
005fe6  e011              B        |L1.24588|
                  |L1.24552|
;;;9966   			}
;;;9967   		}
;;;9968   	}
;;;9969   else
;;;9970   	{
;;;9971   	if(outVoltContrHndlCnt)
005fe8  b180              CBZ      r0,|L1.24588|
;;;9972   		{
;;;9973   		if(outVoltContrHndlCnt_<5)
005fea  f9b30000          LDRSH    r0,[r3,#0]  ; outVoltContrHndlCnt_
005fee  2805              CMP      r0,#5
005ff0  da0c              BGE      |L1.24588|
;;;9974   			{
;;;9975   			outVoltContrHndlCnt_++;
005ff2  f1000001          ADD      r0,r0,#1
005ff6  b200              SXTH     r0,r0
005ff8  8018              STRH     r0,[r3,#0]
;;;9976   			if(outVoltContrHndlCnt_>=5)
005ffa  2805              CMP      r0,#5
005ffc  db06              BLT      |L1.24588|
;;;9977   				{
;;;9978   				outVoltContrHndlCnt=0;
005ffe  8015              STRH     r5,[r2,#0]
;;;9979   				if(uout_av)avar_uout_hndl(0);
006000  485d              LDR      r0,|L1.24952|
006002  7800              LDRB     r0,[r0,#0]  ; uout_av
006004  b110              CBZ      r0,|L1.24588|
006006  2000              MOVS     r0,#0
006008  f7fffffe          BL       avar_uout_hndl
                  |L1.24588|
;;;9980   				}
;;;9981   			}
;;;9982   		}
;;;9983   	}
;;;9984   
;;;9985   if (load_U<(USIGN*10)) 
00600c  485b              LDR      r0,|L1.24956|
00600e  f9b41000          LDRSH    r1,[r4,#0]  ; load_U
006012  f9b00000          LDRSH    r0,[r0,#0]  ; USIGN
006016  eb000080          ADD      r0,r0,r0,LSL #2
00601a  ebb10f40          CMP      r1,r0,LSL #1
00601e  da0b              BGE      |L1.24632|
;;;9986   	{
;;;9987   	if(!bSILENT)
006020  4857              LDR      r0,|L1.24960|
006022  6800              LDR      r0,[r0,#0]  ; bSILENT
006024  2800              CMP      r0,#0
006026  d107              BNE      |L1.24632|
;;;9988   		{
;;;9989   		mess_send(MESS2RELE_HNDL,PARAM_RELE_BAT_IS_DISCHARGED,1,20);
006028  e8bd4070          POP      {r4-r6,lr}
00602c  2314              MOVS     r3,#0x14
00602e  2201              MOVS     r2,#1
006030  2172              MOVS     r1,#0x72
006032  20d2              MOVS     r0,#0xd2
006034  f7ffbffe          B.W      mess_send
                  |L1.24632|
;;;9990   		}
;;;9991   
;;;9992   	//bU_BAT2REL_AV_BAT=1;
;;;9993   	}
;;;9994   
;;;9995   
;;;9996   }
006038  bd70              POP      {r4-r6,pc}
;;;9997   
                          ENDP

                  vent_resurs_hndl PROC
;;;9998   //-----------------------------------------------
;;;9999   void vent_resurs_hndl(void)
00603a  e92d47f0          PUSH     {r4-r10,lr}
;;;10000  {
;;;10001  char i;
;;;10002  char crc_in,crc_eval;
;;;10003  
;;;10004  for(i=0;i<NUMIST;i++)
00603e  f04f0200          MOV      r2,#0
;;;10005  	{
;;;10006  	if((bps[i]._buff[7]&0xc0)==0x00)
;;;10007  		{
;;;10008  		bps[i]._vent_resurs_temp[0]=bps[i]._buff[7];
;;;10009  		}
;;;10010  	else if((bps[i]._buff[7]&0xc0)==0x40)
;;;10011  		{
;;;10012  		bps[i]._vent_resurs_temp[1]=bps[i]._buff[7];
;;;10013  		}
;;;10014  	else if((bps[i]._buff[7]&0xc0)==0x80)
;;;10015  		{
;;;10016  		bps[i]._vent_resurs_temp[2]=bps[i]._buff[7];
;;;10017  		}
;;;10018  	else if((bps[i]._buff[7]&0xc0)==0xc0)
;;;10019  		{
;;;10020  		bps[i]._vent_resurs_temp[3]=bps[i]._buff[7];
;;;10021  		}
;;;10022  	crc_in=0;
;;;10023  	crc_in|=(bps[i]._vent_resurs_temp[0]&0x30)>>4;
;;;10024  	crc_in|=(bps[i]._vent_resurs_temp[1]&0x30)>>2;
;;;10025  	crc_in|=(bps[i]._vent_resurs_temp[2]&0x30);
;;;10026  	crc_in|=(bps[i]._vent_resurs_temp[3]&0x30)<<2;
;;;10027  
;;;10028  	crc_eval =bps[i]._vent_resurs_temp[0]&0x0f;
;;;10029  	crc_eval^=bps[i]._vent_resurs_temp[1]&0x0f;
;;;10030  	crc_eval^=bps[i]._vent_resurs_temp[2]&0x0f;
;;;10031  	crc_eval^=bps[i]._vent_resurs_temp[3]&0x0f;
;;;10032  
;;;10033  	if(crc_eval==crc_in)
;;;10034  		{
;;;10035  		unsigned short temp_US;
;;;10036  		temp_US=0;
;;;10037  
;;;10038  		temp_US|=(bps[i]._vent_resurs_temp[3]&0x0f);
;;;10039  		temp_US<<=4;
;;;10040  		temp_US|=(bps[i]._vent_resurs_temp[2]&0x0f);
;;;10041  		temp_US<<=4;
;;;10042  		temp_US|=(bps[i]._vent_resurs_temp[1]&0x0f);
;;;10043  		temp_US<<=4;
;;;10044  		temp_US|=(bps[i]._vent_resurs_temp[0]&0x0f);
;;;10045  
;;;10046  		if(bps[i]._vent_resurs!=temp_US)bps[i]._vent_resurs=temp_US;
;;;10047  		}
;;;10048  
;;;10049  	if((bps[i]._vent_resurs>TVENTMAX*10)&&(TVENTMAX>0))
006042  4850              LDR      r0,|L1.24964|
006044  f8dfc140          LDR      r12,|L1.24968|
006048  f9b06000          LDRSH    r6,[r0,#0]
00604c  4843              LDR      r0,|L1.24924|
00604e  f9b07000          LDRSH    r7,[r0,#0]            ;10004
006052  e0a2              B        |L1.24986|
                  |L1.24660|
006054  ebc200c2          RSB      r0,r2,r2,LSL #3       ;10006
006058  eb001002          ADD      r0,r0,r2,LSL #4       ;10006
00605c  eb0c0080          ADD      r0,r12,r0,LSL #2      ;10006
006060  7b41              LDRB     r1,[r0,#0xd]          ;10006
006062  098b              LSRS     r3,r1,#6              ;10006
006064  d006              BEQ      |L1.24692|
006066  2301              MOVS     r3,#1                 ;10010
006068  ebb31f91          CMP      r3,r1,LSR #6          ;10010
00606c  d105              BNE      |L1.24698|
00606e  f8801055          STRB     r1,[r0,#0x55]         ;10012
006072  e00f              B        |L1.24724|
                  |L1.24692|
006074  f8801054          STRB     r1,[r0,#0x54]         ;10008
006078  e00c              B        |L1.24724|
                  |L1.24698|
00607a  2302              MOVS     r3,#2                 ;10014
00607c  ebb31f91          CMP      r3,r1,LSR #6          ;10014
006080  d102              BNE      |L1.24712|
006082  f8801056          STRB     r1,[r0,#0x56]         ;10016
006086  e005              B        |L1.24724|
                  |L1.24712|
006088  2303              MOVS     r3,#3                 ;10018
00608a  ebb31f91          CMP      r3,r1,LSR #6          ;10018
00608e  d101              BNE      |L1.24724|
006090  f8801057          STRB     r1,[r0,#0x57]         ;10020
                  |L1.24724|
006094  f8101f54          LDRB     r1,[r0,#0x54]!        ;10023
006098  f3c11401          UBFX     r4,r1,#4,#2           ;10023
00609c  7843              LDRB     r3,[r0,#1]            ;10024
00609e  f0030530          AND      r5,r3,#0x30           ;10024
0060a2  ea440495          ORR      r4,r4,r5,LSR #2       ;10024
0060a6  f8909002          LDRB     r9,[r0,#2]            ;10025
0060aa  f0090830          AND      r8,r9,#0x30           ;10025
0060ae  ea480804          ORR      r8,r8,r4              ;10025
0060b2  78c5              LDRB     r5,[r0,#3]            ;10026
0060b4  f1a00054          SUB      r0,r0,#0x54           ;10026
0060b8  f0050430          AND      r4,r5,#0x30           ;10026
0060bc  ea480884          ORR      r8,r8,r4,LSL #2       ;10026
0060c0  f001010f          AND      r1,r1,#0xf            ;10028
0060c4  f003040f          AND      r4,r3,#0xf            ;10029
0060c8  ea840a01          EOR      r10,r4,r1             ;10029
0060cc  f009030f          AND      r3,r9,#0xf            ;10030
0060d0  ea83090a          EOR      r9,r3,r10             ;10030
0060d4  f005050f          AND      r5,r5,#0xf            ;10031
0060d8  ea850909          EOR      r9,r5,r9              ;10031
0060dc  45c1              CMP      r9,r8                 ;10033
0060de  d113              BNE      |L1.24840|
0060e0  ea4f1505          LSL      r5,r5,#4              ;10039
0060e4  ea430305          ORR      r3,r3,r5              ;10040
0060e8  ea4f1303          LSL      r3,r3,#4              ;10041
0060ec  ea440403          ORR      r4,r4,r3              ;10042
0060f0  ea4f5304          LSL      r3,r4,#20             ;10043
0060f4  ea4f4313          LSR      r3,r3,#16             ;10043
0060f8  ea410103          ORR      r1,r1,r3              ;10044
0060fc  f8b03058          LDRH     r3,[r0,#0x58]         ;10046
006100  428b              CMP      r3,r1                 ;10046
006102  d001              BEQ      |L1.24840|
006104  f8a01058          STRH     r1,[r0,#0x58]         ;10046
                  |L1.24840|
006108  f8b01058          LDRH     r1,[r0,#0x58]
00610c  eb060386          ADD      r3,r6,r6,LSL #2
006110  ebb10f43          CMP      r1,r3,LSL #1
006114  dd3a              BLE      |L1.24972|
006116  2e00              CMP      r6,#0
006118  dd38              BLE      |L1.24972|
;;;10050  		{
;;;10051  		bps[i]._av|=(1<<4);
00611a  7841              LDRB     r1,[r0,#1]
00611c  f0410110          ORR      r1,r1,#0x10
006120  7041              STRB     r1,[r0,#1]
006122  e037              B        |L1.24980|
                  |L1.24868|
                          DCD      ||.text||+0xe6c
                  |L1.24872|
006128  202020c2          DCB      "   ",194,219,208,192,194,205,200,194,192,222,217,200,201
00612c  dbd0c0c2
006130  cdc8c2c0
006134  ded9c8c9
006138  20202020          DCB      "    ",0
00613c  00      
00613d  00                DCB      0
00613e  00                DCB      0
00613f  00                DCB      0
                  |L1.24896|
                          DCD      hv_vz_wrk_cnt
                  |L1.24900|
                          DCD      hv_vz_up_cnt
                  |L1.24904|
                          DCD      VZ_HR
                  |L1.24908|
                          DCD      ||.text||+0x8e0
                  |L1.24912|
                          DCD      ||.text||+0x1764
                  |L1.24916|
                          DCD      ||area_number.25||
                  |L1.24920|
                          DCD      FORVARDBPSCHHOUR
                  |L1.24924|
                          DCD      NUMIST
                  |L1.24928|
                          DCD      load_U
                  |L1.24932|
                          DCD      U_OUT_KONTR_MAX
                  |L1.24936|
                          DCD      outVoltContrHndlCnt
                  |L1.24940|
                          DCD      outVoltContrHndlCnt_
                  |L1.24944|
                          DCD      U_OUT_KONTR_MIN
                  |L1.24948|
                          DCD      U_OUT_KONTR_DELAY
                  |L1.24952|
                          DCD      uout_av
                  |L1.24956|
                          DCD      USIGN
                  |L1.24960|
                          DCD      bSILENT
                  |L1.24964|
                          DCD      TVENTMAX
                  |L1.24968|
                          DCD      bps
                  |L1.24972|
;;;10052  		}
;;;10053  	else bps[i]._av&=~(1<<4);
00618c  7841              LDRB     r1,[r0,#1]
00618e  f0210110          BIC      r1,r1,#0x10
006192  7041              STRB     r1,[r0,#1]
                  |L1.24980|
006194  f1020201          ADD      r2,r2,#1              ;10004
006198  b2d2              UXTB     r2,r2                 ;10004
                  |L1.24986|
00619a  42ba              CMP      r2,r7                 ;10004
00619c  f6ffaf5a          BLT      |L1.24660|
;;;10054  	}
;;;10055  }
0061a0  e8bd87f0          POP      {r4-r10,pc}
;;;10056  
                          ENDP

                  vent_hndl PROC
;;;10057  //-----------------------------------------------
;;;10058  void vent_hndl(void)
0061a4  e92d4ff0          PUSH     {r4-r11,lr}
;;;10059  {
0061a8  b087              SUB      sp,sp,#0x1c
;;;10060  if(RELEVENTSIGN==rvsAKB)
0061aa  48ab              LDR      r0,|L1.25688|
;;;10061  	{
;;;10062  	if(vent_stat==0)
0061ac  4cab              LDR      r4,|L1.25692|
;;;10063  		{
;;;10064  		if	(
;;;10065  			(BAT_IS_ON[0]==bisON)&&((bat[0]._Tb>TVENTON)||(bat[0]._nd))
0061ae  49ac              LDR      r1,|L1.25696|
;;;10066  			||
;;;10067  			(BAT_IS_ON[1]==bisON)&&((bat[1]._Tb>TVENTON)||(bat[1]._nd))
;;;10068  			)
;;;10069  			{
;;;10070  			vent_stat=1;
;;;10071  			}
;;;10072  		}
;;;10073  	else if(vent_stat==1)
;;;10074  		{
;;;10075  		if	(
;;;10076  			((BAT_IS_ON[0]!=bisON)||((BAT_IS_ON[0]==bisON)&&(bat[0]._Tb<TVENTOFF)&&(!bat[0]._nd)))
0061b0  4aac              LDR      r2,|L1.25700|
0061b2  7800              LDRB     r0,[r0,#0]            ;10060  ; RELEVENTSIGN
0061b4  f9943000          LDRSB    r3,[r4,#0]            ;10062
0061b8  f9b11000          LDRSH    r1,[r1,#0]            ;10065
0061bc  f9b22000          LDRSH    r2,[r2,#0]
0061c0  b148              CBZ      r0,|L1.25046|
;;;10077  			&&
;;;10078  			((BAT_IS_ON[1]!=bisON)||((BAT_IS_ON[1]==bisON)&&(bat[1]._Tb<TVENTOFF)&&(!bat[1]._nd)))
;;;10079  			)
;;;10080  			{
;;;10081  			vent_stat=0;
;;;10082  			}
;;;10083  		}
;;;10084  	}
;;;10085  else if(RELEVENTSIGN==rvsBPS)
0061c2  2802              CMP      r0,#2
0061c4  d03c              BEQ      |L1.25152|
;;;10086  	{
;;;10087  /*	if	(
;;;10088  		(((bps[0]._flags_tm&0x06)||(bps[0]._cnt>=30)))||
;;;10089  		(((bps[1]._flags_tm&0x06)||(bps[1]._cnt>=30))&&(NUMIST>1))||
;;;10090  		(((bps[2]._flags_tm&0x06)||(bps[2]._cnt>=30))&&(NUMIST>2))||
;;;10091  		(((bps[3]._flags_tm&0x06)||(bps[3]._cnt>=30))&&(NUMIST>3))||
;;;10092  		(((bps[4]._flags_tm&0x06)||(bps[4]._cnt>=30))&&(NUMIST>4))||
;;;10093  		(((bps[5]._flags_tm&0x06)||(bps[5]._cnt>=30))&&(NUMIST>5))||
;;;10094  		(((bps[6]._flags_tm&0x06)||(bps[6]._cnt>=30))&&(NUMIST>6))
;;;10095  		)
;;;10096  		{
;;;10097  		vent_stat=1;
;;;10098  		}
;;;10099  	else vent_stat=0;
;;;10100  	*/
;;;10101  
;;;10102  	if	(
;;;10103  		((NUMIST)&&((bps[0]._Ti>TVENTON)||(bps[0]._cnt>=30)))
;;;10104  		||
;;;10105  		((NUMIST>1)&&((bps[1]._Ti>TVENTON)||(bps[1]._cnt>=30)))
;;;10106  		||
;;;10107  		((NUMIST>2)&&((bps[2]._Ti>TVENTON)||(bps[2]._cnt>=30)))
;;;10108  		||
;;;10109  		((NUMIST>3)&&((bps[3]._Ti>TVENTON)||(bps[3]._cnt>=30)))
;;;10110  		||
;;;10111  		((NUMIST>4)&&((bps[4]._Ti>TVENTON)||(bps[4]._cnt>=30)))
;;;10112  		||
;;;10113  		((NUMIST>5)&&((bps[5]._Ti>TVENTON)||(bps[5]._cnt>=30)))
;;;10114  		||
;;;10115  		((NUMIST>6)&&((bps[6]._Ti>TVENTON)||(bps[6]._cnt>=30)))
;;;10116  		||
;;;10117  		((NUMIST>7)&&((bps[7]._Ti>TVENTON)||(bps[7]._cnt>=30)))
;;;10118  		)
;;;10119  		{
;;;10120  		vent_stat=1;
;;;10121  		}
;;;10122  	else if(vent_stat==1)
;;;10123  		{
;;;10124  		if	(
;;;10125  			((!NUMIST)||((NUMIST)&&(bps[0]._Ti<TVENTOFF)&&(bps[0]._cnt<10)))
;;;10126  			&&
;;;10127  			((NUMIST<2)||((NUMIST>=2)&&(bps[1]._Ti<TVENTOFF)&&(bps[1]._cnt<10)))
;;;10128  			&&
;;;10129  			((NUMIST<3)||((NUMIST>=3)&&(bps[2]._Ti<TVENTOFF)&&(bps[2]._cnt<10)))
;;;10130  			&&
;;;10131  			((NUMIST<4)||((NUMIST>=4)&&(bps[3]._Ti<TVENTOFF)&&(bps[3]._cnt<10)))
;;;10132  			&&
;;;10133  			((NUMIST<5)||((NUMIST>=5)&&(bps[4]._Ti<TVENTOFF)&&(bps[4]._cnt<10)))
;;;10134  			&&
;;;10135  			((NUMIST<6)||((NUMIST>=6)&&(bps[5]._Ti<TVENTOFF)&&(bps[5]._cnt<10)))
;;;10136  			&&
;;;10137  			((NUMIST<7)||((NUMIST>=7)&&(bps[6]._Ti<TVENTOFF)&&(bps[6]._cnt<10)))
;;;10138  			&&
;;;10139  			((NUMIST<8)||((NUMIST>=8)&&(bps[7]._Ti<TVENTOFF)&&(bps[7]._cnt<10)))
;;;10140  			)
;;;10141  			{
;;;10142  			vent_stat=0;
;;;10143  			}
;;;10144  		}
;;;10145  	}
;;;10146  else if(RELEVENTSIGN==rvsEXT)
0061c6  2801              CMP      r0,#1
0061c8  d07e              BEQ      |L1.25288|
;;;10147  	{
;;;10148  	if	(
;;;10149  		((NUMDT)&&((t_ext[0]>TVENTON)||(ND_EXT[0])))
;;;10150  		||
;;;10151  		((NUMDT>1)&&((t_ext[1]>TVENTON)||(ND_EXT[1])))
;;;10152  		||
;;;10153  		((NUMDT>2)&&((t_ext[2]>TVENTON)||(ND_EXT[2])))
;;;10154  		)
;;;10155  		{
;;;10156  		vent_stat=1;
;;;10157  		}
;;;10158  	else if(vent_stat==1)
;;;10159  		{
;;;10160  		if	(
;;;10161  			((!NUMDT)||((NUMDT)&&(t_ext[0]<TVENTOFF)&&(!ND_EXT[0])))
;;;10162  			&&
;;;10163  			((NUMDT<2)||((NUMDT>=2)&&(t_ext[1]<TVENTOFF)&&(!ND_EXT[1])))
;;;10164  			&&
;;;10165  			((NUMDT<3)||((NUMDT>=3)&&(t_ext[2]<TVENTOFF)&&(!ND_EXT[2])))
;;;10166  			)
;;;10167  			{
;;;10168  			vent_stat=0;
;;;10169  			}
;;;10170  		}
;;;10171  	}
;;;10172  else vent_stat=1;
0061ca  f04f0001          MOV      r0,#1
0061ce  7020              STRB     r0,[r4,#0]
                  |L1.25040|
;;;10173  }
0061d0  b007              ADD      sp,sp,#0x1c
0061d2  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.25046|
0061d6  4fa4              LDR      r7,|L1.25704|
0061d8  f8df8290          LDR      r8,|L1.25708|
0061dc  f9b7000a          LDRSH    r0,[r7,#0xa]          ;10065
0061e0  7b3d              LDRB     r5,[r7,#0xc]          ;10065
0061e2  f9b76056          LDRSH    r6,[r7,#0x56]         ;10067
0061e6  f898c000          LDRB     r12,[r8,#0]           ;10064
0061ea  f8977058          LDRB     r7,[r7,#0x58]         ;10067
0061ee  f8988001          LDRB     r8,[r8,#1]            ;10067
0061f2  b12b              CBZ      r3,|L1.25088|
0061f4  2b01              CMP      r3,#1                 ;10073
0061f6  d1eb              BNE      |L1.25040|
0061f8  f1bc0f55          CMP      r12,#0x55             ;10075
0061fc  d115              BNE      |L1.25130|
0061fe  e010              B        |L1.25122|
                  |L1.25088|
006200  f1bc0f55          CMP      r12,#0x55             ;10064
006204  d102              BNE      |L1.25100|
006206  4288              CMP      r0,r1                 ;10065
006208  dc07              BGT      |L1.25114|
00620a  b935              CBNZ     r5,|L1.25114|
                  |L1.25100|
00620c  f1b80f55          CMP      r8,#0x55              ;10067
006210  d1de              BNE      |L1.25040|
006212  428e              CMP      r6,r1                 ;10067
006214  dc01              BGT      |L1.25114|
006216  2f00              CMP      r7,#0                 ;10067
006218  d0da              BEQ      |L1.25040|
                  |L1.25114|
00621a  f04f0001          MOV      r0,#1                 ;10070
00621e  7020              STRB     r0,[r4,#0]            ;10070
006220  e7d6              B        |L1.25040|
                  |L1.25122|
006222  4290              CMP      r0,r2                 ;10076
006224  dad4              BGE      |L1.25040|
006226  2d00              CMP      r5,#0                 ;10076
006228  d1d2              BNE      |L1.25040|
                  |L1.25130|
00622a  f1b80f55          CMP      r8,#0x55              ;10078
00622e  d103              BNE      |L1.25144|
006230  4296              CMP      r6,r2                 ;10078
006232  dacd              BGE      |L1.25040|
006234  2f00              CMP      r7,#0                 ;10078
006236  d1cb              BNE      |L1.25040|
                  |L1.25144|
006238  f04f0000          MOV      r0,#0                 ;10081
00623c  7020              STRB     r0,[r4,#0]            ;10081
00623e  e7c7              B        |L1.25040|
                  |L1.25152|
006240  4e8c              LDR      r6,|L1.25716|
006242  488b              LDR      r0,|L1.25712|
006244  6ab5              LDR      r5,[r6,#0x28]         ;10103
006246  f9b00000          LDRSH    r0,[r0,#0]            ;10102  ; NUMIST
00624a  78f6              LDRB     r6,[r6,#3]            ;10103
00624c  b118              CBZ      r0,|L1.25174|
00624e  428d              CMP      r5,r1                 ;10103
006250  dc7a              BGT      |L1.25416|
006252  2e1e              CMP      r6,#0x1e              ;10103
006254  d278              BCS      |L1.25416|
                  |L1.25174|
006256  f8dfc21c          LDR      r12,|L1.25716|
00625a  2801              CMP      r0,#1                 ;10105
00625c  f8dc7084          LDR      r7,[r12,#0x84]        ;10105
006260  f89cc05f          LDRB     r12,[r12,#0x5f]       ;10105
006264  f8cdc018          STR      r12,[sp,#0x18]        ;10105
006268  dd06              BLE      |L1.25208|
00626a  428f              CMP      r7,r1                 ;10105
00626c  dc6c              BGT      |L1.25416|
00626e  f8ddc018          LDR      r12,[sp,#0x18]        ;10105
006272  f1bc0f1e          CMP      r12,#0x1e             ;10105
006276  d267              BCS      |L1.25416|
                  |L1.25208|
006278  f8dfc1f8          LDR      r12,|L1.25716|
00627c  2802              CMP      r0,#2                 ;10107
00627e  f8dc80e0          LDR      r8,[r12,#0xe0]        ;10107
006282  f8cd8014          STR      r8,[sp,#0x14]         ;10107
006286  f89cc0bb          LDRB     r12,[r12,#0xbb]       ;10107
00628a  f8cdc010          STR      r12,[sp,#0x10]        ;10107
00628e  dd08              BLE      |L1.25250|
006290  f8ddc014          LDR      r12,[sp,#0x14]        ;10107
006294  458c              CMP      r12,r1                ;10107
006296  dc57              BGT      |L1.25416|
006298  f8ddc010          LDR      r12,[sp,#0x10]        ;10107
00629c  f1bc0f1e          CMP      r12,#0x1e             ;10107
0062a0  d252              BCS      |L1.25416|
                  |L1.25250|
0062a2  f8dfc1d0          LDR      r12,|L1.25716|
0062a6  2803              CMP      r0,#3                 ;10109
0062a8  f8dc813c          LDR      r8,[r12,#0x13c]       ;10109
0062ac  f8cd800c          STR      r8,[sp,#0xc]          ;10109
0062b0  f89cc117          LDRB     r12,[r12,#0x117]      ;10109
0062b4  f8cdc008          STR      r12,[sp,#8]           ;10109
0062b8  dd0a              BLE      |L1.25296|
0062ba  f8ddc00c          LDR      r12,[sp,#0xc]         ;10109
0062be  458c              CMP      r12,r1                ;10109
0062c0  dc42              BGT      |L1.25416|
0062c2  f8ddc008          LDR      r12,[sp,#8]           ;10109
0062c6  e000              B        |L1.25290|
                  |L1.25288|
0062c8  e080              B        |L1.25548|
                  |L1.25290|
0062ca  f1bc0f1e          CMP      r12,#0x1e             ;10109
0062ce  d23b              BCS      |L1.25416|
                  |L1.25296|
0062d0  f8df81a0          LDR      r8,|L1.25716|
0062d4  2804              CMP      r0,#4                 ;10111
0062d6  f8d8c198          LDR      r12,[r8,#0x198]       ;10111
0062da  f8988173          LDRB     r8,[r8,#0x173]        ;10111
0062de  f8cd8004          STR      r8,[sp,#4]            ;10111
0062e2  dd06              BLE      |L1.25330|
0062e4  458c              CMP      r12,r1                ;10111
0062e6  dc2f              BGT      |L1.25416|
0062e8  f8dd8004          LDR      r8,[sp,#4]            ;10111
0062ec  f1b80f1e          CMP      r8,#0x1e              ;10111
0062f0  d22a              BCS      |L1.25416|
                  |L1.25330|
0062f2  f8df9180          LDR      r9,|L1.25716|
0062f6  2805              CMP      r0,#5                 ;10113
0062f8  f8d981f4          LDR      r8,[r9,#0x1f4]        ;10113
0062fc  f89991cf          LDRB     r9,[r9,#0x1cf]        ;10113
006300  f8cd9000          STR      r9,[sp,#0]            ;10113
006304  dd06              BLE      |L1.25364|
006306  4588              CMP      r8,r1                 ;10113
006308  dc1e              BGT      |L1.25416|
00630a  f8dd9000          LDR      r9,[sp,#0]            ;10113
00630e  f1b90f1e          CMP      r9,#0x1e              ;10113
006312  d219              BCS      |L1.25416|
                  |L1.25364|
006314  f8dfa15c          LDR      r10,|L1.25716|
006318  2806              CMP      r0,#6                 ;10115
00631a  f89ae22b          LDRB     lr,[r10,#0x22b]       ;10115
00631e  f8da9250          LDR      r9,[r10,#0x250]       ;10115
006322  dd04              BLE      |L1.25390|
006324  4589              CMP      r9,r1                 ;10115
006326  dc0f              BGT      |L1.25416|
006328  f1be0f1e          CMP      lr,#0x1e              ;10115
00632c  d20c              BCS      |L1.25416|
                  |L1.25390|
00632e  f8dfb144          LDR      r11,|L1.25716|
006332  2807              CMP      r0,#7                 ;10117
006334  f8dba2ac          LDR      r10,[r11,#0x2ac]      ;10117
006338  f89bb287          LDRB     r11,[r11,#0x287]      ;10117
00633c  dd08              BLE      |L1.25424|
00633e  458a              CMP      r10,r1                ;10117
006340  dc02              BGT      |L1.25416|
006342  f1bb0f1e          CMP      r11,#0x1e             ;10117
006346  d303              BCC      |L1.25424|
                  |L1.25416|
006348  f04f0001          MOV      r0,#1                 ;10120
00634c  7020              STRB     r0,[r4,#0]            ;10120
                  |L1.25422|
00634e  e73f              B        |L1.25040|
                  |L1.25424|
006350  2b01              CMP      r3,#1                 ;10122
006352  d1fc              BNE      |L1.25422|
006354  b118              CBZ      r0,|L1.25438|
006356  4295              CMP      r5,r2                 ;10125
006358  daf9              BGE      |L1.25422|
00635a  2e0a              CMP      r6,#0xa               ;10125
00635c  d2f7              BCS      |L1.25422|
                  |L1.25438|
00635e  2802              CMP      r0,#2                 ;10127
006360  db04              BLT      |L1.25452|
006362  4297              CMP      r7,r2                 ;10127
006364  daf3              BGE      |L1.25422|
006366  9906              LDR      r1,[sp,#0x18]         ;10127
006368  290a              CMP      r1,#0xa               ;10127
00636a  d2f0              BCS      |L1.25422|
                  |L1.25452|
00636c  2803              CMP      r0,#3                 ;10129
00636e  db05              BLT      |L1.25468|
006370  9905              LDR      r1,[sp,#0x14]         ;10129
006372  4291              CMP      r1,r2                 ;10129
006374  daeb              BGE      |L1.25422|
006376  9904              LDR      r1,[sp,#0x10]         ;10129
006378  290a              CMP      r1,#0xa               ;10129
00637a  d2e8              BCS      |L1.25422|
                  |L1.25468|
00637c  2804              CMP      r0,#4                 ;10131
00637e  db05              BLT      |L1.25484|
006380  9903              LDR      r1,[sp,#0xc]          ;10131
006382  4291              CMP      r1,r2                 ;10131
006384  dae3              BGE      |L1.25422|
006386  9902              LDR      r1,[sp,#8]            ;10131
006388  290a              CMP      r1,#0xa               ;10131
00638a  d2e0              BCS      |L1.25422|
                  |L1.25484|
00638c  2805              CMP      r0,#5                 ;10133
00638e  db04              BLT      |L1.25498|
006390  4594              CMP      r12,r2                ;10133
006392  dadc              BGE      |L1.25422|
006394  9901              LDR      r1,[sp,#4]            ;10133
006396  290a              CMP      r1,#0xa               ;10133
006398  d2d9              BCS      |L1.25422|
                  |L1.25498|
00639a  2806              CMP      r0,#6                 ;10135
00639c  db04              BLT      |L1.25512|
00639e  4590              CMP      r8,r2                 ;10135
0063a0  dad5              BGE      |L1.25422|
0063a2  9900              LDR      r1,[sp,#0]            ;10135
0063a4  290a              CMP      r1,#0xa               ;10135
0063a6  d2d2              BCS      |L1.25422|
                  |L1.25512|
0063a8  2807              CMP      r0,#7                 ;10137
0063aa  db04              BLT      |L1.25526|
0063ac  4591              CMP      r9,r2                 ;10137
0063ae  dace              BGE      |L1.25422|
0063b0  f1be0f0a          CMP      lr,#0xa               ;10137
0063b4  d2cb              BCS      |L1.25422|
                  |L1.25526|
0063b6  2808              CMP      r0,#8                 ;10139
0063b8  db04              BLT      |L1.25540|
0063ba  4592              CMP      r10,r2                ;10139
0063bc  dac7              BGE      |L1.25422|
0063be  f1bb0f0a          CMP      r11,#0xa              ;10139
0063c2  d2c4              BCS      |L1.25422|
                  |L1.25540|
0063c4  f04f0000          MOV      r0,#0                 ;10142
0063c8  7020              STRB     r0,[r4,#0]            ;10142
                  |L1.25546|
0063ca  e701              B        |L1.25040|
                  |L1.25548|
0063cc  482a              LDR      r0,|L1.25720|
0063ce  4d2b              LDR      r5,|L1.25724|
0063d0  4e2b              LDR      r6,|L1.25728|
0063d2  f9b00000          LDRSH    r0,[r0,#0]            ;10148  ; NUMDT
0063d6  f9b55000          LDRSH    r5,[r5,#0]            ;10149
0063da  7836              LDRB     r6,[r6,#0]            ;10149
0063dc  b110              CBZ      r0,|L1.25572|
0063de  428d              CMP      r5,r1                 ;10149
0063e0  dc1d              BGT      |L1.25630|
0063e2  b9e6              CBNZ     r6,|L1.25630|
                  |L1.25572|
0063e4  4f25              LDR      r7,|L1.25724|
0063e6  f8dfc098          LDR      r12,|L1.25728|
0063ea  2801              CMP      r0,#1                 ;10151
0063ec  f9b77002          LDRSH    r7,[r7,#2]            ;10151
0063f0  f89cc001          LDRB     r12,[r12,#1]          ;10151
0063f4  dd04              BLE      |L1.25600|
0063f6  428f              CMP      r7,r1                 ;10151
0063f8  dc11              BGT      |L1.25630|
0063fa  f1bc0f00          CMP      r12,#0                ;10151
0063fe  d10e              BNE      |L1.25630|
                  |L1.25600|
006400  f8df8078          LDR      r8,|L1.25724|
006404  f8df9078          LDR      r9,|L1.25728|
006408  2802              CMP      r0,#2                 ;10153
00640a  f9b88004          LDRSH    r8,[r8,#4]            ;10153
00640e  f8999002          LDRB     r9,[r9,#2]            ;10153
006412  dd08              BLE      |L1.25638|
006414  4588              CMP      r8,r1                 ;10153
006416  dc02              BGT      |L1.25630|
006418  f1b90f00          CMP      r9,#0                 ;10153
00641c  d003              BEQ      |L1.25638|
                  |L1.25630|
00641e  f04f0001          MOV      r0,#1                 ;10156
006422  7020              STRB     r0,[r4,#0]            ;10156
006424  e6d4              B        |L1.25040|
                  |L1.25638|
006426  2b01              CMP      r3,#1                 ;10158
006428  d191              BNE      |L1.25422|
00642a  b118              CBZ      r0,|L1.25652|
00642c  4295              CMP      r5,r2                 ;10161
00642e  da8e              BGE      |L1.25422|
006430  2e00              CMP      r6,#0                 ;10161
006432  d18c              BNE      |L1.25422|
                  |L1.25652|
006434  2802              CMP      r0,#2                 ;10163
006436  db04              BLT      |L1.25666|
006438  4297              CMP      r7,r2                 ;10163
00643a  da88              BGE      |L1.25422|
00643c  f1bc0f00          CMP      r12,#0                ;10163
006440  d185              BNE      |L1.25422|
                  |L1.25666|
006442  2803              CMP      r0,#3                 ;10165
006444  db04              BLT      |L1.25680|
006446  4590              CMP      r8,r2                 ;10165
006448  dabf              BGE      |L1.25546|
00644a  f1b90f00          CMP      r9,#0                 ;10165
00644e  d1bc              BNE      |L1.25546|
                  |L1.25680|
006450  f04f0000          MOV      r0,#0                 ;10168
006454  7020              STRB     r0,[r4,#0]            ;10168
006456  e6bb              B        |L1.25040|
;;;10174  
                          ENDP

                  |L1.25688|
                          DCD      RELEVENTSIGN
                  |L1.25692|
                          DCD      ||area_number.25||
                  |L1.25696|
                          DCD      TVENTON
                  |L1.25700|
                          DCD      TVENTOFF
                  |L1.25704|
                          DCD      bat
                  |L1.25708|
                          DCD      BAT_IS_ON
                  |L1.25712|
                          DCD      NUMIST
                  |L1.25716|
                          DCD      bps
                  |L1.25720|
                          DCD      NUMDT
                  |L1.25724|
                          DCD      t_ext
                  |L1.25728|
                          DCD      ND_EXT

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  samokalibr_init PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  4902              LDR      r1,|L2.12|
;;;297    {          
000002  f24060f9          MOV      r0,#0x6f9
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  f8a1004a          STRH     r0,[r1,#0x4a]
00000a  4770              BX       lr
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
;;;315    
;;;316    	spc_stat=spcKE;
;;;317    	__ee_spc_stat=spcKE;
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
;;;319    	
;;;320    	spc_bat=0;
;;;321    	__ee_spc_bat=0;
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
;;;329    
;;;330    	
;;;331    	spc_phase=0;
;;;332    	__ee_spc_phase=0;
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
;;;343    		gran_char(&temp,1,99);
;;;344    		*((char*)(&(ke_date[0])))=temp;
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
;;;347    		gran_char(&temp,1,12);
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
;;;351    		gran_char(&temp,1,31);
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
;;;358    		gran_char(&temp,0,23);
;;;359    		*((char*)(&(ke_date[1])))=temp;
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
;;;362    		gran_char(&temp,0,59);
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
;;;366    		gran_char(&temp,0,59);
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
;;;373    	}
;;;374    }
;;;375    #endif
                          ENDP

                  |L2.12|
                          DCD      ||area_number.25||

                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  adc_drv6 PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;297    {          
000004  4c80              LDR      r4,|L3.520|
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000008  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00000a  1a40              SUBS     r0,r0,r1
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000c  b200              SXTH     r0,r0
00000e  f7fffffe          BL       abs_pal
;;;315    
;;;316    	spc_stat=spcKE;
000012  1da5              ADDS     r5,r4,#6
000014  8028              STRH     r0,[r5,#0]
000016  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
;;;317    	__ee_spc_stat=spcKE;
000018  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00001a  1a40              SUBS     r0,r0,r1
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001c  b200              SXTH     r0,r0
00001e  f7fffffe          BL       abs_pal
000022  8068              STRH     r0,[r5,#2]
000024  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
;;;319    	
;;;320    	spc_bat=0;
000026  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
;;;321    	__ee_spc_bat=0;
000028  1a40              SUBS     r0,r0,r1
00002a  b200              SXTH     r0,r0
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  f7fffffe          BL       abs_pal
000030  80a8              STRH     r0,[r5,#4]
000032  f44f7196          MOV      r1,#0x12c
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000036  f1a406ea          SUB      r6,r4,#0xea
00003a  4288              CMP      r0,r1
00003c  da02              BGE      |L3.68|
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
00003e  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000040  86f0              STRH     r0,[r6,#0x36]
000042  e00c              B        |L3.94|
                  |L3.68|
000044  f9b50002          LDRSH    r0,[r5,#2]  ; adc_self_ch_disp
000048  4288              CMP      r0,r1
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004a  da02              BGE      |L3.82|
00004c  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
00004e  86f0              STRH     r0,[r6,#0x36]
000050  e005              B        |L3.94|
                  |L3.82|
000052  f9b50000          LDRSH    r0,[r5,#0]  ; adc_self_ch_disp
000056  4288              CMP      r0,r1
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  da01              BGE      |L3.94|
;;;332    	__ee_spc_phase=0;
00005a  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
00005c  86f0              STRH     r0,[r6,#0x36]
                  |L3.94|
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  7a77              LDRB     r7,[r6,#9]  ; adc_ch_net
000060  2200              MOVS     r2,#0
000062  b3f7              CBZ      r7,|L3.226|
000064  7b33              LDRB     r3,[r6,#0xc]  ; adc_window_flag
000066  4869              LDR      r0,|L3.524|
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000068  b18b              CBZ      r3,|L3.142|
00006a  f9b61036          LDRSH    r1,[r6,#0x36]  ; adc_result
00006e  6804              LDR      r4,[r0,#0]  ; main_power_buffer
000070  eb0404a1          ADD      r4,r4,r1,ASR #2
000074  6004              STR      r4,[r0,#0]  ; main_power_buffer
000076  6844              LDR      r4,[r0,#4]  ; main_power_buffer
000078  eb0404a1          ADD      r4,r4,r1,ASR #2
00007c  6044              STR      r4,[r0,#4]  ; main_power_buffer
00007e  6884              LDR      r4,[r0,#8]  ; main_power_buffer
000080  eb0404a1          ADD      r4,r4,r1,ASR #2
000084  6084              STR      r4,[r0,#8]  ; main_power_buffer
000086  68c4              LDR      r4,[r0,#0xc]  ; main_power_buffer
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  eb0401a1          ADD      r1,r4,r1,ASR #2
00008c  60c1              STR      r1,[r0,#0xc]  ; main_power_buffer
                  |L3.142|
;;;343    		gran_char(&temp,1,99);
00008e  f9b61036          LDRSH    r1,[r6,#0x36]  ; adc_result
000092  2964              CMP      r1,#0x64
000094  da04              BGE      |L3.160|
000096  8f71              LDRH     r1,[r6,#0x3a]  ; adc_zero_cnt
000098  f1010101          ADD      r1,r1,#1
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  8771              STRH     r1,[r6,#0x3a]
00009e  e000              B        |L3.162|
                  |L3.160|
0000a0  8772              STRH     r2,[r6,#0x3a]
                  |L3.162|
0000a2  f9b6403a          LDRSH    r4,[r6,#0x3a]  ; adc_zero_cnt
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  f44f61fa          MOV      r1,#0x7d0
;;;347    		gran_char(&temp,1,12);
0000aa  428c              CMP      r4,r1
0000ac  db05              BLT      |L3.186|
0000ae  8771              STRH     r1,[r6,#0x3a]
0000b0  6002              STR      r2,[r0,#0]  ; main_power_buffer
0000b2  6042              STR      r2,[r0,#4]  ; main_power_buffer
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  6082              STR      r2,[r0,#8]  ; main_power_buffer
0000b6  60c2              STR      r2,[r0,#0xc]  ; main_power_buffer
0000b8  86b2              STRH     r2,[r6,#0x34]
                  |L3.186|
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000ba  8f71              LDRH     r1,[r6,#0x3a]  ; adc_zero_cnt
0000bc  2905              CMP      r1,#5
;;;351    		gran_char(&temp,1,31);
0000be  d14f              BNE      |L3.352|
0000c0  b1bb              CBZ      r3,|L3.242|
0000c2  8f31              LDRH     r1,[r6,#0x38]  ; adc_gorb_cnt
0000c4  f1010101          ADD      r1,r1,#1
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000c8  b209              SXTH     r1,r1
0000ca  8731              STRH     r1,[r6,#0x38]
0000cc  f5b17f00          CMP      r1,#0x200
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000d0  db00              BLT      |L3.212|
0000d2  8732              STRH     r2,[r6,#0x38]
                  |L3.212|
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d4  f9b61038          LDRSH    r1,[r6,#0x38]  ; adc_gorb_cnt
0000d8  064c              LSLS     r4,r1,#25
0000da  d10a              BNE      |L3.242|
0000dc  ea4f11e1          ASR      r1,r1,#7
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000e0  e000              B        |L3.228|
                  |L3.226|
;;;358    		gran_char(&temp,0,23);
0000e2  e015              B        |L3.272|
                  |L3.228|
0000e4  f8504021          LDR      r4,[r0,r1,LSL #2]
0000e8  ea4f2424          ASR      r4,r4,#8
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ec  86b4              STRH     r4,[r6,#0x34]
0000ee  f8402021          STR      r2,[r0,r1,LSL #2]
                  |L3.242|
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f2  f9b6003c          LDRSH    r0,[r6,#0x3c]  ; adc_window_cnt
;;;362    		gran_char(&temp,0,59);
0000f6  2896              CMP      r0,#0x96
0000f8  dd01              BLE      |L3.254|
0000fa  b103              CBZ      r3,|L3.254|
0000fc  7332              STRB     r2,[r6,#0xc]
                  |L3.254|
0000fe  381f              SUBS     r0,r0,#0x1f
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  2827              CMP      r0,#0x27
000102  d22d              BCS      |L3.352|
000104  7b30              LDRB     r0,[r6,#0xc]  ; adc_window_flag
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  bb58              CBNZ     r0,|L3.352|
000108  f04f0001          MOV      r0,#1
;;;366    		gran_char(&temp,0,59);
00010c  7330              STRB     r0,[r6,#0xc]
00010e  e027              B        |L3.352|
                  |L3.272|
000110  483f              LDR      r0,|L3.528|
000112  7ab5              LDRB     r5,[r6,#0xa]  ; adc_ch
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  7af3              LDRB     r3,[r6,#0xb]  ; adc_ch_cnt
000116  eb001485          ADD      r4,r0,r5,LSL #6
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011a  f9b61036          LDRSH    r1,[r6,#0x36]  ; adc_result
00011e  f8441023          STR      r1,[r4,r3,LSL #2]
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000122  0798              LSLS     r0,r3,#30
000124  d10f              BNE      |L3.326|
000126  4601              MOV      r1,r0
                  |L3.296|
000128  f854c020          LDR      r12,[r4,r0,LSL #2]
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
;;;373    	}
;;;374    }
00012c  4461              ADD      r1,r1,r12
00012e  f1000001          ADD      r0,r0,#1
000132  b2c0              UXTB     r0,r0
000134  2810              CMP      r0,#0x10
000136  d3f7              BCC      |L3.296|
000138  ea4f1021          ASR      r0,r1,#4
00013c  4933              LDR      r1,|L3.524|
00013e  f1a10120          SUB      r1,r1,#0x20
000142  f8210015          STRH     r0,[r1,r5,LSL #1]
                  |L3.326|
000146  1c6d              ADDS     r5,r5,#1
000148  b2e8              UXTB     r0,r5
00014a  72b0              STRB     r0,[r6,#0xa]
00014c  2810              CMP      r0,#0x10
00014e  d307              BCC      |L3.352|
000150  72b2              STRB     r2,[r6,#0xa]
000152  f1030301          ADD      r3,r3,#1
000156  b2d8              UXTB     r0,r3
000158  72f0              STRB     r0,[r6,#0xb]
00015a  2810              CMP      r0,#0x10
00015c  d300              BCC      |L3.352|
00015e  72f2              STRB     r2,[r6,#0xb]
                  |L3.352|
000160  7232              STRB     r2,[r6,#8]
000162  f1070701          ADD      r7,r7,#1
000166  f0070001          AND      r0,r7,#1
00016a  7270              STRB     r0,[r6,#9]
00016c  4a29              LDR      r2,|L3.532|
00016e  b130              CBZ      r0,|L3.382|
000170  6810              LDR      r0,[r2,#0]
000172  f02000ff          BIC      r0,r0,#0xff
000176  f1000004          ADD      r0,r0,#4
00017a  6010              STR      r0,[r2,#0]
00017c  e03d              B        |L3.506|
                  |L3.382|
00017e  7ab1              LDRB     r1,[r6,#0xa]  ; adc_ch
000180  0708              LSLS     r0,r1,#28
000182  d406              BMI      |L3.402|
000184  6810              LDR      r0,[r2,#0]
000186  f02000ff          BIC      r0,r0,#0xff
00018a  f1000001          ADD      r0,r0,#1
00018e  6010              STR      r0,[r2,#0]
000190  e005              B        |L3.414|
                  |L3.402|
000192  6810              LDR      r0,[r2,#0]
000194  f02000ff          BIC      r0,r0,#0xff
000198  f1000002          ADD      r0,r0,#2
00019c  6010              STR      r0,[r2,#0]
                  |L3.414|
00019e  481e              LDR      r0,|L3.536|
0001a0  6803              LDR      r3,[r0,#0]
0001a2  f0435380          ORR      r3,r3,#0x10000000
0001a6  6003              STR      r3,[r0,#0]
0001a8  6a03              LDR      r3,[r0,#0x20]
0001aa  f0434380          ORR      r3,r3,#0x40000000
0001ae  6203              STR      r3,[r0,#0x20]
0001b0  6e03              LDR      r3,[r0,#0x60]
0001b2  f0436380          ORR      r3,r3,#0x4000000
0001b6  6603              STR      r3,[r0,#0x60]
0001b8  07cb              LSLS     r3,r1,#31
0001ba  d00a              BEQ      |L3.466|
0001bc  6943              LDR      r3,[r0,#0x14]
0001be  f0435380          ORR      r3,r3,#0x10000000
0001c2  6143              STR      r3,[r0,#0x14]
                  |L3.452|
0001c4  078b              LSLS     r3,r1,#30
0001c6  d409              BMI      |L3.476|
0001c8  6b43              LDR      r3,[r0,#0x34]
0001ca  f0234380          BIC      r3,r3,#0x40000000
0001ce  6343              STR      r3,[r0,#0x34]
0001d0  e008              B        |L3.484|
                  |L3.466|
0001d2  6943              LDR      r3,[r0,#0x14]
0001d4  f0235380          BIC      r3,r3,#0x10000000
0001d8  6143              STR      r3,[r0,#0x14]
0001da  e7f3              B        |L3.452|
                  |L3.476|
0001dc  6b43              LDR      r3,[r0,#0x34]
0001de  f0434380          ORR      r3,r3,#0x40000000
0001e2  6343              STR      r3,[r0,#0x34]
                  |L3.484|
0001e4  0749              LSLS     r1,r1,#29
0001e6  d404              BMI      |L3.498|
0001e8  6f41              LDR      r1,[r0,#0x74]
0001ea  f0216180          BIC      r1,r1,#0x4000000
0001ee  6741              STR      r1,[r0,#0x74]
0001f0  e003              B        |L3.506|
                  |L3.498|
0001f2  6f41              LDR      r1,[r0,#0x74]
0001f4  f0416180          ORR      r1,r1,#0x4000000
0001f8  6741              STR      r1,[r0,#0x74]
                  |L3.506|
0001fa  6810              LDR      r0,[r2,#0]
0001fc  f0407080          ORR      r0,r0,#0x1000000
000200  6010              STR      r0,[r2,#0]
000202  e8bd81f0          POP      {r4-r8,pc}
;;;375    #endif
                          ENDP

000206  0000              DCW      0x0000
                  |L3.520|
                          DCD      ||area_number.25||+0xea
                  |L3.524|
                          DCD      ||.bss||+0x42c
                  |L3.528|
                          DCD      ||.bss||+0xc
                  |L3.532|
                          DCD      0x40034000
                  |L3.536|
                          DCD      0x2009c000

                          AREA ||area_number.4||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.text||
                  ips_current_average_hndl_ PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  e92d43f0          PUSH     {r4-r9,lr}
;;;297    {          
000004  b085              SUB      sp,sp,#0x14
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  4c64              LDR      r4,|L4.408|
000008  4e64              LDR      r6,|L4.412|
00000a  2500              MOVS     r5,#0
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000c  7820              LDRB     r0,[r4,#0]  ; ica_timer_cnt
00000e  1c40              ADDS     r0,r0,#1
000010  b2c0              UXTB     r0,r0
;;;315    
;;;316    	spc_stat=spcKE;
000012  7020              STRB     r0,[r4,#0]
000014  280a              CMP      r0,#0xa
000016  d340              BCC      |L4.154|
;;;317    	__ee_spc_stat=spcKE;
000018  7025              STRB     r5,[r4,#0]
00001a  f8dfc184          LDR      r12,|L4.416|
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001e  f89c0000          LDRB     r0,[r12,#0]  ; ica_plazma
000022  f1000001          ADD      r0,r0,#1
;;;319    	
;;;320    	spc_bat=0;
000026  f88c0000          STRB     r0,[r12,#0]
;;;321    	__ee_spc_bat=0;
00002a  485e              LDR      r0,|L4.420|
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  495e              LDR      r1,|L4.424|
00002e  f9b00000          LDRSH    r0,[r0,#0]  ; bps_I
000032  8008              STRH     r0,[r1,#0]
000034  495d              LDR      r1,|L4.428|
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000036  f8df8178          LDR      r8,|L4.432|
00003a  4662              MOV      r2,r12
00003c  4637              MOV      r7,r6
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
00003e  f9b11000          LDRSH    r1,[r1,#0]  ; ica_your_current
000042  7852              LDRB     r2,[r2,#1]
000044  f9b83000          LDRSH    r3,[r8,#0]
000048  f9b77000          LDRSH    r7,[r7,#0]
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004c  4288              CMP      r0,r1
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
00004e  dd06              BLE      |L4.94|
000050  eba00901          SUB      r9,r0,r1
000054  f1b90f0a          CMP      r9,#0xa
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  db01              BLT      |L4.94|
;;;332    	__ee_spc_phase=0;
00005a  2f01              CMP      r7,#1
00005c  d007              BEQ      |L4.110|
                  |L4.94|
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  4288              CMP      r0,r1
000060  da16              BGE      |L4.144|
000062  1a08              SUBS     r0,r1,r0
000064  280a              CMP      r0,#0xa
000066  db13              BLT      |L4.144|
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000068  2f01              CMP      r7,#1
00006a  d009              BEQ      |L4.128|
00006c  e010              B        |L4.144|
                  |L4.110|
00006e  f1020201          ADD      r2,r2,#1
000072  f88c2001          STRB     r2,[r12,#1]
000076  f1a30301          SUB      r3,r3,#1
00007a  f8a83000          STRH     r3,[r8,#0]
00007e  e007              B        |L4.144|
                  |L4.128|
000080  f1a20201          SUB      r2,r2,#1
000084  f88c2001          STRB     r2,[r12,#1]
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  f1030301          ADD      r3,r3,#1
00008c  f8a83000          STRH     r3,[r8,#0]
                  |L4.144|
;;;343    		gran_char(&temp,1,99);
000090  2214              MOVS     r2,#0x14
000092  4251              RSBS     r1,r2,#0
000094  4846              LDR      r0,|L4.432|
000096  f7fffffe          BL       gran
                  |L4.154|
00009a  7820              LDRB     r0,[r4,#0]  ; ica_timer_cnt
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  f8df8114          LDR      r8,|L4.436|
0000a0  4f45              LDR      r7,|L4.440|
0000a2  2808              CMP      r0,#8
0000a4  d125              BNE      |L4.242|
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  8830              LDRH     r0,[r6,#0]  ; ICA_EN
0000a8  2801              CMP      r0,#1
;;;347    		gran_char(&temp,1,12);
0000aa  d122              BNE      |L4.242|
0000ac  f8b80000          LDRH     r0,[r8,#0]  ; ICA_MODBUS_ADDRESS
0000b0  f88d0000          STRB     r0,[sp,#0]
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  f04f0004          MOV      r0,#4
0000b8  f88d0001          STRB     r0,[sp,#1]
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000bc  f88d5002          STRB     r5,[sp,#2]
;;;351    		gran_char(&temp,1,31);
0000c0  f04f0002          MOV      r0,#2
0000c4  f88d0003          STRB     r0,[sp,#3]
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000c8  f88d5004          STRB     r5,[sp,#4]
0000cc  f04f0001          MOV      r0,#1
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000d0  f88d0005          STRB     r0,[sp,#5]
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d4  f04f0106          MOV      r1,#6
0000d8  4668              MOV      r0,sp
0000da  f7fffffe          BL       CRC16_2
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000de  f88d0006          STRB     r0,[sp,#6]
;;;358    		gran_char(&temp,0,23);
0000e2  ea4f2020          ASR      r0,r0,#8
0000e6  f88d0007          STRB     r0,[sp,#7]
0000ea  f9b70000          LDRSH    r0,[r7,#0]  ; ICA_CH
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ee  b3e8              CBZ      r0,|L4.364|
0000f0  2801              CMP      r0,#1
                  |L4.242|
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f2  4832              LDR      r0,|L4.444|
0000f4  f06f0214          MVN      r2,#0x14
;;;362    		gran_char(&temp,0,59);
0000f8  f9b00000          LDRSH    r0,[r0,#0]  ; TBAT
0000fc  ebc01100          RSB      r1,r0,r0,LSL #4
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  eb020181          ADD      r1,r2,r1,LSL #2
000104  4a2e              LDR      r2,|L4.448|
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  f9b2204c          LDRSH    r2,[r2,#0x4c]  ; main_kb_cnt
;;;366    		gran_char(&temp,0,59);
00010a  4291              CMP      r1,r2
00010c  d134              BNE      |L4.376|
00010e  8831              LDRH     r1,[r6,#0]  ; ICA_EN
000110  2901              CMP      r1,#1
000112  d131              BNE      |L4.376|
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  f8b81000          LDRH     r1,[r8,#0]  ; ICA_MODBUS_ADDRESS
000118  f88d1000          STRB     r1,[sp,#0]
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011c  f04f0106          MOV      r1,#6
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000120  f88d1001          STRB     r1,[sp,#1]
000124  f88d5002          STRB     r5,[sp,#2]
000128  f04f011e          MOV      r1,#0x1e
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
;;;373    	}
;;;374    }
00012c  f88d1003          STRB     r1,[sp,#3]
000130  ea4f71e0          ASR      r1,r0,#31
000134  eb006111          ADD      r1,r0,r1,LSR #24
000138  ea4f2221          ASR      r2,r1,#8
00013c  f88d2004          STRB     r2,[sp,#4]
000140  f88d0005          STRB     r0,[sp,#5]
000144  f04f0106          MOV      r1,#6
000148  4668              MOV      r0,sp
00014a  f7fffffe          BL       CRC16_2
00014e  f88d0006          STRB     r0,[sp,#6]
000152  ea4f2020          ASR      r0,r0,#8
000156  f88d0007          STRB     r0,[sp,#7]
00015a  8838              LDRH     r0,[r7,#0]  ; ICA_CH
00015c  2800              CMP      r0,#0
00015e  d10b              BNE      |L4.376|
000160  4604              MOV      r4,r0
000162  466d              MOV      r5,sp
                  |L4.356|
000164  5d28              LDRB     r0,[r5,r4]
000166  f7fffffe          BL       putchar_sc16is700
00016a  e000              B        |L4.366|
                  |L4.364|
00016c  e007              B        |L4.382|
                  |L4.366|
00016e  f1040401          ADD      r4,r4,#1
000172  b2e4              UXTB     r4,r4
000174  2c08              CMP      r4,#8
000176  d3f5              BCC      |L4.356|
                  |L4.376|
000178  b005              ADD      sp,sp,#0x14
00017a  e8bd83f0          POP      {r4-r9,pc}
                  |L4.382|
00017e  f04f0400          MOV      r4,#0
000182  46e9              MOV      r9,sp
                  |L4.388|
000184  f8190004          LDRB     r0,[r9,r4]
000188  f7fffffe          BL       putchar_sc16is700
00018c  f1040401          ADD      r4,r4,#1
000190  b2e4              UXTB     r4,r4
000192  2c08              CMP      r4,#8
000194  d3f6              BCC      |L4.388|
000196  e7ac              B        |L4.242|
;;;375    #endif
                          ENDP

                  |L4.408|
                          DCD      ica_timer_cnt
                  |L4.412|
                          DCD      ICA_EN
                  |L4.416|
                          DCD      ica_plazma
                  |L4.420|
                          DCD      bps_I
                  |L4.424|
                          DCD      ica_my_current
                  |L4.428|
                          DCD      ica_your_current
                  |L4.432|
                          DCD      ica_u_necc
                  |L4.436|
                          DCD      ICA_MODBUS_ADDRESS
                  |L4.440|
                          DCD      ICA_CH
                  |L4.444|
                          DCD      TBAT
                  |L4.448|
                          DCD      ||area_number.25||

                          AREA ||area_number.5||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.text||
                  inv_drv PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  b570              PUSH     {r4-r6,lr}
;;;297    {          
000002  4604              MOV      r4,r0
000004  f04f0207          MOV      r2,#7
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000008  f04f0101          MOV      r1,#1
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000c  48a4              LDR      r0,|L5.672|
00000e  f7fffffe          BL       gran_char
;;;315    
;;;316    	spc_stat=spcKE;
000012  48a4              LDR      r0,|L5.676|
000014  eb040144          ADD      r1,r4,r4,LSL #1
;;;317    	__ee_spc_stat=spcKE;
000018  eb001541          ADD      r5,r0,r1,LSL #5
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001c  f8950047          LDRB     r0,[r5,#0x47]
000020  f8951046          LDRB     r1,[r5,#0x46]
000024  ea800001          EOR      r0,r0,r1
;;;319    	
;;;320    	spc_bat=0;
;;;321    	__ee_spc_bat=0;
000028  4a9f              LDR      r2,|L5.680|
00002a  b100              CBZ      r0,|L5.46|
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  7050              STRB     r0,[r2,#1]
                  |L5.46|
00002e  ea010100          AND      r1,r1,r0
000032  b101              CBZ      r1,|L5.54|
000034  7091              STRB     r1,[r2,#2]
                  |L5.54|
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000036  ea000301          AND      r3,r0,r1
00003a  07db              LSLS     r3,r3,#31
00003c  d027              BEQ      |L5.142|
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
00003e  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
000040  f1000001          ADD      r0,r0,#1
000044  70d0              STRB     r0,[r2,#3]
000046  b134              CBZ      r4,|L5.86|
000048  2c01              CMP      r4,#1
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004a  d00b              BEQ      |L5.100|
00004c  2c02              CMP      r4,#2
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
00004e  d010              BEQ      |L5.114|
000050  2c03              CMP      r4,#3
000052  d015              BEQ      |L5.128|
000054  e120              B        |L5.664|
                  |L5.86|
000056  2301              MOVS     r3,#1
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  461a              MOV      r2,r3
;;;332    	__ee_spc_phase=0;
00005a  210e              MOVS     r1,#0xe
00005c  a093              ADR      r0,|L5.684|
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  f7fffffe          BL       snmp_trap_send
000062  e119              B        |L5.664|
                  |L5.100|
000064  2301              MOVS     r3,#1
000066  2202              MOVS     r2,#2
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000068  210e              MOVS     r1,#0xe
00006a  a097              ADR      r0,|L5.712|
00006c  f7fffffe          BL       snmp_trap_send
000070  e112              B        |L5.664|
                  |L5.114|
000072  2301              MOVS     r3,#1
000074  2203              MOVS     r2,#3
000076  210e              MOVS     r1,#0xe
000078  a09a              ADR      r0,|L5.740|
00007a  f7fffffe          BL       snmp_trap_send
00007e  e10b              B        |L5.664|
                  |L5.128|
000080  2301              MOVS     r3,#1
000082  2204              MOVS     r2,#4
000084  210e              MOVS     r1,#0xe
000086  a09e              ADR      r0,|L5.768|
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  f7fffffe          BL       snmp_trap_send
00008c  e104              B        |L5.664|
                  |L5.142|
;;;343    		gran_char(&temp,1,99);
00008e  0783              LSLS     r3,r0,#30
000090  d529              BPL      |L5.230|
000092  078b              LSLS     r3,r1,#30
000094  d527              BPL      |L5.230|
000096  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
000098  f1000001          ADD      r0,r0,#1
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  70d0              STRB     r0,[r2,#3]
00009e  b134              CBZ      r4,|L5.174|
0000a0  2c01              CMP      r4,#1
0000a2  d00b              BEQ      |L5.188|
0000a4  2c02              CMP      r4,#2
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  d010              BEQ      |L5.202|
0000a8  2c03              CMP      r4,#3
;;;347    		gran_char(&temp,1,12);
0000aa  d015              BEQ      |L5.216|
0000ac  e0f4              B        |L5.664|
                  |L5.174|
0000ae  2302              MOVS     r3,#2
0000b0  2201              MOVS     r2,#1
0000b2  210e              MOVS     r1,#0xe
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  a099              ADR      r0,|L5.796|
0000b6  f7fffffe          BL       snmp_trap_send
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000ba  e0ed              B        |L5.664|
                  |L5.188|
0000bc  2302              MOVS     r3,#2
;;;351    		gran_char(&temp,1,31);
0000be  461a              MOV      r2,r3
0000c0  210e              MOVS     r1,#0xe
0000c2  a09d              ADR      r0,|L5.824|
0000c4  f7fffffe          BL       snmp_trap_send
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000c8  e0e6              B        |L5.664|
                  |L5.202|
0000ca  2302              MOVS     r3,#2
0000cc  2203              MOVS     r2,#3
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000ce  210e              MOVS     r1,#0xe
0000d0  a0a0              ADR      r0,|L5.852|
0000d2  f7fffffe          BL       snmp_trap_send
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d6  e0df              B        |L5.664|
                  |L5.216|
0000d8  2302              MOVS     r3,#2
0000da  2204              MOVS     r2,#4
0000dc  210e              MOVS     r1,#0xe
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000de  a0a4              ADR      r0,|L5.880|
0000e0  f7fffffe          BL       snmp_trap_send
;;;358    		gran_char(&temp,0,23);
0000e4  e0d8              B        |L5.664|
                  |L5.230|
0000e6  0743              LSLS     r3,r0,#29
0000e8  d529              BPL      |L5.318|
0000ea  074b              LSLS     r3,r1,#29
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ec  d527              BPL      |L5.318|
0000ee  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0000f0  f1000001          ADD      r0,r0,#1
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f4  70d0              STRB     r0,[r2,#3]
;;;362    		gran_char(&temp,0,59);
0000f6  b134              CBZ      r4,|L5.262|
0000f8  2c01              CMP      r4,#1
0000fa  d00b              BEQ      |L5.276|
0000fc  2c02              CMP      r4,#2
0000fe  d010              BEQ      |L5.290|
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  2c03              CMP      r4,#3
000102  d015              BEQ      |L5.304|
000104  e0c8              B        |L5.664|
                  |L5.262|
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  2303              MOVS     r3,#3
000108  2201              MOVS     r2,#1
;;;366    		gran_char(&temp,0,59);
00010a  210e              MOVS     r1,#0xe
00010c  a09f              ADR      r0,|L5.908|
00010e  f7fffffe          BL       snmp_trap_send
000112  e0c1              B        |L5.664|
                  |L5.276|
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  2303              MOVS     r3,#3
000116  2202              MOVS     r2,#2
000118  210e              MOVS     r1,#0xe
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011a  a0a3              ADR      r0,|L5.936|
00011c  f7fffffe          BL       snmp_trap_send
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000120  e0ba              B        |L5.664|
                  |L5.290|
000122  2303              MOVS     r3,#3
000124  461a              MOV      r2,r3
000126  210e              MOVS     r1,#0xe
000128  a0a6              ADR      r0,|L5.964|
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
00012a  f7fffffe          BL       snmp_trap_send
;;;373    	}
;;;374    }
00012e  e0b3              B        |L5.664|
                  |L5.304|
000130  2303              MOVS     r3,#3
000132  2204              MOVS     r2,#4
000134  210e              MOVS     r1,#0xe
000136  a0aa              ADR      r0,|L5.992|
000138  f7fffffe          BL       snmp_trap_send
00013c  e0ac              B        |L5.664|
                  |L5.318|
00013e  0703              LSLS     r3,r0,#28
000140  d529              BPL      |L5.406|
000142  070b              LSLS     r3,r1,#28
000144  d527              BPL      |L5.406|
000146  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
000148  f1000001          ADD      r0,r0,#1
00014c  70d0              STRB     r0,[r2,#3]
00014e  b134              CBZ      r4,|L5.350|
000150  2c01              CMP      r4,#1
000152  d00b              BEQ      |L5.364|
000154  2c02              CMP      r4,#2
000156  d010              BEQ      |L5.378|
000158  2c03              CMP      r4,#3
00015a  d015              BEQ      |L5.392|
00015c  e09c              B        |L5.664|
                  |L5.350|
00015e  2304              MOVS     r3,#4
000160  2201              MOVS     r2,#1
000162  210e              MOVS     r1,#0xe
000164  a0a5              ADR      r0,|L5.1020|
000166  f7fffffe          BL       snmp_trap_send
00016a  e095              B        |L5.664|
                  |L5.364|
00016c  2304              MOVS     r3,#4
00016e  2202              MOVS     r2,#2
000170  210e              MOVS     r1,#0xe
000172  a0ab              ADR      r0,|L5.1056|
000174  f7fffffe          BL       snmp_trap_send
000178  e08e              B        |L5.664|
                  |L5.378|
00017a  2304              MOVS     r3,#4
00017c  2203              MOVS     r2,#3
00017e  210e              MOVS     r1,#0xe
000180  a0b0              ADR      r0,|L5.1092|
000182  f7fffffe          BL       snmp_trap_send
000186  e087              B        |L5.664|
                  |L5.392|
000188  2304              MOVS     r3,#4
00018a  461a              MOV      r2,r3
00018c  210e              MOVS     r1,#0xe
00018e  a0b6              ADR      r0,|L5.1128|
000190  f7fffffe          BL       snmp_trap_send
000194  e080              B        |L5.664|
                  |L5.406|
000196  06c3              LSLS     r3,r0,#27
000198  d529              BPL      |L5.494|
00019a  06cb              LSLS     r3,r1,#27
00019c  d527              BPL      |L5.494|
00019e  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001a0  f1000001          ADD      r0,r0,#1
0001a4  70d0              STRB     r0,[r2,#3]
0001a6  b134              CBZ      r4,|L5.438|
0001a8  2c01              CMP      r4,#1
0001aa  d00b              BEQ      |L5.452|
0001ac  2c02              CMP      r4,#2
0001ae  d010              BEQ      |L5.466|
0001b0  2c03              CMP      r4,#3
0001b2  d015              BEQ      |L5.480|
0001b4  e070              B        |L5.664|
                  |L5.438|
0001b6  2305              MOVS     r3,#5
0001b8  2201              MOVS     r2,#1
0001ba  210e              MOVS     r1,#0xe
0001bc  a0b3              ADR      r0,|L5.1164|
0001be  f7fffffe          BL       snmp_trap_send
0001c2  e069              B        |L5.664|
                  |L5.452|
0001c4  2305              MOVS     r3,#5
0001c6  2202              MOVS     r2,#2
0001c8  210e              MOVS     r1,#0xe
0001ca  a0b9              ADR      r0,|L5.1200|
0001cc  f7fffffe          BL       snmp_trap_send
0001d0  e062              B        |L5.664|
                  |L5.466|
0001d2  2305              MOVS     r3,#5
0001d4  2203              MOVS     r2,#3
0001d6  210e              MOVS     r1,#0xe
0001d8  a0be              ADR      r0,|L5.1236|
0001da  f7fffffe          BL       snmp_trap_send
0001de  e05b              B        |L5.664|
                  |L5.480|
0001e0  2305              MOVS     r3,#5
0001e2  2204              MOVS     r2,#4
0001e4  210e              MOVS     r1,#0xe
0001e6  a0c4              ADR      r0,|L5.1272|
0001e8  f7fffffe          BL       snmp_trap_send
0001ec  e054              B        |L5.664|
                  |L5.494|
0001ee  0683              LSLS     r3,r0,#26
0001f0  d529              BPL      |L5.582|
0001f2  068b              LSLS     r3,r1,#26
0001f4  d527              BPL      |L5.582|
0001f6  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
0001f8  f1000001          ADD      r0,r0,#1
0001fc  70d0              STRB     r0,[r2,#3]
0001fe  b134              CBZ      r4,|L5.526|
000200  2c01              CMP      r4,#1
000202  d00b              BEQ      |L5.540|
000204  2c02              CMP      r4,#2
000206  d010              BEQ      |L5.554|
000208  2c03              CMP      r4,#3
00020a  d015              BEQ      |L5.568|
00020c  e044              B        |L5.664|
                  |L5.526|
00020e  2306              MOVS     r3,#6
000210  2201              MOVS     r2,#1
000212  210e              MOVS     r1,#0xe
000214  a0c1              ADR      r0,|L5.1308|
000216  f7fffffe          BL       snmp_trap_send
00021a  e03d              B        |L5.664|
                  |L5.540|
00021c  2306              MOVS     r3,#6
00021e  2202              MOVS     r2,#2
000220  210e              MOVS     r1,#0xe
000222  a0c7              ADR      r0,|L5.1344|
000224  f7fffffe          BL       snmp_trap_send
000228  e036              B        |L5.664|
                  |L5.554|
00022a  2306              MOVS     r3,#6
00022c  2203              MOVS     r2,#3
00022e  210e              MOVS     r1,#0xe
000230  a0cc              ADR      r0,|L5.1380|
000232  f7fffffe          BL       snmp_trap_send
000236  e02f              B        |L5.664|
                  |L5.568|
000238  2306              MOVS     r3,#6
00023a  2204              MOVS     r2,#4
00023c  210e              MOVS     r1,#0xe
00023e  a0d2              ADR      r0,|L5.1416|
000240  f7fffffe          BL       snmp_trap_send
000244  e028              B        |L5.664|
                  |L5.582|
000246  b300              CBZ      r0,|L5.650|
000248  b9f9              CBNZ     r1,|L5.650|
00024a  78d0              LDRB     r0,[r2,#3]  ; plazma_inv
00024c  f1000001          ADD      r0,r0,#1
000250  70d0              STRB     r0,[r2,#3]
000252  b134              CBZ      r4,|L5.610|
000254  2c01              CMP      r4,#1
000256  d00b              BEQ      |L5.624|
000258  2c02              CMP      r4,#2
00025a  d010              BEQ      |L5.638|
00025c  2c03              CMP      r4,#3
00025e  d015              BEQ      |L5.652|
000260  e01a              B        |L5.664|
                  |L5.610|
000262  2300              MOVS     r3,#0
000264  2201              MOVS     r2,#1
000266  210e              MOVS     r1,#0xe
000268  a0d0              ADR      r0,|L5.1452|
00026a  f7fffffe          BL       snmp_trap_send
00026e  e013              B        |L5.664|
                  |L5.624|
000270  2300              MOVS     r3,#0
000272  2202              MOVS     r2,#2
000274  210e              MOVS     r1,#0xe
000276  a0d2              ADR      r0,|L5.1472|
000278  f7fffffe          BL       snmp_trap_send
00027c  e00c              B        |L5.664|
                  |L5.638|
00027e  2300              MOVS     r3,#0
000280  2203              MOVS     r2,#3
000282  210e              MOVS     r1,#0xe
000284  a0d3              ADR      r0,|L5.1492|
000286  f7fffffe          BL       snmp_trap_send
                  |L5.650|
00028a  e005              B        |L5.664|
                  |L5.652|
00028c  2300              MOVS     r3,#0
00028e  2204              MOVS     r2,#4
000290  210e              MOVS     r1,#0xe
000292  a0d5              ADR      r0,|L5.1512|
000294  f7fffffe          BL       snmp_trap_send
                  |L5.664|
000298  f8150f46          LDRB     r0,[r5,#0x46]!
00029c  7068              STRB     r0,[r5,#1]
00029e  bd70              POP      {r4-r6,pc}
;;;375    #endif
                          ENDP

                  |L5.672|
                          DCD      first_inv_slot
                  |L5.676|
                          DCD      inv
                  |L5.680|
                          DCD      ||area_number.25||+0xb4
                  |L5.684|
0002ac  496e7665          DCB      "Invertor #1 Alarm, overload",0
0002b0  72746f72
0002b4  20233120
0002b8  416c6172
0002bc  6d2c206f
0002c0  7665726c
0002c4  6f616400
                  |L5.712|
0002c8  496e7665          DCB      "Invertor #2 Alarm, overload",0
0002cc  72746f72
0002d0  20233220
0002d4  416c6172
0002d8  6d2c206f
0002dc  7665726c
0002e0  6f616400
                  |L5.740|
0002e4  496e7665          DCB      "Invertor #3 Alarm, overload",0
0002e8  72746f72
0002ec  20233320
0002f0  416c6172
0002f4  6d2c206f
0002f8  7665726c
0002fc  6f616400
                  |L5.768|
000300  496e7665          DCB      "Invertor #4 Alarm, overload",0
000304  72746f72
000308  20233420
00030c  416c6172
000310  6d2c206f
000314  7665726c
000318  6f616400
                  |L5.796|
00031c  496e7665          DCB      "Invertor #1 Alarm, overheat",0
000320  72746f72
000324  20233120
000328  416c6172
00032c  6d2c206f
000330  76657268
000334  65617400
                  |L5.824|
000338  496e7665          DCB      "Invertor #2 Alarm, overheat",0
00033c  72746f72
000340  20233220
000344  416c6172
000348  6d2c206f
00034c  76657268
000350  65617400
                  |L5.852|
000354  496e7665          DCB      "Invertor #3 Alarm, overheat",0
000358  72746f72
00035c  20233320
000360  416c6172
000364  6d2c206f
000368  76657268
00036c  65617400
                  |L5.880|
000370  496e7665          DCB      "Invertor #4 Alarm, overheat",0
000374  72746f72
000378  20233420
00037c  416c6172
000380  6d2c206f
000384  76657268
000388  65617400
                  |L5.908|
00038c  496e7665          DCB      "Invertor #1 Alarm, is warm",0
000390  72746f72
000394  20233120
000398  416c6172
00039c  6d2c2069
0003a0  73207761
0003a4  726d00  
0003a7  00                DCB      0
                  |L5.936|
0003a8  496e7665          DCB      "Invertor #2 Alarm, is warm",0
0003ac  72746f72
0003b0  20233220
0003b4  416c6172
0003b8  6d2c2069
0003bc  73207761
0003c0  726d00  
0003c3  00                DCB      0
                  |L5.964|
0003c4  496e7665          DCB      "Invertor #3 Alarm, is warm",0
0003c8  72746f72
0003cc  20233320
0003d0  416c6172
0003d4  6d2c2069
0003d8  73207761
0003dc  726d00  
0003df  00                DCB      0
                  |L5.992|
0003e0  496e7665          DCB      "Invertor #4 Alarm, is warm",0
0003e4  72746f72
0003e8  20233420
0003ec  416c6172
0003f0  6d2c2069
0003f4  73207761
0003f8  726d00  
0003fb  00                DCB      0
                  |L5.1020|
0003fc  496e7665          DCB      "Invertor #1 Alarm, voltage is up",0
000400  72746f72
000404  20233120
000408  416c6172
00040c  6d2c2076
000410  6f6c7461
000414  67652069
000418  73207570
00041c  00      
00041d  00                DCB      0
00041e  00                DCB      0
00041f  00                DCB      0
                  |L5.1056|
000420  496e7665          DCB      "Invertor #2 Alarm, voltage is up",0
000424  72746f72
000428  20233220
00042c  416c6172
000430  6d2c2076
000434  6f6c7461
000438  67652069
00043c  73207570
000440  00      
000441  00                DCB      0
000442  00                DCB      0
000443  00                DCB      0
                  |L5.1092|
000444  496e7665          DCB      "Invertor #3 Alarm, voltage is up",0
000448  72746f72
00044c  20233320
000450  416c6172
000454  6d2c2076
000458  6f6c7461
00045c  67652069
000460  73207570
000464  00      
000465  00                DCB      0
000466  00                DCB      0
000467  00                DCB      0
                  |L5.1128|
000468  496e7665          DCB      "Invertor #4 Alarm, voltage is up",0
00046c  72746f72
000470  20233420
000474  416c6172
000478  6d2c2076
00047c  6f6c7461
000480  67652069
000484  73207570
000488  00      
000489  00                DCB      0
00048a  00                DCB      0
00048b  00                DCB      0
                  |L5.1164|
00048c  496e7665          DCB      "Invertor #1 Alarm, voltage is down",0
000490  72746f72
000494  20233120
000498  416c6172
00049c  6d2c2076
0004a0  6f6c7461
0004a4  67652069
0004a8  7320646f
0004ac  776e00  
0004af  00                DCB      0
                  |L5.1200|
0004b0  496e7665          DCB      "Invertor #2 Alarm, voltage is down",0
0004b4  72746f72
0004b8  20233220
0004bc  416c6172
0004c0  6d2c2076
0004c4  6f6c7461
0004c8  67652069
0004cc  7320646f
0004d0  776e00  
0004d3  00                DCB      0
                  |L5.1236|
0004d4  496e7665          DCB      "Invertor #3 Alarm, voltage is down",0
0004d8  72746f72
0004dc  20233320
0004e0  416c6172
0004e4  6d2c2076
0004e8  6f6c7461
0004ec  67652069
0004f0  7320646f
0004f4  776e00  
0004f7  00                DCB      0
                  |L5.1272|
0004f8  496e7665          DCB      "Invertor #4 Alarm, voltage is down",0
0004fc  72746f72
000500  20233420
000504  416c6172
000508  6d2c2076
00050c  6f6c7461
000510  67652069
000514  7320646f
000518  776e00  
00051b  00                DCB      0
                  |L5.1308|
00051c  496e7665          DCB      "Invertor #1 Alarm, output is offed",0
000520  72746f72
000524  20233120
000528  416c6172
00052c  6d2c206f
000530  75747075
000534  74206973
000538  206f6666
00053c  656400  
00053f  00                DCB      0
                  |L5.1344|
000540  496e7665          DCB      "Invertor #2 Alarm, output is offed",0
000544  72746f72
000548  20233220
00054c  416c6172
000550  6d2c206f
000554  75747075
000558  74206973
00055c  206f6666
000560  656400  
000563  00                DCB      0
                  |L5.1380|
000564  496e7665          DCB      "Invertor #3 Alarm, output is offed",0
000568  72746f72
00056c  20233320
000570  416c6172
000574  6d2c206f
000578  75747075
00057c  74206973
000580  206f6666
000584  656400  
000587  00                DCB      0
                  |L5.1416|
000588  496e7665          DCB      "Invertor #4 Alarm, output is offed",0
00058c  72746f72
000590  20233420
000594  416c6172
000598  6d2c206f
00059c  75747075
0005a0  74206973
0005a4  206f6666
0005a8  656400  
0005ab  00                DCB      0
                  |L5.1452|
0005ac  496e7665          DCB      "Invertor #1 is norm",0
0005b0  72746f72
0005b4  20233120
0005b8  6973206e
0005bc  6f726d00
                  |L5.1472|
0005c0  496e7665          DCB      "Invertor #2 is norm",0
0005c4  72746f72
0005c8  20233220
0005cc  6973206e
0005d0  6f726d00
                  |L5.1492|
0005d4  496e7665          DCB      "Invertor #3 is norm",0
0005d8  72746f72
0005dc  20233320
0005e0  6973206e
0005e4  6f726d00
                  |L5.1512|
0005e8  496e7665          DCB      "Invertor #4 is norm",0
0005ec  72746f72
0005f0  20233420
0005f4  6973206e
0005f8  6f726d00

                          AREA ||area_number.6||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.text||
                  klimat_hndl PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;297    {          
000004  4d66              LDR      r5,|L6.416|
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  4867              LDR      r0,|L6.420|
000008  4c67              LDR      r4,|L6.424|
00000a  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000e  f9b02000          LDRSH    r2,[r0,#0]  ; TBOXMAX
;;;315    
;;;316    	spc_stat=spcKE;
000012  f9b40000          LDRSH    r0,[r4,#0]
000016  4291              CMP      r1,r2
;;;317    	__ee_spc_stat=spcKE;
000018  dd03              BLE      |L6.34|
00001a  f1000001          ADD      r0,r0,#1
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001e  8020              STRH     r0,[r4,#0]
000020  e003              B        |L6.42|
                  |L6.34|
000022  da02              BGE      |L6.42|
000024  f1a00001          SUB      r0,r0,#1
;;;319    	
;;;320    	spc_bat=0;
;;;321    	__ee_spc_bat=0;
000028  8020              STRH     r0,[r4,#0]
                  |L6.42|
00002a  2206              MOVS     r2,#6
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  2100              MOVS     r1,#0
00002e  485e              LDR      r0,|L6.424|
000030  f7fffffe          BL       gran
000034  f9b40000          LDRSH    r0,[r4,#0]  ; av_tbox_cnt
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000038  495c              LDR      r1,|L6.428|
00003a  2601              MOVS     r6,#1
00003c  2805              CMP      r0,#5
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
00003e  dd00              BLE      |L6.66|
000040  700e              STRB     r6,[r1,#0]
                  |L6.66|
000042  2400              MOVS     r4,#0
000044  2801              CMP      r0,#1
000046  da00              BGE      |L6.74|
000048  700c              STRB     r4,[r1,#0]
                  |L6.74|
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004a  4959              LDR      r1,|L6.432|
00004c  f9b50000          LDRSH    r0,[r5,#0]  ; t_box
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
000050  4a58              LDR      r2,|L6.436|
000052  f9b11000          LDRSH    r1,[r1,#0]  ; TBOXREG
000056  4f58              LDR      r7,|L6.440|
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  1e8b              SUBS     r3,r1,#2
;;;332    	__ee_spc_phase=0;
00005a  4298              CMP      r0,r3
00005c  da0f              BGE      |L6.126|
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  f9921000          LDRSB    r1,[r2,#0]  ; t_box_cnt
000062  291e              CMP      r1,#0x1e
000064  da1e              BGE      |L6.164|
000066  f1010101          ADD      r1,r1,#1
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
00006a  b249              SXTB     r1,r1
00006c  7011              STRB     r1,[r2,#0]
00006e  291e              CMP      r1,#0x1e
000070  db18              BLT      |L6.164|
000072  8839              LDRH     r1,[r7,#0]  ; main_vent_pos
000074  f1a10101          SUB      r1,r1,#1
000078  8039              STRH     r1,[r7,#0]
00007a  7014              STRB     r4,[r2,#0]
00007c  e012              B        |L6.164|
                  |L6.126|
00007e  4288              CMP      r0,r1
000080  dd0f              BLE      |L6.162|
000082  f9921000          LDRSB    r1,[r2,#0]  ; t_box_cnt
000086  291e              CMP      r1,#0x1e
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  da0c              BGE      |L6.164|
00008a  f1010101          ADD      r1,r1,#1
;;;343    		gran_char(&temp,1,99);
00008e  b249              SXTB     r1,r1
000090  7011              STRB     r1,[r2,#0]
000092  291e              CMP      r1,#0x1e
000094  db06              BLT      |L6.164|
000096  8839              LDRH     r1,[r7,#0]  ; main_vent_pos
000098  f1010101          ADD      r1,r1,#1
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  8039              STRH     r1,[r7,#0]
00009e  7014              STRB     r4,[r2,#0]
0000a0  e000              B        |L6.164|
                  |L6.162|
0000a2  7014              STRB     r4,[r2,#0]
                  |L6.164|
0000a4  4945              LDR      r1,|L6.444|
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  f9b11000          LDRSH    r1,[r1,#0]  ; TBOXVENTMAX
;;;347    		gran_char(&temp,1,12);
0000aa  4288              CMP      r0,r1
0000ac  dd05              BLE      |L6.186|
0000ae  2214              MOVS     r2,#0x14
0000b0  2100              MOVS     r1,#0
0000b2  4841              LDR      r0,|L6.440|
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  f7fffffe          BL       gran
0000b8  e007              B        |L6.202|
                  |L6.186|
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000ba  4841              LDR      r0,|L6.448|
0000bc  2100              MOVS     r1,#0
;;;351    		gran_char(&temp,1,31);
0000be  8800              LDRH     r0,[r0,#0]  ; pos_vent
0000c0  3009              ADDS     r0,r0,#9
0000c2  b202              SXTH     r2,r0
0000c4  483c              LDR      r0,|L6.440|
0000c6  f7fffffe          BL       gran
                  |L6.202|
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000ca  20f0              MOVS     r0,#0xf0
0000cc  f7fffffe          BL       mess_find_unvol
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000d0  b128              CBZ      r0,|L6.222|
0000d2  483c              LDR      r0,|L6.452|
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d4  6801              LDR      r1,[r0,#0]  ; mess_data
0000d6  29f1              CMP      r1,#0xf1
0000d8  d101              BNE      |L6.222|
0000da  6840              LDR      r0,[r0,#4]  ; mess_data
0000dc  8038              STRH     r0,[r7,#0]
                  |L6.222|
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000de  f9b71000          LDRSH    r1,[r7,#0]  ; main_vent_pos
;;;358    		gran_char(&temp,0,23);
0000e2  4839              LDR      r0,|L6.456|
0000e4  2901              CMP      r1,#1
0000e6  dc01              BGT      |L6.236|
0000e8  7006              STRB     r6,[r0,#0]
0000ea  e000              B        |L6.238|
                  |L6.236|
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ec  7004              STRB     r4,[r0,#0]
                  |L6.238|
0000ee  4837              LDR      r0,|L6.460|
0000f0  f8df80dc          LDR      r8,|L6.464|
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f4  f9b00000          LDRSH    r0,[r0,#0]  ; TBATDISABLE
;;;362    		gran_char(&temp,0,59);
0000f8  f1a00132          SUB      r1,r0,#0x32
0000fc  2928              CMP      r1,#0x28
0000fe  d821              BHI      |L6.324|
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
000104  4f33              LDR      r7,|L6.468|
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  4281              CMP      r1,r0
000108  dd03              BLE      |L6.274|
;;;366    		gran_char(&temp,0,59);
00010a  8838              LDRH     r0,[r7,#0]  ; tbatdisable_cnt
00010c  f1000001          ADD      r0,r0,#1
000110  8038              STRH     r0,[r7,#0]
                  |L6.274|
000112  4831              LDR      r0,|L6.472|
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  f9b00000          LDRSH    r0,[r0,#0]  ; TBATENABLE
000118  4281              CMP      r1,r0
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011a  da03              BGE      |L6.292|
00011c  8838              LDRH     r0,[r7,#0]  ; tbatdisable_cnt
00011e  f1a00001          SUB      r0,r0,#1
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000122  8038              STRH     r0,[r7,#0]
                  |L6.292|
000124  2206              MOVS     r2,#6
000126  2100              MOVS     r1,#0
000128  482a              LDR      r0,|L6.468|
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
00012a  f7fffffe          BL       gran
;;;373    	}
;;;374    }
00012e  f9b70000          LDRSH    r0,[r7,#0]  ; tbatdisable_cnt
000132  2805              CMP      r0,#5
000134  dd01              BLE      |L6.314|
000136  f8886000          STRB     r6,[r8,#0]
                  |L6.314|
00013a  2801              CMP      r0,#1
00013c  da04              BGE      |L6.328|
00013e  f8884000          STRB     r4,[r8,#0]
000142  e001              B        |L6.328|
                  |L6.324|
000144  f8884000          STRB     r4,[r8,#0]
                  |L6.328|
000148  4824              LDR      r0,|L6.476|
00014a  4f25              LDR      r7,|L6.480|
00014c  f9b00000          LDRSH    r0,[r0,#0]  ; TLOADDISABLE
000150  f1a00132          SUB      r1,r0,#0x32
000154  291e              CMP      r1,#0x1e
000156  d820              BHI      |L6.410|
000158  f9b51000          LDRSH    r1,[r5,#0]  ; t_box
00015c  4d21              LDR      r5,|L6.484|
00015e  4281              CMP      r1,r0
000160  dd03              BLE      |L6.362|
000162  8828              LDRH     r0,[r5,#0]  ; tloaddisable_cnt
000164  f1000001          ADD      r0,r0,#1
000168  8028              STRH     r0,[r5,#0]
                  |L6.362|
00016a  481f              LDR      r0,|L6.488|
00016c  f9b00000          LDRSH    r0,[r0,#0]  ; TLOADENABLE
000170  4281              CMP      r1,r0
000172  da03              BGE      |L6.380|
000174  8828              LDRH     r0,[r5,#0]  ; tloaddisable_cnt
000176  f1a00001          SUB      r0,r0,#1
00017a  8028              STRH     r0,[r5,#0]
                  |L6.380|
00017c  2206              MOVS     r2,#6
00017e  2100              MOVS     r1,#0
000180  4818              LDR      r0,|L6.484|
000182  f7fffffe          BL       gran
000186  f9b50000          LDRSH    r0,[r5,#0]  ; tloaddisable_cnt
00018a  2805              CMP      r0,#5
00018c  dd00              BLE      |L6.400|
00018e  703e              STRB     r6,[r7,#0]
                  |L6.400|
000190  2801              CMP      r0,#1
000192  da00              BGE      |L6.406|
000194  703c              STRB     r4,[r7,#0]
                  |L6.406|
000196  e8bd81f0          POP      {r4-r8,pc}
                  |L6.410|
00019a  703c              STRB     r4,[r7,#0]
00019c  e7fb              B        |L6.406|
;;;375    #endif
                          ENDP

00019e  0000              DCW      0x0000
                  |L6.416|
                          DCD      t_box
                  |L6.420|
                          DCD      TBOXMAX
                  |L6.424|
                          DCD      av_tbox_cnt
                  |L6.428|
                          DCD      av_tbox_stat
                  |L6.432|
                          DCD      TBOXREG
                  |L6.436|
                          DCD      t_box_cnt
                  |L6.440|
                          DCD      main_vent_pos
                  |L6.444|
                          DCD      TBOXVENTMAX
                  |L6.448|
                          DCD      pos_vent
                  |L6.452|
                          DCD      mess_data
                  |L6.456|
                          DCD      mixer_vent_stat
                  |L6.460|
                          DCD      TBATDISABLE
                  |L6.464|
                          DCD      tbatdisable_stat
                  |L6.468|
                          DCD      tbatdisable_cnt
                  |L6.472|
                          DCD      TBATENABLE
                  |L6.476|
                          DCD      TLOADDISABLE
                  |L6.480|
                          DCD      tloaddisable_stat
                  |L6.484|
                          DCD      tloaddisable_cnt
                  |L6.488|
                          DCD      TLOADENABLE

                          AREA ||area_number.7||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.text||
                  u_avt_set_hndl1 PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  e92d5fff          PUSH     {r0-r12,lr}
;;;297    {          
000004  484e              LDR      r0,|L7.320|
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  2165              MOVS     r1,#0x65
000008  2564              MOVS     r5,#0x64
00000a  f9b00000          LDRSH    r0,[r0,#0]
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000e  4c4b              LDR      r4,|L7.316|
000010  4341              MULS     r1,r0,r1
;;;315    
;;;316    	spc_stat=spcKE;
000012  eb001040          ADD      r0,r0,r0,LSL #5
000016  fbb1f1f5          UDIV     r1,r1,r5
;;;317    	__ee_spc_stat=spcKE;
00001a  eb000040          ADD      r0,r0,r0,LSL #1
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001e  fbb0f0f5          UDIV     r0,r0,r5
000022  f8dfb120          LDR      r11,|L7.324|
;;;319    	
;;;320    	spc_bat=0;
000026  b20a              SXTH     r2,r1
;;;321    	__ee_spc_bat=0;
000028  7823              LDRB     r3,[r4,#0]  ; uavt_set_stat
00002a  b201              SXTH     r1,r0
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
00002c  f89b0000          LDRB     r0,[r11,#0]
000030  4e45              LDR      r6,|L7.328|
000032  4f46              LDR      r7,|L7.332|
000034  f8df8118          LDR      r8,|L7.336|
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
000038  f8df9118          LDR      r9,|L7.340|
00003c  f8dfa118          LDR      r10,|L7.344|
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
000040  2500              MOVS     r5,#0
000042  2b01              CMP      r3,#1
000044  d002              BEQ      |L7.76|
000046  2b02              CMP      r3,#2
000048  d031              BEQ      |L7.174|
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
00004a  e071              B        |L7.304|
                  |L7.76|
00004c  803a              STRH     r2,[r7,#0]
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
00004e  f8a81000          STRH     r1,[r8,#0]
000052  2801              CMP      r0,#1
000054  d000              BEQ      |L7.88|
000056  7035              STRB     r5,[r6,#0]
                  |L7.88|
;;;329    
;;;330    	
;;;331    	spc_phase=0;
000058  230a              MOVS     r3,#0xa
;;;332    	__ee_spc_phase=0;
00005a  2200              MOVS     r2,#0
00005c  21e6              MOVS     r1,#0xe6
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
00005e  20e1              MOVS     r0,#0xe1
000060  f7fffffe          BL       mess_send
000064  f04f0201          MOV      r2,#1
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
000068  f04f0000          MOV      r0,#0
00006c  f9b73000          LDRSH    r3,[r7,#0]
000070  f9b85000          LDRSH    r5,[r8,#0]
000074  f9ba6000          LDRSH    r6,[r10,#0]
000078  e00d              B        |L7.150|
                  |L7.122|
00007a  ebc001c0          RSB      r1,r0,r0,LSL #3
00007e  eb011100          ADD      r1,r1,r0,LSL #4
000082  eb090181          ADD      r1,r9,r1,LSL #2
000086  69c9              LDR      r1,[r1,#0x1c]
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
000088  4299              CMP      r1,r3
00008a  da09              BGE      |L7.160|
00008c  42a9              CMP      r1,r5
;;;343    		gran_char(&temp,1,99);
00008e  dd07              BLE      |L7.160|
000090  f1000001          ADD      r0,r0,#1
000094  b2c0              UXTB     r0,r0
                  |L7.150|
000096  42b0              CMP      r0,r6
000098  dbef              BLT      |L7.122|
                  |L7.154|
00009a  2a01              CMP      r2,#1
;;;344    		*((char*)(&(ke_date[0])))=temp;
00009c  d003              BEQ      |L7.166|
00009e  e047              B        |L7.304|
                  |L7.160|
0000a0  f04f0200          MOV      r2,#0
0000a4  e7f9              B        |L7.154|
                  |L7.166|
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
0000a6  f04f0002          MOV      r0,#2
;;;347    		gran_char(&temp,1,12);
0000aa  7020              STRB     r0,[r4,#0]
0000ac  e040              B        |L7.304|
                  |L7.174|
0000ae  803a              STRH     r2,[r7,#0]
0000b0  f8a81000          STRH     r1,[r8,#0]
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
0000b4  2802              CMP      r0,#2
0000b6  d000              BEQ      |L7.186|
0000b8  7035              STRB     r5,[r6,#0]
                  |L7.186|
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
0000ba  230a              MOVS     r3,#0xa
0000bc  2200              MOVS     r2,#0
;;;351    		gran_char(&temp,1,31);
0000be  21e6              MOVS     r1,#0xe6
0000c0  20e1              MOVS     r0,#0xe1
0000c2  f7fffffe          BL       mess_send
0000c6  f04f0201          MOV      r2,#1
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
0000ca  f04f0000          MOV      r0,#0
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
0000ce  f9b73000          LDRSH    r3,[r7,#0]
0000d2  f9b87000          LDRSH    r7,[r8,#0]
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
0000d6  f9bac000          LDRSH    r12,[r10,#0]
0000da  e00d              B        |L7.248|
                  |L7.220|
0000dc  ebc001c0          RSB      r1,r0,r0,LSL #3
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
0000e0  eb011100          ADD      r1,r1,r0,LSL #4
;;;358    		gran_char(&temp,0,23);
0000e4  eb090181          ADD      r1,r9,r1,LSL #2
0000e8  69c9              LDR      r1,[r1,#0x1c]
0000ea  4299              CMP      r1,r3
;;;359    		*((char*)(&(ke_date[1])))=temp;
0000ec  da09              BGE      |L7.258|
0000ee  42b9              CMP      r1,r7
0000f0  dd07              BLE      |L7.258|
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
0000f2  f1000001          ADD      r0,r0,#1
;;;362    		gran_char(&temp,0,59);
0000f6  b2c0              UXTB     r0,r0
                  |L7.248|
0000f8  4560              CMP      r0,r12
0000fa  dbef              BLT      |L7.220|
                  |L7.252|
0000fc  2a01              CMP      r2,#1
0000fe  d003              BEQ      |L7.264|
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
000100  e016              B        |L7.304|
                  |L7.258|
000102  f04f0200          MOV      r2,#0
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
000106  e7f9              B        |L7.252|
                  |L7.264|
000108  20ee              MOVS     r0,#0xee
;;;366    		gran_char(&temp,0,59);
00010a  e9cd0500          STRD     r0,r5,[sp,#0]
00010e  9502              STR      r5,[sp,#8]
000110  9503              STR      r5,[sp,#0xc]
000112  7831              LDRB     r1,[r6,#0]  ; uavt_bps_pntr
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
000114  4603              MOV      r3,r0
000116  2216              MOVS     r2,#0x16
000118  4608              MOV      r0,r1
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
00011a  f7fffffe          BL       mcp2515_transmit
00011e  7830              LDRB     r0,[r6,#0]  ; uavt_bps_pntr
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
000120  1c40              ADDS     r0,r0,#1
000122  b2c0              UXTB     r0,r0
000124  7030              STRB     r0,[r6,#0]
000126  f9ba1000          LDRSH    r1,[r10,#0]  ; NUMIST
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
00012a  4288              CMP      r0,r1
;;;373    	}
;;;374    }
00012c  db00              BLT      |L7.304|
00012e  7025              STRB     r5,[r4,#0]
                  |L7.304|
000130  7820              LDRB     r0,[r4,#0]  ; uavt_set_stat
000132  f88b0000          STRB     r0,[r11,#0]
000136  e8bd9fff          POP      {r0-r12,pc}
;;;375    #endif
                          ENDP

00013a  0000              DCW      0x0000
                  |L7.316|
                          DCD      uavt_set_stat
                  |L7.320|
                          DCD      U_AVT
                  |L7.324|
                          DCD      uavt_set_stat_old
                  |L7.328|
                          DCD      uavt_bps_pntr
                  |L7.332|
                          DCD      u_max_temp
                  |L7.336|
                          DCD      u_min_temp
                  |L7.340|
                          DCD      bps
                  |L7.344|
                          DCD      NUMIST

                          AREA ||area_number.8||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.8||, ||.text||
                  averageChargeStartStop PROC
;;;295    //-----------------------------------------------
;;;296    void ke_start(char in)
000000  4908              LDR      r1,|L8.36|
;;;297    {          
000002  f44f70b4          MOV      r0,#0x168
;;;298    ke_start_stat=(enum_ke_start_stat)0;		 
000006  780a              LDRB     r2,[r1,#0]  ; hv_vz_stat
000008  b132              CBZ      r2,|L8.24|
00000a  f04f0200          MOV      r2,#0
;;;299    /*
;;;300    if(spc_stat==spcVZ)ke_start_stat=kssNOT_VZ;
;;;301    #ifndef UKU_220_IPS_TERMOKOMPENSAT
;;;302    else if(BAT_IS_ON[in]!=bisON)ke_start_stat=kssNOT_BAT;
;;;303    #endif
;;;304    else if(bat[in]._av&(1<<0))ke_start_stat=kssNOT_BAT_AV;
;;;305    else if(bat[in]._temper_stat&(1<<1))ke_start_stat=kssNOT_BAT_AV_T;
;;;306    else if(bat[in]._av&(1<<1))ke_start_stat=kssNOT_BAT_AV_ASS;
;;;307    else if(bat[in]._Ib>IKB)ke_start_stat=kssNOT_BAT_ZAR;
;;;308    else if(bat[in]._Ib<-IKB)ke_start_stat=kssNOT_BAT_RAZR;
;;;309    else if((spc_stat==spcKE)&&(spc_bat==0))ke_start_stat=kssNOT_KE1;
;;;310    else if((spc_stat==spcKE)&&(spc_bat==1))ke_start_stat=kssNOT_KE2;
;;;311    else */
;;;312    	{
;;;313    
;;;314    	ke_start_stat=kssYES;
00000e  700a              STRB     r2,[r1,#0]
000010  f04f0100          MOV      r1,#0
;;;315    
;;;316    	spc_stat=spcKE;
000014  f7ffbffe          B.W      lc640_write
                  |L8.24|
;;;317    	__ee_spc_stat=spcKE;
000018  f04f0201          MOV      r2,#1
;;;318    	lc640_write_int(EE_SPC_STAT,__ee_spc_stat);
00001c  700a              STRB     r2,[r1,#0]
00001e  4611              MOV      r1,r2
000020  f7ffbffe          B.W      lc640_write
;;;319    	
;;;320    	spc_bat=0;
;;;321    	__ee_spc_bat=0;
;;;322    	lc640_write_int(EE_SPC_BAT,__ee_spc_bat);
;;;323    
;;;324    	bat[0]._zar_cnt_ke=0;
;;;325    	lc640_write_int(ADR_EE_BAT_ZAR_CNT_KE[0],0);
;;;326    
;;;327    	bat[0]._time_min_cnt_ke=0;
;;;328    	lc640_write_int(EE_ZVU_BAT_MIN_CNT_KE,0);
;;;329    
;;;330    	
;;;331    	spc_phase=0;
;;;332    	__ee_spc_phase=0;
;;;333    	lc640_write_int(EE_SPC_PHASE,__ee_spc_phase);
;;;334    
;;;335    	//ke_mem_hndl(in,lc640_read_int(ADR_EE_BAT_ZAR_CNT_KE[spc_bat]));
;;;336    
;;;337    		{					
;;;338    		signed short temp_temp;
;;;339    		signed char temp;
;;;340    		temp_temp=bat[in]._u_old[((bat_u_old_cnt+1)&0x07)]; 
;;;341    		    
;;;342    		temp=LPC_RTC->YEAR;
;;;343    		gran_char(&temp,1,99);
;;;344    		*((char*)(&(ke_date[0])))=temp;
;;;345    			
;;;346    		temp=LPC_RTC->MONTH;
;;;347    		gran_char(&temp,1,12);
;;;348    		*(((char*)(&(ke_date[0])))+1)=temp;
;;;349    		
;;;350    		temp=LPC_RTC->DOM;
;;;351    		gran_char(&temp,1,31);
;;;352    		*(((char*)(&(ke_date[0])))+2)=temp;			
;;;353    				
;;;354    		*(((char*)(&(ke_date[0])))+3)=*((char*)&temp_temp);
;;;355    		lc640_write_long(EE_SPC_KE_DATE0,ke_date[0]);
;;;356    
;;;357    		temp=LPC_RTC->HOUR;
;;;358    		gran_char(&temp,0,23);
;;;359    		*((char*)(&(ke_date[1])))=temp;
;;;360                   
;;;361    		temp=LPC_RTC->MIN;
;;;362    		gran_char(&temp,0,59);
;;;363    		*(((char*)(&(ke_date[1])))+1)=temp;
;;;364    	          
;;;365    		temp=LPC_RTC->SEC;
;;;366    		gran_char(&temp,0,59);
;;;367    		*(((char*)(&(ke_date[1])))+2)=temp;
;;;368    			
;;;369    		*(((char*)(&(ke_date[1])))+3)=*(((char*)&temp_temp)+1);
;;;370    		lc640_write_long(EE_SPC_KE_DATE1,ke_date[1]);
;;;371    		}
;;;372    	bat_hndl_zvu_ke_init=1;
;;;373    	}
;;;374    }
;;;375    #endif
                          ENDP

                  |L8.36|
                          DCD      hv_vz_stat

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  i_bat_buff
                          %        12
                  adc_buff
                          %        1024
                  adc_buff_
                          %        32
                  main_power_buffer
                          %        32
                  I_from_t_table
                          %        14
                  U_end_from_i_table
                          %        14
                  bat_hndl_plazma
                          %        20

                          AREA ||area_number.11||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.11||, ||.bss||
                  adc_buff_max
                          %        24

                          AREA ||area_number.12||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.bss||
                  net_buff
                          %        64

                          AREA ||.constdata||, DATA, READONLY, ALIGN=0

                  sk_buff_KONTUR
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.15||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.15||, ||.constdata||
                  sk_buff_RSTKM
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.16||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.constdata||
                  sk_buff_GLONASS
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.17||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.constdata||
                  sk_buff_3U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.18||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.18||, ||.constdata||
                  sk_buff_6U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.19||, DATA, READONLY, ALIGN=2

                          EXPORTAS ||area_number.19||, ||.constdata||
                  sk_buff_220
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e
                          DCD      0x00000258
                          DCD      0x00000708
                          DCD      0x00000e10
                          DCD      0x00002a30
                          DCD      0x00004650
                          DCD      0x00008ca0
                          DCD      0x00011940
                          DCD      0x00000258
                          DCD      0x00000708
                          DCD      0x00000e10
                          DCD      0x00002a30
                          DCD      0x00004650
                          DCD      0x00008ca0
                          DCD      0x00011940

                          AREA ||area_number.20||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.20||, ||.constdata||
                  sk_buff_TELECORE2015
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||.data||, DATA, ALIGN=1

                  adc_buff_min
000000  13881388          DCW      0x1388,0x1388
000004  13881388          DCW      0x1388,0x1388
000008  13881388          DCW      0x1388,0x1388
00000c  13881388          DCW      0x1388,0x1388
000010  13881388          DCW      0x1388,0x1388
                          DCDU     0x00000000

                          AREA ||area_number.22||, DATA, ALIGN=1

                          EXPORTAS ||area_number.22||, ||.data||
                  unet_buff_min
000000  1388              DCW      0x1388

                          AREA ||area_number.23||, DATA, ALIGN=0

                          EXPORTAS ||area_number.23||, ||.data||
                  adc_stat
000000  01                DCB      0x01

                          AREA ||area_number.24||, DATA, ALIGN=1

                          EXPORTAS ||area_number.24||, ||.data||
                  bat_ver_cnt
000000  0096              DCW      0x0096

                          AREA ||area_number.25||, DATA, ALIGN=2

                          EXPORTAS ||area_number.25||, ||.data||
                  vent_stat
000000  00                DCB      0x00
                  bat_hndl_zvu_init
000001  00                DCB      0x00
                  bat_hndl_zvu_ke_init
000002  00                DCB      0x00
                  bat_hndl_i_vector
000003  00                DCB      0x00
                  bat_hndl_i_vector_old
000004  00                DCB      0x00
                  ke_drv_cnt_10s
000005  00                DCB      0x00
                  i_bat_buff_cnt
000006  00                DCB      0x00
                  cntrlStatIsDownCnt
000007  00                DCB      0x00
                  adc_self_ch_cnt
000008  00                DCB      0x00
                  adc_ch_net
000009  00                DCB      0x00
                  adc_ch
00000a  00                DCB      0x00
                  adc_ch_cnt
00000b  00                DCB      0x00
                  adc_window_flag
00000c  00                DCB      0x00
                  ch_cnt0
00000d  00                DCB      0x00
                  b1Hz_ch
00000e  00                DCB      0x00
                  i
00000f  00                DCB      0x00
                  iiii
000010  00                DCB      0x00
                  bAVG
000011  00                DCB      0x00
                  avg_num
000012  00                DCB      0x00
                  kb_full_ver
000013  00                DCB      0x00
                  kb_start_ips
000014  00                DCB      0x00
                  num_of_wrks_bps
000015  00                DCB      0x00
                  num_necc_up
000016  00                DCB      0x00
                  num_necc_down
000017  00                DCB      0x00
                  sh_cnt0
000018  00                DCB      0x00
                  b1Hz_sh
000019  00                DCB      0x00
                  spc_stat
00001a  00                DCB      0x00
                  spc_bat
00001b  00                DCB      0x00
                  spc_phase
00001c  00                DCB      0x00
                  bAVZ
00001d  00                DCB      0x00
                  ke_start_stat
00001e  00                DCB      0x00
                  numOfForvardBps
00001f  00                DCB      0x00
                  numOfForvardBps_old
000020  00                DCB      0x00
                  numOfForvardBps_minCnt
000021  00                DCB      0x00
                  bPARALLEL_NOT_ENOUG
000022  00                DCB      0x00
                  bPARALLEL_ENOUG
000023  00                DCB      0x00
                  bPARALLEL
000024  00                DCB      0x00
                  cntrl_hndl_plazma
000025  00                DCB      0x00
                  vz1_stat
000026  00                DCB      0x00
                  vz1_stat_old
000027  00                DCB      0x00
                  volt_region
000028  00                DCB      0x00
                  vz2_stat
000029  00                DCB      0x00
                  vz2_stat_old
00002a  00                DCB      0x00
                  bat_hndl_zvu_Q_cnt
00002b  00                DCB      0x00
                  cntrl_stat
00002c  0258              DCW      0x0258
                  cntrl_stat_old
00002e  0258              DCW      0x0258
                  avg_main_cnt
000030  0014              DCW      0x0014
                  num_necc_block_cnt
000032  0000              DCB      0x00,0x00
                  net_buff_
000034  0000              DCB      0x00,0x00
                  adc_result
000036  0000              DCB      0x00,0x00
                  adc_gorb_cnt
000038  0000              DCB      0x00,0x00
                  adc_zero_cnt
00003a  0000              DCB      0x00,0x00
                  adc_window_cnt
00003c  0000              DCB      0x00,0x00
                  adc_net_buff_cnt
00003e  0000              DCB      0x00,0x00
                  plazma_sk
000040  0000              DCB      0x00,0x00
                  cntrl_stat_new
000042  0000              DCB      0x00,0x00
                  Ibmax
000044  0000              DCB      0x00,0x00
                  IZMAX_
000046  0000              DCB      0x00,0x00
                  Ubpsmax
000048  0000              DCB      0x00,0x00
                  samokalibr_cnt
00004a  0000              DCB      0x00,0x00
                  main_kb_cnt
00004c  0000              DCB      0x00,0x00
                  kb_cnt_1lev
00004e  0000              DCB      0x00,0x00
                  kb_cnt_2lev
000050  0000              DCB      0x00,0x00
                  kb_start
000052  0000              DCB      0x00,0x00
                  ibat_ips
000054  0000              DCB      0x00,0x00
                  ibat_ips_
000056  0000              DCB      0x00,0x00
                  bps_on_mask
000058  0000              DCB      0x00,0x00
                  bps_off_mask
00005a  0000              DCB      0x00,0x00
                  vz_cnt_s
00005c  0000              DCB      0x00,0x00
                  vz_cnt_s_
00005e  0000              DCB      0x00,0x00
                  vz_cnt_h
000060  0000              DCB      0x00,0x00
                  vz_cnt_h_
000062  0000              DCB      0x00,0x00
                  cnt_end_ke
000064  0000              DCB      0x00,0x00
                  __ee_vz_cnt
000066  0000              DCB      0x00,0x00
                  __ee_spc_stat
000068  0000              DCB      0x00,0x00
                  __ee_spc_bat
00006a  0000              DCB      0x00,0x00
                  __ee_spc_phase
00006c  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt
00006e  0000              DCB      0x00,0x00
                  cntrl_stat_blok_cnt_
000070  0000              DCB      0x00,0x00
                  numOfForvardBps_hourCnt
000072  0000              DCB      0x00,0x00
                  vz1_stat_cnt
000074  0000              DCB      0x00,0x00
                  volt_region_cnt
000076  0000              DCB      0x00,0x00
                  vz2_stat_cnt
000078  0000              DCB      0x00,0x00
                  vz2_stat_ph2_cnt
00007a  0000              DCB      0x00,0x00
                  plazma_ica1
00007c  0000              DCB      0x00,0x00
                  bat_hndl_i
00007e  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_hour
000080  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_min
000082  0000              DCB      0x00,0x00
                  bat_hndl_t_razr_mininhour
000084  0000              DCB      0x00,0x00
                  bat_hndl_i_temp
000086  0000              DCB      0x00,0x00
                  bat_hndl_u_end
000088  00000000          DCB      0x00,0x00,0x00,0x00
                  bat_hndl_i_zar_price
                          DCD      0x00000000
                  ibat
                          DCD      0x00000000
                  ibat_
                          DCD      0x00000000
                  i_avg_max
                          DCD      0x00000000
                  i_avg_min
                          DCD      0x00000000
                  i_avg_summ
                          DCD      0x00000000
                  i_avg
                          DCD      0x00000000
                  avg
                          DCD      0x00000000
                  cntrl_stat_blok_cnt_plus
                          DCD      0x00000000
                  cntrl_stat_blok_cnt_minus
                          DCD      0x00000000
                  plazma_inv
                          DCD      0x00000000
                  vz1_wrk_cnt
                          DCD      0x00000000
                  vz1_up_cnt
                          DCD      0x00000000
                  vz2_wrk_cnt
                          DCD      0x00000000
                  vz2_up_cnt
                          DCD      0x00000000
                  bat_hndl_t_razr
                          DCD      0x00000000
                  bat_hndl_t_razr_ke
                          DCD      0x00000000
                  bat_hndl_zvu_Q
                          DCD      0x00000000
                  bat_hndl_proc_razr
                          DCD      0x00000000
                  bat_hndl_remain_time
                          DCD      0x00000000
                  amper_chas_cnt_drv_summ
                          DCD      0x00000000
                  bat_hndl_i_summ
                          DCD      0x00000000
                  net_metr_buff_
                          DCD      0x00000000
0000e8  0000              DCB      0x00,0x00
                  adc_self_ch_buff
0000ea  0000              DCB      0x00,0x00
                          DCD      0x00000000
                  adc_self_ch_disp
                          DCD      0x00000000
0000f4  00000000          DCB      0x00,0x00,0x00,0x00
                  ke_date
                          %        8

                          AREA ||area_number.26||, DATA, ALIGN=0

                          EXPORTAS ||area_number.26||, ||.data||
                  rx_read_power_cnt_phase
000000  0f                DCB      0x0f

                          AREA ||area_number.27||, DATA, ALIGN=1

                          EXPORTAS ||area_number.27||, ||.data||
                  read_power_cnt_main_cnt
000000  0064              DCW      0x0064

                          AREA ||area_number.28||, DATA, ALIGN=0

                          EXPORTAS ||area_number.28||, ||.data||
                  rx_read_power_cnt_plazma
000000  00                DCB      0x00

                          AREA ||area_number.29||, DATA, ALIGN=0

                          EXPORTAS ||area_number.29||, ||.data||
                  rx_read_power_cnt_flag
000000  00                DCB      0x00

                          AREA ||area_number.30||, DATA, ALIGN=0

                          EXPORTAS ||area_number.30||, ||.data||
                  bENERGOMETR_UIP
000000  00                DCB      0x00

                          AREA ||area_number.31||, DATA, ALIGN=1

                          EXPORTAS ||area_number.31||, ||.data||
                  unet_buff_max
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.32||, DATA, ALIGN=0

                          EXPORTAS ||area_number.32||, ||.data||
                  adc_cnt
000000  00                DCB      0x00

                          AREA ||area_number.33||, DATA, ALIGN=0

                          EXPORTAS ||area_number.33||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.34||, DATA, ALIGN=1

                          EXPORTAS ||area_number.34||, ||.data||
                  zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.35||, DATA, ALIGN=0

                          EXPORTAS ||area_number.35||, ||.data||
                  net_buff_cnt
000000  00                DCB      0x00

                          AREA ||area_number.36||, DATA, ALIGN=1

                          EXPORTAS ||area_number.36||, ||.data||
                  ADWR
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.37||, DATA, ALIGN=1

                          EXPORTAS ||area_number.37||, ||.data||
                  period_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.38||, DATA, ALIGN=1

                          EXPORTAS ||area_number.38||, ||.data||
                  non_zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.39||, DATA, ALIGN=0

                          EXPORTAS ||area_number.39||, ||.data||
                  rele_stat
000000  00                DCB      0x00

                          AREA ||area_number.40||, DATA, ALIGN=0

                          EXPORTAS ||area_number.40||, ||.data||
                  bRELE_OUT
000000  00                DCB      0x00

                          AREA ||area_number.41||, DATA, ALIGN=2

                          EXPORTAS ||area_number.41||, ||.data||
                  main_power_buffer_
                          DCD      0x00000000

                          AREA ||area_number.42||, DATA, ALIGN=1

                          EXPORTAS ||area_number.42||, ||.data||
                  main_power_buffer_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.43||, DATA, ALIGN=1

                          EXPORTAS ||area_number.43||, ||.data||
                  adc_buff_out_
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00

                          AREA ||area_number.44||, DATA, ALIGN=1

                          EXPORTAS ||area_number.44||, ||.data||
                  plazma_adc_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.45||, DATA, ALIGN=0

                          EXPORTAS ||area_number.45||, ||.data||
                  unh_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.46||, DATA, ALIGN=0

                          EXPORTAS ||area_number.46||, ||.data||
                  unh_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.47||, DATA, ALIGN=0

                          EXPORTAS ||area_number.47||, ||.data||
                  b1Hz_unh
000000  00                DCB      0x00

                          AREA ||area_number.48||, DATA, ALIGN=0

                          EXPORTAS ||area_number.48||, ||.data||
                  ch_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.49||, DATA, ALIGN=0

                          EXPORTAS ||area_number.49||, ||.data||
                  b1_30Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.50||, DATA, ALIGN=0

                          EXPORTAS ||area_number.50||, ||.data||
                  ch_cnt2
000000  00                DCB      0x00

                          AREA ||area_number.51||, DATA, ALIGN=0

                          EXPORTAS ||area_number.51||, ||.data||
                  b1_10Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.52||, DATA, ALIGN=1

                          EXPORTAS ||area_number.52||, ||.data||
                  IZMAX_70
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.53||, DATA, ALIGN=1

                          EXPORTAS ||area_number.53||, ||.data||
                  IZMAX_130
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.54||, DATA, ALIGN=1

                          EXPORTAS ||area_number.54||, ||.data||
                  cntrl_stat_blck_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.55||, DATA, ALIGN=0

                          EXPORTAS ||area_number.55||, ||.data||
                  avg_cnt
000000  00                DCB      0x00

                          AREA ||area_number.56||, DATA, ALIGN=0

                          EXPORTAS ||area_number.56||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.57||, DATA, ALIGN=0

                          EXPORTAS ||area_number.57||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.58||, DATA, ALIGN=0

                          EXPORTAS ||area_number.58||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.59||, DATA, ALIGN=0

                          EXPORTAS ||area_number.59||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.60||, DATA, ALIGN=0

                          EXPORTAS ||area_number.60||, ||.data||
                  plazma_bat
000000  00                DCB      0x00

                          AREA ||area_number.61||, DATA, ALIGN=0

                          EXPORTAS ||area_number.61||, ||.data||
                  plazma_cntrl_stat
000000  00                DCB      0x00

                          AREA ||area_number.62||, DATA, ALIGN=1

                          EXPORTAS ||area_number.62||, ||.data||
                  ce102m_delayCnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.63||, DATA, ALIGN=1

                          EXPORTAS ||area_number.63||, ||.data||
                  volta_short
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.64||, DATA, ALIGN=1

                          EXPORTAS ||area_number.64||, ||.data||
                  curr_short
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.65||, DATA, ALIGN=2

                          EXPORTAS ||area_number.65||, ||.data||
                  power_int
                          DCD      0x00000000

                          AREA ||area_number.66||, DATA, ALIGN=1

                          EXPORTAS ||area_number.66||, ||.data||
                  plazma_ica2
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.67||, DATA, ALIGN=0

                          EXPORTAS ||area_number.67||, ||.data||
                  rele_hndl_plazma
000000  000000            DCB      0x00,0x00,0x00

;*** Start embedded assembler ***

#line 1 "control.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___9_control_c_9601dfb0____REV16|
#line 112 "C:\\Keil\\ARM\\CMSIS\\Include\\core_cmInstr.h"
|__asm___9_control_c_9601dfb0____REV16| PROC
#line 113

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___9_control_c_9601dfb0____REVSH|
#line 130
|__asm___9_control_c_9601dfb0____REVSH| PROC
#line 131

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
